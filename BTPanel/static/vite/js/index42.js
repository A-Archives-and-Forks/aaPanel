import{cw as e,d as t,a1 as a,k as s,b9 as n,cx as i,j as l,m as o}from"./page_layout.js?v=1744703330658";import{_ as r}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1744703330658";import{c as u,e as c,f as d,h as p,s as _,i as m}from"./logs.js?v=1744703330658";import{c as g,b as f,u as x,a as y}from"./public.js?v=1744703330658";import{d as v,r as b,j as k,R as w,S as h,P as C,V as S,U as N,$ as j,ap as L,F as $,N as P,ag as R,a1 as U,M as T,O as W,w as q,a0 as I,c as z,af as B,e as F}from"./vue.js?v=1744703330658";import{_ as A}from"./index104.js?v=1744703330658";import{_ as K}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1744703330658";import{_ as D}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1744703330658";import{_ as H}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1744703330658";import{T as M,bU as O,bz as V,ck as E}from"./naive.js?v=1744703330658";import{_ as G}from"./index103.js?v=1744703330658";import{_ as J}from"./index.js?v=1744703330658";import{_ as Q}from"./index95.js?v=1744703330658";import{_ as X}from"./logs.vue_vue_type_script_setup_true_lang.js?v=1744703330658";import{g as Y}from"./site.js?v=1744703330658";import"./common.js?v=1744703330658";import"./__commonjsHelpers__.js?v=1744703330658";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1744703330658";const Z={class:"w-240px"},ee={class:"item mt-10px"},te=["onClick"],ae=s(v({__name:"index",setup(s){const n=e(),i=b(),l=k({p:1,limit:999,search:"",type:-1}),o=b([]),{loading:c,setLoading:d}=g(),p=async()=>{try{d(!0);const{message:e}=await u(T(l));t(e)&&(n.setWebsite(e.data[0].name),i.value=e.data[0].name,o.value=e.data)}finally{d(!1)}};return p(),(e,t)=>{const s=r,u=a;return w(),h("div",Z,[C(s,{value:S(l).search,"onUpdate:value":t[0]||(t[0]=e=>S(l).search=e),placeholder:e.$t("Logs.Panel.index_4"),onSearch:p},null,8,["value","placeholder"]),N("div",ee,[S(c)?(w(),j(u,{key:0,height:"36px",text:"",repeat:6})):L("",!0),(w(!0),h($,null,P(S(o),(e=>(w(),h("div",{class:R(["list",{"list-active":S(i)==e.name}]),key:e.id,onClick:t=>{return a=e.name,n.setWebsite(a),void(i.value=a);var a}},U(e.name),11,te)))),128))])])}}}),[["__scopeId","data-v-87bf7484"]]),se=v({__name:"index",setup(a,{expose:s}){const i=e(),{t:l}=W(),{keys:o,table:r,columns:u}=f([{key:"username",title:l("Ftp.Analysis.Index_27")},{key:"type",title:l("Logs.Panel.index_6")},{key:"log",title:l("Public.Btn.Details")},{key:"addtime",align:"right",title:l("Logs.Panel.index_7")}]),d=k({search:i.websiteName,p:1,limit:10,stype:"Site manager"}),{loading:p,setLoading:_}=g(),m=async()=>{try{_(!0);const{message:e}=await c(d);t(e)&&(r.data=e.data,r.total=n(e.page))}finally{o.value=[],_(!1)}};q((()=>i.websiteName),(e=>{e&&(d.p=1,d.search=e,m())}));const x=()=>{i.websiteName&&m()};return x(),s({getList:x}),(e,t)=>{const a=M,s=H,n=D,i=K;return w(),j(i,{feedback:!1},{toolsLeft:I((()=>[C(a,{type:"primary",onClick:x},{default:I((()=>[z(U(e.$t("Public.Btn.Refresh")),1)])),_:1})])),table:I((()=>[C(s,{"checked-row-keys":S(o),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>B(o)?o.value=e:null),"row-key":"name",loading:S(p),data:S(r).data,columns:S(u)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:I((()=>[C(n,{page:S(d).p,"onUpdate:page":t[1]||(t[1]=e=>S(d).p=e),"page-size":S(d).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>S(d).limit=e),"item-count":S(r).total,onRefresh:x},null,8,["page","page-size","item-count"])])),_:1})}}}),ne=v({__name:"index",setup(a,{expose:s}){const n=e(),{loading:i,setLoading:l}=g(),o=b("None"),r=async()=>{l(!0);try{const{message:e}=await d({siteName:n.websiteName});t(e)&&(o.value=e.result?e.result:"None")}finally{l(!1)}};q((()=>n.websiteName),(e=>{e&&r()}));const u=()=>{n.websiteName&&r()};return u(),s({getList:u}),(e,t)=>{const a=M,s=G,n=O;return w(),j(n,{vertical:"",class:"h-full"},{default:I((()=>[C(a,{class:"self-start",type:"primary",onClick:u},{default:I((()=>[z(U(e.$t("Public.Btn.Refresh")),1)])),_:1}),C(s,{loading:S(i),log:S(o)},null,8,["loading","log"])])),_:1})}}}),ie=v({__name:"index",setup(a,{expose:s}){const n=e(),{loading:i,setLoading:l}=g(),o=b("None"),r=async()=>{l(!0);try{const{message:e}=await p({siteName:n.websiteName});t(e)&&(o.value=e.result?e.result:"None")}finally{l(!1)}};q((()=>n.websiteName),(e=>{e&&r()}));const u=()=>{n.websiteName&&r()};return u(),s({getList:u}),(e,t)=>{const a=M,s=G,n=O;return w(),j(n,{vertical:"",class:"h-full"},{default:I((()=>[C(a,{class:"self-start",type:"primary",onClick:u},{default:I((()=>[z(U(e.$t("Public.Btn.Refresh")),1)])),_:1}),C(s,{loading:S(i),log:S(o)},null,8,["loading","log"])])),_:1})}}}),le={class:"text-error"},oe={class:"w-400px p-20px"},re={class:"mb-16px"},ue=s(v({__name:"index",setup(a,{expose:s}){const n=e(),r=i(),{t:u}=W(),c=b(!1),d=b(0),{keys:p,table:v,columns:k}=f([{key:"start_time",title:u("Logs.Panel.index_13")},{key:"time",title:u("Public.Unit.Time"),render:e=>Number(e.time).toFixed(2)+" Sec"},{key:"xss",title:u("Site.TableRow.index_4"),render:e=>e.xss>0?C(l,{onClick:()=>{P("xss")}},{default:()=>[e.xss]}):e.xss},{key:"sql",title:u("Site.TableRow.index_5"),render:e=>e.sql>0?C(l,{onClick:()=>{P("sql")}},{default:()=>[e.sql]}):e.sql},{key:"san",title:u("Site.TableRow.index_6"),render:e=>e.san>0?C(l,{class:"button-color",onClick:()=>{P("san")}},{default:()=>[e.san]}):e.san},{key:"php",title:u("Logs.Panel.index_14"),render:e=>e.php>0?C(l,{onClick:()=>{P("php")}},{default:()=>[e.php]}):e.php},{key:"ip",title:u("Logs.Website.index_5"),render:e=>e.ip>0?C(l,{onClick:()=>{P("ip")}},{default:()=>[e.ip]}):e.ip},{key:"url",title:u("Logs.Website.index_1"),render:e=>e.url>0?C(l,{onClick:()=>{P("url")}},{default:()=>[e.url]}):e.url},{key:"log",title:u("Security.Anti.Index_7"),render:e=>e.xss+e.sql+e.san+e.php+e.ip+e.url}]),j=()=>{y({title:u("Site.Config.index_104"),content:u("Logs.Website.index_3",[n.websiteName]),onConfirm:async({hide:e})=>{try{await _({siteName:R.value}),c.value=!0,L()}finally{e()}}})},L=(e=0)=>{let a=setTimeout((async()=>{const{message:e}=await Y({path:R.value});t(e)&&(d.value=e.result,d.value>=100?(o.success(u("Site.Config.index_107")),c.value=!1,d.value=0,D(),clearTimeout(a)):L(1e3))}),e)},P=e=>{x({title:"[".concat(e,"] ").concat(u("Site.Config.index_103")),data:{type:e,path:R.value},component:X})},R=F((()=>{let e="";switch(r.webserver){case"nginx":e=".log";break;case"apache":e="-access_log";break;default:e="_ols.access_log"}return"/www/wwwlogs/".concat(n.websiteName).concat(e)})),{loading:T,setLoading:A}=g(),D=async()=>{try{A(!0);const{message:e}=await m({siteName:R.value});t(e)&&(v.data=e.is_status?[e]:[])}finally{p.value=[],A(!1)}};return q((()=>n.websiteName),(e=>{e&&D()})),D(),s({init:D}),(e,t)=>{const a=M,s=H,n=K,i=Q,o=V,r=J;return w(),h($,null,[C(n,{feedback:!1},{toolsLeft:I((()=>[C(a,{type:"primary",onClick:j},{default:I((()=>[z(U(e.$t("Site.Config.index_104")),1)])),_:1})])),table:I((()=>[C(s,{"checked-row-keys":S(p),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>B(p)?p.value=e:null),"row-key":"name","max-height":1e3,loading:S(T),data:S(v).data,columns:S(k)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),C(i,{class:"mt-16px"},{default:I((()=>[N("li",null,[z(U(e.$t("Site.Config.index_108"))+" ",1),N("span",le,U(e.$t("Site.Config.index_109")),1)]),N("li",null,U(e.$t("Site.Config.index_110")),1),N("li",null,U(e.$t("Site.Config.index_111")),1),N("li",null,U(e.$t("Site.Config.index_112")),1),N("li",null,[C(l,{href:"https://www.aapanel.com/forum/d/3351-nginx-waf-instructions",target:"_blank"},{default:I((()=>[z(U(e.$t("Site.Config.index_113")),1)])),_:1}),z(" "+U(e.$t("Site.Config.index_114")),1)])])),_:1}),C(r,{show:S(c),"onUpdate:show":t[1]||(t[1]=e=>B(c)?c.value=e:null)},{default:I((()=>[N("div",oe,[N("div",re,U(e.$t("Site.Config.index_115")),1),C(o,{type:"line",status:"success",height:24,percentage:S(d),"border-radius":4,"indicator-placement":"inside"},null,8,["percentage"])])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-e3fe61d2"]]),ce=s(v({__name:"index",setup(e){const{t:t}=W(),a=b("operation"),s=[{key:"operation",label:t("Security.Tabs.Index_7"),component:se},{key:"access",label:t("Logs.Website.index_2"),component:ne},{key:"error",label:t("Logs.Website.index_4"),component:ie},{key:"security",label:t("Site.Config.index_102"),component:ue}];return(e,t)=>{const n=A;return w(),j(n,{class:"box",value:S(a),"onUpdate:value":t[0]||(t[0]=e=>B(a)?a.value=e:null),options:s},null,8,["value"])}}}),[["__scopeId","data-v-7029a0a8"]]),de=v({__name:"index",setup(e){const t=i();return(async()=>{await t.getConfig()})(),(e,t)=>{const a=O,s=E;return w(),j(s,{class:"p-16px"},{default:I((()=>[C(a,{class:"flex-nowrap!"},{default:I((()=>[C(ae),C(ce)])),_:1})])),_:1})}}});export{de as default};
