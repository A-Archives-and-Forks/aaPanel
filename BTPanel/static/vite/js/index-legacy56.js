System.register(["./index-legacy104.js?v=1741416570306","./page_layout-legacy.js?v=1741416570306","./vue-legacy.js?v=1741416570306","./public-legacy.js?v=1741416570306","./index-legacy.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy2.js?v=1741416570306","./config-legacy3.js?v=1741416570306","./naive-legacy.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy4.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1741416570306"],(function(e,t){"use strict";var s,a,i,l,n,c,o,u,r,d,p,S,_,y,g,x,v,m,f,h,b,H,w,k,$,B,L,j,C,O,A,U,P,q,M,z,R,T,N,F,J,G,I,V,W,Y,D,E,Q,K,X,Z,ee,te,se,ae,ie,le,ne,ce;return{setters:[e=>{s=e._},e=>{a=e.az,i=e.d,l=e.b,n=e.a,c=e.au,o=e.m,u=e.bY,r=e.l,d=e.j,p=e.k,S=e.u,_=e.G,y=e.$},e=>{g=e.d,x=e.M,v=e.r,m=e.e,f=e.P,h=e.Q,b=e.N,H=e.$,w=e.S,k=e.ah,$=e.ae,B=e.R,L=e.a0,j=e.c,C=e._,O=e.W,A=e.Y,U=e.j,P=e.a7,q=e.F,M=e.k,z=e.v,R=e.n},e=>{T=e.d,N=e.c,F=e.a,J=e.e,G=e.b},e=>{I=e._},e=>{V=e._},e=>{W=e._},e=>{Y=e.g},e=>{D=e.bV,E=e.cb,Q=e.bS,K=e.T,X=e.ch,Z=e.bu,ee=e.cm,te=e.cf,se=e.ce,ae=e.bO},e=>{ie=e._},e=>{le=e._},e=>{ne=e._},e=>{ce=e._}],execute:function(){var oe=document.createElement("style");oe.textContent=".ul-style[data-v-6bf43814]{margin:0 auto;display:flex;align-items:center;justify-content:center;gap:48px;font-size:16px}.ul-style li[data-v-6bf43814]{display:flex;align-items:center}\n",document.head.appendChild(oe),e("o",((e,t=!0)=>a.post("/ssh_security?action=set_sshkey",e,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_3"),successMessage:t}})));const ue=e("g",(()=>a.post("/ssh_security?action=get_key"))),re=(e("a",(e=>a.post("/ssh_security?action=get_logs",e))),e("b",(()=>a.post("/ssh_security?action=get_login_send")))),de=(e("s",((e,t)=>a.post("/ssh_security?action="+(e?"set_login_send":"clear_login_send"),t,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_9"),successMessage:!0}}))),e("c",(()=>a.post("/ssh_security?action=return_ip"))),e("e",(e=>a.post("/ssh_security?action=add_return_ip",e,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_10"),successMessage:!0}}))),e("d",(e=>a.post("/ssh_security?action=del_return_ip",e,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_11"),successMessage:!0}}))),{class:"px-16px pt-4px pb-16px"}),pe={class:"mx-20px"},Se={class:"w-200px mr-6px"},_e={class:"ml-10px text-desc"},ye={class:"my-24px"},ge={class:"w-360px"},xe={class:"flex w-260px"},ve={class:"flex-1 mr-6px"},me={class:"ml-10px text-desc"},fe={class:"ml-10px text-desc"},he={class:"my-24px"},be={class:"ml-10px text-desc"},He={class:"mt-20px text-desc"},we=g({__name:"index",setup(e,{expose:s}){const p=O((()=>n((()=>t.import("./open-legacy2.js?v=1741416570306")),void 0))),S=O((()=>n((()=>t.import("./view-legacy.js?v=1741416570306")),void 0))),_=O((()=>n((()=>t.import("./index-legacy196.js?v=1741416570306")),void 0))),{t:y}=x(),g=v(!1),A=async e=>{var t;await(t={status:e},a.post("/ssh_security?action="+(t.status?"set_password":"stop_password"),t,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_2"),successMessage:!0}}))},U=v(!1),P=T(y("Security.SSH.Basic.index_19"),{onRefresh:()=>{Le()}}),q=()=>{U.value=!1},M=async e=>{e?P.show=!0:(await a.post("/ssh_security?action=stop_key",{},{requestOptions:{loading:i.global.t("Security.SSH.Api.index_4"),successMessage:!0}}),Le())},z=v(22),R=async()=>{var e;c(z.value)?await(e={port:z.value},a.post("/firewall?action=SetSshPort",e,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_5"),successMessage:!0}})):o.error(y("Security.SSH.Basic.index_20"),{close:!0})},J=v(null),G=v([]),Z=async e=>{var t;await(t={p_type:e},a.post("/ssh_security?action=set_root",t,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_6"),successMessage:!0}}))},ee=v(""),te=()=>{""!==ee.value.trim()?F({title:y("Security.SSH.Basic.index_22"),content:y("Security.SSH.Basic.index_23"),onConfirm:async()=>{var e;await(e={username:"root",password:ee.value},a.post("/ssh_security?action=set_root_password",e,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_7"),successMessage:!0}}))}}):o.error(y("Security.SSH.Basic.index_21"))},se=T(y("Security.SSH.Basic.index_2")),ae=()=>{U.value?se.show=!0:o.error(y("Security.SSH.Basic.index_24"))},ie=async()=>{if(!U.value)return void o.error(y("Security.SSH.Basic.index_25"));const{close:e}=o.loading(y("Security.SSH.Basic.index_26"));try{await ue(),window.open(`${u()}/ssh_security?action=download_key`)}finally{e()}},le=v(""),ne=v({}),ce=m((()=>void 0===Object.keys(ne.value).find((e=>e===le.value)))),oe=m((()=>{const e=ne.value[le.value];return e?e.title:""})),we=T(y("Security.SSH.Basic.index_13"),{onSetName:e=>{le.value=e}}),ke=()=>{we.data.config=ne.value,we.show=!0},$e=k(),Be=()=>{$e.push("/security/system-hardening")},Le=async()=>{const{message:e}=await a.post("/ssh_security?action=get_config");l(e)&&(g.value="yes"===e.password,U.value="yes"===e.pubkey,z.value=e.port,J.value=e.root_login_type,l(e.root_login_types)&&(G.value=Object.entries(e.root_login_types).map((([e,t])=>({label:t,value:e})))))},je=async()=>{const{message:e}=await re();l(e)&&(le.value=e.result)},Ce=async()=>{const{message:e}=await Y();l(e)&&(ne.value=e)},{setLoading:Oe}=N(!0);return(async()=>{try{Oe(!0),await Promise.all([Le(),je(),Ce()])}finally{Oe(!1)}})(),s({init:()=>{je(),Le()}}),(e,t)=>{const s=D,a=E,i=Q,l=K,n=r,c=X,o=W,u=d,y=V,x=I;return f(),h("div",de,[b(y,{"label-width":"140px"},{default:H((()=>[b(a,{label:e.$t("Security.SSH.Basic.index_1")},{default:H((()=>[b(s,{value:w(g),"onUpdate:value":[t[0]||(t[0]=e=>$(g)?g.value=e:null),A],size:"small"},null,8,["value"]),B("span",pe,L(e.$t("Security.SSH.Basic.index_2")),1),b(s,{value:w(U),"onUpdate:value":[t[1]||(t[1]=e=>$(U)?U.value=e:null),M],size:"small"},null,8,["value"])])),_:1},8,["label"]),b(a,{label:e.$t("Security.SSH.Basic.index_3"),"show-feedback":!1},{default:H((()=>[B("div",Se,[b(i,{value:w(z),"onUpdate:value":t[2]||(t[2]=e=>$(z)?z.value=e:null),min:1,max:65535,"show-button":!1},null,8,["value"])]),b(l,{type:"primary",onClick:R},{default:H((()=>[j(L(e.$t("Public.Btn.Save")),1)])),_:1}),B("div",_e,L(e.$t("Security.SSH.Basic.index_4")),1)])),_:1},8,["label"]),B("div",ye,[b(n)]),b(a,{label:e.$t("Security.SSH.Basic.index_5")},{default:H((()=>[B("div",ge,[b(c,{value:w(J),"onUpdate:value":[t[3]||(t[3]=e=>$(J)?J.value=e:null),Z],options:w(G)},null,8,["value","options"])])])),_:1},8,["label"]),b(a,{label:e.$t("Security.SSH.Basic.index_6")},{default:H((()=>[B("div",xe,[B("div",ve,[b(o,{value:w(ee),"onUpdate:value":t[4]||(t[4]=e=>$(ee)?ee.value=e:null),default:!1},null,8,["value"])]),b(l,{type:"primary",onClick:te},{default:H((()=>[j(L(e.$t("Public.Btn.Reset")),1)])),_:1})]),B("div",me,L(e.$t("Security.SSH.Basic.index_8")),1)])),_:1},8,["label"]),b(a,{label:e.$t("Security.SSH.Basic.index_9"),"show-feedback":!1},{default:H((()=>[b(l,{type:"primary",class:"btn-xs",onClick:ae},{default:H((()=>[j(L(e.$t("Security.SSH.Basic.index_10")),1)])),_:1}),b(l,{class:"btn-xs ml-10px",onClick:ie},{default:H((()=>[j(L(e.$t("Public.Btn.Download")),1)])),_:1}),B("div",fe,L(e.$t("Security.SSH.Basic.index_12")),1)])),_:1},8,["label"]),B("div",he,[b(n)]),b(a,{label:e.$t("Security.SSH.Basic.index_13"),"show-feedback":!1},{default:H((()=>[w(ce)?(f(),C(u,{key:0,type:"warning",onClick:ke},{default:H((()=>[j(L(e.$t("Security.SSH.Basic.index_14")),1)])),_:1})):(f(),C(u,{key:1,onClick:ke},{default:H((()=>[j(L(e.$t("Security.SSH.Basic.index_15",[w(oe)])),1)])),_:1})),b(l,{type:"primary",class:"btn-xs ml-10px",onClick:ke},{default:H((()=>[j(L(e.$t("Public.Btn.Set")),1)])),_:1}),B("div",be,L(e.$t("Security.SSH.Basic.index_12")),1)])),_:1},8,["label"]),B("div",He,[j(L(e.$t("Security.SSH.Basic.index_17"))+" ",1),b(u,{onClick:Be},{default:H((()=>[j(">>"+L(e.$t("Security.SSH.Basic.index_18")),1)])),_:1})])])),_:1}),b(x,{show:w(P).show,"onUpdate:show":t[5]||(t[5]=e=>w(P).show=e),title:w(P).title,data:w(P).data,width:400,"min-height":124,footer:!0,component:w(p),onPublicClose:q},null,8,["show","title","data","component"]),b(x,{show:w(se).show,"onUpdate:show":t[6]||(t[6]=e=>w(se).show=e),title:w(se).title,width:400,"min-height":322,component:w(S)},null,8,["show","title","component"]),b(x,{show:w(we).show,"onUpdate:show":t[7]||(t[7]=e=>w(we).show=e),title:w(we).title,data:w(we).data,width:1e3,height:600,component:w(_)},null,8,["show","title","data","component"])])}}}),ke={class:"pt-40px pb-40px"},$e={class:"mb-24px text-center text-22px font-bold"},Be={class:"mb-16px"},Le={class:"ul-style"},je={class:"ml-4px"},Ce={class:"text-center my-24px"},Oe={class:"flex justify-center"},Ae={class:"w-76%"},Ue=p(g({__name:"free",setup(e){const t=()=>{J({source:100})};return(e,s)=>{const a=K,i=Z;return f(),h("div",ke,[B("div",$e,L(e.$t("Security.SSH.Logs.free_1")),1),B("div",Be,[B("ul",Le,[B("li",null,[B("span",je,L(e.$t("Security.SSH.Logs.free_2")),1)])])]),B("div",Ce,[b(a,{type:"primary",class:"h-36px text-14px",onClick:t},{default:H((()=>[j(L(e.$t("WP.Transition.index_7")),1)])),_:1})]),B("div",Oe,[B("div",Ae,[b(i,{class:"flex justify-center w-full",src:w("/static/vite/images/ssh-logs.png")},null,8,["src"])])])])}}}),[["__scopeId","data-v-6bf43814"]]),Pe=g({__name:"index",setup(e,{expose:t}){const{t:s}=x(),n=S(),{isPro:c}=A(n),{table:u,columns:r,setLoading:d}=G([{key:"address",title:s("Security.SSH.Logs.index_5"),render:e=>b("a",{class:"bt-link",href:"javascript:;",onClick:()=>{p(e)}},[e.address,j(":"),b("span",{class:"text-#666 cursor-default"},[e.port])])},{key:"area",title:s("Security.SSH.Logs.index_6"),render:e=>e.area.info||"--"},{key:"user",title:s("Security.SSH.Logs.index_7")},{key:"status",title:s("Security.SSH.Logs.index_8"),render:e=>b("span",{class:e.status?"text-primary":"text-error"},[e.status?s("Security.SSH.Logs.index_14"):s("Security.SSH.Logs.index_15")])},{key:"time",title:s("Security.SSH.Logs.index_9")}]),p=e=>{F({title:s("Security.SSH.Logs.index_10"),content:e.deny_status?s("Security.SSH.Logs.index_13"):s("Security.SSH.Logs.index_11"),onConfirm:async()=>{if(e.deny_status){const{message:s}=await(t={address:e.address},a.post("/safe/syslog/remove_ip_rules",{data:JSON.stringify(t)},{requestOptions:{loading:i.global.t("Security.SSH.Api.index_8")}}));_(s)&&s.length>0&&o.success(s[0].msg)}else{const{message:t}=await(e=>a.post("/safe/syslog/create_ip_rules",{data:JSON.stringify(e)},{requestOptions:{loading:i.global.t("Security.SSH.Api.index_8")}}))({address:e.address,types:"drop",brief:s("Security.SSH.Logs.index_12"),domain:"",choose:"address"});_(t)&&t.length>0&&o.success(t[0].msg)}var t;v()}})},y=U({p:1,limit:20,select:"ALL",search:""}),g=()=>{c.value&&(y.p=1,v())},v=async()=>{try{d(!0);const{message:t}=await(e=P(y),a.post("/safe/syslog/get_ssh_list",{data:JSON.stringify(e)}));l(t)&&(u.data=_(t.data)?t.data:[],u.total=t.total)}finally{d(!1)}var e};return g(),t({init:()=>{y.select="ALL",g()}}),(e,t)=>{const s=K,a=ee,i=te,l=ce,n=ne,o=le,d=ie;return w(c)?(f(),C(d,{key:0},{toolsLeft:H((()=>[b(s,{type:"primary",onClick:g},{default:H((()=>[j(L(e.$t("Public.Btn.Refresh")),1)])),_:1})])),toolsRight:H((()=>[b(i,{value:w(y).select,"onUpdate:value":[t[0]||(t[0]=e=>w(y).select=e),g]},{default:H((()=>[b(a,{value:"ALL"},{default:H((()=>[j(L(e.$t("Security.SSH.Logs.index_1")),1)])),_:1}),b(a,{value:"Accepted"},{default:H((()=>[j(L(e.$t("Security.SSH.Logs.index_2")),1)])),_:1}),b(a,{value:"Failed"},{default:H((()=>[j(L(e.$t("Security.SSH.Logs.index_3")),1)])),_:1})])),_:1},8,["value"]),b(l,{value:w(y).search,"onUpdate:value":t[1]||(t[1]=e=>w(y).search=e),width:"320",placeholder:e.$t("Security.SSH.Logs.index_4"),onSearch:g},null,8,["value","placeholder"])])),table:H((()=>[b(n,{loading:w(u).loading,data:w(u).data,columns:w(r)},null,8,["loading","data","columns"])])),pageRight:H((()=>[b(o,{page:w(y).p,"onUpdate:page":t[2]||(t[2]=e=>w(y).p=e),"page-size":w(y).limit,"onUpdate:pageSize":t[3]||(t[3]=e=>w(y).limit=e),"item-count":w(u).total,onRefresh:v},null,8,["page","page-size","item-count"])])),_:1})):(f(),C(Ue,{key:1}))}}}),qe={class:"mr-10px"},Me={class:"mx-20px"},ze=g({__name:"index",setup(e){const{t:t}=x(),n=U({status:!1,success:0,successToday:0,error:0,errorToday:0}),c=v(),o=v("basic"),u=[{key:"basic",label:t("Security.SSH.index_5"),component:we},{key:"logs",label:t("Security.SSH.index_6"),data:{type:"ALL"},component:Pe}],p=e=>{c.value.setValue("logs"),R((()=>{const t=c.value.getCompRef("logs");t&&t.init(e)}))},S=async()=>{const{message:e}=await a.post("/safe/ssh/GetSshInfo");l(e)&&(n.status=e.status)},_=async()=>{const{message:e}=await a.post("/safe/ssh/get_ssh_login_info");l(e)&&(n.success=e.success,n.successToday=e.today_success,n.error=e.error,n.errorToday=e.today_error)},g=e=>{F({title:t("Security.SSH.index_7"),content:t(e?"Security.SSH.index_8":"Security.SSH.index_9"),onConfirm:async()=>{var t;await(t={status:e?0:1},a.post("/firewall?action=SetSshStatus",t,{requestOptions:{loading:i.global.t("Security.SSH.Api.index_1"),successMessage:!0}})),S(),_()}})},{loading:m,setLoading:k}=N();return k(!0),Promise.all([S(),_()]).finally((()=>{k(!1)})),(e,t)=>{const a=y,i=D,l=r,S=d,_=ae,x=se,v=s;return f(),h(q,null,[b(x,{class:"mb-16px p-16px"},{default:H((()=>[M(b(a,{width:600,height:20,sharp:!1,size:"medium"},null,512),[[z,w(m)]]),M(b(_,{class:"items-center",size:0},{default:H((()=>[B("div",qe,L(e.$t("Security.SSH.index_1")),1),b(i,{value:w(n).status,"onUpdate:value":g},null,8,["value"]),B("div",Me,[b(l,{class:"mx-0! text-20px",vertical:""})]),B("div",null,[B("span",null,L(e.$t("Security.SSH.index_2")),1),b(S,{onClick:t[0]||(t[0]=e=>p("Accepted"))},{default:H((()=>[j(L(e.$t("Security.SSH.index_3",[w(n).success,w(n).successToday])),1)])),_:1}),t[3]||(t[3]=B("span",{class:"mx-10px"},"/",-1)),b(S,{type:"error",onClick:t[1]||(t[1]=e=>p("Failed"))},{default:H((()=>[j(L(e.$t("Security.SSH.index_4",[w(n).error,w(n).errorToday])),1)])),_:1})])])),_:1},512),[[z,!w(m)]])])),_:1}),b(x,{class:"p-16px"},{default:H((()=>[b(v,{ref_key:"tabsRef",ref:c,value:w(o),"onUpdate:value":t[2]||(t[2]=e=>$(o)?o.value=e:null),options:u},null,8,["value"])])),_:1})],64)}}}),Re=Object.freeze(Object.defineProperty({__proto__:null,default:ze},Symbol.toStringTag,{value:"Module"}));e("i",Re)}}}));
