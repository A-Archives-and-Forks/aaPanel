const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index268.js?v=1756367574781","js/index108.js?v=1756367574781","js/vue.js?v=1756367574781","js/__commonjsHelpers__.js?v=1756367574781","js/naive.js?v=1756367574781","js/common.js?v=1756367574781","js/page_layout.js?v=1756367574781","js/public.js?v=1756367574781","css/public.css?v=1756367574781","css/page_layout.css?v=1756367574781","css/index21.css?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang5.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang6.js?v=1756367574781","css/index15.css?v=1756367574781","js/index87.js?v=1756367574781","js/index133.js?v=1756367574781","css/index23.css?v=1756367574781","js/index.js?v=1756367574781","css/index107.css?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang7.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang12.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang8.js?v=1756367574781","js/site4.js?v=1756367574781","js/site.js?v=1756367574781","js/soft.js?v=1756367574781","js/index244.js?v=1756367574781","css/index59.css?v=1756367574781","js/index99.js?v=1756367574781","css/index14.css?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang10.js?v=1756367574781","js/index98.js?v=1756367574781","css/index13.css?v=1756367574781","js/index100.js?v=1756367574781","js/index101.js?v=1756367574781","js/file.js?v=1756367574781","js/theme-monokai.js?v=1756367574781","css/index16.css?v=1756367574781","js/refersh.js?v=1756367574781","js/php.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang17.js?v=1756367574781","js/index105.js?v=1756367574781","css/index19.css?v=1756367574781","js/ssl.js?v=1756367574781","js/cert.js?v=1756367574781","js/utils3.js?v=1756367574781","js/index217.js?v=1756367574781","js/paypal-js.js?v=1756367574781","css/index48.css?v=1756367574781","js/ssl-lets-progress.js?v=1756367574781","css/ssl-lets-progress.css?v=1756367574781","js/upload.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang15.js?v=1756367574781","css/index60.css?v=1756367574781","js/index269.js?v=1756367574781"])))=>i.map(i=>d[i]);
import{t as e,i as t,d as a,bd as l,p as s,m as i,w as n,bR as o,_ as u,a as r}from"./page_layout.js?v=1756367574781";import{_ as d}from"./index.js?v=1756367574781";import{o as p}from"./site4.js?v=1756367574781";import{d as c,c as _,h as m,f as h,a as f,_ as v,w,e as x,G as g,r as y}from"./public.js?v=1756367574781";import{X as b,aG as k}from"./site.js?v=1756367574781";import{i as j,j as P,k as C,l as O,s as R,n as W,p as D}from"./index87.js?v=1756367574781";import{_ as z}from"./index108.js?v=1756367574781";import{i as q,p as M,k as U,W as L,R as $,V as A,S as B,U as F,a2 as E,a3 as I,q as S,P as T,r as H,aj as V,ak as K,j as N,a4 as G,t as J,an as X,e as Q,_ as Y}from"./vue.js?v=1756367574781";import{dj as Z,dm as ee,dd as te,au as ae,aC as le,dk as se,bJ as ie}from"./naive.js?v=1756367574781";import{_ as ne}from"./form.vue_vue_type_script_setup_true_lang2.js?v=1756367574781";import"./common.js?v=1756367574781";import"./__commonjsHelpers__.js?v=1756367574781";import"./index133.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang12.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1756367574781";import"./soft.js?v=1756367574781";import"./index244.js?v=1756367574781";import"./index99.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang10.js?v=1756367574781";import"./index98.js?v=1756367574781";import"./index100.js?v=1756367574781";import"./index101.js?v=1756367574781";import"./file.js?v=1756367574781";import"./theme-monokai.js?v=1756367574781";import"./refersh.js?v=1756367574781";import"./php.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang17.js?v=1756367574781";import"./index105.js?v=1756367574781";import"./ssl.js?v=1756367574781";import"./cert.js?v=1756367574781";import"./utils3.js?v=1756367574781";import"./index217.js?v=1756367574781";import"./paypal-js.js?v=1756367574781";import"./ssl-lets-progress.js?v=1756367574781";import"./upload.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang15.js?v=1756367574781";const oe=Symbol("server-list");function ue(){return q(oe)}const re=a=>e.post("/tamper_core/add_black_exts.json",a,{requestOptions:{loading:t.global.t("WP.api.tamper_2"),isOriginalResult:!0,prefix:""}}),de=a=>e.post("/tamper_core/remove_black_exts.json",a,{requestOptions:{loading:t.global.t("WP.api.tamper_3"),isOriginalResult:!0,prefix:""}}),pe=U({__name:"index",setup(s,{expose:i}){const{site:n,setPid:o}=ue(),{loading:u,setLoading:r}=c(),{table:d,columns:p}=_([{key:"name",title:"Name"},{key:"status",title:"Status",align:"right",render:l=>L(Z,{value:l.status,size:"small",checkedValue:1,uncheckedValue:0,onUpdateValue:async s=>{const{message:i}=await(n={key:l.key,value:s,path_id:l.id},e.post("/tamper_core/modify_path_config.json",n,{requestOptions:{loading:t.global.t("WP.api.tamper_1"),isOriginalResult:!0,prefix:""}}));var n;a(i)&&i.status&&(l.status=s)}},null)}]),h=[{title:"Create file",name:"create"},{title:"Modify file",name:"modify"},{title:"Delete file",name:"unlink"},{title:"Create directory",name:"mkdir"},{title:"Delete directory",name:"rmdir"},{title:"Rename file",name:"rename"},{title:"Create soft link",name:"link"},{title:"Modify permissions",name:"chmod"},{title:"Modify owner",name:"chown"}],f=async()=>{try{r(!0);const{message:t}=await j({path:n.path});a(t)&&!ee(t)?(o(t.pid),e=t,d.data=h.map(t=>{const a="is_".concat(t.name),s=e[a];return{key:a,id:e.pid,name:"Disabled ".concat(t.title),status:l(s)?s:0}})):d.data=[]}finally{r(!1)}var e};return f(),i({init:f}),(e,t)=>{const a=m;return A(),$("div",null,[L(a,{loading:F(u),"loading-num":9,"max-height":340,data:F(d).data,columns:F(p)},null,8,["loading","data","columns"]),t[0]||(t[0]=B("div",{class:"mt-16px text-#777"}," Tip: Current config intercepts the above rules by default, please set and config the rules according the current project requirements. ",-1))])}}});const ce=s({},[["render",function(e,t){const a=te;return A(),E(a,{size:"small",bordered:!1},{default:I(()=>[S(e.$slots,"default",{},void 0,!0)]),_:3})}],["__scopeId","data-v-c6193199"]]),_e={class:"flex mb-12px"},me={class:"w-240px mr-12px"},he=U({__name:"index",setup(e,{expose:t}){const{t:l}=T(),{site:s,setPid:o}=ue(),u=H("");let r=-1,d="";const p=async()=>{if(""===u.value.trim())return void i.error("Please enter suffix");const{message:e}=await re({path_id:r,path:d,exts:u.value});a(e)&&(e.status?(i.success(e.msg),u.value="",k()):i.error(e.msg))},{table:w,columns:x}=_([{key:"exts",title:"Suffix"},h({width:100,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{g(e)}}]})]),g=async e=>{f({title:"Delete protected file suffix [".concat(e.exts,"]"),content:"Delete protected file suffix, the file whose file name ends with this suffix will lose protection. want to continue?",onConfirm:async()=>{const{message:t}=await de({path_id:e.id,path:d,exts:e.exts});a(t)&&(t.status?(i.success(t.msg),k()):i.error(t.msg))}})},{loading:y,setLoading:b}=c(),k=async()=>{try{b(!0);const{message:t}=await j({path:s.path});a(t)&&(o(t.pid),r=(e=t).pid,d=e.path,n(e.black_exts)?w.data=e.black_exts.filter(e=>"/"!=e[0]&&-1==e.indexOf("./")).map(t=>({id:e.pid,exts:t})):w.data=[])}finally{b(!1)}var e};return k(),t({init:k}),(e,t)=>{const a=ae,l=le,s=m,i=ce,n=v;return A(),$("div",null,[B("div",_e,[B("div",me,[L(a,{value:F(u),"onUpdate:value":t[0]||(t[0]=e=>K(u)?u.value=e:null),placeholder:"Suffix",onKeyup:V(p,["enter"])},null,8,["value"])]),L(l,{type:"primary",onClick:p},{default:I(()=>[N(G(e.$t("Public.Btn.Add")),1)]),_:1})]),L(s,{loading:F(y),"loading-num":6,"max-height":230,data:F(w).data,columns:F(x)},null,8,["loading","data","columns"]),L(n,{class:"mt-16px"},{default:I(()=>[t[25]||(t[25]=B("li",null," The so-called file suffix refers the string at the end of the file name, not necessarily the extension ",-1)),B("li",null,[t[5]||(t[5]=N(" As: ",-1)),L(i,null,{default:I(()=>t[1]||(t[1]=[N(".php",-1)])),_:1,__:[1]}),t[6]||(t[6]=N(", ",-1)),L(i,null,{default:I(()=>t[2]||(t[2]=[N(".html",-1)])),_:1,__:[2]}),t[7]||(t[7]=N(", ",-1)),L(i,null,{default:I(()=>t[3]||(t[3]=[N(".js?v=1756367574781",-1)])),_:1,__:[3]}),t[8]||(t[8]=N(", ",-1)),L(i,null,{default:I(()=>t[4]||(t[4]=[N("index.php",-1)])),_:1,__:[4]}),t[9]||(t[9]=N(" etc. ",-1))]),t[26]||(t[26]=B("div",null,"Example:",-1)),B("li",null,[L(i,null,{default:I(()=>t[10]||(t[10]=[N(".php",-1)])),_:1,__:[10]}),t[14]||(t[14]=N(" Match: ",-1)),L(i,null,{default:I(()=>t[11]||(t[11]=[N("./1.php",-1)])),_:1,__:[11]}),t[15]||(t[15]=N()),L(i,null,{default:I(()=>t[12]||(t[12]=[N("./test/2.php",-1)])),_:1,__:[12]}),t[16]||(t[16]=N(" Mismatch: ",-1)),L(i,null,{default:I(()=>t[13]||(t[13]=[N("./1.php/1.txt",-1)])),_:1,__:[13]})]),B("li",null,[L(i,null,{default:I(()=>t[17]||(t[17]=[N("index.php",-1)])),_:1,__:[17]}),t[22]||(t[22]=N(" Match: ",-1)),L(i,null,{default:I(()=>t[18]||(t[18]=[N("./index.php",-1)])),_:1,__:[18]}),t[23]||(t[23]=N()),L(i,null,{default:I(()=>t[19]||(t[19]=[N("./test/index.php",-1)])),_:1,__:[19]}),L(i,{class:"ml-0.5em"},{default:I(()=>t[20]||(t[20]=[N("./abc_index.php",-1)])),_:1,__:[20]}),t[24]||(t[24]=N(" Mismatch: ",-1)),L(i,null,{default:I(()=>t[21]||(t[21]=[N("./index.php.tar.gz",-1)])),_:1,__:[21]})])]),_:1,__:[25,26]})])}}}),fe={class:"flex mb-12px"},ve={class:"w-240px mr-12px"},we=U({__name:"index",setup(e,{expose:t}){const{t:l}=T(),{site:s,setPid:o}=ue(),u=H("");let r=-1,d="";const p=async()=>{if(""===u.value.trim())return void i.error("Please enter the full path or relative path of the file");const{message:e}=await re({path_id:r,path:d,exts:u.value});a(e)&&(e.status?(i.success(e.msg),u.value="",k()):i.error(e.msg))},{table:w,columns:x}=_([{key:"exts",title:"Full file path"},h({width:100,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{g(e)}}]})]),g=async e=>{f({title:"Delete protected files [".concat(e.exts,"]"),content:"After deleting a protected file, the file will be unprotected, should I continue the operation?",onConfirm:async()=>{const{message:t}=await de({path_id:e.id,path:d,exts:e.exts});a(t)&&(t.status?(i.success(t.msg),k()):i.error(t.msg))}})},{loading:y,setLoading:b}=c(),k=async()=>{try{b(!0);const{message:t}=await j({path:s.path});a(t)&&(o(t.pid),r=(e=t).pid,d=e.path,n(e.black_exts)?w.data=e.black_exts.filter(e=>"/"==e[0]||"."==e[0]&&"/"==e[1]).map(t=>({id:e.pid,exts:t})):w.data=[])}finally{b(!1)}var e};return k(),t({init:k}),(e,t)=>{const a=ae,l=le,s=m,i=ce,n=v;return A(),$("div",null,[B("div",fe,[B("div",ve,[L(a,{value:F(u),"onUpdate:value":t[0]||(t[0]=e=>K(u)?u.value=e:null),placeholder:"Full path Or Relative path",onKeyup:V(p,["enter"])},null,8,["value"])]),L(l,{type:"primary",onClick:p},{default:I(()=>[N(G(e.$t("Public.Btn.Add")),1)]),_:1})]),L(s,{loading:F(y),"loading-num":5,"max-height":200,data:F(w).data,columns:F(x)},null,8,["loading","data","columns"]),L(n,{class:"mt-16px"},{default:I(()=>[t[15]||(t[15]=B("li",{class:"font-bold text-#333"},"The following 4 methods are supported",-1)),B("li",null,[t[2]||(t[2]=N("1. Complete file path, such as: ",-1)),L(i,null,{default:I(()=>t[1]||(t[1]=[N("/www/wwwroot/test/123.log",-1)])),_:1,__:[1]})]),B("li",null,[t[5]||(t[5]=N(" 2. Relative path to the site, such as: Full path ",-1)),L(i,null,{default:I(()=>t[3]||(t[3]=[N("/www/wwwroot/test/app/123.log",-1)])),_:1,__:[3]}),t[6]||(t[6]=N(" Relative path ",-1)),L(i,null,{default:I(()=>t[4]||(t[4]=[N("./app/123.log",-1)])),_:1,__:[4]})]),B("li",null,[t[9]||(t[9]=N(" 3. All files in the specified directory, such as: ",-1)),L(i,null,{default:I(()=>t[7]||(t[7]=[N("/www/wwwroot/test/app/*",-1)])),_:1,__:[7]}),t[10]||(t[10]=N(" Relative path ",-1)),L(i,null,{default:I(()=>t[8]||(t[8]=[N("./app/*",-1)])),_:1,__:[8]})]),B("li",null,[t[13]||(t[13]=N(" 4. the specified directory under the specified file type, such as: ",-1)),L(i,null,{default:I(()=>t[11]||(t[11]=[N("/www/wwwroot/test/app/*.log",-1)])),_:1,__:[11]}),t[14]||(t[14]=N(" Relative path ",-1)),L(i,null,{default:I(()=>t[12]||(t[12]=[N("./app/*.log",-1)])),_:1,__:[12]})]),t[16]||(t[16]=B("li",{class:"text-error"}," Note: files already included in the protected file suffix do not need to be set. ",-1))]),_:1,__:[15,16]})])}}}),xe={class:"flex mb-12px"},ge={class:"w-240px mr-12px"},ye=U({__name:"index",setup(l,{expose:s}){const{t:o}=T(),{site:u,setPid:r}=ue(),d=H("");let p=-1,x="";const g=async()=>{if(""===d.value.trim())return void i.error("Please enter directory name");const{message:l}=await(s={path_id:p,path:x,dirnames:d.value},e.post("/tamper_core/add_white_dirs.json",s,{requestOptions:{loading:t.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var s;a(l)&&(l.status?(i.success(l.msg),d.value="",O()):i.error(l.msg))},{table:y,columns:b}=_([{key:"dir",title:"Directory",ellipsis:{tooltip:!0}},w({title:"Remark",onBlur:async(l,s)=>{const{message:n}=await(o={path_id:s.id,dir_name:s.dir,ps:l},e.post("/tamper_core/set_white_dir_with_ps.json",o,{requestOptions:{loading:t.global.t("WP.api.tamper_5"),isOriginalResult:!0,prefix:""}}));var o;a(n)&&(n.status?s.ps=l:i.error(n.msg))}}),h({width:80,options:e=>[{label:o("Public.Btn.Del"),onClick:()=>{k(e)}}]})]),k=async l=>{f({title:"Delete directory whitelist",content:l.tip_msg?l.tip_msg:"Delete [".concat(l.dir,"] later, All files in the directory will be protected, continue?"),onConfirm:async()=>{const{message:s}=await(n={path_id:l.id,path:x,dirname:l.dir},e.post("/tamper_core/remove_white_dirs.json",n,{requestOptions:{loading:t.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var n;a(s)&&(s.status?(i.success(s.msg),O()):i.error(s.msg))}})},{loading:P,setLoading:C}=c(),O=async()=>{try{C(!0);const{message:t}=await j({path:u.path});a(t)&&(r(t.pid),p=(e=t).pid,x=e.path,n(e.white_dirs)?y.data=e.white_dirs.map(t=>({id:e.pid,ps:t.ps||"",tip_msg:t.tip_msg||"",...t})):y.data=[])}finally{C(!1)}var e};return O(),s({init:O}),(e,t)=>{const a=ae,l=le,s=m,i=ce,n=v;return A(),$("div",null,[B("div",xe,[B("div",ge,[L(a,{value:F(d),"onUpdate:value":t[0]||(t[0]=e=>K(d)?d.value=e:null),placeholder:"Directory name",onKeyup:V(g,["enter"])},null,8,["value"])]),L(l,{type:"primary",onClick:g},{default:I(()=>[N(G(e.$t("Public.Btn.Add")),1)]),_:1})]),L(s,{loading:F(P),"loading-num":5,"max-height":188,data:F(y).data,columns:F(b)},null,8,["loading","data","columns"]),L(n,{class:"mt-16px"},{default:I(()=>[B("li",null,[t[4]||(t[4]=N(" Full path or directory name or parts path are allowed such as: ",-1)),L(i,null,{default:I(()=>t[1]||(t[1]=[N("/www/abc/cache/test/",-1)])),_:1,__:[1]}),t[5]||(t[5]=N(", ",-1)),L(i,null,{default:I(()=>t[2]||(t[2]=[N("test",-1)])),_:1,__:[2]}),t[6]||(t[6]=N(", ",-1)),L(i,null,{default:I(()=>t[3]||(t[3]=[N("cache/test/",-1)])),_:1,__:[3]})]),B("li",null,[t[10]||(t[10]=N(" The first character of the Full path must be ",-1)),L(i,null,{default:I(()=>t[7]||(t[7]=[N("/",-1)])),_:1,__:[7]}),t[11]||(t[11]=N(", as: ",-1)),L(i,null,{default:I(()=>t[8]||(t[8]=[N("cache/test/",-1)])),_:1,__:[8]}),t[12]||(t[12]=N(" or ",-1)),L(i,null,{default:I(()=>t[9]||(t[9]=[N("test",-1)])),_:1,__:[9]})]),B("li",null,[t[15]||(t[15]=N(" art of directory name or path cannot begin with ",-1)),L(i,null,{default:I(()=>t[13]||(t[13]=[N("/",-1)])),_:1,__:[13]}),t[16]||(t[16]=N(", as: ",-1)),L(i,null,{default:I(()=>t[14]||(t[14]=[N("/www/abc/cache/test/",-1)])),_:1,__:[14]})]),t[39]||(t[39]=B("div",null,"Example:",-1)),B("li",null,[L(i,null,{default:I(()=>t[17]||(t[17]=[N("/www/abc/",-1)])),_:1,__:[17]}),t[21]||(t[21]=N(" Match: ",-1)),L(i,null,{default:I(()=>t[18]||(t[18]=[N("/www/abc/*",-1)])),_:1,__:[18]}),t[22]||(t[22]=N(" Mismatch: ",-1)),L(i,null,{default:I(()=>t[19]||(t[19]=[N("/www/abc",-1)])),_:1,__:[19]}),L(i,{class:"ml-0.5em"},{default:I(()=>t[20]||(t[20]=[N("/www/abc123",-1)])),_:1,__:[20]})]),B("li",null,[L(i,null,{default:I(()=>t[23]||(t[23]=[N("test",-1)])),_:1,__:[23]}),t[27]||(t[27]=N(" Match: ",-1)),L(i,null,{default:I(()=>t[24]||(t[24]=[N("/www/test/1.txt",-1)])),_:1,__:[24]}),t[28]||(t[28]=N()),L(i,null,{default:I(()=>t[25]||(t[25]=[N("/www/test_abc",-1)])),_:1,__:[25]}),t[29]||(t[29]=N(" Mismatch: ",-1)),L(i,null,{default:I(()=>t[26]||(t[26]=[N("/www/1.php",-1)])),_:1,__:[26]})]),B("li",null,[L(i,null,{default:I(()=>t[30]||(t[30]=[N("cache/test/",-1)])),_:1,__:[30]}),t[35]||(t[35]=N(" Match: ",-1)),L(i,null,{default:I(()=>t[31]||(t[31]=[N("/www/cache/test/1.txt",-1)])),_:1,__:[31]}),t[36]||(t[36]=N()),L(i,null,{default:I(()=>t[32]||(t[32]=[N("/cache/test/",-1)])),_:1,__:[32]}),t[37]||(t[37]=N(" Mismatch: ",-1)),L(i,null,{default:I(()=>t[33]||(t[33]=[N("/www/cache/test",-1)])),_:1,__:[33]}),t[38]||(t[38]=N()),L(i,null,{default:I(()=>t[34]||(t[34]=[N("/cache/",-1)])),_:1,__:[34]})])]),_:1,__:[39]})])}}}),be={class:"flex mb-12px"},ke={class:"w-240px mr-12px"},je=U({__name:"index",setup(l,{expose:s}){const{t:o}=T(),{site:u,setPid:r}=ue(),d=H("");let p=-1,w="";const x=async()=>{if(""===d.value.trim())return void i.error("Please enter file name");const{message:l}=await(s={path_id:p,path:w,filename:d.value},e.post("/tamper_core/add_white_files.json",s,{requestOptions:{loading:t.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var s;a(l)&&(l.status?(i.success(l.msg),d.value="",C()):i.error(l.msg))},{table:g,columns:y}=_([{key:"filename",title:"File name"},h({width:100,options:e=>[{label:o("Public.Btn.Del"),onClick:()=>{b(e)}}]})]),b=async l=>{f({title:"Delete file whitelist [".concat(l.filename,"]"),content:"After Delete whitelist, the file will be protected. want to continue?",onConfirm:async()=>{const{message:s}=await(n={path_id:l.id,path:w,filename:l.filename},e.post("/tamper_core/remove_white_files.json",n,{requestOptions:{loading:t.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var n;a(s)&&(s.status?(i.success(s.msg),C()):i.error(s.msg))}})},{loading:k,setLoading:P}=c(),C=async()=>{try{P(!0);const{message:t}=await j({path:u.path});a(t)&&(r(t.pid),p=(e=t).pid,w=e.path,n(e.white_files)?g.data=e.white_files.map(t=>({id:e.pid,filename:t})):g.data=[])}finally{P(!1)}var e};return C(),s({init:C}),(e,t)=>{const a=ae,l=le,s=m,i=ce,n=v;return A(),$("div",null,[B("div",be,[B("div",ke,[L(a,{value:F(d),"onUpdate:value":t[0]||(t[0]=e=>K(d)?d.value=e:null),placeholder:"File name",onKeyup:V(x,["enter"])},null,8,["value"])]),L(l,{type:"primary",onClick:x},{default:I(()=>[N(G(e.$t("Public.Btn.Add")),1)]),_:1})]),L(s,{loading:F(k),"loading-num":6,"max-height":230,data:F(g).data,columns:F(y)},null,8,["loading","data","columns"]),L(n,{class:"mt-16px"},{default:I(()=>[B("li",null,[t[3]||(t[3]=N(" Full path or single filename are allowed such as: ",-1)),L(i,null,{default:I(()=>t[1]||(t[1]=[N("/test/index.php",-1)])),_:1,__:[1]}),t[4]||(t[4]=N(", ",-1)),L(i,null,{default:I(()=>t[2]||(t[2]=[N("index.php",-1)])),_:1,__:[2]})]),t[17]||(t[17]=B("li",null,"Note: Only be an absolute path or file name, relative paths are not supported",-1)),t[18]||(t[18]=B("div",null,"Example:",-1)),B("li",null,[L(i,null,{default:I(()=>t[5]||(t[5]=[N("index.php",-1)])),_:1,__:[5]}),t[10]||(t[10]=N(" Match: ",-1)),L(i,null,{default:I(()=>t[6]||(t[6]=[N("./index.php",-1)])),_:1,__:[6]}),t[11]||(t[11]=N()),L(i,null,{default:I(()=>t[7]||(t[7]=[N("./test/index.php",-1)])),_:1,__:[7]}),t[12]||(t[12]=N(" Mismatch: ",-1)),L(i,null,{default:I(()=>t[8]||(t[8]=[N("./abc_index.php",-1)])),_:1,__:[8]}),t[13]||(t[13]=N()),L(i,null,{default:I(()=>t[9]||(t[9]=[N("./index.php/1.txt",-1)])),_:1,__:[9]})]),B("li",null,[L(i,null,{default:I(()=>t[14]||(t[14]=[N("/test/index.php",-1)])),_:1,__:[14]}),t[16]||(t[16]=N(" match only: ",-1)),L(i,null,{default:I(()=>t[15]||(t[15]=[N("/test/index.php",-1)])),_:1,__:[15]})])]),_:1,__:[17,18]})])}}}),Pe={class:"p-20px"},Ce={class:"flex items-center text-12px text-#666"},Oe={key:0,class:"ml-12px"},Re={class:"h-500px"},We=U({__name:"index",props:{open:{type:Boolean,default:!1},site:{}},emits:["changeOpen"],setup(e,{emit:t}){const a=e,l=t,s=J(a,"site");let i=-1;const n=H(a.open),o=H(),u=async e=>{e?await P({paths:[{path:s.value.path,ps:s.value.ps}]}):await C({path_id:i}),n.value=e,l("changeOpen",e),o.value.init()},r=H("basic"),d=[{key:"basic",label:"Basic Setting",component:pe},{key:"suffix",label:"Protected file suffix",component:he},{key:"protected file",label:"Protected File",component:we},{key:"directory whitelist",label:"Directory whitelist",component:ye},{key:"file whitelist",label:"File whitelist",component:je}];var p;return p={site:s.value,setPid:e=>{i=e}},M(oe,p),(e,t)=>{const a=Z,l=se,s=z;return A(),$("div",Pe,[L(l,{class:"mb-16px",type:F(n)?"success":"error","show-icon":!1,bordered:!1},{default:I(()=>[B("div",Ce,[t[1]||(t[1]=B("span",{class:"mr-12px"},"Protection switch",-1)),L(a,{value:F(n),"onUpdate:value":u},null,8,["value"]),F(n)?X("",!0):(A(),$("span",Oe," Protection directory closed, be security risks, Recommended open protection immediately "))])]),_:1},8,["type"]),B("div",Re,[L(s,{ref_key:"tabsRef",ref:o,value:F(r),"onUpdate:value":t[0]||(t[0]=e=>K(r)?r.value=e:null),options:d},null,8,["value"])])])}}}),De=U({__name:"index",props:{site:{}},emits:["changeHotlink"],setup(e,{emit:t}){const a=t,l=J(e,"site"),s=e=>{a("changeHotlink",e)};return(e,t)=>(A(),$("div",null,[L(ne,{class:"p-20px",site:F(l),onChangeHotlink:s},null,8,["site"])]))}}),ze={class:"p-20px"},qe={class:"tools-card"},Me={class:"tools-img"},Ue={class:"tools-name"},Le={class:"tools-desc"},$e={class:"ml-0.5em"},Ae={class:"tools-card"},Be={class:"tools-img"},Fe={class:"tools-name"},Ee={class:"tools-desc"},Ie={class:"ml-0.5em"},Se={class:"tools-card"},Te={class:"tools-img"},He={class:"tools-name"},Ve={class:"tools-card flex-col!"},Ke={class:"flex items-center! w-full pb-10px"},Ne={class:"tools-name"},Ge={class:"tools-card flex-col!"},Je={class:"flex items-center! w-full pb-10px"},Xe={class:"tools-name min-w-auto!"},Qe=s(U({__name:"index",props:{site:{}},setup(e){const t=Y(()=>r(()=>import("./index268.js?v=1756367574781"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53]))),l=Y(()=>r(()=>import("./index269.js?v=1756367574781"),__vite__mapDeps([54,7,6,2,3,4,5,9,8,14,15,16,17,18,11,12,13,19,20,21,22,23,24,25,26,27,28,1,10,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53]))),{t:s}=T(),i=J(e,"site"),n=Q({status:!1,number:0,pid:-1}),c=H(!1),_=H(!1),m=async e=>{try{c.value=!0;const t=s(e?"WP.index_46":"WP.index_47");f({title:s("WP.index_48"),content:t,onConfirm:async()=>{await R({path:i.value.path}),_.value=e}})}finally{c.value=!1}},h=x(s("WP.index_43")),v=async()=>{h.data.row=i.value,h.show=!0},w=x(),z=async()=>{w.title="".concat(s("WP.index_32")," [").concat(i.value.name,"]"),w.data.site=i.value,w.show=!0},q=H(!1),M=async e=>{try{q.value=!0,await g({source:200}),await y("tamper_core"),e?await P({paths:[{path:i.value.path,ps:i.value.ps}]}):await C({path_id:n.pid}),de()}finally{q.value=!1}},U=x("File Protection [".concat(i.value.name,"]"),{site:i.value,open:!1,onChangeOpen:e=>{n.status=e}}),E=async()=>{await g({source:200}),await y("tamper_core"),U.data.open=n.status,U.show=!0},S=Q({status:!1,number:0}),V=H(!1),K=async e=>{try{V.value=!0,await g({source:201}),await y("btwaf"),e?await W({site_name:i.value.name}):await D({site_name:i.value.name}),de()}finally{V.value=!1}},X=async()=>{await g({source:201}),await y("btwaf"),p(i.value.name),ee()},ee=()=>{let e=0;const t=setInterval(()=>{e+=.5;const a=document.querySelector(".waf_site_body");if(a){let e=!1;new MutationObserver(t=>{t.forEach(t=>{"childList"!==t.type||document.contains(a)||e||(de(),e=!0)})}).observe(document.body,{childList:!0,subtree:!0}),clearInterval(t)}e>=20&&clearInterval(t)},500)},ae=H(!1),se=H(!1),ne=async e=>{try{se.value=!0;const{message:t}=await b({id:i.value.id,name:i.value.name},!1);if(a(t)){const a={id:i.value.id,name:i.value.name,fix:t.fix,domains:t.domains,return_rule:t.return_rule,status:e,http_status:"true"===t.http_status};await k(a,!1),ae.value=e}}finally{se.value=!1}},oe=x("Hotlink Protection [".concat(i.value.name,"]"),{site:i.value,onChangeHotlink:e=>{ae.value=e}}),ue=()=>{oe.show=!0},re=e=>{q.value=e,V.value=e,se.value=e,c.value=e},de=async()=>{try{re(!0);const{message:e}=await O({id:i.value.id,path:i.value.path,site_name:i.value.name});if(a(e)&&(n.status=1===e.file_status,n.number=e.file_count,S.status=1===e.firewall_status,S.number=e.firewall_count,ae.value=1===e.hotlink_status,_.value=1===e.virus_scanning,1===e.file_status)){const{message:e}=await j({path:i.value.path});a(e)&&(n.pid=e.pid)}}finally{re(!1)}};return de(),(e,a)=>{const s=ie,i=Z,r=u,p=le,f=te,x=d;return A(),$("div",ze,[B("div",qe,[B("div",Me,[L(s,{lazy:!0,"preview-disabled":!0,width:"24",src:"".concat(F(o),"images/soft-ico/ico-tamper_core.png")},null,8,["src"])]),B("div",Ue,G(e.$t("WP.Label.index_5")),1),L(i,{value:F(n).status,loading:F(q),"onUpdate:value":M},null,8,["value","loading"]),L(p,{quaternary:"",size:"small",onClick:E},{default:I(()=>[L(r,{name:"setting",size:"18"})]),_:1}),B("div",Le,[L(f,{type:"error",size:"small",bordered:!1},{default:I(()=>[N(G(F(n).number),1)]),_:1}),B("span",$e,G(e.$t("WP.Config.index_6")),1)])]),B("div",Ae,[B("div",Be,[L(s,{lazy:!0,"preview-disabled":!0,width:"26",src:"".concat(F(o),"images/soft-ico/ico-btwaf.png")},null,8,["src"])]),B("div",Fe,G(e.$t("WP.Label.index_6")),1),L(i,{value:F(S).status,loading:F(V),"onUpdate:value":K},null,8,["value","loading"]),L(p,{quaternary:"",size:"small",onClick:X},{default:I(()=>[L(r,{name:"setting",size:"18"})]),_:1}),B("div",Ee,[L(f,{type:"error",size:"small",bordered:!1},{default:I(()=>[N(G(F(S).number),1)]),_:1}),B("span",Ie,G(e.$t("WP.Config.index_7")),1)])]),B("div",Se,[B("div",Te,[L(r,{name:"soft-hotlink",size:"24"})]),B("div",He,G(e.$t("WP.Label.index_7")),1),L(i,{value:F(ae),loading:F(se),"onUpdate:value":ne},null,8,["value","loading"]),L(p,{quaternary:"",size:"small",onClick:ue},{default:I(()=>[L(r,{name:"setting",size:"18"})]),_:1})]),B("div",Ve,[B("div",Ke,[a[4]||(a[4]=B("div",{class:"tools-img"},[B("i",{class:"i-healthicons:health-vulnerability-through-social-determinants-outline-24px text-26px text-primary!"})],-1)),B("div",Ne,G(e.$t("WP.index_43")),1),L(i,{value:F(_),loading:F(c),"onUpdate:value":m},null,8,["value","loading"]),L(p,{quaternary:"",size:"small",onClick:v},{default:I(()=>[L(r,{name:"setting",size:"18"})]),_:1})]),a[5]||(a[5]=B("div",{class:"w-full color-#999"},"Check plugins and themes for security risks",-1))]),B("div",Ge,[B("div",Je,[a[6]||(a[6]=B("div",{class:"tools-img"},[B("i",{class:"i-material-symbols:library-add-check-outline text-26px text-#20a53a!"})],-1)),B("div",Xe,G(e.$t("WP.TableRow.index_4")),1),L(p,{quaternary:"",size:"small",onClick:z},{default:I(()=>[L(r,{name:"setting",size:"18"})]),_:1})]),a[7]||(a[7]=B("div",{class:"w-full color-#999"}," Check the integrity of the core files of this WP version to ensure they are not infected with malicious viruses! ",-1))]),L(x,{show:F(U).show,"onUpdate:show":a[0]||(a[0]=e=>F(U).show=e),title:F(U).title,data:F(U).data,width:800,component:We},null,8,["show","title","data"]),L(x,{show:F(oe).show,"onUpdate:show":a[1]||(a[1]=e=>F(oe).show=e),title:F(oe).title,data:F(oe).data,component:De},null,8,["show","title","data"]),L(x,{show:F(h).show,"onUpdate:show":a[2]||(a[2]=e=>F(h).show=e),title:F(h).title,data:F(h).data,width:800,"min-height":500,component:F(t)},null,8,["show","title","data","component"]),L(x,{show:F(w).show,"onUpdate:show":a[3]||(a[3]=e=>F(w).show=e),title:F(w).title,data:F(w).data,width:600,"min-height":190,component:F(l)},null,8,["show","title","data","component"])])}}}),[["__scopeId","data-v-856e3a0e"]]);export{Qe as default};
