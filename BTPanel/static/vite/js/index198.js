import{_ as a}from"./index228.js?v=1747989938512";import{av as e,a as s,ad as l,_ as t,aw as n,ax as i}from"./public.js?v=1747989938512";import{c as o,_ as r,m as u,eQ as c,O as d,p as m,q as p}from"./page_layout.js?v=1747989938512";import{r as f,d as v,O as h,af as _,j as x,e as y,f as S,a3 as w,R as g,S as b,U as L,P as k,a1 as j,a2 as C,V as z,c as $,aj as R,ao as A,a0 as N}from"./vue.js?v=1747989938512";import{bU as U,cR as D,cl as O,T,c3 as H}from"./naive.js?v=1747989938512";import"./common.js?v=1747989938512";import"./__commonjsHelpers__.js?v=1747989938512";const I=f(!1),J=f({}),P=async a=>{try{I.value=!0;const{message:s}=await e({hash:a});o(s)&&(J.value=s)}finally{I.value=!1}},q={class:"text-#20a53a"},M={class:"mt-16px"},Q=m(v({__name:"index",props:{row:{},onRefresh:{}},setup(a){const{t:e}=h(),n=a,{row:i}=_(n),m=f("all"),p=x({domains:i.value.user_for.sites||[]}),v=f([]),A=f([]),N=y((()=>"matched"===m.value?A.value:v.value)),H=({option:a})=>{const e=a.match?"ssl-lock":"ssl-unlock",s=a.match?"text-#20a53a":"text-error";return k(U,{size:5,class:"items-center flex-nowrap!"},{default:()=>[k(r,{name:e,class:s,size:18},null),k("div",{class:"truncate w-full"},[a.label])]})},Q=()=>{s({title:"Deploy SSL Certificate",content:p.domains.length?"Are you sure you want to deploy this certificate?":"Are you sure you want to cancel the deployment",onConfirm:async()=>{const{message:a}=await l({hash:i.value.hash,domains:JSON.stringify(p.domains)});o(a)&&(a.faild?u.error("".concat(e("SSL.index_31"),"（").concat(a.faildList.map((a=>a.siteName)).join(","),"）")):u.success(e("SSL.index_32")),n.onRefresh())}})},V=a=>a.map((a=>({label:a.name,value:a.name,match:a.match})));return S((()=>{(async()=>{await P(i.value.hash);const a=J.value.sites.filter((a=>a.match)),e=J.value.sites.filter((a=>!a.match));v.value=V([...a,...e]),A.value=V(a),p.domains=p.domains.filter((a=>v.value.some((e=>e.value===a))))})()})),(a,e)=>{const s=w("i18n-t"),l=D,n=O,o=c,u=d,f=T,v=r,h=t;return g(),b("div",null,[L("div",null,[k(s,{keypath:"SSL.index_26",tag:"span",scope:"global"},{a:j((()=>{var a,e;return[L("span",q,C(null==(e=null==(a=z(i))?void 0:a.verify_domains)?void 0:e.join(",")),1)]})),_:1}),e[2]||(e[2]=L("span",null," site",-1))]),k(n,{type:"segment",animated:"",value:z(m),"onUpdate:value":e[0]||(e[0]=a=>R(m)?m.value=a:null),class:"my-10px"},{default:j((()=>[k(l,{name:"all"},{default:j((()=>[$(C(a.$t("SSL.index_28")),1)])),_:1}),k(l,{name:"matched"},{default:j((()=>[$(C(a.$t("SSL.index_27")),1)])),_:1})])),_:1},8,["value"]),k(u,{show:z(I)},{default:j((()=>[k(o,{"render-source-label":H,"render-target-label":H,value:z(p).domains,"onUpdate:value":e[1]||(e[1]=a=>z(p).domains=a),options:z(N),"source-filterable":"","virtual-scroll":""},null,8,["value","options"])])),_:1},8,["show"]),L("div",M,[k(f,{type:"primary",onClick:Q},{default:j((()=>[$(C(a.$t("SSL.index_29")),1)])),_:1})]),k(h,{class:"mt-20px"},{default:j((()=>[L("li",null,[k(v,{name:"ssl-lock",class:"text-#20a53a",size:18}),e[3]||(e[3]=L("span",{class:"ml-8px"},"This SSL is applicable to the this domain",-1))]),L("li",null,[k(v,{name:"ssl-unlock",class:"text-error",size:18}),e[4]||(e[4]=L("span",{class:"ml-8px"},'After using this SSL, accessing the domain will show a "Not Secure" warning',-1))])])),_:1})])}}}),[["__scopeId","data-v-1cd65fd9"]]),V={key:0,class:"text-#20a53a"},B={class:"icon-box"},E=m(v({__name:"index",props:{row:{}},setup(a){const e=a,{row:l}=_(e),i=x({domains:"",issuer:"",end_date:"",is_match:1}),o=a=>{s({title:"Deploy SSL Certificate",content:0===a?"Are you sure to deploy this SSL certificate to the panel?":"Are you sure you want to restore it?",onConfirm:async()=>{await n({hash:l.value.hash,recover:a}),window.location.href=window.location.href.split("?")[0]+"?_t="+Date.now()}})};return S((()=>{(async()=>{await P(l.value.hash),i.domains=J.value.panel[0].info.subject,i.issuer=J.value.panel[0].info.issuer,i.end_date=J.value.panel[0].info.notAfter,i.is_match=J.value.panel[0].match})()})),(a,e)=>{const s=w("i18n-t"),n=r,u=p,c=U,m=H,f=d,v=T,h=t;return g(),b("div",null,[L("div",null,[k(s,{keypath:"SSL.index_26",tag:"span",scope:"global"},{a:j((()=>[z(l)?(g(),b("span",V,C(z(l).verify_domains.join(",")),1)):A("",!0)])),_:1}),e[2]||(e[2]=L("span",null," panel",-1))]),k(f,{show:z(I),class:"my-16px"},{default:j((()=>[k(m,{type:"info","show-icon":!1},{default:j((()=>[k(c,{class:"py-2px text-12px items-center flex-nowrap!"},{default:j((()=>[e[3]||(e[3]=L("b",{class:"text-nowrap!"},"Current SSL",-1)),k(n,{name:"ssl-lock",class:"text-#20a53a",size:18}),k(u,{vertical:""}),L("div",null,[L("div",null,[$(C(a.$t("Config.Safe.index_37")),1),L("b",null,C(z(i).domains),1)]),L("div",null,[$(C(a.$t("Config.Safe.index_38")),1),L("b",null,C(z(i).issuer),1)]),L("div",null,[$(C(a.$t("Config.Safe.index_39")),1),L("b",null,C(z(i).end_date),1)])])])),_:1})])),_:1}),L("div",B,[k(n,{name:"file-back",size:40,color:"#0a8c46"})]),k(m,{type:z(i).is_match?"success":"error","show-icon":!1},{default:j((()=>[k(c,{class:"py-2px text-12px items-center flex-nowrap! text-primary"},{default:j((()=>[e[4]||(e[4]=L("b",{class:"text-nowrap!"},"New SSL",-1)),z(i).is_match?(g(),N(n,{key:0,name:"ssl-lock",class:"text-#20a53a",size:18})):(g(),N(n,{key:1,name:"ssl-unlock",class:"text-error",size:18})),k(u,{vertical:""}),L("div",null,[L("div",null,[$(C(a.$t("Config.Safe.index_37")),1),L("b",null,C(z(l).verify_domains.join(",")),1)]),L("div",null,[$(C(a.$t("Config.Safe.index_38")),1),L("b",null,C(z(l).provider+" "+z(l).issuer),1)]),L("div",null,[$(C(a.$t("Config.Safe.index_39")),1),L("b",null,C(z(l).end_date),1)])])])),_:1})])),_:1},8,["type"])])),_:1},8,["show"]),L("div",null,[k(v,{type:"primary",onClick:e[0]||(e[0]=a=>o(0))},{default:j((()=>[$(C(a.$t("SSL.index_29")),1)])),_:1})]),k(u,{class:"my-16px!"}),k(c,{class:"items-center"},{default:j((()=>[e[6]||(e[6]=L("span",{class:"text-desc"},"Restore to panel self-signed certificate?",-1)),k(v,{type:"primary",ghost:"",onClick:e[1]||(e[1]=a=>o(1))},{default:j((()=>e[5]||(e[5]=[$("Restore")]))),_:1})])),_:1}),k(h,{class:"mt-20px"},{default:j((()=>[L("li",null,[k(n,{name:"ssl-lock",class:"text-#20a53a",size:18}),e[7]||(e[7]=L("span",{class:"ml-8px"},"This SSL is applicable to the this panel",-1))]),L("li",null,[k(n,{name:"ssl-unlock",class:"text-error",size:18}),e[8]||(e[8]=L("span",{class:"ml-8px"},'After using this SSL, accessing the panel will show a "Not Secure" warning',-1))])])),_:1})])}}}),[["__scopeId","data-v-5d5ba104"]]),F={class:"text-#20a53a"},G={class:"mt-16px"},K=v({__name:"index",props:{row:{},onRefresh:{}},setup(a){const{t:e}=h(),l=a,{row:n}=_(l),m=f("all"),p=x({domains:n.value.user_for.mails}),v=f([]),S=f([]),A=y((()=>"matched"===m.value?S.value:v.value)),N=({option:a})=>{const e=a.match?"ssl-lock":"ssl-unlock",s=a.match?"text-#20a53a":"text-error";return k(U,{size:5,class:"items-center flex-nowrap!"},{default:()=>[k(r,{name:e,class:s,size:18},null),k("div",{class:"truncate w-full"},[a.label])]})},H=()=>{s({title:"Deploy SSL Certificate",content:p.domains.length?"Are you sure you want to deploy this certificate?":"Are you sure you want to cancel the deployment",onConfirm:async()=>{try{const{message:a}=await i({hash:n.value.hash,domains:JSON.stringify(p.domains)});o(a)&&(a.faild?u.error("".concat(e("SSL.index_31"),"（").concat(a.faildList.map((a=>a.siteName)).join(","),"）")):u.success(e("SSL.index_32")))}finally{l.onRefresh()}}})},q=a=>a.map((a=>({label:a.domain,value:a.domain,match:a.match})));return(async()=>{await P(n.value.hash);const a=J.value.mails.filter((a=>a.match)),e=J.value.mails.filter((a=>!a.match));v.value=q([...a,...e]),S.value=q(a)})(),(a,e)=>{const s=w("i18n-t"),l=D,i=O,o=c,u=d,f=T,v=r,h=t;return g(),b("div",null,[L("div",null,[k(s,{keypath:"SSL.index_26",tag:"span",scope:"global"},{a:j((()=>{var a,e;return[L("span",F,C(null==(e=null==(a=z(n))?void 0:a.verify_domains)?void 0:e.join(",")),1)]})),_:1}),e[2]||(e[2]=L("span",null," mail",-1))]),k(i,{type:"segment",animated:"",value:z(m),"onUpdate:value":e[0]||(e[0]=a=>R(m)?m.value=a:null),class:"my-10px"},{default:j((()=>[k(l,{name:"all"},{default:j((()=>[$(C(a.$t("SSL.index_28")),1)])),_:1}),k(l,{name:"matched"},{default:j((()=>[$(C(a.$t("SSL.index_27")),1)])),_:1})])),_:1},8,["value"]),k(u,{show:z(I)},{default:j((()=>[k(o,{"render-source-label":N,"render-target-label":N,value:z(p).domains,"onUpdate:value":e[1]||(e[1]=a=>z(p).domains=a),options:z(A),"source-filterable":"","virtual-scroll":""},null,8,["value","options"])])),_:1},8,["show"]),L("div",G,[k(f,{type:"primary",onClick:H},{default:j((()=>[$(C(a.$t("SSL.index_29")),1)])),_:1})]),k(h,{class:"mt-20px"},{default:j((()=>[L("li",null,[k(v,{name:"ssl-lock",class:"text-#20a53a",size:18}),e[3]||(e[3]=L("span",{class:"ml-8px"},"This SSL is applicable to the this domain",-1))]),L("li",null,[k(v,{name:"ssl-unlock",class:"text-error",size:18}),e[4]||(e[4]=L("span",{class:"ml-8px"},'After using this SSL, accessing the domain will show a "Not Secure" warning',-1))])])),_:1})])}}}),W=v({__name:"index",props:{data:{}},setup(e){const{t:s}=h(),l=e,{row:t,onRefresh:n,menu:i}=l.data,o=f("site"),r=[{key:"site",label:s("Home.index_68"),component:Q,data:{row:t,onRefresh:n}},{key:"mail",label:"Mail",component:K,data:{row:t,onRefresh:n}},{key:"panel",label:"Panel",component:E,data:{row:t}}];return o.value=i||"site",(e,s)=>{const l=a;return g(),N(l,{value:z(o),"onUpdate:value":s[0]||(s[0]=a=>R(o)?o.value=a:null),data:r},null,8,["value"])}}});export{W as default};
