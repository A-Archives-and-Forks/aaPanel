const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index216.js?v=1744703330658","js/page_layout.js?v=1744703330658","js/vue.js?v=1744703330658","js/__commonjsHelpers__.js?v=1744703330658","js/naive.js?v=1744703330658","js/common.js?v=1744703330658","js/public.js?v=1744703330658","css/public.css?v=1744703330658","css/page_layout.css?v=1744703330658","js/site.js?v=1744703330658","js/index.vue_vue_type_script_setup_true_lang14.js?v=1744703330658","js/file.js?v=1744703330658","css/index88.css?v=1744703330658","js/index217.js?v=1744703330658","js/index.js?v=1744703330658","css/index93.css?v=1744703330658","js/index103.js?v=1744703330658","css/index20.css?v=1744703330658","js/index.vue_vue_type_script_setup_true_lang4.js?v=1744703330658","js/index.vue_vue_type_script_setup_true_lang8.js?v=1744703330658","css/index19.css?v=1744703330658","js/index.vue_vue_type_script_setup_true_lang5.js?v=1744703330658","js/index.vue_vue_type_script_setup_true_lang12.js?v=1744703330658","js/index.vue_vue_type_script_setup_true_lang6.js?v=1744703330658","js/set4.js?v=1744703330658","js/index.vue_vue_type_script_setup_true_lang.js?v=1744703330658","js/index218.js?v=1744703330658","js/index104.js?v=1744703330658","css/index21.css?v=1744703330658","js/index.vue_vue_type_script_setup_true_lang10.js?v=1744703330658","js/index96.js?v=1744703330658","css/index15.css?v=1744703330658","js/index99.js?v=1744703330658","css/index16.css?v=1744703330658","js/soft.js?v=1744703330658","js/ssl.js?v=1744703330658","css/index86.css?v=1744703330658","js/index219.js?v=1744703330658","js/index226.js?v=1744703330658","css/index55.css?v=1744703330658","js/index95.js?v=1744703330658","js/index.vue_vue_type_script_setup_true_lang15.js?v=1744703330658","js/theme-chrome.js?v=1744703330658","js/index123.js?v=1744703330658","css/index23.css?v=1744703330658","js/refersh.js?v=1744703330658","js/php.js?v=1744703330658","js/form.vue_vue_type_script_setup_true_lang2.js?v=1744703330658","js/logs.vue_vue_type_script_setup_true_lang.js?v=1744703330658","css/index87.css?v=1744703330658","js/index220.js?v=1744703330658","js/ssl-log.js?v=1744703330658","js/batch3.js?v=1744703330658","js/batch4.js?v=1744703330658","js/batch5.js?v=1744703330658"])))=>i.map(i=>d[i]);
import{j as e,a9 as t,k as a,i,a as n,s,d as l,K as o,_ as d,I as r,cx as u,u as c,b9 as p}from"./page_layout.js?v=1744703330658";import{_}from"./index123.js?v=1744703330658";import{_ as m}from"./index.js?v=1744703330658";import{_ as h}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1744703330658";import{_ as w}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1744703330658";import{_ as f}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1744703330658";import{_ as P}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1744703330658";import{_ as x}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1744703330658";import{_ as y}from"./index121.js?v=1744703330658";import{d as v,t as g,r as k,e as b,R as S,$ as H,a0 as j,P as C,c as E,a1 as O,V as R,U as B,af as D,Y as I,ai as T,O as U,F as L,i as V,ad as $,S as A,_ as M,j as W,w as z,o as K,M as q,n as Y,ap as F}from"./vue.js?v=1744703330658";import{l as N}from"./site4.js?v=1744703330658";import{u as Z,_ as G,c as J,d as Q,b as X,a as ee,o as te,p as ae,f as ie,k as ne}from"./public.js?v=1744703330658";import{s as se,c as le,d as oe,e as de,f as re,h as ue}from"./site.js?v=1744703330658";import"./soft.js?v=1744703330658";import{bZ as ce,T as pe,aV as _e,bU as me,bz as he,cn as we,ck as fe,b_ as Pe}from"./naive.js?v=1744703330658";import{o as xe,a as ye}from"./utils2.js?v=1744703330658";import{Y as ve,j as ge,c as ke}from"./common.js?v=1744703330658";import{m as be}from"./ssl.js?v=1744703330658";import"./__commonjsHelpers__.js?v=1744703330658";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1744703330658";import"./php.js?v=1744703330658";import"./useModal2.js?v=1744703330658";const Se={class:"flex justify-end"},He=a(v({__name:"index",props:{row:{}},setup(a){const i=g(a,"row"),n=k(null),s=k(null),l=new Date;l.setHours(0,0,0,0);const o=b((()=>{const e=new Date(i.value.edate);return"0000-00-00"!==i.value.edate&&ve(e,l)})),d=b((()=>{const e=new Date(i.value.edate);return"0000-00-00"!==i.value.edate&&ve(e,ge(l,7))})),r=e=>ve(e,ge(l,1)),u=()=>{n.value="0000-00-00"===i.value.edate?null:new Date(i.value.edate).getTime()},c=async()=>{var e;await se({id:i.value.id,edate:"0000-00-00"}),i.value.edate="0000-00-00",null==(e=s.value)||e.setShow(!1)},p=async()=>{var e;if(null===n.value)return;const t=ke(n.value,"yyyy-MM-dd");await se({id:i.value.id,edate:t}),i.value.edate=t,null==(e=s.value)||e.setShow(!1)};return(a,l)=>{const _=e,m=pe,h=_e,w=t,f=ce;return S(),H(f,{ref_key:"popoverRef",ref:s,placement:"bottom",trigger:"click"},{trigger:j((()=>[C(_,{type:R(o)?"error":R(d)?"warning":"primary",onClick:u},{default:j((()=>[E(O("0000-00-00"===R(i).edate?a.$t("Site.PHP.index_34"):R(o)?a.$t("Site.PHP.index_28"):R(i).edate),1)])),_:1},8,["type"])])),default:j((()=>[C(w,{value:R(n),"onUpdate:value":l[0]||(l[0]=e=>D(n)?n.value=e:null),type:"date",panel:!0,actions:null,"is-date-disabled":r},{footer:j((()=>[B("div",Se,[C(h,{size:"small"},{default:j((()=>[C(m,{onClick:c},{default:j((()=>[E(O(a.$t("Site.PHP.index_34")),1)])),_:1}),C(m,{disabled:null===R(n),onClick:p},{default:j((()=>[E(O(a.$t("Public.Btn.Confirm")),1)])),_:1},8,["disabled"])])),_:1})])])),_:1},8,["value"])])),_:1},512)}}}),[["__scopeId","data-v-0f7e7fa2"]]),{t:je}=i.global;function Ce(e){Z({title:1===e.length?"".concat(je("Site.Cert.index_56")," [").concat(e[0].name,"]"):"".concat(je("Site.Cert.index_57")),width:480,minHeight:248,footer:!0,data:{rows:e},component:I((()=>n((()=>import("./index216.js?v=1744703330658")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))))})}const Ee=v({functional:!0,props:{path:{type:String,default:"",required:!0}},setup(e){const t=T();return{goPath:()=>{s("Path",e.path),t.push("/files")}}},render(){return C("a",{class:"text-primary hover:text-primary-hover",href:"javascript:;",onClick:()=>{this.goPath()}},[this.path])}});const Oe=({row:e})=>C("a",{href:"javascript:;",class:"bt-link"},[e.name]),Re=({row:e})=>C(G,{value:e.status},null),Be=({row:t})=>{const{t:a}=U();return C(e,{type:t.backup_count>0?"primary":"warning",onClick:()=>{Z({title:a("Site.PHP.index_33",[t.name]),width:720,minHeight:200,data:{row:t},component:I((()=>n((()=>import("./index217.js?v=1744703330658")),__vite__mapDeps([13,14,2,3,5,6,1,4,8,7,15,16,17,18,19,20,21,22,23,9]))))})}},{default:()=>[t.backup_count>0?a("Site.PHP.index_31",[t.backup_count]):a("Site.PHP.index_32")]})},De=({row:e})=>C(Ee,{path:e.path},null),Ie=({row:t})=>C(e,null,{default:()=>[t.php_version]}),Te=({row:t,sslInfo:a,callback:i})=>{const{t:n}=U(),s=a.filter((e=>e.target_id===t.id)),{ssl:r}=t;if(l(r))return C(e,{type:r.endtime<0?"error":"primary"},{default:()=>[r.endtime<0?n("Site.PHP.index_28"):n("Site.PHP.index_29",[r.endtime])]});if(s.length)return C(ce,{trigger:"hover"},{trigger:()=>C(o,{size:"small"},null),default:()=>C(L,null,[s.map((e=>C("div",{class:"flex flex-nowrap! p-10px cursor-pointer justify-between items-center",key:e.task_name,onClick:t=>{t.stopPropagation(),i(e.task_log)}},[C("span",{class:"whitespace-nowrap mr-10px"},[e.task_name]),C(me,{class:"items-center flex-nowrap!"},{default:()=>[C(he,{class:"w-120px!",type:"line",status:"success",percentage:e.task_status,"indicator-placement":"inside",processing:100!==e.task_status},null),C(d,{name:"base-left-logs",size:18,color:"#666666"},null)]})])))])});{let t;return C(e,{type:"warning"},"function"==typeof(u=t=n("Site.PHP.index_30"))||"[object Object]"===Object.prototype.toString.call(u)&&!V(u)?t:{default:()=>[t]})}var u},Ue=({row:t})=>C(e,{type:t.attack>0?"error":"primary"},{default:()=>[t.attack]}),Le={class:"w-160px"},Ve=v({__name:"index",props:{value:{default:null}},emits:["change","update:value"],setup(e,{emit:t}){const{t:a}=U(),i=I((()=>n((()=>import("./set4.js?v=1744703330658")),__vite__mapDeps([24,14,2,3,5,6,1,4,8,7,15,25,9])))),s=t,l=$(e,"value"),{loading:o,setLoading:d}=J(),u=k([]),c=e=>{sessionStorage.setItem("typeValue",e),s("change"),s("update:value",e)},p=Q(a("Site.PHP.index_44"),{setOptions:(e,t)=>{t===l.value&&(l.value=-1),u.value=e.map((e=>({label:e.name,value:e.id}))),h()}}),_=()=>{p.show=!0},h=()=>{u.value.unshift({label:a("Site.PHP.index_45"),value:-1})};return h(),(async()=>{try{d(!0);const{message:e}=await le();r(e)?u.value=e.map((e=>({label:e.name,value:e.id}))):u.value=[],h()}finally{d(!1);const e=sessionStorage.getItem("typeValue");l.value=e?Number(e):-1}})(),(e,t)=>{const a=pe,n=we,s=m;return S(),A("div",Le,[C(n,{value:R(l),"onUpdate:value":t[0]||(t[0]=e=>D(l)?l.value=e:null),loading:R(o),options:R(u),onUpdateValue:c},{action:j((()=>[C(a,{block:"",onClick:_},{default:j((()=>[E(O(e.$t("Site.PHP.index_43")),1)])),_:1})])),_:1},8,["value","loading","options"]),C(s,{show:R(p).show,"onUpdate:show":t[1]||(t[1]=e=>R(p).show=e),width:350,title:R(p).title,data:R(p).data,component:R(i)},null,8,["show","title","data","component"])])}}}),$e=v({__name:"index",setup(t){const a=I((()=>n((()=>import("./index218.js?v=1744703330658")),__vite__mapDeps([26,27,2,3,4,5,1,6,7,8,28,25,29,30,31,32,33,9,34,35,36])))),i=I((()=>n((()=>import("./index219.js?v=1744703330658").then((e=>e.i))),__vite__mapDeps([37,1,2,3,4,5,6,7,8,38,39,18,19,20,22,23,32,33,9,14,15,25,29,30,31,27,28,40,41,42,11,43,44,45,46,47,16,17,48,49])))),s=I((()=>n((()=>import("./index220.js?v=1744703330658")),__vite__mapDeps([50,38,2,3,4,5,1,6,7,8,39,27,28,41,42,11,40,25,9,46])))),o=I((()=>n((()=>import("./ssl-log.js?v=1744703330658")),__vite__mapDeps([51,16,1,2,3,4,5,6,7,8,17,35])))),{t:v}=U(),g=u(),b=c(),{web:T,webserver:L}=M(g),V=k(!1),$=Q(v("Site.PHP.index_9"),{done:async()=>{await Me(),Ke()}}),A=()=>{$.show=!0},G=Q(v("Database.Mysql.index_3")),se=()=>{G.show=!0},le=Q(v("SSL.Domain.index_5")),ce=[{label:v("Site.PHP.index_5"),key:"default-page"},{label:v("Site.PHP.index_6"),key:"default-site"},{label:v("Site.PHP.index_7"),key:"php-version"},{label:v("Site.PHP.index_86"),key:"https"}],me=e=>{G.data.config={menu:e},G.show=!0},he=W({show:!1,title:"",data:{siteInfo:null,config:{menu:"",subMenu:""}}}),we=(e,t={})=>{he.title=v("Site.PHP.index_13",[e.name,e.addtime]),he.data.siteInfo=e,he.data.config=Object.assign({menu:"",subMenu:""},t),he.show=!0},ve=k([]),{keys:ge,table:ke,columns:Se}=X([{type:"selection",width:40},{key:"name",title:v("Site.PHP.index_17"),width:"12%",minWidth:110,sorter:!0,sortOrder:!1,ellipsis:{tooltip:!0},render:e=>C(Oe,{row:e,onClick:()=>{we(e)}},null)},{key:"status",title:v("Public.Table.Status"),width:"10%",minWidth:95,sorter:!0,sortOrder:!1,render:e=>C(Re,{row:e,onClick:t=>{ee({title:"".concat(v("1"===t?"Site.PHP.index_21_2":"Site.PHP.index_21_3")," ").concat(v("Site.PHP.index_21_1",[e.name])),content:v("1"===t?"Site.PHP.index_22":"Site.PHP.index_23"),onConfirm:async()=>{await oe("1"===t,{id:e.id,name:e.name}),e.status=t}})}},null)},{key:"backup_count",title:v("Site.PHP.index_19"),width:"6%",minWidth:70,render:e=>C(Be,{row:e},null)},{key:"path",title:v("Site.PHP.index_20"),width:"15%",minWidth:180,ellipsis:{tooltip:!0},render:e=>C(De,{row:e},null)},te({type:"site",minWidth:70,callback:()=>{Me()}}),{key:"edate",title:v("Site.PHP.index_25"),width:"8%",minWidth:96,render:e=>C(He,{row:e},null)},ae({width:"8%",onBlur:async(e,t)=>{await ue({id:t.id,ps:e})}}),{key:"php_version",title:v("Site.PHP.index_26"),width:70,render:e=>C(Ie,{row:e,onClick:()=>{we(e,{menu:"php"})}},null)},{key:"site_ssl",title:v("Site.PHP.index_27"),width:"12%",minWidth:90,sorter:!0,sortOrder:!1,render:e=>C(Te,{row:e,sslInfo:ve.value,callback:e=>{le.data.path=e,le.show=!0},onClick:()=>{we(e,{menu:"ssl"})}},null)},{key:"attack",title:v("Site.PHP.index_24"),width:"4%",minWidth:80,ellipsis:{tooltip:!0},render:e=>C(Ue,{row:e,onClick:()=>{we(e,{menu:"logs",subMenu:"security"})}},null)},ie({title:v("Public.Table.Operation"),width:"20%",maxWidth:200,options:e=>[{label:v("Site.PHP.index_14"),onClick:()=>{xe()}},{label:v("Site.PHP.index_15"),show:"nginx"===g.webserver||"apache"===g.webserver,onClick:async()=>{ye(e)}},{label:v("Site.PHP.index_16"),onClick:()=>{we(e)}},{label:v("Public.Btn.Del"),onClick:()=>{Ce([e])}}]})]),je=e=>{Se.value.forEach((t=>{const a=t;a.key===e.columnKey?a.sortOrder=e.order:a.sortOrder=void 0})),e.order?Le.order="".concat(e.columnKey," ").concat("descend"===e.order?"desc":"asc"):Le.order="",Me()},Ee=[{key:"enable",type:"confirm",label:v("Site.Batch.index_1"),confirm:{title:v("Site.Batch.index_2"),desc:v("Site.Batch.index_3"),columns:[Se.value[1]],api:e=>oe(!0,{id:e.id,name:e.name},!1),done:()=>{Me()}}},{key:"disable",type:"confirm",label:v("Site.Batch.index_4"),confirm:{title:v("Site.Batch.index_5"),desc:v("Site.Batch.index_6"),columns:[Se.value[1]],api:e=>oe(!1,{id:e.id,name:e.name},!1),done:()=>{Me()}}},{key:"backup",type:"confirm",label:v("Site.Batch.index_7"),confirm:{title:v("Site.Batch.index_8"),desc:v("Site.Batch.index_9"),columns:[Se.value[1]],api:e=>de({id:e.id},!1),done:()=>{Me()}}},{key:"expired",label:v("Site.PHP.index_70"),onBatch:e=>{Z({title:v("Site.PHP.index_71"),width:380,minHeight:72,footer:!0,data:{rows:e},component:I((()=>n((()=>import("./batch3.js?v=1744703330658")),__vite__mapDeps([52,25,4,2,3,5,1,6,7,8,9,10]))))})}},{key:"php",label:v("Site.PHP.index_66"),onBatch:e=>{Z({title:v("Site.PHP.index_65"),width:500,minHeight:198,footer:!0,data:{rows:e},component:I((()=>n((()=>import("./batch4.js?v=1744703330658")),__vite__mapDeps([53,40,1,2,3,4,5,6,7,8,25,9,10]))))})}},{key:"category",label:v("Crontab.Planned.index_19"),onBatch:e=>{Z({title:v("Site.Batch.index_22"),width:350,minHeight:72,footer:!0,data:{rows:e},component:I((()=>n((()=>import("./batch5.js?v=1744703330658")),__vite__mapDeps([54,25,4,2,3,5,1,6,7,8,9]))))})}},{key:"delete",label:v("Site.Batch.index_10"),onBatch:e=>{Ce(e)}}],Le=W({p:1,limit:10,table:"sites",search:"",order:"",type:-1}),{loading:$e,setLoading:Ae}=J(!0),Me=async(e=!1)=>{try{Ae(!(ve.value.length>0||e));const t={...q(Le)},{message:a}=await re(t);l(a)?(ke.data=r(a.data)?a.data:[],ke.total=p(a.page)):(ke.data=[],ke.total=0)}finally{ge.value=[],Ae(!1)}};let We=null;const ze=k(!1),Ke=async()=>{We&&clearTimeout(We);const{message:e}=await be();r(e)&&(ve.value=e,e.length>0?(ze.value=!0,We=window.setTimeout((()=>{Ke()}),3e3)):(ze.value&&Me(!0),We&&clearTimeout(We)))};z((()=>g.isRefresh),(e=>{e&&(g.setRefresh(!1),Me())})),z((()=>b.taskCount),(()=>{qe()}));const qe=async()=>{try{await g.getConfig(),Ae(!1),await Y(),Ae(!0),g.web.setup?(V.value=!0,await Me(),Ke()):(V.value=!1,Ae(!1),N())}catch(e){Ae(!1)}};return qe(),K((()=>{We&&clearTimeout(We)})),(t,n)=>{const l=e,r=pe,u=d,c=Pe,p=_e,v=y,g=x,k=P,b=f,I=w,U=h,M=m,W=_,z=fe;return S(),H(z,null,{default:j((()=>[C(W,{install:R(T).setup},{desc:j((()=>[B("span",null,O(t.$t("Site.PHP.index_1")),1),C(l,{class:"ml-4px",onClick:n[0]||(n[0]=e=>R(ne)("nginx"))},{default:j((()=>[E(O(t.$t("Site.PHP.index_2")),1)])),_:1}),n[13]||(n[13]=B("span",{class:"mx-4px"},"|",-1)),C(l,{onClick:n[1]||(n[1]=e=>R(ne)("apache"))},{default:j((()=>[E(O(t.$t("Site.PHP.index_3")),1)])),_:1})])),default:j((()=>[C(U,{class:"p-16px",feedback:!0},{toolsLeft:j((()=>[C(r,{type:"primary",class:"add-site-btn",onClick:A},{default:j((()=>[E(O(t.$t("Site.PHP.index_4")),1)])),_:1}),C(p,null,{default:j((()=>[C(r,{onClick:se},{default:j((()=>[E(O(t.$t("Database.Mysql.index_3")),1)])),_:1}),C(c,{trigger:"hover",options:ce,onSelect:me},{default:j((()=>[C(r,null,{default:j((()=>[C(u,{name:"base-arrow-bottom"})])),_:1})])),_:1})])),_:1}),R(V)?(S(),H(v,{key:0,"soft-name":R(L)},null,8,["soft-name"])):F("",!0)])),toolsRight:j((()=>[C(Ve,{value:R(Le).type,"onUpdate:value":n[2]||(n[2]=e=>R(Le).type=e),onChange:Me},null,8,["value"]),C(g,{value:R(Le).search,"onUpdate:value":n[3]||(n[3]=e=>R(Le).search=e),placeholder:t.$t("Site.PHP.index_8"),onSearch:n[4]||(n[4]=e=>Me(!1))},null,8,["value","placeholder"])])),table:j((()=>[C(k,{"checked-row-keys":R(ge),"onUpdate:checkedRowKeys":n[5]||(n[5]=e=>D(ge)?ge.value=e:null),loading:R($e),data:R(ke).data,columns:R(Se),"onUpdate:sorter":je},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:j((()=>[C(b,{"checked-row-keys":R(ge),"onUpdate:checkedRowKeys":n[6]||(n[6]=e=>D(ge)?ge.value=e:null),data:R(ke).data,options:Ee},null,8,["checked-row-keys","data"])])),pageRight:j((()=>[C(I,{page:R(Le).p,"onUpdate:page":n[7]||(n[7]=e=>R(Le).p=e),"page-size":R(Le).limit,"onUpdate:pageSize":n[8]||(n[8]=e=>R(Le).limit=e),"item-count":R(ke).total,"store-key":"site-php-page",onRefresh:Me},null,8,["page","page-size","item-count"])])),_:1}),C(M,{show:R($).show,"onUpdate:show":n[9]||(n[9]=e=>R($).show=e),title:R($).title,data:R($).data,width:700,height:540,footer:!0,component:R(a)},null,8,["show","title","data","component"]),C(M,{show:R(he).show,"onUpdate:show":n[10]||(n[10]=e=>R(he).show=e),title:R(he).title,data:R(he).data,width:860,height:700,component:R(i)},null,8,["show","title","data","component"]),C(M,{show:R(G).show,"onUpdate:show":n[11]||(n[11]=e=>R(G).show=e),title:R(G).title,data:R(G).data,width:950,height:620,component:R(s)},null,8,["show","title","data","component"]),C(M,{show:R(le).show,"onUpdate:show":n[12]||(n[12]=e=>R(le).show=e),title:R(le).title,data:R(le).data,width:700,height:450,footer:!1,component:R(o)},null,8,["show","title","data","component"])])),_:1},8,["install"])])),_:1})}}});export{$e as default};
