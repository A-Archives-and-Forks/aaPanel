import{_ as a}from"./index135.js?v=1721298337096";import{_ as e}from"./index68.js?v=1721298337096";import{d6 as t,ar as s,h as n,d7 as l,n as i,d8 as p,al as d,b5 as o,d9 as u,j as r,p as m,B as c,a as v,k as _,da as b,G as h,db as x,dc as y,dd as f,de as w,df as g,cj as D,dg as $,cJ as k,ab as j}from"./index.js?v=1721298337096";import{A as C,a as P,l as S,ad as U,r as T,S as B,Z as E,_ as L,P as N,V as q,q as I,a3 as z,W as A,a5 as F,a6 as H,f as M,b as G,F as J,af as R,d as V}from"./vue.js?v=1721298337096";import{_ as W}from"./Checkbox.js?v=1721298337096";import{u as Z}from"./useLoading.js?v=1721298337096";import{an as K}from"./site2.js?v=1721298337096";import{_ as O}from"./Select.js?v=1721298337096";import{_ as Q,a as X}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1721298337096";import{_ as Y}from"./useTableColumns.js?v=1721298337096";import"./Tabs.js?v=1721298337096";import"./omit.js?v=1721298337096";import"./Ellipsis.js?v=1721298337096";import"./pinia.js?v=1721298337096";import"./Tag.js?v=1721298337096";import"./Empty.js?v=1721298337096";import"./Progress.js?v=1721298337096";const aa=Symbol("php-admin");function ea(a,e,t,s){return new Promise((n=>{const l="".concat(a,"/index.php?lang=en"),i=document.createElement("form"),p='\n\t\t\t<input type="text" name="pma_username" id="pma_username" value="'.concat(t,'" />\n\t\t\t<input type="password" name="pma_password" id="pma_password" value="').concat(s,'" />\n\t\t\t<input type="text" name="server" value="1" />\n\t\t\t<input type="text" name="target" value="index.php" />\n\t\t\t<input type="text" name="db" id="db" value="').concat(e,'" />\n\t\t');i.action=l,i.setAttribute("public-data",l),i.method="post",i.target="_blank",i.style.display="none",i.innerHTML=p,document.body.appendChild(i),i.submit(),document.body.removeChild(i),n(i)}))}async function ta(a,e){const{data:s}=await t.get("/phpmyadmin/index.php?lang=en"),n={session:"",token:""},l=s.match(/"set_session"\s+value="(\w+)"/),i=s.match(/"token"\s+value="(\w+)"/);l&&l.length>1&&(n.session=l[1]||""),i&&i.length>1&&(n.token=i[1]||"");const p=document.createElement("form");p.action="/phpmyadmin/index.php",p.method="post",p.target="_blank",p.style.display="none";const d='\n\t\t<input  name="set_session" id="input_session" value="'.concat(n.session,'" />\n\t\t<input type="text" name="pma_username" id="pma_username" value="').concat(a,'" size="24" />\n\t\t<input type="password" name="pma_password" id="pma_password" value="').concat(e,'" size="24" />\n\t\t<input  name="token" id="input_token" value="').concat(n.token,'" />\n\t\t<input  name="target" id="input_target" value="index.php" />\n\t\t<input  name="server" value="1" id="input_server" />\n\t');p.innerHTML=d,document.body.appendChild(p),p.submit(),document.body.removeChild(p)}const sa={class:"p-4px"},na={class:"mb-16px"},la={class:"text-error"},ia={class:"mt-20px"},pa=(a=>(F("data-v-1a5b087a"),a=a(),H(),a))((()=>L("span",{class:"bg-recommend"},null,-1))),da="phpmyadmin",oa=v(S({__name:"index",setup(a,{expose:t}){const{t:v}=U(),_=s(),{mysqlInfo:b}=P(aa),h=T(!1),x=a=>{n({title:v("Database.phpadmin.index_12",[v(a?"Public.Status.Start":"Public.Status.Stop")]),content:v("Database.phpadmin.index_13",[v(a?"Public.Status.start":"Public.Status.stop")]),onConfirm:async()=>{await l({name:da,type:a?"start":"stop"}),f()}})},y=async a=>{const e=i.loading(v("Database.phpadmin.index_14"));try{const{message:t}=await p({sName:da}),s=d(t,"ext.url",""),n=d(t,"ext.auth",!1);if("panel"==a){if(n)return i.error(v("Database.phpadmin.index_15")),void e.close();if(_.isFree)return o({source:160}),void e.close();if(b.value)await ta(b.value.username,b.value.password);else{const{message:a}=await u(),e=d(a,"result","");await ta("root",e)}}else if(b.value)await ea(s,b.value.name,b.value.username,b.value.password);else{const{message:a}=await u(),e=d(a,"result","");await ea(s,"","root",e)}e.close()}catch(t){e.close(),console.error(t)}},f=async()=>{const{message:a}=await p({sName:da});r(a)&&(h.value=a.status)};return f(),t({init:f}),(a,t)=>{const s=W,n=e,l=m,i=c;return B(),E("div",sa,[L("div",na,[N(s,{checked:A(h),"onUpdate:checked":x},{default:q((()=>[I(z(a.$t("Database.phpadmin.index_4")),1)])),_:1},8,["checked"])]),N(n,{class:"mb-20px"},{default:q((()=>[L("li",la,z(a.$t("Database.phpadmin.index_5")),1)])),_:1}),N(l,{dashed:""}),L("div",ia,[N(i,{onClick:t[0]||(t[0]=a=>y("panel"))},{default:q((()=>[L("span",null,z(a.$t("Database.phpadmin.index_11")),1),pa])),_:1}),N(i,{class:"ml-24px",onClick:t[1]||(t[1]=a=>y())},{default:q((()=>[I(z(a.$t("Database.phpadmin.index_6")),1)])),_:1})]),N(n,{class:"mt-16px"},{default:q((()=>[L("li",null,z(a.$t("Database.phpadmin.index_7")),1),L("li",null,z(a.$t("Database.phpadmin.index_8")),1),L("li",null,z(a.$t("Database.phpadmin.index_9")),1),L("li",null,z(a.$t("Database.phpadmin.index_10")),1)])),_:1})])}}}),[["__scopeId","data-v-1a5b087a"]]),ua={class:"w-160px"},ra=S({__name:"index",setup(a,{expose:e}){const{t:t}=U(),s=M({php_version:null}),n=T([]),{loading:l,setLoading:o}=Z(),u=async()=>{try{o(!0);const[a,e]=await Promise.all([K(),p({sName:"phpmyadmin"})]),{message:t}=a;_(t)&&(n.value=t.map((a=>({label:a.name,value:a.version}))));const{message:l}=e;s.php_version=d(l,"ext.phpversion",null)}finally{o(!1)}},r=async()=>{const a=s.php_version;null!==a?(await b({phpversion:a}),u()):i.error(t("Database.phpadmin.index_32"))};return u(),e({init:u}),(a,e)=>{const t=O,i=c,p=h;return B(),E("div",null,[N(p,{class:"items-center"},{default:q((()=>[L("span",null,z(a.$t("Database.phpadmin.index_31")),1),L("div",ua,[N(t,{value:A(s).php_version,"onUpdate:value":e[0]||(e[0]=a=>A(s).php_version=a),loading:A(l),options:A(n)},null,8,["value","loading","options"])]),N(i,{type:"primary",onClick:r},{default:q((()=>[I(z(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1})])}}}),ma={class:"p-4px"},ca={class:"w-142px mr-8px"},va={class:"w-142px mr-8px"},_a={class:"w-240px"},ba={class:"w-240px"},ha={class:"w-240px"},xa=S({__name:"index",setup(a,{expose:t}){const{t:s}=U(),l=T(null),o=T(!1),u=T(null),r=T(!1);let v=!1;const _=M({username:"",password:"",repass:""}),b=async()=>{const a=l.value;null!==a?(await x({port:a}),H()):i.error(s("Database.phpadmin.index_25"))},h=async a=>{await y({v:a?1:0}),W()},C=async()=>{const a=u.value;null!==a?(await f({port:a}),W()):i.error(s("Database.phpadmin.index_26"))},P=a=>{!a&&v?n({title:s("Public.Confirm.Title"),content:s("Database.phpadmin.index_27"),onConfirm:async()=>{await w(),H()}}):r.value=a},S=async()=>{""!==_.password.trim()&&""!==_.username.trim()?_.password.length<3||_.username.length<3?i.error(s("Database.phpadmin.index_29")):_.password===_.repass?(await g({username:_.username,password:_.password}),H()):i.error(s("Database.phpadmin.index_30")):i.error(s("Database.phpadmin.index_28"))},F=T(!1),H=async()=>{try{F.value=!0;const{message:a}=await p({sName:"phpmyadmin"}),e=d(a,"ext.port",null);l.value=e?D(e):null,r.value=d(a,"ext.auth",!1),v=r.value}finally{F.value=!1}},V=T(!1),W=async()=>{try{V.value=!0;const{message:a}=await $();o.value=d(a,"status",!1);const e=d(a,"port",null);u.value=e?D(e):null}finally{V.value=!1}},Z=()=>{Promise.all([H(),W()])};return Z(),t({init:Z}),(a,t)=>{const s=k,n=c,i=Q,p=m,d=Y,v=j,x=e,y=X;return B(),E("div",ma,[N(y,{"label-width":"160"},{default:q((()=>[N(i,{label:a.$t("Database.phpadmin.index_16")},{default:q((()=>[L("div",ca,[N(s,{value:A(l),"onUpdate:value":t[0]||(t[0]=a=>G(l)?l.value=a:null),min:0,max:66325,"show-button":!1,loading:A(F),placeholder:""},null,8,["value","loading"])]),N(n,{type:"primary",onClick:b},{default:q((()=>[I(z(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1},8,["label"]),N(p,{dashed:""}),N(i,{class:"mt-20px",label:a.$t("Database.phpadmin.index_17")},{default:q((()=>[N(d,{value:A(o),loading:A(V),"onUpdate:value":h},null,8,["value","loading"])])),_:1},8,["label"]),N(i,{label:a.$t("Database.phpadmin.index_18")},{default:q((()=>[L("div",va,[N(s,{value:A(u),"onUpdate:value":t[1]||(t[1]=a=>G(u)?u.value=a:null),min:0,max:66325,"show-button":!1,loading:A(V),placeholder:""},null,8,["value","loading"])]),N(n,{type:"primary",onClick:C},{default:q((()=>[I(z(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1},8,["label"]),N(p,{dashed:""}),N(i,{class:"mt-20px",label:a.$t("Database.phpadmin.index_19")},{default:q((()=>[N(d,{value:A(r),loading:A(F),"onUpdate:value":P},null,8,["value","loading"])])),_:1},8,["label"]),A(r)?(B(),E(J,{key:0},[N(i,{label:a.$t("Database.phpadmin.index_20")},{default:q((()=>[L("div",_a,[N(v,{value:A(_).username,"onUpdate:value":t[2]||(t[2]=a=>A(_).username=a),placeholder:a.$t("Database.phpadmin.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"]),N(i,{label:a.$t("Database.phpadmin.index_21")},{default:q((()=>[L("div",ba,[N(v,{value:A(_).password,"onUpdate:value":t[3]||(t[3]=a=>A(_).password=a),type:"password",placeholder:a.$t("Database.phpadmin.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"]),N(i,{label:a.$t("Database.phpadmin.index_22")},{default:q((()=>[L("div",ha,[N(v,{value:A(_).repass,"onUpdate:value":t[4]||(t[4]=a=>A(_).repass=a),type:"password",placeholder:a.$t("Database.phpadmin.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"]),N(i,{label:" "},{default:q((()=>[N(n,{type:"primary",onClick:S},{default:q((()=>[I(z(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1})],64)):R("",!0),N(x,null,{default:q((()=>[L("li",null,z(a.$t("Database.phpadmin.index_24")),1)])),_:1})])),_:1})])}}}),ya={class:"h-580px"},fa=S({__name:"index",props:{row:{default:void 0}},setup(e){const t=V(e,"row"),{t:s}=U(),n=T("service"),l=[{key:"service",label:s("Database.phpadmin.index_1"),component:oa},{key:"php",label:s("Database.phpadmin.index_2"),component:ra},{key:"safe",label:s("Database.phpadmin.index_3"),component:xa}];return C(aa,{mysqlInfo:t}),(e,t)=>{const s=a;return B(),E("div",ya,[N(s,{value:A(n),"onUpdate:value":t[0]||(t[0]=a=>G(n)?n.value=a:null),ref:"tabsRef",data:l},null,8,["value"])])}}});export{fa as default};
