import{c as e,d as t,h as a,e as s,K as i,f as n,_ as l,a as o,b as u,F as c}from"./public.js?v=1749179669910";import{_ as r}from"./index103.js?v=1749179669910";import{_ as d}from"./index.js?v=1749179669910";import{i as p,t as _,a4 as y,N as m,cH as g,m as x,c as v,b4 as h,_ as w,p as k,u as b,q as f}from"./page_layout.js?v=1749179669910";import{_ as S}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1749179669910";import{d as I,O as A,r as j,n as O,j as P,R as U,S as C,P as q,a1 as R,U as $,a2 as M,V as T,aj as z,_ as L,w as F,F as K,c as H,a0 as W,N,ak as B,k as D,v as E,e as V}from"./vue.js?v=1749179669910";import{cp as G,bU as J,_ as Q,cj as X,T as Y,bA as Z,cm as ee,c0 as te}from"./naive.js?v=1749179669910";import{_ as ae}from"./index.vue_vue_type_script_setup_true_lang.js?v=1749179669910";import{_ as se}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1749179669910";import"./common.js?v=1749179669910";import"./__commonjsHelpers__.js?v=1749179669910";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1749179669910";const{t:ie}=p.global,ne={class:"p-20px"},le=I({__name:"log",props:{data:{}},setup(s,{expose:i}){const{t:n}=A(),l=s,{date:o,name:u}=l.data,c=j([]),{keys:r,table:d,columns:p}=e([{key:"log",title:n("Ftp.Analysis.Index_27"),render:()=>u},{key:"cwd",title:n("Security.Anti.Index_46")},{key:"cmd",title:n("Security.Anti.Index_47")},{key:"filename",title:n("Security.Anti.Index_48")},{key:"cwd",title:n("Config.Safe.index_152"),render:e=>y(e.timestamp)}]);O((()=>{c.value=o.map((e=>({label:e,value:e})))}));const g=P({p:1,num:999,day:o[0]}),{loading:x,setLoading:v}=t(),h=async()=>{try{v(!0);const{message:t}=await(e={...g,user:u},_.post("/plugin?action=a&name=bt_security&s=get_user_log",e));m(t)&&(d.data=t,d.total=t.length)}finally{r.value=[],v(!1)}var e};return h(),i({init:h}),(e,t)=>{const s=G,i=J,n=a,l=S;return U(),C("div",ne,[q(i,{class:"flex-nowrap! items-center mb-10px"},{default:R((()=>[$("span",null,M(e.$t("Security.Anti.Index_45")),1),q(s,{class:"w-150px",value:T(g).day,"onUpdate:value":[t[0]||(t[0]=e=>T(g).day=e),h],options:T(c)},null,8,["value","options"])])),_:1}),q(l,null,{table:R((()=>[q(n,{"checked-row-keys":T(r),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>z(r)?r.value=e:null),loading:T(x),data:T(d).data,"max-height":350,columns:T(p)},null,8,["checked-row-keys","loading","data","columns"])])),_:1})])}}}),oe=I({__name:"index",setup(o,{expose:u}){const{t:c}=A(),r=g(),{antiForm:p}=L(r),y=s(),{keys:h,table:w,columns:k}=e([{key:"user",title:c("Ftp.Analysis.Index_27")},{key:"total",title:c("Security.Anti.Index_7")},{key:"today",title:c("Public.Search.Today")},i({key:"protection",title:c("Security.Tabs.Index_8"),minWidth:60,onClick:async(e,t)=>{var a;e?await(a={user:t.user},_.post("/plugin?action=a&name=bt_security&s=start_user_security",a,{requestOptions:{loading:ie("Security.Api.Index_1"),successMessage:!0}})):await(e=>_.post("/plugin?action=a&name=bt_security&s=stop_user_security",e,{requestOptions:{loading:ie("Security.Api.Index_2"),successMessage:!0}}))({user:t.user})}}),i({key:"log",title:c("Security.Anti.Index_8"),minWidth:60,onClick:async(e,t)=>{var a;e?await(a={uid:t.uid},_.post("/plugin?action=a&name=bt_security&s=start_user_log",a,{requestOptions:{loading:ie("Security.Api.Index_1"),successMessage:!0}})):await(e=>_.post("/plugin?action=a&name=bt_security&s=stop_user_log",e,{requestOptions:{loading:ie("Security.Api.Index_2"),successMessage:!0}}))({uid:t.uid})}}),{key:"remark",title:c("Site.Proxy.index_3")},n({width:130,title:c("Public.Table.Operation"),options:e=>[{label:c("Site.Proxy.index_51"),onClick:async()=>{const{message:t}=await(a={user:e.user},_.post("/plugin?action=a&name=bt_security&s=get_logs_list",a,{requestOptions:{loading:ie("Site.Api.Index_10"),successMessage:!1}}));var a;!m(t)||t.length?(y.title="[".concat(e.user,"] - ").concat(c("Site.Proxy.index_51")),y.data.date=t,y.data.name=e.user,y.show=!0):x.error(c("Security.Anti.Index_44"))}}]})]);F((()=>r.isRefresh),(e=>{e&&(r.setRefresh(!1),S())}));const{loading:b,setLoading:f}=t(),S=async()=>{try{f(!0);const{message:e}=await _.post("/plugin?action=a&name=bt_security&s=get_total_all");v(e)&&(p.value.switch=e.open,p.value.times=e.totla_times,p.value.days=e.totla_days,w.data=e.system_user.map((e=>({user:e[0],total:e[4].totla,today:e[4].day_totla,protection:e[3],log:e[5],remark:e[6],uid:e[1]}))))}finally{h.value=[],f(!1)}};return S(),u({init:S}),(e,t)=>{const s=a,i=l,n=d;return U(),C(K,null,[q(s,{"checked-row-keys":T(h),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>z(h)?h.value=e:null),"row-key":"user","max-height":750,loading:T(b),data:T(w).data,columns:T(k)},null,8,["checked-row-keys","loading","data","columns"]),q(i,{class:"mt-16px"},{default:R((()=>[$("li",null,M(e.$t("Security.Anti.Index_4")),1),$("li",null,M(e.$t("Security.Anti.Index_5")),1),$("li",null,M(e.$t("Security.Anti.Index_6")),1)])),_:1}),q(n,{show:T(y).show,"onUpdate:show":t[1]||(t[1]=e=>T(y).show=e),title:T(y).title,data:T(y).data,width:750,"min-height":268,footer:!1,component:le},null,8,["show","title","data"])],64)}}}),ue={class:"p-20px"},ce={class:"w-280px"},re={class:"color-#ff3333"},de=I({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=A(),s=e,{getList:i}=s.data,n=j(null),o=P({name:""}),u={name:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{var t,a;await(null==(t=n.value)?void 0:t.validate()),await(a={cmd:o.name},_.post("/plugin?action=a&name=bt_security&s=add_porcess_log",a,{requestOptions:{loading:ie("Security.Api.Index_4"),successMessage:!0}})),null==i||i(),e()}}),(e,t)=>{const a=Q,s=X,i=ae,c=l;return U(),C("div",ue,[q(i,{ref_key:"formRef",ref:n,model:T(o),rules:u},{default:R((()=>[q(s,{label:e.$t("Home.index_24"),path:"name"},{default:R((()=>[$("div",ce,[q(a,{type:"text",value:T(o).name,"onUpdate:value":t[0]||(t[0]=e=>T(o).name=e),placeholder:"e.g:/bin/bash"},null,8,["value"])])])),_:1},8,["label"])])),_:1},8,["model"]),q(c,{class:"mt-4px"},{default:R((()=>[$("li",re,M(e.$t("Security.Anti.Index_9")),1)])),_:1})])}}}),pe=I({__name:"index",setup(i,{expose:l}){const{t:u}=A(),{loading:c,setLoading:r}=t(),{keys:p,table:y,columns:g}=e([{key:"whitelist",title:u("Security.Anti.Index_11")},n({width:130,options:e=>[{label:u("Public.Btn.Del"),onClick:()=>{o({title:"".concat(u("Security.Anti.Index_12")," [").concat(e.whitelist,"]"),content:u("Security.Anti.Index_13"),onConfirm:async({hide:t})=>{var a;await(a={cmd:e.whitelist},_.post("/plugin?action=a&name=bt_security&s=del_porcess_log",a,{requestOptions:{loading:ie("Security.Api.Index_3"),successMessage:!0}})),x(),t()}})}}]})]),x=async()=>{try{r(!0);const{message:e}=await _.post("/plugin?action=a&name=bt_security&s=porcess_set_up_log");m(e)&&(y.data=e.map((e=>({whitelist:e}))))}finally{p.value=[],r(!1)}};x(),l({init:x});const v=()=>{h.show=!0},h=s(u("Security.Anti.Index_10"),{getList:x});return(e,t)=>{const s=Y,i=a,n=S,l=d;return U(),C("div",null,[q(n,null,{toolsLeft:R((()=>[q(s,{type:"primary",onClick:v},{default:R((()=>[H(M(e.$t("Security.Anti.Index_10")),1)])),_:1})])),table:R((()=>[q(i,{"checked-row-keys":T(p),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>z(p)?p.value=e:null),"row-key":"whitelist",loading:T(c),"max-height":440,data:T(y).data,columns:T(g)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),q(l,{show:T(h).show,"onUpdate:show":t[1]||(t[1]=e=>T(h).show=e),title:T(h).title,data:T(h).data,width:480,footer:!0,component:de},null,8,["show","title","data"])])}}}),_e=I({__name:"index",setup(s,{expose:i}){const{t:n}=A(),{keys:l,table:o,columns:u}=e([{key:"log",title:n("Public.Table.Operation")},{key:"addtime",align:"right",title:n("Site.Cert.index_68")}]),c=P({p:1,limit:10}),{loading:r,setLoading:d}=t(),p=async()=>{try{d(!0);const{message:t}=await(e=c,_.post("/plugin?action=a&name=bt_security&s=get_log",e));v(t)&&(o.data=t.data,o.total=h(t.page))}finally{l.value=[],d(!1)}var e};return p(),i({init:p}),(e,t)=>{const s=a,i=se,n=S;return U(),W(n,{feedback:!0},{table:R((()=>[q(s,{"checked-row-keys":T(l),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>z(l)?l.value=e:null),"row-key":"log",loading:T(r),data:T(o).data,columns:T(u)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:R((()=>[q(i,{page:T(c).p,"onUpdate:page":t[1]||(t[1]=e=>T(c).p=e),"page-size":T(c).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>T(c).limit=e),"item-count":T(o).total,"store-key":"security-anti",onRefresh:p},null,8,["page","page-size","item-count"])])),_:1})}}}),ye=I({__name:"index",setup(e){const{t:t}=A(),a=j("overview"),s=[{key:"overview",label:t("Security.Tabs.Index_5"),component:oe},{key:"whitelist",label:t("Security.Tabs.Index_6"),component:pe},{key:"operation",label:t("Security.Tabs.Index_7"),component:_e}];return(e,t)=>{const i=r;return U(),W(i,{value:T(a),"onUpdate:value":t[0]||(t[0]=e=>z(a)?a.value=e:null),options:s},null,8,["value"])}}}),me={class:"pt-40px pb-40px"},ge={class:"mb-16px"},xe={class:"ul-style"},ve={class:"text-center my-24px"},he={class:"flex justify-center"},we={class:"item"},ke=["onClick"],be=k(I({__name:"conversion",setup(e){const t=j(0),a=["Overview","Process whitelist","Operation logs"],s=()=>{u({source:105})};return(e,i)=>{const n=w,l=Y,o=Z,u=ee;return U(),W(u,null,{default:R((()=>[$("div",me,[i[3]||(i[3]=$("div",{class:"mb-24px text-center text-22px font-bold"},"Anti Intrusion prevention features",-1)),$("div",ge,[$("ul",xe,[$("li",null,[q(n,{name:"security-lixian",size:"22"}),i[0]||(i[0]=$("span",{class:"ml-4px"},"Prevents the program from hanging",-1))]),$("li",null,[q(n,{name:"security-sanfang",size:"20"}),i[1]||(i[1]=$("span",{class:"ml-4px"},"Stop the mining virus",-1))]),$("li",null,[q(n,{name:"security-webshell",size:"26"}),i[2]||(i[2]=$("span",null,"Prevent Privilege Escalation Attacks",-1))])])]),$("div",ve,[q(l,{type:"primary",class:"h-36px text-14px",onClick:s},{default:R((()=>[H(M(e.$t("WP.Transition.index_7")),1)])),_:1})]),$("div",he,[$("div",we,[$("ul",null,[(U(),C(K,null,N(a,((e,a)=>$("li",{class:B({active:T(t)==a}),key:a,onClick:e=>t.value=a},M(e),11,ke))),64))])]),D(q(o,{width:"100%",src:T("/static/vite/images/overview2.png")},null,8,["src"]),[[E,0==T(t)]]),D(q(o,{width:"100%",src:T("/static/vite/images/whitelist.png")},null,8,["src"]),[[E,1==T(t)]]),D(q(o,{width:"100%",src:T("/static/vite/images/logs.png")},null,8,["src"]),[[E,2==T(t)]])])])])),_:1})}}}),[["__scopeId","data-v-f9cef105"]]),fe={key:0},Se=I({__name:"index",setup(e){const t=b(),{isPro:a}=L(t),s=g(),{antiForm:i}=L(s),n=j(i.value.switch),l=V((()=>i.value.switch));F(l,(e=>{n.value=e}));const o=V((()=>i.value.times)),u=V((()=>i.value.days)),r=async e=>{e?await _.post("/plugin?action=a&name=bt_security&s=start_bt_security",{},{requestOptions:{loading:ie("Security.Api.Index_1"),successMessage:!0}}):await _.post("/plugin?action=a&name=bt_security&s=stop_bt_security",{},{requestOptions:{loading:ie("Security.Api.Index_2"),successMessage:!0}}),await s.setRefresh(!0)};return(async()=>{a.value&&await c("bt_security")})(),(e,t)=>{const s=te,i=f,l=J,c=ee;return T(a)?(U(),C("div",fe,[q(c,{class:"my-15px"},{default:R((()=>[q(l,{class:"p-15px items-center"},{default:R((()=>[$("span",null,M(e.$t("Security.Anti.Index_1")),1),q(s,{value:T(n),"onUpdate:value":[t[0]||(t[0]=e=>z(n)?n.value=e:null),r],"rubber-band":!1,size:"small"},null,8,["value"]),q(i,{vertical:""}),$("span",null,M(e.$t("Security.Anti.Index_2"))+": "+M(T(o)),1),q(i,{vertical:""}),$("span",null,M(e.$t("Security.Anti.Index_3"))+": "+M(T(u)),1)])),_:1})])),_:1}),q(c,{class:"p-15px"},{default:R((()=>[q(ye)])),_:1})])):(U(),W(be,{key:1}))}}});export{Se as default};
