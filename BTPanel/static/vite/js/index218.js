import{_ as e}from"./index104.js?v=1744703330658";import{_ as a}from"./index.vue_vue_type_script_setup_true_lang.js?v=1744703330658";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang10.js?v=1744703330658";import{_ as s}from"./index99.js?v=1744703330658";import{cx as l,j as i,I as d,_ as n,l as u,d as o,da as p,fu as r,k as c,g as _,m as v,bD as m,a$ as f}from"./page_layout.js?v=1744703330658";import{d as P,O as x,_ as S,as as b,e as h,R as g,S as y,U as w,P as H,V as $,a0 as k,c as U,a1 as L,ap as j,F as q,r as C,n as E,ar as I,ai as M,$ as R,j as O,k as B,af as D,v as z}from"./vue.js?v=1744703330658";import{aq as F,c as J,aJ as Q,aK as T}from"./site.js?v=1744703330658";import{c as V,u as K}from"./public.js?v=1744703330658";import{a as N}from"./soft.js?v=1744703330658";import{cn as Z,_ as A,T as G,aV as W,a2 as X,bZ as Y,bU as ee,cm as ae,cl as te,ch as se,ct as le}from"./naive.js?v=1744703330658";import{g as ie}from"./ssl.js?v=1744703330658";import"./index96.js?v=1744703330658";import"./common.js?v=1744703330658";import"./__commonjsHelpers__.js?v=1744703330658";const de={class:"w-150px"},ne={key:0,class:"ml-8px"},ue=P({__name:"select-ftp",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e){const{t:a}=x(),t=l(),{ftp:s}=S(t),d=b(e,"value"),n=[{label:a("Site.PHP.add_site_31"),value:"0"},{label:a("Site.PHP.add_site_34"),value:"1"}],u=h((()=>!s.value.setup)),o=()=>{N("pureftpd")};return(e,a)=>{const t=Z,s=i;return g(),y(q,null,[w("div",de,[H(t,{value:d.value,"onUpdate:value":a[0]||(a[0]=e=>d.value=e),class:"ftp-select",options:n,disabled:$(u)},null,8,["value","disabled"])]),$(u)?(g(),y("div",ne,[H(s,{onClick:o},{default:k((()=>[U(L(e.$t("Site.PHP.add_site_33")),1)])),_:1})])):j("",!0)],64)}}}),oe={class:"w-150px"},pe={key:0,class:"ml-8px"},re=P({__name:"select-database",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e){const{t:a}=x(),t=l(),{mysql:s}=S(t),d=b(e,"value"),n=[{label:a("Site.PHP.add_site_31"),value:"0"},{label:a("Site.PHP.add_site_32"),value:"MySQL"}],u=h((()=>!s.value.setup)),o=()=>{N("mysql")};return(e,a)=>{const t=Z,s=i;return g(),y(q,null,[w("div",oe,[H(t,{value:d.value,"onUpdate:value":a[0]||(a[0]=e=>d.value=e),class:"db-select",options:n,disabled:$(u)},null,8,["value","disabled"])]),$(u)?(g(),y("div",pe,[H(s,{onClick:o},{default:k((()=>[U(L(e.$t("Site.PHP.add_site_30")),1)])),_:1})])):j("",!0)],64)}}}),ce={class:"w-150px"},_e=P({__name:"select-php",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e){const a=b(e,"value"),{loading:t,setLoading:s}=V(),l=C([]);return(async()=>{try{s(!0);const{message:e}=await F(),t=d(e)?e:[];l.value=t.reverse().map((e=>({label:e.name,value:e.version}))),await E(),t.length>0&&(a.value=t[0].version)}finally{s(!1)}})(),(e,s)=>{const i=Z;return g(),y("div",ce,[H(i,{value:a.value,"onUpdate:value":s[0]||(s[0]=e=>a.value=e),class:"php-select",loading:$(t),options:$(l)},null,8,["value","loading","options"])])}}}),ve={class:"w-150px"},me=P({__name:"select-category",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e){const a=b(e,"value"),{loading:t,setLoading:s}=V(),l=C([]);return(async()=>{try{s(!0);const{message:e}=await J();d(e)?(l.value=e.map((e=>({label:e.name,value:e.id}))),e.length>0&&(a.value=e[0].id)):l.value=[]}finally{s(!1)}})(),(e,s)=>{const i=Z;return g(),y("div",ve,[H(i,{value:a.value,"onUpdate:value":s[0]||(s[0]=e=>a.value=e),class:"type-select",loading:$(t),options:$(l)},null,8,["value","loading","options"])])}}}),fe={class:"flex items-center w-600px py-30px px-50px"},Pe={class:"w-120px text-primary"},xe={class:"flex flex-col gap-16px flex-1 ml-60px"},Se={key:0,class:"leading-24px"},be={class:"flex items-center h-30px"},he={class:"mt-8px"},ge={class:"font-bold"},ye={class:"font-bold"},we={key:1,class:"leading-24px"},He={class:"flex items-center h-30px"},$e={class:"mt-8px"},ke={class:"font-bold"},Ue={class:"font-bold"},Le=P({__name:"site-result",props:{data:{}},setup(e){const a=e,{info:t}=a.data;return(e,a)=>{const s=n,l=u;return g(),y("div",fe,[w("div",Pe,[H(s,{name:"base-success",size:"120"})]),w("div",xe,[$(t).ftpStatus?(g(),y("div",Se,[w("div",be,L(e.$t("Site.PHP.add_site_35")),1),H(l,{dashed:""}),w("div",he,[U(L(e.$t("Site.PHP.add_site_37")),1),w("span",ge,L($(t).ftpUser||"--"),1)]),w("div",null,[U(L(e.$t("Site.PHP.add_site_38")),1),w("span",ye,L($(t).ftpPass||"--"),1)])])):j("",!0),$(t).databaseStatus?(g(),y("div",we,[w("div",He,L(e.$t("Site.PHP.add_site_36")),1),H(l,{dashed:""}),w("div",$e,[U(L(e.$t("Site.PHP.add_site_37"))+" ",1),w("span",ke,L($(t).databaseUser||"--"),1)]),w("div",null,[U(L(e.$t("Site.PHP.add_site_38"))+" ",1),w("span",Ue,L($(t).databasePass||"--"),1)])])):j("",!0)])])}}}),je={key:0,class:"text-desc"},qe=c(P({__name:"domain-input",props:{value:{required:!0},valueModifiers:{},parseList:{required:!0},parseListModifiers:{}},emits:I(["update:domain"],["update:value","update:parseList"]),setup(e,{expose:a,emit:t}){const s=M(),l=b(e,"value"),d=b(e,"parseList"),n=t,u=async(e,a)=>{if(0===a&&n("update:domain",e),!(null==e?void 0:e.trim()))return void(d.value[a]&&d.value.splice(a,1));const{message:t}=await ie({domain:e});o(t)&&l.value[a]&&(d.value[a]={...t,auto:t.support.includes("auto"),ssl_cert:t.support.includes("ssl_cert"),cf_proxy:t.support.includes("cf_proxy")})},c=()=>{s.push("/ssl_domain/domain")};return a({onDomainItemBlur:u}),(e,a)=>{const t=A,s=G,o=W,_=X,v=i,m=Y,f=p,P=ee,x=r;return g(),R(x,{value:l.value,"onUpdate:value":a[0]||(a[0]=e=>l.value=e)},{default:k((({index:a})=>[H(t,{class:"w-140px!",value:l.value[a],"onUpdate:value":e=>l.value[a]=e,placeholder:e.$t("Mail.Setting.index_20"),onBlur:e=>u(l.value[a],a)},null,8,["value","onUpdate:value","placeholder","onBlur"])])),action:k((({index:t})=>[H(P,{class:"items-center ml-5px"},{default:k((()=>{var i;return[H(o,null,{default:k((()=>[H(s,{onClick:e=>(e=>{l.value.splice(e,1),d.value.splice(e,1),0===e&&n("update:domain",l.value[0]?l.value[0]:"")})(t),disabled:1===l.value.length,round:""},{default:k((()=>a[1]||(a[1]=[w("span",null,"-",-1)]))),_:2},1032,["onClick","disabled"]),H(s,{onClick:e=>(e=>{l.value.splice(e+1,0,""),d.value.splice(e+1,0,{})})(t),round:""},{default:k((()=>a[2]||(a[2]=[w("span",null,"+",-1)]))),_:2},1032,["onClick"])])),_:2},1024),(null==(i=d.value[t])?void 0:i.support)?(g(),y("span",je,[H(f,null,{default:k((()=>[H(m,{trigger:"hover",disabled:d.value[t].support.includes("auto")},{trigger:k((()=>[H(_,{checked:d.value[t].auto,"onUpdate:checked":e=>d.value[t].auto=e,disabled:!d.value[t].support.includes("auto"),label:e.$t("SSL.Domain.index_34")},null,8,["checked","onUpdate:checked","disabled","label"])])),default:k((()=>[w("div",null,[U(L(e.$t("SSL.index_5"))+" ",1),H(v,{onClick:c},{default:k((()=>[U(L(e.$t("SSL.index_4")),1)])),_:1})])])),_:2},1032,["disabled"]),H(m,{trigger:"hover",disabled:d.value[t].support.includes("ssl_cert")},{trigger:k((()=>[H(_,{checked:d.value[t].ssl_cert,"onUpdate:checked":e=>d.value[t].ssl_cert=e,disabled:!d.value[t].support.includes("ssl_cert"),label:e.$t("SSL.index_7")},null,8,["checked","onUpdate:checked","disabled","label"])])),default:k((()=>[w("div",null,[U(L(e.$t("SSL.index_6"))+" ",1),H(v,{onClick:c},{default:k((()=>[U(L(e.$t("SSL.index_4")),1)])),_:1})])])),_:2},1032,["disabled"]),d.value[t].support.includes("cf_proxy")?(g(),R(_,{key:0,checked:d.value[t].cf_proxy,"onUpdate:checked":e=>d.value[t].cf_proxy=e,disabled:!d.value[t].support.includes("cf_proxy"),label:e.$t("SSL.index_8")},null,8,["checked","onUpdate:checked","disabled","label"])):j("",!0)])),_:2},1024)])):j("",!0)]})),_:2},1024)])),_:1},8,["value"])}}}),[["__scopeId","data-v-639625dc"]]),Ce={class:"w-440px"},Ee={class:"w-400px"},Ie={class:"w-400px"},Me={class:"flex-1"},Re={class:"w-174px"},Oe={class:"ml-8px"},Be={class:"w-174px"},De={class:"mt-8px text-desc"},ze={class:"flex-1"},Fe={class:"w-174px"},Je={class:"ml-8px"},Qe={class:"w-174px"},Te={class:"mt-8px text-desc"},Ve={class:"w-150px"},Ke=P({__name:"index",props:{getList:{type:Function}},setup(e,{expose:i}){const d=e,{t:u}=x(),p=l(),r=C("0"),c=C("0"),m=C(null),f=C(null),P=C([]),S=O({type:0,domain:[""],webname:{domain:""},ps:"",path:p.sitePath,ftp:!1,ftp_username:"",ftp_password:"",sql:!1,codeing:"utf8",datauser:"",datapassword:"",version:null,type_id:null,set_ssl:!1,force_ssl:!1}),b={"webname.domain":{required:!0,trigger:["blur","change"],validator:(e,a)=>""!==a.trim()||0!==S.type||new Error(u("Site.PHP.add_site_23"))},domain:{trigger:["blur"],validator:(e,a)=>!(!a[0]&&1===S.type)||new Error(u("Site.PHP.add_site_23"))},path:{trigger:["blur","change"],validator:(e,a)=>""!==a||new Error(u("Site.PHP.add_site_26"))},version:{trigger:"change",validator:(e,a)=>null!==a||new Error(u("Site.PHP.add_site_27"))},type_id:{trigger:"change",validator:(e,a)=>null!==a||new Error(u("Site.PHP.add_site_28"))}},h=e=>{if(!e)return void(S.webname.domain=S.domain.filter(Boolean).join("\n"));const a=S.webname.domain.trim();a!==S.domain.join("\n")&&(S.domain=a?a.split("\n").filter(Boolean):[""],S.domain.forEach(((e,a)=>{var t;return null==(t=m.value)?void 0:t.onDomainItemBlur(e,a)})))},q=e=>{const a=null==e?void 0:e.trim().split("\n")[0].split(":")[0];if(a){const e=a.replace(new RegExp(/([-.])/g),"_");S.ps=e,S.path="".concat(p.sitePath,"/").concat(a),S.ftp_username="ftp_".concat(e),S.ftp_password=_(16),S.datauser="sql_".concat(e),S.datapassword=_(16)}else S.ps="",S.path=p.sitePath,S.ftp_username="",S.ftp_password="",S.datauser="",S.datapassword=""},E=e=>{S.ftp="1"===e},I=e=>{S.sql="0"!==e&&e};return i({onConfirm:async()=>{var e;await(null==(e=f.value)?void 0:e.validate());const a=(()=>{const{version:e,type_id:a}=S;if(null===e)throw v.error(u("Site.PHP.add_site_27")),new Error(u("Site.PHP.add_site_27"));if(null===a)throw v.error(u("Site.PHP.add_site_28")),new Error(u("Site.PHP.add_site_28"));const t=S.webname.domain.trim().split("\n"),s=t[0]+"\r",l=t[0].split(":")[1]||"80",i=t.length>1?t.slice(1):[],d=P.value.map((e=>({domain:e.domain,hash:e.hash,support:[...e.auto?["auto"]:[],...e.ssl_cert?["ssl_cert"]:[],...e.cf_proxy?["cf_proxy"]:[]]})));let n={webname:{domain:s,domainlist:i,count:i.length},parse_list:1===S.type?JSON.stringify(d):null,port:l,type:"PHP",ps:S.ps,path:S.path,ftp:S.ftp,sql:S.sql,codeing:S.codeing,version:e,type_id:a,set_ssl:S.set_ssl?1:0,force_ssl:S.force_ssl?1:0};return S.ftp&&(n=Object.assign(n,{ftp_username:S.ftp_username,ftp_password:S.ftp_password})),S.sql&&(n=Object.assign(n,{datauser:S.datauser,datapassword:S.datapassword})),n})(),{message:t}=await Q(a);var s;!o(t)||!1===t.ftpStatus&&!1===t.databaseStatus?v.success(u("Site.PHP.add_site_29")):(s=t,K({title:u("Site.PHP.add_site_29"),data:{info:s},component:Le})),d.getList()}}),(e,l)=>{const i=ae,d=te,u=n,o=se,p=s,_=A,v=t,x=ee,C=a;return g(),y("div",null,[H(C,{ref_key:"formRef",ref:f,model:$(S),rules:b},{default:k((()=>[H(o,{label:e.$t("SSL.index_1")},{default:k((()=>[H(d,{value:$(S).type,"onUpdate:value":[l[0]||(l[0]=e=>$(S).type=e),h]},{default:k((()=>[H(i,{value:0},{default:k((()=>[U(L(e.$t("SSL.index_2")),1)])),_:1}),H(i,{value:1},{default:k((()=>[U(L(e.$t("SSL.index_3")),1)])),_:1})])),_:1},8,["value"]),H(u,{name:"ssl-stars",size:22})])),_:1},8,["label"]),B(H(o,{label:e.$t("Site.PHP.add_site_4"),path:"domain"},{default:k((()=>[H(qe,{ref_key:"domainInputRef",ref:m,value:$(S).domain,"onUpdate:value":l[1]||(l[1]=e=>$(S).domain=e),"parse-list":$(P),"onUpdate:parseList":l[2]||(l[2]=e=>D(P)?P.value=e:null),"onUpdate:domain":q},null,8,["value","parse-list"])])),_:1},8,["label"]),[[z,1===$(S).type]]),B(H(o,{label:e.$t("Site.PHP.add_site_4"),path:"webname.domain"},{default:k((()=>[w("div",Ce,[H(p,{value:$(S).webname.domain,"onUpdate:value":[l[3]||(l[3]=e=>$(S).webname.domain=e),q],name:"domain"},{default:k((()=>[w("p",null,L(e.$t("Site.PHP.add_site_5")),1),w("p",null,L(e.$t("Site.PHP.add_site_6")),1),w("p",null,L(e.$t("Site.PHP.add_site_7")),1)])),_:1},8,["value"])])])),_:1},8,["label"]),[[z,0===$(S).type]]),H(o,{label:e.$t("Site.PHP.add_site_8"),path:"ps"},{default:k((()=>[w("div",Ee,[H(_,{value:$(S).ps,"onUpdate:value":l[4]||(l[4]=e=>$(S).ps=e),"input-props":{name:"ps"},placeholder:""},null,8,["value"])])])),_:1},8,["label"]),H(o,{label:e.$t("Site.PHP.add_site_9"),path:"path"},{default:k((()=>[w("div",Ie,[H(v,{value:$(S).path,"onUpdate:value":l[5]||(l[5]=e=>$(S).path=e),"input-props":{name:"path"}},null,8,["value"])])])),_:1},8,["label"]),H(o,{label:e.$t("Site.PHP.add_site_10")},{default:k((()=>[H(ue,{value:$(r),"onUpdate:value":[l[6]||(l[6]=e=>D(r)?r.value=e:null),E]},null,8,["value"])])),_:1},8,["label"]),"1"===$(r)?(g(),R(o,{key:0,label:e.$t("Site.PHP.add_site_11")},{default:k((()=>[w("div",Me,[H(x,{class:"items-center"},{default:k((()=>[w("div",Re,[H(_,{value:$(S).ftp_username,"onUpdate:value":l[7]||(l[7]=e=>$(S).ftp_username=e),"input-props":{name:"ftp_username"},placeholder:e.$t("Site.PHP.add_site_12")},null,8,["value","placeholder"])]),w("div",Oe,L(e.$t("Site.PHP.add_site_13")),1),w("div",Be,[H(_,{value:$(S).ftp_password,"onUpdate:value":l[8]||(l[8]=e=>$(S).ftp_password=e),"input-props":{name:"ftp_password"},placeholder:e.$t("Site.PHP.add_site_14")},null,8,["value","placeholder"])])])),_:1}),w("div",De,L(e.$t("Site.PHP.add_site_15")),1)])])),_:1},8,["label"])):j("",!0),H(o,{label:e.$t("Site.PHP.add_site_16")},{default:k((()=>[H(re,{value:$(c),"onUpdate:value":[l[9]||(l[9]=e=>D(c)?c.value=e:null),I]},null,8,["value"])])),_:1},8,["label"]),"MySQL"===$(c)?(g(),R(o,{key:1,label:e.$t("Site.PHP.add_site_17")},{default:k((()=>[w("div",ze,[H(x,{class:"items-center"},{default:k((()=>[w("div",Fe,[H(_,{value:$(S).datauser,"onUpdate:value":l[10]||(l[10]=e=>$(S).datauser=e),"input-props":{name:"db_username"},placeholder:e.$t("Site.PHP.add_site_18")},null,8,["value","placeholder"])]),w("div",Je,L(e.$t("Site.PHP.add_site_13")),1),w("div",Qe,[H(_,{value:$(S).datapassword,"onUpdate:value":l[11]||(l[11]=e=>$(S).datapassword=e),"input-props":{name:"db_password"},placeholder:e.$t("Site.PHP.add_site_19")},null,8,["value","placeholder"])])])),_:1}),w("div",Te,L(e.$t("Site.PHP.add_site_20")),1)])])),_:1},8,["label"])):j("",!0),H(o,{label:e.$t("Site.PHP.add_site_21"),path:"version"},{default:k((()=>[w("div",Ve,[H(_e,{value:$(S).version,"onUpdate:value":l[12]||(l[12]=e=>$(S).version=e)},null,8,["value"])])])),_:1},8,["label"]),H(o,{label:e.$t("Site.PHP.add_site_22"),path:"type_id"},{default:k((()=>[H(me,{value:$(S).type_id,"onUpdate:value":l[13]||(l[13]=e=>$(S).type_id=e)},null,8,["value"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),Ne={class:"px-10px"},Ze={class:"mt-8px leading-22px text-default"},Ae={class:"mt-6px"},Ge=P({__name:"index",setup(e,{expose:t}){const{t:i}=x(),d=l(),n=O({domain:"domain|1|0|0|0\ndomain|1|0|0|0\ndomain|1|0|0|0"}),u=C([{key:"name",title:i("Site.TableRow.index_1")},{key:"ftp",title:i("Site.PHP.add_site_10"),render:e=>e.succesInfo?e.succesInfo.ftp_status?H("span",{class:"text-primary"},[i("Site.PHP.index_35")]):"".concat(i("Site.PHP.index_37")):"--"},{key:"database",title:i("Site.PHP.add_site_16"),render:e=>e.succesInfo?e.succesInfo.db_status?H("span",{class:"text-primary"},[i("Site.PHP.index_35")]):"".concat(i("Site.PHP.index_37")):"--"},{key:"result",title:i("Site.DelSite.index_10"),render:e=>"error"===e.status?H("span",{class:"text-error"},[e.errorMsg]):H("span",{class:"text-primary"},[i("Site.PHP.index_35")])}]);return t({onConfirm:async()=>{let e=[];const a=n.domain.trim().split("\n");for(let s=0;s<a.length;s++){const t=a[s].split("|");for(let a=0;a<t.length;a++){const l=s+1,d=t[a].trim();switch(a){case 0:e=d.split(",");for(let a=0;a<e.length;a++){const a=e[0],t=a.split(":");if(!m(t[0]))return void v.error("".concat(i("Site.PHP.index_39")," ").concat(l,", ").concat(i("Site.PHP.index_40")," [").concat(a,"]"));if(void 0!==t[1]&&f(t[1]))return void v.error("".concat(i("Site.PHP.index_39")," ").concat(l,", ").concat(i("Site.PHP.index_41")," [").concat(t[1],"]"))}break;case 1:if("1"!==d&&d.indexOf("/")<-1)return void v.error("".concat(i("Site.PHP.index_39")," ").concat(l,", ").concat(i("Site.PHP.index_42")," [").concat(d,"]"))}}}const{message:t}=await T({websites_content:a});o(t)&&(v.success(t.msg),(e=>{const a=[];Object.entries(e.error).forEach((([e,t])=>{a.push({name:e,status:"error",errorMsg:t.result})})),Object.entries(e.success).forEach((([e,t])=>{a.push({name:e,status:"success",succesInfo:t})})),K({title:i("Site.PHP.index_38"),content:()=>H("div",{class:"w-500px p-20px"},[H(le,{data:a,columns:u.value},null)])})})(t)),d.setRefresh(!0)}}),(e,t)=>{const l=s,i=se,d=a;return g(),y("div",Ne,[H(d,{ref:"formRef"},{default:k((()=>[H(i,{label:""},{default:k((()=>[H(l,{value:$(n).domain,"onUpdate:value":t[0]||(t[0]=e=>$(n).domain=e),rows:10,name:"batch-domain"},null,8,["value"])])),_:1})])),_:1},512),w("div",Ze,[w("p",null,L(e.$t("Site.PHP.add_site_39")),1),w("p",Ae,L(e.$t("Site.PHP.add_site_40")),1),w("p",null,L(e.$t("Site.PHP.add_site_41")),1),w("p",null,L(e.$t("Site.PHP.add_site_42")),1),w("p",null,L(e.$t("Site.PHP.add_site_43")),1),w("p",null,L(e.$t("Site.PHP.add_site_44")),1),t[1]||(t[1]=w("p",{class:"mt-6px"},"Eq, bt.cn,test.cn:8081|/www/wwwroot/bt.cn|1|1|56",-1))])])}}}),We={class:"p-20px h-full"},Xe=c(P({__name:"index",props:{done:{type:Function}},setup(a,{expose:t}){const s=a,{t:l}=x(),i=C("single"),d=C(),n=[{key:"single",label:l("Site.PHP.add_site_1"),isLazy:!0,component:Ke,data:{getList:s.done}},{key:"batch",label:l("Site.PHP.add_site_2"),isLazy:!0,component:Ge}];return t({onConfirm:async()=>{var e;await(null==(e=d.value)?void 0:e.onConfirm())}}),(a,t)=>{const s=e;return g(),y("div",We,[H(s,{ref_key:"tabsRef",ref:d,value:$(i),"onUpdate:value":t[0]||(t[0]=e=>D(i)?i.value=e:null),options:n},null,8,["value"])])}}}),[["__scopeId","data-v-22c72b40"]]);export{Xe as default};
