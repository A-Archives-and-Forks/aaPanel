const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/form8.js?v=1744703330658","js/index.vue_vue_type_script_setup_true_lang.js?v=1744703330658","js/naive.js?v=1744703330658","js/vue.js?v=1744703330658","js/__commonjsHelpers__.js?v=1744703330658","js/common.js?v=1744703330658","js/page_layout.js?v=1744703330658","js/public.js?v=1744703330658","css/public.css?v=1744703330658","css/page_layout.css?v=1744703330658","js/index104.js?v=1744703330658","css/index21.css?v=1744703330658","js/index.vue_vue_type_script_setup_true_lang4.js?v=1744703330658","js/index.vue_vue_type_script_setup_true_lang8.js?v=1744703330658","css/index19.css?v=1744703330658","js/index.vue_vue_type_script_setup_true_lang6.js?v=1744703330658","js/index.js?v=1744703330658","css/index93.css?v=1744703330658","js/xterm.js?v=1744703330658","js/xterm-addon-canvas.js?v=1744703330658","css/xterm-addon-canvas.css?v=1744703330658"])))=>i.map(i=>d[i]);
import{Y as e,d as t,O as a,P as s,w as l,R as n,S as o,a0 as i,c as r,a1 as d,V as u,af as c,r as p,j as m,_ as v,av as _,f,o as h,n as x,$ as g,N as w,ag as b,ao as k,U as y,H as C,F as T,ap as S,k as A,v as O}from"./vue.js?v=1744703330658";import{i as j,aS as E,a as I,cS as L,I as D,k as R,_ as U,f as F}from"./page_layout.js?v=1744703330658";import{_ as M}from"./index104.js?v=1744703330658";import{_ as q}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1744703330658";import{_ as P}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1744703330658";import{u as $,b as z,f as B,a as H,c as K,h as N,d as V,s as Y}from"./public.js?v=1744703330658";import{T as W,_ as X,ch as G,bU as J,ck as Q}from"./naive.js?v=1744703330658";import{_ as Z}from"./index.js?v=1744703330658";import{_ as ee}from"./index.vue_vue_type_script_setup_true_lang.js?v=1744703330658";import{x as te,a as ae,b as se,c as le}from"./xterm.js?v=1744703330658";import{x as ne}from"./xterm-addon-canvas.js?v=1744703330658";const{t:oe}=j.global,ie=e=>E.post("/xterm?action=create_host",e,{requestOptions:{loading:oe("Security.Api.Index_4"),successMessage:!0}}),re=e=>E.post("/xterm?action=get_host_find",e),de=t=>{$({title:t.title,width:600,footer:!0,data:t.data,component:e((()=>I((()=>import("./form8.js?v=1744703330658")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]))))})},ue=t({__name:"index",setup(e,{expose:t}){const{t:p}=a(),m=L(),{keys:v,table:_,columns:f}=z([{key:"host",title:p("Term.index_8"),ellipsis:{tooltip:{width:"trigger"}},render:e=>s("span",{class:"cursor-pointer w-100%",onClick:()=>x(e)},[e.host])},B({width:130,options:e=>[{label:p("Site.TableOP.index_7"),onClick:()=>{const t={title:p("Term.index_22"),data:{isEdit:!0,row:e}};de(t)}},{label:p("Public.Btn.Del"),onClick:()=>{H({title:p("Term.index_6"),content:p("Term.index_7",[e.host]),onConfirm:async({hide:t})=>{var a;await(a={host:e.host},E.post("/xterm?action=remove_host",a,{requestOptions:{loading:oe("Security.Api.Index_3"),successMessage:!0}})),b(),t()}})}}]})]),h=()=>{const e={title:p("Term.index_19"),data:{isEdit:!1}};de(e)},x=e=>{m.server={...e,time:new Date}},{loading:g,setLoading:w}=K(),b=async()=>{try{w(!0);const{message:e}=await E.post("/xterm?action=get_host_list");D(e)&&(_.data=e)}finally{v.value=[],w(!1)}};return b(),l((()=>m.isRefresh),(e=>{e&&(m.setRefresh(!1),b())})),t({init:b}),(e,t)=>{const a=W,l=P,p=q;return n(),o("div",null,[s(p,null,{toolsLeft:i((()=>[s(a,{type:"primary",onClick:h},{default:i((()=>[r(d(e.$t("Term.index_19")),1)])),_:1})])),table:i((()=>[s(l,{"checked-row-keys":u(v),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>c(v)?v.value=e:null),loading:u(g),data:u(_).data,columns:u(f)},null,8,["checked-row-keys","loading","data","columns"])])),_:1})])}}}),ce={class:"p-20px"},pe=t({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:l}=a(),r=e,{isEdit:d,row:c,getList:v}=r.data,_=p(null),f=m({name:"",content:""}),h={name:{required:!0,message:l("Security.Conf.Index_28"),trigger:["blur","input"]},content:{required:!0,message:l("Security.Conf.Index_28"),trigger:["blur","input"]}};return d&&c&&(f.name=c.title,f.content=c.shell),t({onConfirm:async({hide:e})=>{var t,a;await(null==(t=_.value)?void 0:t.validate()),d?await(a={shell:f.content,title:c?c.title:"",new_title:f.name},E.post("/xterm?action=modify_command",a,{requestOptions:{loading:oe("Crontab.Api.index_5"),successMessage:!0}})):await(e=>E.post("/xterm?action=create_command",e,{requestOptions:{loading:oe("Security.Api.Index_4"),successMessage:!0}}))({shell:f.content,title:f.name}),null==v||v(),e()}}),(e,t)=>{const a=X,l=G,r=ee;return n(),o("div",ce,[s(r,{ref_key:"formRef",ref:_,model:u(f),rules:h},{default:i((()=>[s(l,{label:e.$t("Docker.Compose.form.index_3"),path:"name"},{default:i((()=>[s(a,{class:"w-280px!",value:u(f).name,"onUpdate:value":t[0]||(t[0]=e=>u(f).name=e),placeholder:e.$t("Term.idnex_1")},null,8,["value","placeholder"])])),_:1},8,["label"]),s(l,{label:e.$t("Docker.LocalImage.build_5"),path:"content"},{default:i((()=>[s(a,{class:"w-280px!",type:"textarea",rows:6,value:u(f).content,"onUpdate:value":t[1]||(t[1]=e=>u(f).content=e),placeholder:e.$t("Term.index_2")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),me=t({__name:"index",setup(e,{expose:t}){const{t:l}=a(),{keys:p,table:m,columns:v}=z([{key:"title",title:l("Term.index_4"),ellipsis:{tooltip:{width:"trigger"}},render:e=>s("span",{class:"cursor-pointer w-100%",onClick:()=>{_(e.shell)}},[e.title])},B({width:130,options:e=>[{label:l("Public.Btn.Copy"),onClick:()=>{_(e.shell)}},{label:l("Public.Btn.Edit"),onClick:()=>{b(e)}},{label:l("Public.Btn.Del"),onClick:()=>{H({title:l("Term.index_20"),content:l("Term.index_21",[e.title]),onConfirm:async({hide:t})=>{var a;await(a={title:e.title},E.post("/xterm?action=remove_command",a,{requestOptions:{loading:oe("Security.Api.Index_3"),successMessage:!0}})),x(),t()}})}}]})]),_=e=>{N(e)},{loading:f,setLoading:h}=K(),x=async()=>{try{h(!0);const{message:e}=await E.post("/xterm?action=get_command_list");D(e)&&(m.data=e)}finally{p.value=[],h(!1)}},g=V(l("Term.index_3"),{isEdit:!1,getList:x}),w=()=>{g.data.isEdit=!1,g.title=l("Term.index_3"),g.show=!0},b=e=>{g.data.row=e,g.data.isEdit=!0,g.title=l("Term.index_5"),g.show=!0};return x(),t({init:x}),(e,t)=>{const a=W,l=P,_=q,h=Z;return n(),o("div",null,[s(_,null,{toolsLeft:i((()=>[s(a,{type:"primary",onClick:w},{default:i((()=>[r(d(e.$t("Term.index_3")),1)])),_:1})])),table:i((()=>[s(l,{"checked-row-keys":u(p),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>c(p)?p.value=e:null),loading:u(f),data:u(m).data,columns:u(v)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),s(h,{show:u(g).show,"onUpdate:show":t[1]||(t[1]=e=>u(g).show=e),title:u(g).title,data:u(g).data,width:480,footer:!0,component:pe},null,8,["show","title","data"])])}}}),ve=t({__name:"index",setup(e){const{t:t}=a(),l=p("server"),i=[{key:"server",label:t("Term.index_23"),component:ue},{key:"command",label:t("Term.index_24"),component:me}];return(e,t)=>{const a=M;return n(),o("div",null,[s(a,{class:"w-300px!",value:u(l),"onUpdate:value":t[0]||(t[0]=e=>c(l)?l.value=e:null),options:i},null,8,["value"])])}}}),_e=R(t({__name:"terminal",props:{data:{}},emits:["updateState"],setup(e,{emit:t}){const{t:s}=a(),i=e,{data:r}=i,d=t,u=L(),{isFull:c}=v(u),{ws:m,status:g,send:w,open:b,close:k}=Y("/webssh",{verifyData:{host:r.host,port:r.port,id:r.id,ps:r.ps,sort:0},onMessage:(e,t)=>{const a=t.data;return a.indexOf("Authentication timeout.")>-1&&(T.value=!0),-1==a.indexOf("@127.0.0.1:")&&-1==a.indexOf("@localhost:")||-1==a.indexOf("Authentication failed")?"\\r\\nlogout\\r\\n"==a||"logout\\r\\n"==a||"\r\nlogout\r\n"==a||"logout\r\n"==a||a.search(/logout[\r\n]+$/)>-1?(d("updateState",r.id,!1),y.write("\r"+s("Component.Terminal.index_1")+"\r"),E(),void k()):void 0:(d("updateState",r.id,!1),k(),void E())}});let y,C;const T=p(!1),S=p(null),A=()=>{const e=m.value;e&&(y.loadAddon(C),y.loadAddon(new ne.CanvasAddon),y.loadAddon(new se.WebLinksAddon),y.loadAddon(new le.AttachAddon(e)),setTimeout((()=>{C.fit();const e=S.value;e&&(I.value="".concat(e.clientHeight,"px"))}),100))},O=()=>{S.value&&y.open(S.value)};let j=!1;const E=()=>{j=!1},I=p(""),D=()=>{y.focus(),y.onData((e=>{const t=m.value;"\r"===e&&T.value&&(T.value=!1,y.write("\r\n"),R()),void 0!==t||"\r"!==e||j||(j=!0,y.write("\r\n"+s("Component.Terminal.index_2")+"\r\n"),R())}))},R=()=>{b(),D();const e=m.value;e&&(y.loadAddon(new le.AttachAddon(e)),d("updateState",r.id,!0))},U=()=>{x((()=>{if(C.fit(),"CLOSED"!==g.value){d("updateState",r.id,!0);const{cols:e,rows:t}=y;w({cols:e,rows:t,resize:1})}}))};l((()=>c.value),(e=>{const t=S.value;t&&!e&&(t.style.height=I.value)}));let F=!0;const M=new ResizeObserver((()=>{_((()=>{F?F=!1:U()}),200)()}));return f((()=>{y=new te.Terminal({cursorBlink:!0,fontSize:14,fontFamily:"Monaco, Menlo, Consolas, 'Courier New', monospace",theme:{background:"#333",foreground:"#ececec"}}),C=new ae.FitAddon,A(),O(),D(),U(),(()=>{const e=S.value;e&&M.observe(e)})()})),h((()=>{null==M||M.disconnect()})),(e,t)=>(n(),o("div",{ref_key:"terminalRef",ref:S,class:"w-full box"},null,512))}}),[["__scopeId","data-v-b79b3036"]]),fe=["onClick","onContextmenu"],he=["title"],xe=["onClick"],ge={class:"terminal bg-#333333"},we=R(t({__name:"index",setup(e){const{t:t}=a(),c=L(),{isFull:m,server:_,isShow:f}=v(c),h=p([{id:"aaaaaaaaa",host:"127.0.0.1",port:22,ps:t("Database.form.index_12"),state:!0}]),x=["Copy session","Close session","Close to right","Close other"],j=p("aaaaaaaaa"),E=()=>{const e={title:t("Term.index_19"),data:{isEdit:!1}};de(e)},I=e=>{const t=F(9,"letter");h.value.push({id:t,host:e.host,port:e.port,ps:e.ps,state:!0}),setTimeout((()=>{D(t)}),20)},D=e=>{j.value=e},R=(e,t)=>{h.value=h.value.map((a=>a.id===e?{...a,state:t}:a))},M=e=>{h.value=h.value.filter((t=>t.id!==e)),j.value=h.value.length>0?h.value[h.value.length-1].id:"aaaaaaaaa"},q=p(!1),P=p(0),$=p(0),z=p({id:"",host:"",port:0,ps:"",state:!1});return document.addEventListener("click",(()=>{q.value=!1})),l((()=>_.value),(e=>{null!==e&&I(e)}),{deep:!0}),(e,t)=>{const a=U,l=J;return n(),g(l,{vertical:"",class:"gap-0!"},{default:i((()=>[s(l,{class:"head gap-0!"},{default:i((()=>[(n(!0),o(T,null,w(u(h),(e=>(n(),o("div",{key:e.id,class:b(["item",{"item-active":u(j)===e.id}]),onClick:t=>D(e.id),onContextmenu:k((t=>{return a=t,s=e,z.value=s,P.value=a.clientX,$.value=a.clientY,void(q.value=!0);var a,s}),["prevent"])},[y("div",{class:"text",title:e.ps},[y("span",{class:b(["icon",{"icon-active":!e.state}])},null,2),r(d(e.ps?e.ps:e.host),1)],8,he),s(a,{name:"base-close",class:"close-terminal",size:16,onClick:k((t=>M(e.id)),["stop"])},null,8,["onClick"]),u(q)?(n(),o("div",{key:0,class:"context-menu",style:C({top:u($)-20+"px",left:u(P)-180+"px"})},[y("ul",null,[(n(),o(T,null,w(x,((e,t)=>y("li",{key:t,onClick:t=>(e=>{if(!z.value)return;let t;switch(e){case"Copy session":I(z.value);break;case"Close session":M(z.value.id);break;case"Close to right":t=h.value.findIndex((e=>e.id===z.value.id)),-1!==t&&(h.value.splice(t+1),setTimeout((()=>{var e;D((null==(e=h.value[t])?void 0:e.id)||"aaaaaaaaa")}),20));break;case"Close other":h.value=h.value.filter((e=>e.id===z.value.id)),setTimeout((()=>{D(z.value.id)}),20)}q.value=!1})(e)},d(e),9,xe))),64))])],4)):S("",!0)],42,fe)))),128)),y("div",{class:"add-terminal",onClick:E},[s(a,{name:"base-add",size:24})]),y("div",{class:"absolute right-0px add-terminal",onClick:t[0]||(t[0]=e=>m.value=!u(m))},[s(a,{name:"base-full",size:24})])])),_:1}),y("div",ge,[(n(!0),o(T,null,w(u(h),(e=>A((n(),g(_e,{key:e.id,data:e,onUpdateFull:D,onUpdateState:R},null,8,["data"])),[[O,e.id===u(j)]]))),128)),y("div",{class:b(["terminal-contract-tool",{active:!u(f)}]),onClick:t[1]||(t[1]=e=>f.value=!u(f))},null,2)])])),_:1})}}}),[["__scopeId","data-v-b0b3524c"]]),be={class:"p-16px box"},ke=R(t({__name:"index",setup(e){const t=L(),{isShow:a,isFull:r}=v(t),d=p(null);l((()=>r.value),(e=>{var t;e?(a.value=!1,null==(t=d.value)||t.requestFullscreen()):document.exitFullscreen().catch((e=>{console.log(e.message)}))}));const c=()=>{document.fullscreenElement?r.value=!0:r.value=!1};return f((()=>{document.addEventListener("fullscreenchange",c)})),h((()=>{document.removeEventListener("fullscreenchange",c)})),(e,t)=>{const l=J,r=Q;return n(),o("div",be,[s(r,{class:"p-16px h-100%"},{default:i((()=>[y("div",{class:"bg-#ffffff h-100%",ref_key:"contentRef",ref:d},[s(l,{class:"flex-nowrap! h-100%"},{default:i((()=>[s(we,{class:"flex-1 overflow-hidden"}),A(s(ve,null,null,512),[[O,u(a)]])])),_:1})],512)])),_:1})])}}}),[["__scopeId","data-v-932584a7"]]),ye=Object.freeze(Object.defineProperty({__proto__:null,default:ke},Symbol.toStringTag,{value:"Module"}));export{ie as a,re as g,ye as i};
