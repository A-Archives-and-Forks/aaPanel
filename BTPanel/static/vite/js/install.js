import{_ as e}from"./index.vue_vue_type_script_setup_true_lang.js?v=1744703330658";import{m as a,d as i}from"./page_layout.js?v=1744703330658";import{c as s}from"./public.js?v=1744703330658";import{b as n}from"./site.js?v=1744703330658";import{i as o}from"./index48.js?v=1744703330658";import{d as t,O as l,r,j as p,ai as u,R as m,S as d,P as _,a0 as v,U as c,V as f,$ as g,c as h,a1 as j,ap as x,F as b}from"./vue.js?v=1744703330658";import{_ as y,cr as w,y as M,ch as S,cn as P}from"./naive.js?v=1744703330658";import"./common.js?v=1744703330658";import"./__commonjsHelpers__.js?v=1744703330658";import"./index.js?v=1744703330658";import"./index.vue_vue_type_script_setup_true_lang4.js?v=1744703330658";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1744703330658";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1744703330658";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1744703330658";import"./mail.js?v=1744703330658";const k={class:"p-20px pt-24px pb-8px"},W={class:"w-240px"},U={class:"w-240px"},$=t({__name:"install",props:{domain:{type:Object}},emits:["refresh"],setup(t,{expose:$,emit:C}){const E=C,{t:H}=l(),I=r(null),O=p({domain:"",php_version:null}),R={domain:{trigger:"change",validator:()=>""!==O.domain.trim()||new Error(H("Mail.Setting.index_20"))},php_version:{trigger:"change",validator:()=>null!==O.php_version||new Error(H("Mail.Setting.index_21"))}},F=r([]),L=async()=>{const{message:e}=await n();if(i(e)){F.value=e.versions.reverse().map((e=>({label:e.name,value:e.version})));const a=e.versions.findIndex((e=>"74"===e.version));O.php_version=-1!==a?e.versions[a].version:e.versions[0].version}},{loading:V,setLoading:q}=s(),z=u();return(async()=>{try{q(!0),await Promise.all([L()])}finally{q(!1)}})(),$({onConfirm:async()=>{var e,i,s;await(null==(e=I.value)?void 0:e.validate()),await o({webmail_domain:"".concat(O.domain,".").concat((null==(i=t.domain)?void 0:i.domain)||""),php_version:O.php_version||"",domain:(null==(s=t.domain)?void 0:s.domain)||""});const{close:n}=a.success({content:()=>_(b,null,[h("WebMail Installation Successful, "),_("br",null,null),h(' Manage WebMail view in "'),_("a",{class:"bt-link",href:"javascript:;",onClick:()=>{z.push("/site/php"),n()}},[h("Website > PHP Project")]),h('"')]),close:!0,maxWidth:480});E("refresh")}}),(a,i)=>{const s=y,n=w,o=M,l=S,r=P,p=e;return m(),d("div",k,[_(p,{ref_key:"formRef",ref:I,model:f(O),rules:R},{default:v((()=>[_(l,{label:a.$t("Mail.Setting.index_18"),path:"domain"},{default:v((()=>[c("div",W,[_(o,null,{default:v((()=>{var e;return[_(s,{value:f(O).domain,"onUpdate:value":i[0]||(i[0]=e=>f(O).domain=e)},null,8,["value"]),(null==(e=t.domain)?void 0:e.domain)?(m(),g(n,{key:0},{default:v((()=>{var e;return[h(" ."+j(null==(e=t.domain)?void 0:e.domain),1)]})),_:1})):x("",!0)]})),_:1})])])),_:1},8,["label"]),_(l,{label:a.$t("Mail.Setting.index_19"),path:"php_version"},{default:v((()=>[c("div",U,[_(r,{value:f(O).php_version,"onUpdate:value":i[1]||(i[1]=e=>f(O).php_version=e),loading:f(V),options:f(F)},null,8,["value","loading","options"])])])),_:1},8,["label"])])),_:1},8,["model"])])}}});export{$ as default};
