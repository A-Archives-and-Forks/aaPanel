import{_ as a}from"./index245.js?v=1758789124250";import{i as e,p as s,k as n,P as t,r as i,R as r,V as o,S as l,W as p,a4 as d,U as c,a2 as m,F as u,a3 as v,j as _,e as g,ak as b}from"./vue.js?v=1758789124250";import{_ as x,a as f,b as h,d as y}from"./public.js?v=1758789124250";import{_ as w}from"./index168.js?v=1758789124250";import{t as D,i as M,L as P,u as k,q as j,d as C,m as A,f6 as $,w as q,p as S,c as U}from"./page_layout.js?v=1758789124250";import{aC as z,dV as B,da as O,d5 as F,dR as I,df as L}from"./naive.js?v=1758789124250";import{a as R}from"./soft.js?v=1758789124250";import{g as H}from"./site.js?v=1758789124250";import{_ as N}from"./index.vue_vue_type_script_setup_true_lang.js?v=1758789124250";import"./__commonjsHelpers__.js?v=1758789124250";import"./common.js?v=1758789124250";const T=Symbol("php-admin");const{t:V}=M.global,E=()=>D.post("/adminer_manager?action=get_status"),W=a=>D.post("/adminer_manager?action=install",a,{requestOptions:{loading:V("Database.adminerManager.installing"),successMessage:!0}});async function G(a,e,s,n=""){const t=document.createElement("form");t.action="".concat(P(),"/adminer/index.php?driver=&username=root"),t.method="post",t.target="_blank",t.style.display="none";const i='\n\t\t<input type="text" name="auth[driver]" id="driver" value="'.concat(a,'" size="24" />\n\t\t<input type="text" name="auth[username]" id="username" value="').concat(e,'" size="24" />\n\t\t<input type="password" name="auth[password]" id="password" value="').concat(s,'" size="24" />\n\t\t<input type="text" name="auth[db]" id="db" value="').concat(n,'" size="24" />\n\t\t<input type="text" name="auth[server]" id="server" value="" size="24" />\n\t');t.innerHTML=i,document.body.appendChild(t),t.submit(),document.body.removeChild(t)}const J={class:"p-4px"},K={class:"flex items-center h-40px mb-10px text-14px whitespace-pre-wrap"},Q={class:"flex gap-10px"},X={class:"mt-20px"},Y={class:"flex gap-24px mt-20px"},Z=S(n({__name:"index",setup(a,{expose:s}){const{t:n}=t(),{type:g,db:b,username:y,password:M}=e(T),S=k(),U=i(!1),B=i(""),O=async()=>{f({title:n("Database.adminerManager.service.fixed"),content:n("Database.adminerManager.service.confirmFixed"),onConfirm:async()=>{await W({version:B.value}),N()}})},F=()=>{f({title:n("Database.adminerManager.service.uninstall"),content:n("Database.adminerManager.service.confirmUninstall"),onConfirm:async()=>{await D.post("/adminer_manager?action=uninstall",{},{requestOptions:{loading:V("Database.adminerManager.uninstalling"),successMessage:!0}}),N()}})},I=()=>{f({title:n("Database.adminerManager.service.install"),content:n("Database.adminerManager.service.confirmInstall"),onConfirm:async()=>{const{message:a}=await D.post("/adminer_manager?action=support_versions");q(a)&&await W({version:a[0]}),N()}})},L=new Map([["pgsql","postgres"],["mongo","mongo"]]),R=async()=>{if(S.isFree)return void h({source:160});if(y&&M&&b)return void G(g,y,M,b);const a=A.loading(n("Database.adminerManager.service.jumpingToAdminer"));try{if("mongo"===g)return void(await H());const{message:a}=await $(g);C(a)&&G(g,L.get(g)||"",a.result)}finally{a.close()}},H=async()=>{const{message:a}=await $("mongodb");C(a)&&G(g,L.get(g)||"",a.root)},N=async()=>{const{message:a}=await E();C(a)&&(U.value=1===a.install,B.value=a.version)};return N(),s({init:N}),(a,e)=>{const s=w,n=z,t=j,i=x;return o(),r("div",J,[l("div",K,[l("span",null,d(a.$t("Database.adminerManager.service.currentStatus")),1),p(s,{value:c(U)},null,8,["value"])]),l("div",Q,[c(U)?(o(),r(u,{key:0},[p(n,{onClick:O},{default:v(()=>[_(d(a.$t("Database.adminerManager.service.fixed")),1)]),_:1}),p(n,{onClick:F},{default:v(()=>[_(d(a.$t("Public.Btn.Uninstall")),1)]),_:1})],64)):(o(),m(n,{key:1,onClick:I},{default:v(()=>[_(d(a.$t("Public.Btn.Install")),1)]),_:1}))]),l("div",X,[p(t,{dashed:""})]),l("div",Y,[p(n,{class:"access-btn",onClick:R},{default:v(()=>[l("span",null,d(a.$t("Database.PhpAdmin.index_11")),1),e[1]||(e[1]=l("span",{class:"bg-recommend"},null,-1))]),_:1,__:[1]}),p(n,{class:"access-btn",onClick:e[0]||(e[0]=a=>(async()=>{window.open("".concat(P(),"/adminer/index.php?driver=").concat(g))})())},{default:v(()=>[_(d(a.$t("Database.PhpAdmin.index_6")),1)]),_:1})]),p(i,{class:"mt-16px"},{default:v(()=>[l("li",null,d(a.$t("Database.PhpAdmin.index_7")),1),l("li",null,d(a.$t("Database.PhpAdmin.index_33")),1)]),_:1})])}}}),[["__scopeId","data-v-05019cf2"]]),aa={class:"p-8px"},ea={class:"w-160px"},sa=n({__name:"index",setup(a,{expose:e}){const{t:s}=t(),n=g({php_version:null}),m=i([]),{loading:u,setLoading:b}=y(),x=async()=>{try{b(!0);const[a,e]=await Promise.all([H(),E()]),{message:s}=a;q(s)&&(m.value=s.filter(a=>"00"!==a.version).map(a=>({label:a.name,value:a.version})));const{message:t}=e;n.php_version=F(t,"php_version",null)}finally{b(!1)}},f=async()=>{const a=n.php_version;var e;null!==a?(await(e={php_version:a},D.post("/adminer_manager?action=switch_php",e,{requestOptions:{loading:V("Database.adminerManager.switchingPhp"),successMessage:!0}})),x()):A.error(s("Database.PhpAdmin.index_32"))},h=async()=>{const{message:a}=await U({sName:"php-".concat(Number(n.php_version)/10)});C(a)&&R(a)};return x(),e({init:x}),(a,e)=>{const s=B,t=z,i=O;return o(),r("div",aa,[p(i,{class:"items-center"},{default:v(()=>[l("span",null,d(a.$t("Database.PhpAdmin.index_31")),1),l("div",ea,[p(s,{value:c(n).php_version,"onUpdate:value":e[0]||(e[0]=a=>c(n).php_version=a),loading:c(u),options:c(m)},null,8,["value","loading","options"])]),p(t,{disabled:null===c(n).php_version,type:"primary",onClick:f},{default:v(()=>[_(d(a.$t("Public.Btn.Save")),1)]),_:1},8,["disabled"]),p(t,{disabled:null===c(n).php_version,onClick:h},{default:v(()=>e[1]||(e[1]=[_(" Settings ",-1)])),_:1,__:[1]},8,["disabled"])]),_:1})])}}}),na={class:"p-4px"},ta={class:"w-142px mr-8px"},ia=n({__name:"index",setup(a,{expose:e}){const{t:s}=t(),n=i(null),m=async()=>{const a=n.value;var e;null!==a?(await(e={port:a},D.post("/adminer_manager?action=switch_port",e,{requestOptions:{loading:V("Database.adminerManager.switchingPort"),successMessage:!0}})),g()):A.error(s("Database.PhpAdmin.index_25"))},u=i(!1),g=async()=>{const{message:a}=await E();n.value=F(a,"port",null)},x=()=>{g()};return x(),e({init:x}),(a,e)=>{const s=L,t=z,i=I,g=N;return o(),r("div",na,[p(g,{"label-width":"160"},{default:v(()=>[p(i,{label:a.$t("Database.PhpAdmin.index_16"),"label-width":"auto"},{default:v(()=>[l("div",ta,[p(s,{value:c(n),"onUpdate:value":e[0]||(e[0]=a=>b(n)?n.value=a:null),min:0,max:66325,"show-button":!1,loading:c(u),placeholder:""},null,8,["value","loading"])]),p(t,{type:"primary",onClick:m},{default:v(()=>[_(d(a.$t("Public.Btn.Save")),1)]),_:1})]),_:1},8,["label"])]),_:1})])}}}),ra={class:"h-580px"},oa=n({__name:"index",props:{type:{},username:{},password:{},db:{}},setup(e){const n=e,{t:l}=t(),d=i("service"),m=[{key:"service",label:l("Database.PhpAdmin.index_1"),component:Z},{key:"php",label:l("Database.PhpAdmin.index_2"),component:sa},{key:"safe",label:l("Database.PhpAdmin.index_3"),component:ia}];var u;return u={type:n.type,username:n.username,password:n.password,db:n.db},s(T,u),(e,s)=>{const n=a;return o(),r("div",ra,[p(n,{value:c(d),"onUpdate:value":s[0]||(s[0]=a=>b(d)?d.value=a:null),ref:"tabsRef",data:m},null,8,["value"])])}}});export{oa as default};
