const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/expired.js?v=1753954525509","js/index.vue_vue_type_script_setup_true_lang.js?v=1753954525509","js/naive.js?v=1753954525509","js/vue.js?v=1753954525509","js/__commonjsHelpers__.js?v=1753954525509","js/common.js?v=1753954525509","js/public.js?v=1753954525509","js/page_layout.js?v=1753954525509","css/page_layout.css?v=1753954525509","css/public.css?v=1753954525509","js/site.js?v=1753954525509","js/index225.js?v=1753954525509","js/index.vue_vue_type_script_setup_true_lang13.js?v=1753954525509","js/php2.js?v=1753954525509","js/category.js?v=1753954525509"])))=>i.map(i=>d[i]);
import{j as e,aZ as t,s as a,e as l,q as n,p as i,T as s,u as o,c as r,w as u,X as c,m as d,a as p,o as m}from"./page_layout.js?v=1753954525509";import{_ as f}from"./index127.js?v=1753954525509";import{_}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1753954525509";import{_ as v}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1753954525509";import{_ as y}from"./index.vue_vue_type_script_setup_true_lang11.js?v=1753954525509";import{bU as h,_ as g,ay as x,c4 as k,b$ as w,c0 as b,bX as S,aV as P,c3 as C,c5 as j,c7 as H,aq as B,bY as U,c2 as T,cA as V,cG as W,cD as D}from"./naive.js?v=1753954525509";import{k as N,i as L,r as M,o as R,w as A,U as O,a1 as $,a2 as K,Q as F,W as I,X as E,F as q,V as z,a3 as Q,l as X,v as G,H as Y,c as Z,j as J,aj as ee,P as te,av as ae,ah as le,$ as ne,x as ie,s as se,e as oe,N as re,af as ue,_ as ce,p as de,al as pe}from"./vue.js?v=1753954525509";import{_ as me}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1753954525509";import{_ as fe}from"./index125.js?v=1753954525509";import{a9 as _e,v as ve,G as ye,aa as he,f as ge,e as xe,b as ke,h as we,d as be,c as Se,ab as Pe,u as Ce,m as je}from"./public.js?v=1753954525509";import{s as He,c as Be,d as Ue,e as Te,f as Ve,h as We,i as De,j as Ne,k as Le}from"./site.js?v=1753954525509";import{u as Me}from"./index225.js?v=1753954525509";import{u as Re,_ as Ae}from"./Ssl.vue_vue_type_script_setup_true_lang.js?v=1753954525509";import{u as Oe}from"./soft2.js?v=1753954525509";import{a as $e,b as Ke,c as Fe}from"./php.js?v=1753954525509";import{u as Ie}from"./useOperate.js?v=1753954525509";import{a5 as Ee,a6 as qe,a7 as ze,m as Qe,h as Xe}from"./common.js?v=1753954525509";import{_ as Ge}from"./index.vue_vue_type_script_setup_true_lang15.js?v=1753954525509";import{_ as Ye}from"./index.js?v=1753954525509";import{_ as Ze}from"./index.vue_vue_type_script_setup_true_lang.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1753954525509";import"./__commonjsHelpers__.js?v=1753954525509";import"./soft.js?v=1753954525509";import"./useModal2.js?v=1753954525509";const Je=N({__name:"index",props:{disabledKeys:{type:Array,default:()=>[]},hideKeys:{type:Array,default:()=>[]},storeKey:{type:String,default:""},loading:{type:Boolean,default:!1}},setup(l){const n=L("tableRef"),i=M(!1),s=M([]),o=M([]),r=M([]),u=()=>{i.value=!0},c=()=>{i.value=!1},d=()=>{if(!n)return;const e=h(o.value.filter((e=>s.value.includes(String(e.key))))),a=e.length;if(a>0){const l=Math.floor(100/a),n=100-l*a;e.forEach(((e,a)=>{if(t(e.width)||!e.width)return;let i=l;a<n&&(i+=1),e.width="".concat(i,"%")}))}"selection"===o.value[0].type&&e.unshift(o.value[0]),n.value.setColumns(e)},p=e=>{if(s.value.includes(e)?s.value=s.value.filter((t=>t!==e)):s.value.push(e),l.storeKey&&a(l.storeKey,s.value.join(",")),l.loading){const e=A((()=>l.loading),(t=>{t||d(),e()}))}else d()};return R((()=>{if(n){const t=n.value.getColumns();0===o.value.length&&(o.value=h(t)),(()=>{if(l.storeKey){const t=e(l.storeKey);t&&(s.value=t.split(","))}})(),(()=>{const e=o.value.filter((e=>"selection"!==e.type));0===s.value.length&&(s.value=e.filter((e=>!l.hideKeys.includes(String(e.key)))).map((e=>String(e.key)))),r.value=e.map((e=>({key:String(e.key),disabled:"operate"===e.key||l.disabledKeys.includes(String(e.key)),label:()=>F(q,null,[F(g,{checked:s.value.includes(String(e.key))},null),F("span",{class:"ml-8px"},[String(e.title)])])})))})();const a=A((()=>l.loading),(e=>{e||d(),a()}))}})),(e,t)=>{const a=x,l=k;return O(),$(l,{placement:"bottom-end",show:E(i),"show-arrow":!0,"arrow-point-to-center":!0,options:E(r),onSelect:p,onClickoutside:c},{default:K((()=>[F(a,{onClick:u},{default:K((()=>t[0]||(t[0]=[I("i",{class:"i-famicons:settings-outline text-16px"},null,-1)]))),_:1,__:[0]})])),_:1},8,["show","options"])}}}),et={class:"website-name"},tt={key:0,class:"flex-center w-24px h-24px bg-#F1F9F3 rounded-50%"},at={key:1,class:"flex-center w-24px h-24px rounded-50%"},lt=["src"],nt={class:"flex flex-col flex-1 w-0 overflow-hidden"},it={class:"flex items-center gap-8px"},st={class:"min-w-0"},ot={class:"website-description"},rt=l(N({__name:"Name",props:{ico:{type:String,default:""},name:{type:String,default:"--"},description:{type:String,default:"--"}},emits:["clickName","blur"],setup(e,{emit:t}){const a=t,l=()=>{a("clickName")},n=()=>{window.open("http://".concat(e.name))},i=e=>{a("blur",e)};return(t,a)=>{const s=w,o=x,r=_e;return O(),z("div",et,[I("div",{class:"website-icon",onClick:l},[e.ico?(O(),z("div",at,[I("img",{src:e.ico,class:"w-full h-full"},null,8,lt)])):(O(),z("div",tt,a[0]||(a[0]=[I("i",{class:"i-mdi:earth text-primary text-18px"},null,-1)])))]),I("div",nt,[I("div",it,[I("div",st,[F(s,{class:"max-w-full",tooltip:{contentStyle:{maxWidth:"200px"}}},{default:K((()=>[I("span",{class:"text-primary cursor-pointer",onClick:l},Q(e.name),1)])),_:1})]),F(o,{type:"primary",text:"",onClick:n},{default:K((()=>a[1]||(a[1]=[I("i",{class:"i-fa-solid:external-link-alt"},null,-1)]))),_:1,__:[1]})]),I("div",ot,[F(r,{value:e.description,onBlur:i},null,8,["value"])])])])}}}),[["__scopeId","data-v-254d1ae1"]]),ut={class:"i-famicons:play-circle-outline"},ct={class:"i-famicons:pause-circle-outline"},dt=l(N({__name:"Status",props:{status:{type:String,default:"0"},checkedValue:{type:String,default:"1"},unCheckedValue:{type:String,default:"0"},onUpdateValue:{type:Function}},setup(e){const t=()=>{var t;null==(t=e.onUpdateValue)||t.call(e,e.status===e.checkedValue?e.unCheckedValue:e.checkedValue)};return(a,l)=>(O(),z("div",{class:Y(["website-status",e.status===e.checkedValue?"text-primary":"text-warning"]),onClick:t},[X(I("i",ut,null,512),[[G,e.status===e.checkedValue]]),X(I("i",ct,null,512),[[G,e.status===e.unCheckedValue]])],2))}}),[["__scopeId","data-v-40a31c54"]]),pt=N({__name:"Backup",props:{count:{type:Number,default:0},lastTime:{type:String,default:""}},emits:["showBackup"],setup(e,{emit:t}){const a=t,l=()=>{a("showBackup")},n=t=>Ee(new Date,e.lastTime||new Date)>=t,i=Z((()=>{if(0===e.count)return"Backup now";const t=Ee(new Date,e.lastTime||new Date);return 0===t?"Today":1===t?"Yesterday":"".concat(t," days ago")})),s=Z((()=>n(30)||e.count<=0?"error":n(7)?"warning":"primary"));return(t,a)=>{const n=b,o=S;return O(),z("div",{class:"flex items-center gap-8px cursor-pointer",onClick:l},[F(n,{type:E(s),size:"small",bordered:!1},{default:K((()=>[J(Q(e.count),1)])),_:1},8,["type"]),F(o,{disabled:0===e.count},{trigger:K((()=>[I("div",{class:Y({"text-error":"error"===E(s),"text-warning":"warning"===E(s)})},Q(E(i)),3)])),default:K((()=>[J(" "+Q(e.lastTime),1)])),_:1},8,["disabled"])])}}}),mt={class:"inline-flex items-center w-full"},ft={class:"flex-1 text-right"},_t={class:"flex-1 text-left"},vt=N({__name:"Quick",props:{path:{type:String,default:""},phpVersion:{type:String,default:""}},emits:["showPhp"],setup(e,{emit:t}){const a=t,l=ee(),s=()=>{n("Path",e.path),l.push("/files")},o=()=>{a("showPhp")};return(t,a)=>{const l=x,n=S,r=i;return O(),z("div",mt,[I("div",ft,[F(n,{trigger:"hover"},{trigger:K((()=>[F(l,{text:"",onClick:s},{default:K((()=>a[0]||(a[0]=[I("i",{class:"i-fa:folder-open-o text-13px"},null,-1)]))),_:1,__:[0]})])),default:K((()=>[J(" "+Q(e.path),1)])),_:1})]),F(r,{vertical:""}),I("div",_t,[F(l,{text:"",onClick:o},{default:K((()=>[J(Q(e.phpVersion),1)])),_:1})])])}}}),yt={class:"flex justify-end"},ht=l(N({__name:"ExpiredDate",props:{value:{type:String,default:"0000-00-00"},onUpdateValue:{type:Function}},setup(e){const{t:t}=te(),a=ae("popoverRef"),l=M(null),n=Z((()=>{const t=new Date(e.value);return"0000-00-00"!==e.value&&qe(t,ze())})),i=Z((()=>"0000-00-00"===e.value?t("Site.PHP.index_34"):n.value?t("Site.PHP.index_28"):e.value)),o=e=>qe(e,Qe(ze(),1)),r=Z((()=>{const t=new Date(e.value);return"0000-00-00"!==e.value&&qe(t,Qe(ze(),7))})),u=async()=>{var t,l;await(null==(t=e.onUpdateValue)?void 0:t.call(e,"0000-00-00")),null==(l=a.value)||l.setShow(!1)},c=async()=>{var t,n;if(null===l.value)return;const i=Xe(l.value,"yyyy-MM-dd");await(null==(t=e.onUpdateValue)?void 0:t.call(e,i)),null==(n=a.value)||n.setShow(!1)},d=()=>{l.value="0000-00-00"===e.value?null:new Date(e.value).getTime()};return(e,t)=>{const p=x,m=P,f=s,_=C;return O(),$(_,{ref_key:"popoverRef",ref:a,placement:"bottom",trigger:"click"},{trigger:K((()=>[F(p,{type:E(n)?"error":E(r)?"warning":"default",text:!0,onClick:d},{default:K((()=>[J(Q(E(i)),1)])),_:1},8,["type"])])),default:K((()=>[F(f,{value:E(l),"onUpdate:value":t[0]||(t[0]=e=>le(l)?l.value=e:null),type:"date",panel:!0,actions:null,"is-date-disabled":o},{footer:K((()=>[I("div",yt,[F(m,{size:"small"},{default:K((()=>[F(p,{onClick:u},{default:K((()=>[J(Q(e.$t("Site.PHP.index_34")),1)])),_:1}),F(p,{disabled:null===E(l),onClick:c},{default:K((()=>[J(Q(e.$t("Public.Btn.Confirm")),1)])),_:1},8,["disabled"])])),_:1})])])),_:1},8,["value"])])),_:1},512)}}}),[["__scopeId","data-v-24ef9d79"]]),gt={class:"text-left"},xt={class:"cursor-pointer"},kt=N({__name:"Requests",props:{name:{type:String,default:""},total:{type:[Number,String],default:0},value:{type:Array,default:()=>[]}},setup(e){const{openMonitor:t}=Ie(),a=Z((()=>e.total.toLocaleString("en-US"))),l=Z((()=>({xAxis:{type:"category",data:e.value.map((e=>e.date))},yAxis:{type:"value",show:!1},series:[{name:"页面浏览量",data:e.value.map((e=>e.value)),type:"line",lineStyle:{color:"#20a53a",width:2},areaStyle:{color:"rgba(32, 165, 58, 0.1)"},symbol:"none"}],grid:{left:0,right:0,top:0,bottom:0}})));return(n,i)=>(O(),z("div",{class:"flex flex-col gap-3px cursor-pointer",onClick:i[0]||(i[0]=a=>E(t)(e.name))},[I("div",gt,Q(E(a)),1),I("div",xt,[F(Ge,{type:"line",option:E(l),height:"15px"},null,8,["option"])])]))}}),wt={class:"flex w-full items-center"},bt={class:"flex-1 flex items-center justify-end"},St={class:"flex-1 flex justify-start"},Pt=N({__name:"Waf",props:{siteName:{type:String,default:""},total:{type:Number,default:0},status:{type:Boolean,default:!1},onUpdateStatus:{type:Function}},setup(e){const{openSiteWaf:t}=Ie();return(a,l)=>{const n=x,s=i,o=j;return O(),z("div",wt,[I("div",bt,[F(n,{text:"",onClick:l[0]||(l[0]=a=>E(t)(e.siteName))},{default:K((()=>[J(Q(e.total),1)])),_:1})]),F(s,{vertical:""}),I("div",St,[F(o,{value:e.status,size:"small","onUpdate:value":e.onUpdateStatus},null,8,["value","onUpdate:value"])])])}}}),Ct={class:"inline-flex items-center"},jt=N({__name:"OperateMenu",emits:["clickConfig","clickLog","clickOperate"],setup(e,{emit:t}){const a=t,l=[{key:"scan",label:"Security Scan",icon:()=>F("i",{class:"i-ant-design:security-scan-outlined text-18px"},null)},{key:"delete",label:"Delete WebSite",icon:()=>F("i",{class:"i-weui:delete-outlined text-18px"},null)}],n=e=>{a("clickOperate",e)};return(e,t)=>{const s=x,o=i,r=k;return O(),z("div",Ct,[F(s,{type:"primary",text:"",onClick:t[0]||(t[0]=e=>a("clickConfig"))},{default:K((()=>t[2]||(t[2]=[J("Conf")]))),_:1,__:[2]}),F(o,{vertical:""}),F(s,{class:"mr-8px",type:"primary",text:"",onClick:t[1]||(t[1]=e=>a("clickLog"))},{default:K((()=>t[3]||(t[3]=[J("Log")]))),_:1,__:[3]}),F(r,{trigger:"click",options:l,onSelect:n},{default:K((()=>t[4]||(t[4]=[I("i",{class:"i-famicons:ellipsis-vertical text-18px cursor-pointer"},null,-1)]))),_:1,__:[4]})])}}}),Ht=N({__name:"index",emits:["fetchTable","update:sorter"],setup(t,{expose:a,emit:l}){const n=l,i=Me(),s=o(),{isFree:d}=ne(s),{webserver:p,monitor:m,waf:f,isMonitorInstall:_,isWafInstall:v}=ne(i),{t:y}=te(),{openBackupModal:h,openSiteConfig:g,openDeleteSiteConfig:k}=Re(),{setSiteStatus:w}=Ie(),b=M([{type:"selection",width:40,minWidth:40,maxWidth:40},{key:"name",title:y("Site.PHP.index_17"),minWidth:160,sorter:!0,sortOrder:!1,render:e=>F(rt,{ico:e.ico,name:e.name,description:e.ps,onClickName:()=>{g(e)},onBlur:async t=>{await He({id:e.id,ps:t}),e.ps=t}},null)},{key:"status",title:y("Public.Table.Status"),align:"center",className:"sort-center",width:90,minWidth:90,maxWidth:90,sorter:!0,sortOrder:!1,render:e=>F(dt,{status:e.status,onUpdateValue:t=>{w(t,e)}},null)},{key:"backup_count",title:y("Site.PHP.index_19"),width:"10%",minWidth:110,render:e=>F(pt,{count:e.backup_count,lastTime:e.last_backup_time,onShowBackup:()=>{h(e)}},null)},{key:"path",title:"Quick action",align:"center",width:"8%",minWidth:100,render:e=>F(vt,{path:e.path,phpVersion:e.php_version,onShowPhp:()=>{g(e,{menu:"php"})}},null)},ve({type:"site",minWidth:70,callback:()=>{n("fetchTable")}}),{key:"edate",title:"Expiration",align:"center",width:"8%",minWidth:80,render:e=>F(ht,{value:e.edate,onUpdateValue:async t=>{await Be({id:e.id,edate:t}),e.edate=t}},null)},{key:"site_ssl",title:y("Site.PHP.index_27"),align:"center",width:100,minWidth:100,maxWidth:100,sorter:!0,sortOrder:!1,className:"sort-center",render:e=>{const t=N.value.filter((t=>t.target_id===e.id));return F(Ae,{config:e.ssl,sslApplyList:t,onClick:()=>{g(e,{menu:"ssl"})}},null)}},{key:"requests",title:"Requests",align:"center",width:"12%",minWidth:120,render:e=>{if("nginx"!==p.value&&"apache"!==p.value)return"--";if(d.value)return F(x,{type:"primary",text:!0,onClick:()=>{ye({source:142})}},{default:()=>[J("Active")]});if(!_.value)return F(x,{type:"primary",text:!0,onClick:()=>{Oe("monitor",(async()=>{await i.getConfig(),n("fetchTable"),B()}))}},{default:()=>[1===m.value.is_install?y("Public.Btn.Update"):y("Public.Btn.Install")]});const t=P.value[e.name];if(!H(t)){const a=C(t),l=j(t);return F(kt,{name:e.name,total:a,value:l},null)}return"--"}},{key:"waf",title:"WAF",align:"center",width:"10%",minWidth:100,render:e=>{if("nginx"!==p.value)return"--";if(d.value)return F(x,{type:"primary",text:!0,onClick:()=>{ye({source:216})}},{default:()=>[J("Active")]});if(!v.value)return F(x,{type:"primary",text:!0,onClick:()=>{Oe("btwaf",(async()=>{await i.getConfig(),n("fetchTable"),V()}))}},{default:()=>[1===f.value.is_install?y("Public.Btn.Update"):y("Public.Btn.Install")]});const t=U.value.find((t=>t.siteName===e.name));if(r(t)){const a=T(t);return F(Pt,{siteName:e.name,total:a,status:t.open,onUpdateStatus:async a=>{await $e({siteName:e.name,obj:"open"}),t.open=a}},null)}return"--"}},{key:"operate",title:y("Public.Table.Operation"),align:"right",width:110,minWidth:110,maxWidth:110,render:e=>F(jt,{onClickConfig:()=>{g(e)},onClickLog:()=>{g(e,{menu:"logs"})},onClickOperate:t=>{switch(t){case"scan":g(e,{menu:"logs",subMenu:"security"});break;case"delete":k([e])}}},null)}]),S=e=>{b.value.forEach((t=>{const a=t;a.key===e.columnKey?a.sortOrder=e.order:a.sortOrder=!1}));const t=e.order?"".concat(e.columnKey," ").concat("descend"===e.order?"desc":"asc"):"";n("update:sorter",t)},P=ie({}),C=e=>e.total?e.total.request:0,j=e=>e.list.map((e=>({date:e.date,value:e.request}))),B=async()=>{if(d.value)return;if(!_.value)return;const{message:e}=await Ke((()=>{const e=new Date,t=Qe(e,-30);return{start_date:c(t,"yyyy-MM-dd"),end_date:c(e,"yyyy-MM-dd")}})());r(e)&&(P.value=e)},U=M([]),T=e=>e.total.reduce(((e,t)=>e+t.value),0),V=async()=>{if(d.value)return;if(!v.value)return;const{message:e}=await Fe({p:1,limit:1e3,search:""});r(e)&&(U.value=u(e.data)?e.data.map((e=>({open:e.open,total:e.total,siteName:e.siteName}))):[])};let W=null;const D=M(!1),N=M([]),L=async()=>{W&&clearTimeout(W);const{message:e}=await he();u(e)&&(N.value=e,e.length>0?(D.value=!0,W=window.setTimeout((()=>{L()}),3e3)):(D.value&&n("fetchTable"),W&&clearTimeout(W)))};return(()=>{const t=e("site-php-order","");if(t){const[e,a]=t.split(" "),l=b.value.find((t=>t.key===e));l&&(l.sortOrder="asc"===a?"ascend":"descend")}})(),a({getMonitorData:B,getNginxWafConfig:V,getSSLApplyList:L,getColumns:()=>b.value,setColumns:e=>{b.value=e}}),(e,t)=>{const a=ge;return O(),$(a,se(e.$attrs,{columns:E(b),"onUpdate:sorter":S}),null,16,["columns"])}}}),Bt={class:"p-20px"},Ut={class:"flex-1"},Tt={class:"mt-12px"},Vt={class:"px-20px pt-24px pb-8px"},Wt={class:"w-150px"},Dt=N({__name:"set",props:{data:{}},setup(e){const{t:t}=te(),a=e,{setOptions:l}=a.data,n=M(""),i=async()=>{const e=n.value.trim();""!==e?(await Ve({name:e}),n.value="",await _(),null==l||l(m.data)):d.error(t("Site.PHP.index_46"))},s=xe(),o=M(null),r=oe({id:-1,name:""}),c={name:{required:!0,message:t("Site.PHP.index_46"),trigger:["blur","change"]}},p=async({hide:e})=>{var t;await(null==(t=o.value)?void 0:t.validate()),await We(re(r)),await _(),null==l||l(m.data),e()},{table:m,columns:f}=ke([{key:"name",title:"Name"},we({width:120,options:e=>[{label:t("Public.Btn.Edit"),disabled:0===e.id,onClick:()=>{(e=>{r.id=e.id,r.name=e.name,s.title="".concat(t("Site.PHP.index_48")," [").concat(e.name,"]"),s.show=!0})(e)}},{label:t("Public.Btn.Delete"),disabled:0===e.id,onClick:()=>{be({title:"".concat(t("Site.PHP.index_49")," [").concat(e.name,"]"),content:t("Site.PHP.index_50"),onConfirm:async({hide:t})=>{await Ue({id:e.id}),await _(),null==l||l(m.data,e.id),t()}})}}]})]),_=async()=>{const{message:e}=await Te();m.data=u(e)?e:[]};return _(),(e,t)=>{const a=B,l=x,u=U,d=T,_=V,v=Ze,y=Ye;return O(),z("div",Bt,[F(u,null,{default:K((()=>[I("div",Ut,[F(a,{value:E(n),"onUpdate:value":t[0]||(t[0]=e=>le(n)?n.value=e:null),placeholder:e.$t("Site.PHP.index_46")},null,8,["value","placeholder"])]),I("div",null,[F(l,{type:"primary",onClick:i},{default:K((()=>[J(Q(e.$t("Site.Cert.index_62")),1)])),_:1})])])),_:1}),I("div",Tt,[F(d,{"max-height":300,data:E(m).data,columns:E(f)},null,8,["data","columns"])]),F(y,{show:E(s).show,"onUpdate:show":t[2]||(t[2]=e=>E(s).show=e),title:E(s).title,width:350,footer:!0,onConfirm:p},{default:K((()=>[I("div",Vt,[F(v,{ref_key:"formRef",ref:o,model:E(r),rules:c},{default:K((()=>[F(_,{label:e.$t("Site.PHP.index_47"),path:"name"},{default:K((()=>[I("div",Wt,[F(a,{value:E(r).name,"onUpdate:value":t[1]||(t[1]=e=>E(r).name=e),placeholder:""},null,8,["value"])])])),_:1},8,["label"])])),_:1},8,["model"])])])),_:1},8,["show","title"])])}}}),Nt={class:"w-160px"},Lt=N({__name:"index",props:{value:{default:null}},emits:["change","update:value"],setup(e,{emit:t}){const a=t,l=ue(e,"value"),{t:n}=te(),{loading:i,setLoading:s}=Se(),o=M([]),r=async e=>{a("change"),a("update:value",e),sessionStorage.setItem("typeValue",e)},c=xe(n("Site.PHP.index_44"),{setOptions:(e,t)=>{t===l.value&&(l.value=-1),o.value=e.map((e=>({label:e.name,value:e.id}))),p()}}),d=()=>{c.show=!0},p=()=>{o.value.unshift({label:n("Site.PHP.index_45"),value:-1})};return p(),R((()=>{(async()=>{try{s(!0);const{message:e}=await Te();u(e)?o.value=e.map((e=>({label:e.name,value:e.id}))):o.value=[],p()}finally{s(!1);const e=sessionStorage.getItem("typeValue");l.value=e?Number(e):-1}})()})),(e,t)=>{const a=x,n=W,s=Ye;return O(),z("div",Nt,[F(n,{value:E(l),"onUpdate:value":t[0]||(t[0]=e=>le(l)?l.value=e:null),loading:E(i),options:E(o),onUpdateValue:r},{action:K((()=>[F(a,{block:"",onClick:d},{default:K((()=>[J(Q(e.$t("Site.PHP.index_43")),1)])),_:1})])),_:1},8,["value","loading","options"]),F(s,{show:E(c).show,"onUpdate:show":t[1]||(t[1]=e=>E(c).show=e),width:350,title:E(c).title,data:E(c).data,component:Dt},null,8,["show","title","data"])])}}}),Mt=N({__name:"index",setup(t){const l=Me(),n=o(),{web:i,webserver:s}=ne(l),{t:r}=te(),{openAddSiteModal:u,openSiteAdvancedModal:c,openDeleteSiteConfig:d}=Re(),{tableConfig:h,tableData:g,pageConfig:w,tableParams:b,fetchTable:S,resetTable:C,setLoading:j}=Pe({params:{p:1,limit:10,table:"sites",search:"",order:e("site-php-order",""),type:-1},immediate:!1,fetchFn:De}),H=ae("siteTableRef");de("tableRef",H);const B=M(!1),U=M([]),T=[{label:r("Site.PHP.index_5"),key:"default-page"},{label:r("Site.PHP.index_6"),key:"default-site"},{label:r("Site.PHP.index_7"),key:"php-version"},{label:r("Site.PHP.index_86"),key:"https"}],V=[{key:"enable",type:"confirm",label:r("Site.Batch.index_1"),confirm:{title:r("Site.Batch.index_2"),desc:r("Site.Batch.index_3"),columns:[{key:"name",title:r("Site.PHP.index_17")}],api:e=>Ne(!0,{id:e.id,name:e.name},!1),done:()=>{S(!1)}}},{key:"disable",type:"confirm",label:r("Site.Batch.index_4"),confirm:{title:r("Site.Batch.index_5"),desc:r("Site.Batch.index_6"),columns:[{key:"name",title:r("Site.PHP.index_17")}],api:e=>Ne(!1,{id:e.id,name:e.name},!1),done:()=>{S(!1)}}},{key:"backup",type:"confirm",label:r("Site.Batch.index_7"),confirm:{title:r("Site.Batch.index_8"),desc:r("Site.Batch.index_9"),columns:[{key:"name",title:r("Site.PHP.index_17")}],api:e=>Le({id:e.id},!1),done:()=>{S(!1)}}},{key:"expired",label:r("Site.PHP.index_70"),onBatch:e=>{Ce({title:r("Site.PHP.index_71"),width:380,minHeight:72,footer:!0,data:{rows:e},component:ce((()=>p((()=>import("./expired.js?v=1753954525509")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))))})}},{key:"php",label:r("Site.PHP.index_66"),onBatch:e=>{Ce({title:r("Site.PHP.index_65"),width:500,minHeight:198,footer:!0,data:{rows:e},component:ce((()=>p((()=>import("./php2.js?v=1753954525509")),__vite__mapDeps([13,6,7,3,4,2,5,8,9,1,10,11,12]))))})}},{key:"category",label:r("Crontab.Planned.index_19"),onBatch:e=>{Ce({title:r("Site.Batch.index_22"),width:350,minHeight:72,footer:!0,data:{rows:e},component:ce((()=>p((()=>import("./category.js?v=1753954525509")),__vite__mapDeps([14,1,2,3,4,5,7,6,9,8,10,11]))))})}},{key:"delete",label:r("Site.Batch.index_10"),onBatch:e=>{d(e)}}],W=()=>{u()},N=e=>{b.value.order=e,a("site-php-order",e),S()},L=e=>{c(e)},q=async()=>{var e,t,a;await C(),null==(e=H.value)||e.getNginxWafConfig(),null==(t=H.value)||t.getMonitorData(),null==(a=H.value)||a.getSSLApplyList(),U.value=[]},z=async(e=!1)=>{var t,a,l;await S(e,!0),null==(t=H.value)||t.getSSLApplyList(),null==(a=H.value)||a.getNginxWafConfig(),null==(l=H.value)||l.getMonitorData(),U.value=[]},X=async()=>{try{j(!0),await l.getConfig(),B.value=i.value.setup,i.value.setup&&await z()}finally{j(!1)}};return A((()=>l.isRefresh),(e=>{e&&(l.setRefresh(!1),z())})),A((()=>n.taskCount),(()=>{X()})),j(!0),R((async()=>{X()})),(e,t)=>{const a=m,l=x,n=k,o=P,r=fe,u=me,d=Je,p=y,C=v,j=_,M=f,R=D;return O(),$(R,null,{default:K((()=>[F(M,{install:E(i).setup},{desc:K((()=>[I("span",null,Q(e.$t("Site.PHP.index_1")),1),F(a,{class:"ml-4px",onClick:t[0]||(t[0]=e=>E(je)("nginx"))},{default:K((()=>[J(Q(e.$t("Site.PHP.index_2")),1)])),_:1}),t[7]||(t[7]=I("span",{class:"mx-4px"},"|",-1)),F(a,{onClick:t[1]||(t[1]=e=>E(je)("apache"))},{default:K((()=>[J(Q(e.$t("Site.PHP.index_3")),1)])),_:1})])),default:K((()=>[F(j,{class:"p-16px",feedback:!0},{toolsLeft:K((()=>[F(l,{type:"primary",class:"add-site-btn",onClick:W},{default:K((()=>[J(Q(e.$t("Site.PHP.index_4")),1)])),_:1}),F(o,null,{default:K((()=>[F(l,{onClick:t[2]||(t[2]=e=>E(c)())},{default:K((()=>[J(Q(e.$t("Database.Mysql.index_3")),1)])),_:1}),F(n,{trigger:"hover",options:T,onSelect:L},{default:K((()=>[F(l,null,{default:K((()=>t[8]||(t[8]=[I("i",{class:"i-fa:angle-down"},null,-1)]))),_:1,__:[8]})])),_:1})])),_:1}),E(B)?(O(),$(r,{key:0,"soft-name":E(s)},null,8,["soft-name"])):pe("",!0)])),toolsRight:K((()=>[F(Lt,{value:E(b).type,"onUpdate:value":t[3]||(t[3]=e=>E(b).type=e),onChange:q},null,8,["value"]),F(u,{value:E(b).search,"onUpdate:value":t[4]||(t[4]=e=>E(b).search=e),placeholder:e.$t("Site.PHP.index_8"),onSearch:q},null,8,["value","placeholder"]),F(d,{"store-key":"site-php-columns",loading:E(h).loading,"hide-keys":["quota"],"disabled-keys":["name"]},null,8,["loading"])])),table:K((()=>[F(Ht,se({ref_key:"siteTableRef",ref:H,"checked-row-keys":E(U),"onUpdate:checkedRowKeys":t[5]||(t[5]=e=>le(U)?U.value=e:null)},E(h),{onFetchTable:E(S),"onUpdate:sorter":N}),null,16,["checked-row-keys","onFetchTable"])])),pageLeft:K((()=>[F(p,{"checked-row-keys":E(U),"onUpdate:checkedRowKeys":t[6]||(t[6]=e=>le(U)?U.value=e:null),data:E(g),options:V},null,8,["checked-row-keys","data"])])),pageRight:K((()=>[F(C,se(E(w),{"store-key":"site-php-page",onRefresh:z}),null,16)])),_:1})])),_:1},8,["install"])])),_:1})}}});export{Mt as default};
