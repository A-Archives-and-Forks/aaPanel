import{_ as a}from"./index.js?v=1741416570306";import{_ as e}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1741416570306";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1741416570306";import{b as r,c as n,f as s,a as l,d as i}from"./public.js?v=1741416570306";import{_ as o}from"./index.vue_vue_type_script_setup_true_lang.js?v=1741416570306";import{ay as d,G as p,U as _,b as u,av as g}from"./page_layout.js?v=1741416570306";import{h as c,i as m,g as b,j as x,k as h,l as v}from"./organization.js?v=1741416570306";import{d as f,M as w,r as C,j as y,P as j,Q as k,N as U,$ as P,S as T,_ as L,ao as $,l as z,c as S,a0 as q}from"./vue.js?v=1741416570306";import{bT as E,ch as R,cb as D,_ as I,bO as O,T as B}from"./naive.js?v=1741416570306";import{_ as F}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1741416570306";import"./common.js?v=1741416570306";import"./__commonjsHelpers__.js?v=1741416570306";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1741416570306";const G={class:"p-20px"},H=f({__name:"form",props:{data:{}},setup(a,{expose:e}){const{t:t}=w(),r=a,{isEdit:n,row:s,getList:l,id:i}=r.data,_=C([]),u=C(null),g=y({contrast:"in",compare:"",executeType:"1",script:null,args:"",id:0}),x=y({is_args:!1,args_holder:"",args_title:""}),h=a=>z(E,{trigger:"hover",placement:"top-start"},{trigger:()=>z("span",a.label),default:()=>z("span",a.label)}),v=(a,e)=>{x.is_args=e.is_args,x.args_holder=e.args_ps,x.args_title=e.args_title},f=[{label:t("Crontab.Planned.index_3"),value:"1"}],S=[{label:t("Crontab.arrange.index_9"),value:"in"},{label:t("Crontab.arrange.index_10"),value:"not in"},{label:t("Crontab.arrange.index_11"),value:"="},{label:t("Crontab.arrange.index_12"),value:"!="}],q={compare:{required:!0,message:t("Crontab.arrange.index_8"),trigger:["blur","input"]},script:{required:!0,type:"number",message:t("Crontab.arrange.index_13"),trigger:["blur","input"]},args:{required:!0,trigger:["blur","change"],message:t("Security.Conf.Index_28")}},B=()=>({run_script_id:g.script,operator:g.contrast,op_value:g.compare,run_script:"",args:g.args,...n?{where_id:g.id}:{trigger_id:i}});return(async()=>{const{message:a}=await b();p(a)&&(_.value=a.map((a=>({label:a.name,value:a.name,children:a.script_list.map((a=>({label:a.name,value:a.script_id,is_args:a.is_args,args_ps:a.args_ps,args_title:a.args_title})))}))))})(),n&&s&&(g.contrast=s.operator,g.compare=s.op_value,g.script=s.run_script_id,g.args=s.args,x.is_args=!!s.script_info.is_args,x.args_holder=s.script_info.args_ps,x.args_title=s.script_info.args_title,g.id=s.where_id),e({onConfirm:async({hide:a})=>{var e;await(null==(e=u.value)?void 0:e.validate()),n?await c(B()):await m(B()),null==l||l(),a()}}),(a,e)=>{const t=R,r=D,n=I,s=O,l=d,i=o;return j(),k("div",G,[U(i,{ref_key:"formRef",ref:u,model:T(g),rules:q},{default:P((()=>[U(s,null,{default:P((()=>[U(r,{label:a.$t("Crontab.Planned.index_23")},{default:P((()=>[U(t,{class:"w-120px!",value:T(g).contrast,"onUpdate:value":e[0]||(e[0]=a=>T(g).contrast=a),options:S},null,8,["value"])])),_:1},8,["label"]),U(r,{path:"compare"},{default:P((()=>[U(n,{class:"w-215px!",value:T(g).compare,"onUpdate:value":e[1]||(e[1]=a=>T(g).compare=a),placeholder:a.$t("Crontab.arrange.index_8")},null,8,["value","placeholder"])])),_:1})])),_:1}),U(s,null,{default:P((()=>[U(r,{label:a.$t("Docker.LocalImage.pull.index_12")},{default:P((()=>[U(t,{class:"w-120px!",value:T(g).executeType,"onUpdate:value":e[2]||(e[2]=a=>T(g).executeType=a),options:f},null,8,["value"])])),_:1},8,["label"]),U(r,{path:"script"},{default:P((()=>[U(l,{class:"w-218px!",value:T(g).script,"onUpdate:value":[e[3]||(e[3]=a=>T(g).script=a),v],filterable:!0,"check-strategy":"child","show-path":!1,placeholder:a.$t("Crontab.arrange.index_29"),options:T(_),"render-label":h},null,8,["value","placeholder","options"])])),_:1})])),_:1}),T(x).is_args?(j(),L(r,{key:0,label:T(x).args_title,path:"args"},{default:P((()=>[U(n,{class:"w-350px!",value:T(g).args,"onUpdate:value":e[4]||(e[4]=a=>T(g).args=a),placeholder:T(x).args_holder},null,8,["value","placeholder"])])),_:1},8,["label"])):$("",!0)])),_:1},8,["model"])])}}}),M={class:"p-20px"},N=f({__name:"logs",props:{data:{}},setup(a,{expose:s}){const{t:l}=w(),i=a,{id:o}=i.data,d=y({p:1,rows:10}),{keys:p,table:c,columns:m}=r([{key:"name",title:l("Crontab.arrange.index_5"),render:a=>z("span",{},[_(a.start_time)])},{key:"name",title:l("Crontab.arrange.index_6"),render:a=>{const e=a.end_time-a.start_time;return z("span",{},["".concat(e<1?"<1":e).concat(l("Crontab.Planned.index_45"))])}},{key:"name",title:l("Crontab.Planned.index_23"),render:function(a){return z("span",{},[a.status?z("span",{class:"text-[#20a53a]"},l("Crontab.arrange.index_35")):z("span",{class:"text-[#ef0808]"},l("Crontab.arrange.index_36"))])}},{key:"name",title:l("Crontab.arrange.index_20"),ellipsis:{tooltip:!0},width:"50%",render:function(a){return z("span",{class:"h-60px p-5px"},[a.status?a.result_succ:a.result_err])}}]),{loading:b,setLoading:h}=n(),v=async()=>{try{h(!0);const{message:a}=await x({...d,where_id:o});u(a)&&(c.data=a.data,c.total=g(a.page))}finally{p.value=[],h(!1)}};return v(),s({init:v}),(a,r)=>{const n=t,s=F,l=e;return j(),k("div",M,[U(l,null,{table:P((()=>[U(n,{"max-height":250,loading:T(b),data:T(c).data,columns:T(m)},null,8,["loading","data","columns"])])),pageRight:P((()=>[U(s,{page:T(d).p,"onUpdate:page":r[0]||(r[0]=a=>T(d).p=a),"page-size":T(d).rows,"onUpdate:pageSize":r[1]||(r[1]=a=>T(d).rows=a),"item-count":T(c).total,onRefresh:v},null,8,["page","page-size","item-count"])])),_:1})])}}}),Q={class:"p-20px"},A=f({__name:"index",props:{data:{}},setup(o,{expose:d}){const{t:_}=w(),u=o,{id:g}=u.data,{keys:c,table:m,columns:b}=r([{key:"name",title:_("Crontab.arrange.index_15"),ellipsis:{tooltip:{width:"trigger"}},render:a=>{const e={in:_("Crontab.arrange.index_9"),"not in":_("Crontab.arrange.index_10"),"=":_("Crontab.arrange.index_11"),"!=":_("Crontab.arrange.index_12")};return z("span",{},_("Crontab.arrange.index_39",[a.script_info.name,e[a.operator],a.op_value]))}},s({width:130,options:a=>[{label:_("Site.TableOP.index_7"),onClick:()=>{E(a)}},{label:_("Ftp.Table.index_15"),onClick:()=>{L.data.id=a.where_id,L.show=!0}},{label:_("Public.Btn.Del"),onClick:()=>{l({title:_("Crontab.arrange.index_16"),content:_("Crontab.arrange.index_18"),onConfirm:async({hide:e})=>{await h({where_id:a.where_id}),C(),e()}})}}]})]),{loading:x,setLoading:f}=n(),C=async()=>{try{f(!0);const{message:a}=await v({trigger_id:g});p(a)&&(m.data=a)}finally{c.value=[],f(!1)}},y=i(_("Crontab.arrange.index_14"),{getList:C,id:g}),L=i(_("Crontab.arrange.index_17")),$=()=>{y.data.isEdit=!1,y.title=_("Crontab.arrange.index_14"),y.show=!0},E=a=>{y.data.row=a,y.data.isEdit=!0,y.title=_("Crontab.arrange.index_19"),y.show=!0};return C(),d({init:C}),(r,n)=>{const s=B,l=t,i=e,o=a;return j(),k("div",Q,[U(i,null,{toolsLeft:P((()=>[U(s,{type:"primary",onClick:$},{default:P((()=>[S(q(r.$t("Crontab.arrange.index_14")),1)])),_:1})])),table:P((()=>[U(l,{loading:T(x),"max-height":200,data:T(m).data,columns:T(b)},null,8,["loading","data","columns"])])),_:1}),U(o,{show:T(y).show,"onUpdate:show":n[0]||(n[0]=a=>T(y).show=a),title:T(y).title,data:T(y).data,width:600,footer:!0,component:H},null,8,["show","title","data"]),U(o,{show:T(L).show,"onUpdate:show":n[1]||(n[1]=a=>T(L).show=a),title:T(L).title,data:T(L).data,width:850,component:N},null,8,["show","title","data"])])}}});export{A as default};
