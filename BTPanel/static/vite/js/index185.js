import{_ as a}from"./index95.js?v=1744703330658";import{_ as e}from"./index.vue_vue_type_script_setup_true_lang.js?v=1744703330658";import{d as l,K as t,u as i,m as s,h as o,J as r,_ as d}from"./page_layout.js?v=1744703330658";import{d as n,ai as u,r as c,e as m,R as p,$ as _,a0 as v,V as f,S as y,ap as h,P as x,U as b,c as w,O as g,j as M,k,v as j,a1 as D}from"./vue.js?v=1744703330658";import{ac as q,ad as A}from"./mail.js?v=1744703330658";import{b as $,c as S,e as E}from"./public.js?v=1744703330658";import{_ as U}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1744703330658";import{g as T}from"./index48.js?v=1744703330658";import{g as X}from"./ssl.js?v=1744703330658";import{T as B,bU as P,cq as R,cm as C,cl as N,ch as z,_ as G,bY as W,cn as Y}from"./naive.js?v=1744703330658";import"./common.js?v=1744703330658";import"./__commonjsHelpers__.js?v=1744703330658";import"./index.js?v=1744703330658";import"./index.vue_vue_type_script_setup_true_lang4.js?v=1744703330658";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1744703330658";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1744703330658";const F={key:0,class:"color-desc"},L={key:3,class:"color-desc"},O=n({__name:"automatic",props:{domain:{}},setup(a,{expose:e}){const i=u(),s=a,{table:o,columns:r}=$([{key:"type",title:"Type",width:50},{key:"record",title:"Record",width:120,ellipsis:{tooltip:!0}},{key:"value",title:"Value",ellipsis:{tooltip:!0}},{key:"priority",title:"MX priority",render:a=>-1!==a.priority?a.priority:"-",width:90},{key:"status",title:"Status",width:110}]),d=c(),n=m((()=>{var a;return null==(a=d.value)?void 0:a.support.includes("auto")})),g=()=>{i.push("/ssl_domain/domain")},{loading:M,setLoading:k}=S();return e({getParseStatus:async()=>{const{message:a}=await X({domain:s.domain});if(l(a)&&(d.value=a,n.value))try{k(!0);const{message:e}=await T({domain:s.domain,hash:a.hash});l(e)&&(o.data=[{type:"A",record:e.A.record,value:e.A.record_value,priority:e.A.priority,status:e.A.status?"Added":"Waiting to add"},{type:"MX",record:e.MX.record,value:e.MX.record_value,priority:e.MX.priority,status:e.MX.status?"Added":"Waiting to add"},...e.TXT.map((a=>({type:"TXT",record:a.record,value:a.record_value,priority:a.priority,status:a.status?"Added":"Waiting to add"})))])}finally{k(!1)}},parseStatus:d,isSupportAuto:n}),(a,e)=>{const l=B,i=P,s=R,u=t,c=U;return p(),_(i,null,{default:v((()=>[f(d)?h("",!0):(p(),y("span",F," *The program will use the APl to automatically add the required DNS records forthe mail server and complete the installation of the SSL certifcate. ")),f(d)?(p(),_(i,{key:1},{default:v((()=>[f(n)?(p(),_(s,{key:1,type:"success"},{default:v((()=>e[2]||(e[2]=[w(" Your domain has been connccted to the domain managementccnter, and you can use this fcature to complcte onc-click deployment. ")]))),_:1})):(p(),_(s,{key:0,type:"error"},{default:v((()=>[x(i,{class:"items-center flex-nowrap!"},{default:v((()=>[e[1]||(e[1]=b("span",null,"Your domain has not yet been integrated with the Domain Name Management Center.",-1)),x(l,{type:"primary",size:"small",ghost:"",onClick:g},{default:v((()=>e[0]||(e[0]=[w("Add Now")]))),_:1})])),_:1})])),_:1})),f(M)?(p(),_(i,{key:2,class:"items-center!"},{default:v((()=>[e[3]||(e[3]=b("span",{class:"color-desc"},"Checking for records to be added",-1)),x(u,{size:"small"})])),_:1})):h("",!0),!f(M)&&f(n)?(p(),y("span",L,"The records that will be automatically added")):h("",!0),!f(M)&&f(n)?(p(),_(c,{key:4,data:f(o).data,columns:f(r)},null,8,["data","columns"])):h("",!0)])),_:1})):h("",!0)])),_:1})}}}),V={class:"p-20px"},H={class:"flex h-15px items-center mr-16px"},I={class:"w-320px"},J={class:"w-100px ml-20px"},K={class:"w-320px"},Q={class:"text-error"},Z=n({__name:"index",props:{row:{},isEdit:{type:Boolean}},emits:["refresh"],setup(l,{expose:t,emit:n}){const u=i(),m=l,$=n,S=c(null),U=c(""),T=()=>{var a;""!==R.domain.trim()?U.value!==R.domain&&2===R.dns_record&&(null==(a=S.value)||a.getParseStatus(),U.value=R.domain):U.value=""},{t:X}=g(),B=c(null),R=M({domain:"",a_record:"",dns_record:2,quota:5,quota_unit:"GB",mailboxes:50,email:"",ips:""}),F=[{label:"GB",value:"GB"},{label:"MB",value:"MB"}],L={domain:{trigger:["blur","input"],validator:()=>""!==R.domain.trim()||new Error(X("Mail.Domain.index_27"))}},Z=()=>{E({source:351})},aa=()=>{var a,e;return{domain:R.domain,a_record:R.a_record,ips:m.isEdit&&!R.ips?"del":R.ips,quota:R.quota+" "+R.quota_unit,mailboxes:R.mailboxes,email:R.email,automatic:2===R.dns_record?1:null,hash:2===R.dns_record?null==(e=null==(a=S.value)?void 0:a.parseStatus)?void 0:e.hash:null}};return(()=>{const{isEdit:a,row:e}=m;if(a&&e){const a=e.ip_address.ipv4.join(""),l=e.ip_address.ipv6.join("");R.domain=e.domain,R.a_record=e.a_record,R.ips=a.length>0?a:l;const t=o(e.quota);R.quota=r(t.split(" ")[0]),R.quota_unit=t.split(" ")[1],R.mailboxes=e.mailboxes,R.email=e.email,R.dns_record=1}})(),t({onConfirm:async()=>{var a,e;if(await(null==(a=B.value)?void 0:a.validate()),!(null==(e=S.value)?void 0:e.isSupportAuto)&&2===R.dns_record&&!m.isEdit)return s.error("This domain does not support automatic resolution, please choose manual resolution"),!1;const{isEdit:l}=m;l?await q(aa()):await A(aa()),$("refresh")}}),(l,t)=>{const i=d,s=C,o=N,r=z,n=G,c=P,m=W,g=Y,M=e,q=a;return p(),y("div",V,[x(M,{ref_key:"formRef",ref:B,model:f(R),rules:L,"label-width":"150px"},{default:v((()=>[l.isEdit?h("",!0):(p(),_(r,{key:0,label:"DNS record"},{default:v((()=>[x(o,{value:f(R).dns_record,"onUpdate:value":[t[0]||(t[0]=a=>f(R).dns_record=a),T]},{default:v((()=>[x(s,{value:2},{default:v((()=>[b("div",H,[t[8]||(t[8]=b("div",null,"Automatic",-1)),x(i,{name:"ssl-stars",size:22})])])),_:1}),x(s,{value:1},{default:v((()=>t[9]||(t[9]=[w("Manual")]))),_:1})])),_:1},8,["value"])])),_:1})),x(r,{label:l.$t("Mail.Domain.index_3"),path:"domain"},{default:v((()=>[b("div",I,[x(n,{value:f(R).domain,"onUpdate:value":t[1]||(t[1]=a=>f(R).domain=a),disabled:l.isEdit,placeholder:l.$t("Mail.Domain.index_18"),onBlur:T},null,8,["value","disabled","placeholder"])])])),_:1},8,["label"]),k(x(r,{label:l.$t("Mail.Domain.index_19")},{default:v((()=>[x(c,null,{default:v((()=>[x(n,{class:"w-320px!",value:f(R).a_record,"onUpdate:value":t[2]||(t[2]=a=>f(R).a_record=a),disabled:l.isEdit,placeholder:l.$t("Mail.Domain.index_20")},null,8,["value","disabled","placeholder"]),t[10]||(t[10]=b("span",{class:"color-#777777"}," *Resolve the domain to the mail server's lP address for server communication ormail client connections. ",-1))])),_:1})])),_:1},8,["label"]),[[j,1===f(R).dns_record]]),k(x(r,{label:" "},{default:v((()=>[x(O,{ref_key:"automaticRef",ref:S,domain:f(R).domain},null,8,["domain"])])),_:1},512),[[j,2===f(R).dns_record]]),l.isEdit?(p(),_(r,{key:1,label:"IP"},{default:v((()=>[x(c,{class:"items-center"},{default:v((()=>[x(n,{class:"w-320px!",value:f(R).ips,"onUpdate:value":t[3]||(t[3]=a=>f(R).ips=a),disabled:f(u).isFree,placeholder:l.$t("Mail.Domain.index_65")},null,8,["value","disabled","placeholder"]),f(u).isFree?(p(),y("span",{key:0,class:"cursor-pointer color-#ffb800",onClick:Z}," PRO ")):h("",!0)])),_:1})])),_:1})):h("",!0),x(r,{label:l.$t("Mail.Domain.index_21")},{default:v((()=>[x(m,{value:f(R).quota,"onUpdate:value":t[4]||(t[4]=a=>f(R).quota=a),class:"w-200px",min:0,"show-button":!1},null,8,["value"]),b("div",J,[x(g,{value:f(R).quota_unit,"onUpdate:value":t[5]||(t[5]=a=>f(R).quota_unit=a),options:F},null,8,["value"])])])),_:1},8,["label"]),x(r,{label:l.$t("Mail.Domain.index_22")},{default:v((()=>[x(m,{value:f(R).mailboxes,"onUpdate:value":t[6]||(t[6]=a=>f(R).mailboxes=a),class:"w-320px",min:0,"show-button":!1},null,8,["value"])])),_:1},8,["label"]),x(r,{label:l.$t("Mail.Domain.index_7")},{default:v((()=>[b("div",K,[x(n,{value:f(R).email,"onUpdate:value":t[7]||(t[7]=a=>f(R).email=a),placeholder:l.$t("Mail.Domain.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"])])),_:1},8,["model"]),x(q,null,{default:v((()=>[b("li",Q,D(l.$t("Mail.Domain.index_24")),1),b("li",null,D(l.$t("Mail.Domain.index_25")),1),b("li",null,D(l.$t("Mail.Domain.index_26")),1)])),_:1})])}}});export{Z as default};
