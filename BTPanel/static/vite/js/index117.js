import{_ as a}from"./index223.js?v=1741416570306";import{_ as e}from"./index95.js?v=1741416570306";import{u as t,cO as n,m as s,f as l,cP as i,b as p,l as o,k as d,G as u,cQ as r,cR as m,cS as c,cT as v,cU as _,cV as b,cW as h}from"./page_layout.js?v=1741416570306";import{a as x,e as y,c as f}from"./public.js?v=1741416570306";import{p as w,a as P,d as g,M as A,r as D,P as $,Q as k,R as S,N as C,$ as j,c as U,a0 as T,S as N,j as B,ae as H,F as L,ao as q,t as I}from"./vue.js?v=1741416570306";import{T as M}from"./common.js?v=1741416570306";import{bL as R,a2 as z,T as E,ch as F,bO as O,bH as Q,bS as V,cb as G,bV as W,_ as J}from"./naive.js?v=1741416570306";import{aq as K}from"./site.js?v=1741416570306";import{_ as X}from"./index.vue_vue_type_script_setup_true_lang.js?v=1741416570306";import"./__commonjsHelpers__.js?v=1741416570306";const Y=Symbol("php-admin");function Z(a,e,t,n){return new Promise((s=>{const l="".concat(a,"/index.php?lang=en"),i=document.createElement("form"),p='\n\t\t\t<input type="text" name="pma_username" id="pma_username" value="'.concat(t,'" />\n\t\t\t<input type="password" name="pma_password" id="pma_password" value="').concat(n,'" />\n\t\t\t<input type="text" name="server" value="1" />\n\t\t\t<input type="text" name="target" value="index.php" />\n\t\t\t<input type="text" name="db" id="db" value="').concat(e,'" />\n\t\t');i.action=l,i.setAttribute("public-data",l),i.method="post",i.target="_blank",i.style.display="none",i.innerHTML=p,document.body.appendChild(i),i.submit(),document.body.removeChild(i),s(i)}))}async function aa(a,e){const{data:t}=await M.get("/phpmyadmin/index.php?lang=en"),n={session:"",token:""},s=t.match(/"set_session"\s+value="(\w+)"/),l=t.match(/"token"\s+value="(\w+)"/);s&&s.length>1&&(n.session=s[1]||""),l&&l.length>1&&(n.token=l[1]||"");const i=document.createElement("form");i.action="/phpmyadmin/index.php",i.method="post",i.target="_blank",i.style.display="none";const p='\n\t\t<input  name="set_session" id="input_session" value="'.concat(n.session,'" />\n\t\t<input type="text" name="pma_username" id="pma_username" value="').concat(a,'" size="24" />\n\t\t<input type="password" name="pma_password" id="pma_password" value="').concat(e,'" size="24" />\n\t\t<input  name="token" id="input_token" value="').concat(n.token,'" />\n\t\t<input  name="target" id="input_target" value="index.php" />\n\t\t<input  name="server" value="1" id="input_server" />\n\t');i.innerHTML=p,document.body.appendChild(i),i.submit(),document.body.removeChild(i)}const ea={class:"p-4px"},ta={class:"mb-16px"},na={class:"text-error"},sa={class:"mt-20px"},la="phpmyadmin",ia=d(g({__name:"index",setup(a,{expose:d}){const{t:u}=A(),r=t(),{mysqlInfo:m}=P(Y),c=D(!1),v=a=>{x({title:u("Database.PhpAdmin.index_12",[u(a?"Public.Status.Start":"Public.Status.Stop")]),content:u("Database.PhpAdmin.index_13",[u(a?"Public.Status.start":"Public.Status.stop")]),onConfirm:async()=>{await n({name:la,type:a?"start":"stop"}),b()}})},_=async a=>{const e=s.loading(u("Database.PhpAdmin.index_14"));try{const{message:t}=await l({sName:la}),n=R(t,"ext.url",""),p=R(t,"ext.auth",!1);if("panel"==a){if(p)return s.error(u("Database.PhpAdmin.index_15")),void e.close();if(r.isFree)return y({source:160}),void e.close();if(m.value)await aa(m.value.username,m.value.password);else{const{message:a}=await i(),e=R(a,"result","");await aa("root",e)}}else if(m.value)await Z(n,m.value.name,m.value.username,m.value.password);else{const{message:a}=await i(),e=R(a,"result","");await Z(n,"","root",e)}e.close()}catch(t){e.close(),console.error(t)}},b=async()=>{const{message:a}=await l({sName:la});p(a)&&(c.value=a.status)};return b(),d({init:b}),(a,t)=>{const n=z,s=e,l=o,i=E;return $(),k("div",ea,[S("div",ta,[C(n,{checked:N(c),"onUpdate:checked":v},{default:j((()=>[U(T(a.$t("Database.PhpAdmin.index_4")),1)])),_:1},8,["checked"])]),C(s,{class:"mb-20px"},{default:j((()=>[S("li",na,T(a.$t("Database.PhpAdmin.index_5")),1)])),_:1}),C(l,{dashed:""}),S("div",sa,[C(i,{onClick:t[0]||(t[0]=a=>_("panel"))},{default:j((()=>[S("span",null,T(a.$t("Database.PhpAdmin.index_11")),1),t[2]||(t[2]=S("span",{class:"bg-recommend"},null,-1))])),_:1}),C(i,{class:"ml-24px",onClick:t[1]||(t[1]=a=>_())},{default:j((()=>[U(T(a.$t("Database.PhpAdmin.index_6")),1)])),_:1})]),C(s,{class:"mt-16px"},{default:j((()=>[S("li",null,T(a.$t("Database.PhpAdmin.index_7")),1),S("li",null,T(a.$t("Database.PhpAdmin.index_8")),1),S("li",null,T(a.$t("Database.PhpAdmin.index_9")),1),S("li",null,T(a.$t("Database.PhpAdmin.index_10")),1)])),_:1})])}}}),[["__scopeId","data-v-ccb3caae"]]),pa={class:"w-160px"},oa=g({__name:"index",setup(a,{expose:e}){const{t:t}=A(),n=B({php_version:null}),i=D([]),{loading:p,setLoading:o}=f(),d=async()=>{try{o(!0);const[a,e]=await Promise.all([K(),l({sName:"phpmyadmin"})]),{message:t}=a;u(t)&&(i.value=t.map((a=>({label:a.name,value:a.version}))));const{message:s}=e;n.php_version=R(s,"ext.phpversion",null)}finally{o(!1)}},m=async()=>{const a=n.php_version;null!==a?(await r({phpversion:a}),d()):s.error(t("Database.PhpAdmin.index_32"))};return d(),e({init:d}),(a,e)=>{const t=F,s=E,l=O;return $(),k("div",null,[C(l,{class:"items-center"},{default:j((()=>[S("span",null,T(a.$t("Database.PhpAdmin.index_31")),1),S("div",pa,[C(t,{value:N(n).php_version,"onUpdate:value":e[0]||(e[0]=a=>N(n).php_version=a),loading:N(p),options:N(i)},null,8,["value","loading","options"])]),C(s,{type:"primary",onClick:m},{default:j((()=>[U(T(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1})])}}}),da={class:"p-4px"},ua={class:"w-142px mr-8px"},ra={class:"w-142px mr-8px"},ma={class:"w-240px"},ca={class:"w-240px"},va={class:"w-240px"},_a=g({__name:"index",setup(a,{expose:t}){const{t:n}=A(),i=D(null),p=D(!1),d=D(null),u=D(!1);let r=!1;const y=B({username:"",password:"",repass:""}),f=async()=>{const a=i.value;null!==a?(await m({port:a}),z()):s.error(n("Database.PhpAdmin.index_25"))},w=async a=>{await c({v:a?1:0}),O()},P=async()=>{const a=d.value;null!==a?(await v({port:a}),O()):s.error(n("Database.PhpAdmin.index_26"))},g=a=>{!a&&r?x({title:n("Public.Confirm.Title"),content:n("Database.PhpAdmin.index_27"),onConfirm:async()=>{await _(),z()}}):u.value=a},I=async()=>{""!==y.password.trim()&&""!==y.username.trim()?y.password.length<3||y.username.length<3?s.error(n("Database.PhpAdmin.index_29")):y.password===y.repass?(await b({username:y.username,password:y.password}),z()):s.error(n("Database.PhpAdmin.index_30")):s.error(n("Database.PhpAdmin.index_28"))},M=D(!1),z=async()=>{try{M.value=!0;const{message:a}=await l({sName:"phpmyadmin"}),e=R(a,"ext.port",null);i.value=e?Q(e):null,u.value=R(a,"ext.auth",!1),r=u.value}finally{M.value=!1}},F=D(!1),O=async()=>{try{F.value=!0;const{message:a}=await h();p.value=R(a,"status",!1);const e=R(a,"port",null);d.value=e?Q(e):null}finally{F.value=!1}},K=()=>{Promise.all([z(),O()])};return K(),t({init:K}),(a,t)=>{const n=V,s=E,l=G,r=o,m=W,c=J,v=e,_=X;return $(),k("div",da,[C(_,{"label-width":"160"},{default:j((()=>[C(l,{label:a.$t("Database.PhpAdmin.index_16")},{default:j((()=>[S("div",ua,[C(n,{value:N(i),"onUpdate:value":t[0]||(t[0]=a=>H(i)?i.value=a:null),min:0,max:66325,"show-button":!1,loading:N(M),placeholder:""},null,8,["value","loading"])]),C(s,{type:"primary",onClick:f},{default:j((()=>[U(T(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1},8,["label"]),C(r,{dashed:""}),C(l,{class:"mt-20px",label:a.$t("Database.PhpAdmin.index_17")},{default:j((()=>[C(m,{value:N(p),loading:N(F),"onUpdate:value":w},null,8,["value","loading"])])),_:1},8,["label"]),C(l,{label:a.$t("Database.PhpAdmin.index_18")},{default:j((()=>[S("div",ra,[C(n,{value:N(d),"onUpdate:value":t[1]||(t[1]=a=>H(d)?d.value=a:null),min:0,max:66325,"show-button":!1,loading:N(F),placeholder:""},null,8,["value","loading"])]),C(s,{type:"primary",onClick:P},{default:j((()=>[U(T(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1},8,["label"]),C(r,{dashed:""}),C(l,{class:"mt-20px",label:a.$t("Database.PhpAdmin.index_19")},{default:j((()=>[C(m,{value:N(u),loading:N(M),"onUpdate:value":g},null,8,["value","loading"])])),_:1},8,["label"]),N(u)?($(),k(L,{key:0},[C(l,{label:a.$t("Database.PhpAdmin.index_20")},{default:j((()=>[S("div",ma,[C(c,{value:N(y).username,"onUpdate:value":t[2]||(t[2]=a=>N(y).username=a),placeholder:a.$t("Database.PhpAdmin.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"]),C(l,{label:a.$t("Database.PhpAdmin.index_21")},{default:j((()=>[S("div",ca,[C(c,{value:N(y).password,"onUpdate:value":t[3]||(t[3]=a=>N(y).password=a),type:"password",placeholder:a.$t("Database.PhpAdmin.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"]),C(l,{label:a.$t("Database.PhpAdmin.index_22")},{default:j((()=>[S("div",va,[C(c,{value:N(y).repass,"onUpdate:value":t[4]||(t[4]=a=>N(y).repass=a),type:"password",placeholder:a.$t("Database.PhpAdmin.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"]),C(l,{label:" "},{default:j((()=>[C(s,{type:"primary",onClick:I},{default:j((()=>[U(T(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1})],64)):q("",!0),C(v,null,{default:j((()=>[S("li",null,T(a.$t("Database.PhpAdmin.index_24")),1)])),_:1})])),_:1})])}}}),ba={class:"h-580px"},ha=g({__name:"index",props:{row:{default:void 0}},setup(e){const t=I(e,"row"),{t:n}=A(),s=D("service"),l=[{key:"service",label:n("Database.PhpAdmin.index_1"),component:ia},{key:"php",label:n("Database.PhpAdmin.index_2"),component:oa},{key:"safe",label:n("Database.PhpAdmin.index_3"),component:_a}];return w(Y,{mysqlInfo:t}),(e,t)=>{const n=a;return $(),k("div",ba,[C(n,{value:N(s),"onUpdate:value":t[0]||(t[0]=a=>H(s)?s.value=a:null),ref:"tabsRef",data:l},null,8,["value"])])}}});export{ha as default};
