import{_ as e}from"./public.js?v=1753954525509";import{_ as l}from"./index.vue_vue_type_script_setup_true_lang.js?v=1753954525509";import{_ as r}from"./index100.js?v=1753954525509";import{k as a,P as o,r as t,e as i,U as s,V as u,Q as p,a2 as d,W as c,X as n,l as m,v as f,a3 as _}from"./vue.js?v=1753954525509";import{fU as v,fV as w}from"./page_layout.js?v=1753954525509";import{cG as y,cA as b,aq as h}from"./naive.js?v=1753954525509";import"./common.js?v=1753954525509";import"./__commonjsHelpers__.js?v=1753954525509";const P={class:"p-20px"},S={class:"w-240px"},F={class:"w-240px"},U={class:"w-240px"},x={class:"w-240px"},$={class:"w-240px"},g={class:"w-240px"},j={class:"w-240px"},E={class:"w-240px"},T=a({__name:"form",props:{row:{},isEdit:{type:Boolean,default:!1}},emits:["refresh"],setup(a,{expose:T,emit:I}){const A=a,C=I,{t:k}=o(),{isEdit:D,row:N}=A,O=t(null),V=i({protocol:"tcp",port:"",choose:"all",address:"",domain:"",types:"accept",chain:"INPUT",brief:""}),q={port:{trigger:["blur","input"],validator:()=>{const e=V.port.split(","),l=/^\d+$/;for(let r of e)if(l.test(r)){const e=parseInt(r,10);if(e<1||e>65535)return new Error(k("Security.Firewall.Port.form_15"))}else{if(!r.includes("-"))return""==r?new Error(k("Security.Firewall.Port.form_16")):new Error(k("Security.Firewall.Port.form_15"));{const e=r.split("-"),l=parseInt(e[0],10),a=parseInt(e[1],10);if(l<1||a>65535||l>a)return new Error(k("Security.Firewall.Port.form_15"))}}return!0}},address:{trigger:["blur","input"],validator:()=>!!("point"!==V.choose||""!==V.address.trim()&&V.address)||new Error(k("Security.Firewall.Port.form_18"))},domain:{trigger:["blur","input"],validator:()=>!!("domain"!==V.choose||""!==V.domain.trim()&&V.domain)||new Error(k("Security.Firewall.Port.form_19"))}},B=[{label:"TCP",value:"tcp"},{label:"UDP",value:"udp"},{label:"TCP/UDP",value:"all"}],G=[{label:k("Security.Firewall.Port.form_20"),value:"all"},{label:k("Security.Firewall.Port.form_5"),value:"point"}],H=[{label:k("Security.Firewall.Port.form_21"),value:"accept"},{label:k("Security.Firewall.Port.form_22"),value:"drop"}],Q=[{label:k("Security.Firewall.Port.form_23"),value:"INPUT"},{label:k("Security.Firewall.Port.form_24"),value:"OUTPUT"}];return D&&N&&(V.protocol=N.Protocol,V.port=N.Port,V.choose="all"===N.Address?"all":""===N.domain?"point":"domain",V.address="all"===N.Address?"":N.Address,V.domain=N.domain,V.types=N.Strategy,V.chain=N.Chain,V.brief=N.brief),T({onConfirm:async()=>{var e;await(null==(e=O.value)?void 0:e.validate());const l=(()=>{let e={protocol:V.protocol,port:V.port,choose:V.choose,domain:"domain"===V.choose?V.domain:"",types:V.types,strategy:V.types,chain:V.chain,brief:V.brief};return"point"===e.choose&&(e=Object.assign(e,{address:V.address})),e})();D&&N?await v({new_data:l,old_data:N}):await w(l),C("refresh")}}),(a,o)=>{const t=y,i=b,v=h,w=r,T=l,I=e;return s(),u("div",P,[p(T,{ref_key:"formRef",ref:O,model:n(V),rules:q},{default:d((()=>[p(i,{label:a.$t("Security.Firewall.Port.form_1"),path:"protocol"},{default:d((()=>[c("div",S,[p(t,{value:n(V).protocol,"onUpdate:value":o[0]||(o[0]=e=>n(V).protocol=e),options:B},null,8,["value"])])])),_:1},8,["label"]),p(i,{label:a.$t("Security.Firewall.Port.form_2"),path:"port"},{default:d((()=>[c("div",F,[p(v,{value:n(V).port,"onUpdate:value":o[1]||(o[1]=e=>n(V).port=e),disabled:n(D),placeholder:a.$t("Security.Firewall.Port.form_3")},null,8,["value","disabled","placeholder"])])])),_:1},8,["label"]),p(i,{label:a.$t("Security.Firewall.Port.form_4"),path:"choose"},{default:d((()=>[c("div",U,[p(t,{value:n(V).choose,"onUpdate:value":o[2]||(o[2]=e=>n(V).choose=e),options:G},null,8,["value"])])])),_:1},8,["label"]),m(p(i,{label:a.$t("Security.Firewall.Port.form_5"),path:"address"},{default:d((()=>[c("div",x,[p(w,{value:n(V).address,"onUpdate:value":o[3]||(o[3]=e=>n(V).address=e),rows:3,placeholder:a.$t("Security.Firewall.Port.form_6")},null,8,["value","placeholder"])])])),_:1},8,["label"]),[[f,"point"===n(V).choose]]),m(p(i,{label:a.$t("Security.Firewall.Port.form_7"),path:"domain"},{default:d((()=>[c("div",$,[p(w,{value:n(V).domain,"onUpdate:value":o[4]||(o[4]=e=>n(V).domain=e),rows:3,placeholder:a.$t("Security.Firewall.Port.form_8")},null,8,["value","placeholder"])])])),_:1},8,["label"]),[[f,"domain"===n(V).choose]]),p(i,{label:a.$t("Security.Firewall.Port.form_9"),path:"types"},{default:d((()=>[c("div",g,[p(t,{value:n(V).types,"onUpdate:value":o[5]||(o[5]=e=>n(V).types=e),options:H},null,8,["value"])])])),_:1},8,["label"]),p(i,{label:a.$t("Security.Firewall.Port.form_10"),path:"types"},{default:d((()=>[c("div",j,[p(t,{value:n(V).chain,"onUpdate:value":o[6]||(o[6]=e=>n(V).chain=e),options:Q},null,8,["value"])])])),_:1},8,["label"]),p(i,{label:a.$t("Security.Firewall.Port.form_11"),path:"brief","show-feedback":!1},{default:d((()=>[c("div",E,[p(v,{value:n(V).brief,"onUpdate:value":o[7]||(o[7]=e=>n(V).brief=e),placeholder:a.$t("Security.Firewall.Port.form_12")},null,8,["value","placeholder"])])])),_:1},8,["label"])])),_:1},8,["model"]),p(I,{class:"mt-20px ml-40px"},{default:d((()=>[c("li",null,_(a.$t("Security.Firewall.Port.form_13")),1),c("li",null,_(a.$t("Security.Firewall.Port.form_14")),1)])),_:1})])}}});export{T as default};
