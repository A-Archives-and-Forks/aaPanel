System.register(["./public-legacy.js?v=1749179669910","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1749179669910","./site-legacy.js?v=1749179669910","./page_layout-legacy.js?v=1749179669910","./naive-legacy.js?v=1749179669910","./vue-legacy.js?v=1749179669910","./common-legacy.js?v=1749179669910","./__commonjsHelpers__-legacy.js?v=1749179669910"],(function(e,a){"use strict";var l,t,n,s,i,d,u,o,r,p,c,_,m,h,y,f,v,g,S,x,w,b,L,k,A,$,z,Z,j,U,R,O,E,N,F,q,C,H,J,M,P,B,V;return{setters:[e=>{l=e.d,t=e.ae,n=e.af,s=e.u,i=e.ag,d=e.ah,u=e.ai,o=e.ay,r=e._},e=>{p=e._},e=>{c=e.Z},e=>{_=e.c,m=e.N,h=e.aN,y=e.O},e=>{f=e.bR,v=e.co,g=e.cn,S=e.cj,x=e.a2,w=e.cp,b=e._,L=e.bU,k=e.cN},e=>{A=e.d,$=e.O,z=e.r,Z=e.j,j=e.e,U=e.w,R=e.f,O=e.R,E=e.S,N=e.P,F=e.a1,q=e.V,C=e.c,H=e.a2,J=e.a0,M=e.ao,P=e.F,B=e.N,V=e.U},null,null],execute:function(){const a={class:"p-16px"},W={key:0},D={key:1};e("default",A({__name:"index",props:{onRefresh:{type:Function},onOpenLog:{type:Function}},setup(e,{expose:A}){const{t:G}=$(),I=e,K=z(null),Q=Z({auth_type:"dns",dns_manual:0,site:0,type:"wildcard",domains:"",domains_list:[],all:!1}),T=z([{label:G("SSL.index_17"),value:"single"},{label:G("SSL.index_18"),value:"wildcard"},{label:G("SSL.index_19"),value:"wildcard_all"}]),X=z([]),Y=z([]),ee=()=>{Q.domains=""},ae=()=>{Q.domains_list=[],de()},le=j((()=>Q.domains_list.length>0&&Q.domains_list.length<Y.value.length));U((()=>Q.domains_list),(e=>{e.length===Y.value.length?Q.all=!0:e.length||(Q.all=!1)})),U((()=>Q.all),(e=>{e?(Q.domains_list=Y.value.map((e=>e.name)),K.value?.validate()):Q.domains_list=[]}));const te={domains:{required:!0,trigger:"input",validator:(e,a)=>{if("single"===Q.type){if(!a)return new Error(G("SSL.index_20"));if(!/^[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+$/.test(a))return new Error(G("SSL.index_21"))}else if("wildcard"===Q.type){if(!a)return new Error(G("SSL.index_22"));if(!/^(?:\*\.)?(?:[a-zA-Z0-9-]+\.)?[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+(\n(?:\*\.)?(?:[a-zA-Z0-9-]+\.)?[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+)*$/.test(a))return new Error(G("SSL.index_23"))}else if("wildcard_all"===Q.type){if(!a)return new Error(G("SSL.index_24"));if(!/^\*\.[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+(\n\*\.[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+)*$/i.test(a))return new Error(G("SSL.index_25"))}return!0}},domains_list:{required:!0,trigger:"change",type:"array",message:G("SSL.SiteSSL.index_16")}},ne=()=>({auth_type:Q.dns_manual?"dns_manual":Q.auth_type,domains:JSON.stringify("http"===Q.auth_type?Q.domains_list:"single"===Q.type?[Q.domains]:Q.domains.split("\n")),site_id:Q.dns_manual?-1:void 0}),{loading:se,setLoading:ie}=l(),de=async()=>{try{ie(!0);const{message:e}=await c({id:Q.site});m(e)&&(Y.value=e.map((e=>({name:e.name}))))}finally{ie(!1)}};return R((async()=>{await(async()=>{const{message:e}=await o();m(e)&&(X.value=e.map((e=>({label:e.name,value:e.id}))),Q.site=X.value[0].value)})(),de()})),A({onConfirm:async()=>{if(await(K.value?.validate()),Q.dns_manual){const e=JSON.stringify("http"===Q.auth_type?Q.domains_list:"single"===Q.type?[Q.domains]:Q.domains.split("\n")),{message:l}=await t({site_id:-1,domains:e});if(_(l)&&Object.keys(l).length)return n(l.auths,-1,(()=>{I.onRefresh()}),!0),!1;const o=s({width:500,height:300,hideClose:!0,component:i});try{const{message:e}=await d(ne(),!1);if(_(e)){if(e.deploy)return void I.onRefresh();Array.isArray(e.auths)&&e.auths.length&&n(e.auths,-1,(()=>{I.onRefresh()}))}}catch(a){u(f(a,"message",""))}finally{o.hide()}return}const{message:e}=await d(ne());_(e)&&I.onOpenLog(e.result),I.onRefresh()}}),(e,l)=>{const t=v,n=h,s=g,i=S,d=x,u=w,o=b,c=L,_=k,m=y,f=p,A=r;return O(),E("div",a,[N(f,{ref_key:"formRef",ref:K,model:q(Q),rules:te,"label-width":"150px"},{default:F((()=>[N(i,{label:e.$t("Waf.Setting.config_67"),path:"verify_method"},{default:F((()=>[N(s,{value:q(Q).auth_type,"onUpdate:value":l[0]||(l[0]=e=>q(Q).auth_type=e)},{default:F((()=>[N(n,null,{default:F((()=>[N(t,{value:"dns"},{default:F((()=>[C(H(e.$t("SSL.index_12")),1)])),_:1}),N(t,{value:"http"},{default:F((()=>[C(H(e.$t("SSL.SiteSSL.index_17")),1)])),_:1})])),_:1})])),_:1},8,["value"])])),_:1},8,["label"]),"dns"===q(Q).auth_type?(O(),E("div",W,[N(i,{label:" "},{default:F((()=>[N(d,{checked:q(Q).dns_manual,"onUpdate:checked":l[1]||(l[1]=e=>q(Q).dns_manual=e),"checked-value":1,"unchecked-value":0},{default:F((()=>[C(H(e.$t("SSL.index_2")),1)])),_:1},8,["checked"])])),_:1}),N(i,{label:e.$t("SSL.index_13"),path:"type"},{default:F((()=>[N(u,{class:"w-300px",value:q(Q).type,"onUpdate:value":[l[2]||(l[2]=e=>q(Q).type=e),ee],options:q(T)},null,8,["value","options"])])),_:1},8,["label"]),"single"===q(Q).type?(O(),J(i,{key:0,label:" ",path:"domains"},{default:F((()=>[N(o,{"input-props":{spellcheck:!1},class:"w-300px!",value:q(Q).domains,"onUpdate:value":l[3]||(l[3]=e=>q(Q).domains=e),placeholder:"aapanel.com"},null,8,["value"])])),_:1})):M("",!0),"wildcard"===q(Q).type?(O(),J(i,{key:1,label:" ",path:"domains"},{default:F((()=>[N(o,{"input-props":{spellcheck:!1},type:"textarea",class:"w-300px!",value:q(Q).domains,"onUpdate:value":l[4]||(l[4]=e=>q(Q).domains=e),placeholder:e.$t("SSL.index_14")},null,8,["value","placeholder"])])),_:1})):M("",!0),"wildcard_all"===q(Q).type?(O(),J(i,{key:2,label:" ",path:"domains"},{default:F((()=>[N(o,{"input-props":{spellcheck:!1},type:"textarea",class:"w-300px!",value:q(Q).domains,"onUpdate:value":l[5]||(l[5]=e=>q(Q).domains=e),placeholder:"*.aapanel.com"},null,8,["value"])])),_:1})):M("",!0)])):M("",!0),"http"===q(Q).auth_type?(O(),E("div",D,[N(i,{label:e.$t("Home.index_68")},{default:F((()=>[N(u,{class:"w-300px",value:q(Q).site,"onUpdate:value":[l[6]||(l[6]=e=>q(Q).site=e),ae],options:q(X)},null,8,["value","options"])])),_:1},8,["label"]),N(i,{label:e.$t("Mail.Bcc.index_6"),path:"domains_list"},{default:F((()=>[N(m,{show:q(se),class:"p-12px w-300px max-h-300px min-h-100px overflow-auto border border-solid border-#ccc"},{default:F((()=>[N(d,{class:"mb-12px",checked:q(Q).all,"onUpdate:checked":l[7]||(l[7]=e=>q(Q).all=e),label:e.$t("Public.SelectAll"),indeterminate:q(le)},null,8,["checked","label","indeterminate"]),N(_,{value:q(Q).domains_list,"onUpdate:value":l[8]||(l[8]=e=>q(Q).domains_list=e)},{default:F((()=>[N(c,{class:"flex-col!",size:12},{default:F((()=>[(O(!0),E(P,null,B(q(Y),(e=>(O(),J(d,{key:e.name,value:e.name,label:e.name},null,8,["value","label"])))),128))])),_:1})])),_:1},8,["value"])])),_:1},8,["show"])])),_:1},8,["label"])])):M("",!0)])),_:1},8,["model"]),N(A,{class:"mt-16px"},{default:F((()=>[V("li",null,H(e.$t("SSL.index_15")),1),l[9]||(l[9]=V("li",null,"Manually resolved certificates do not support auto-renewal",-1)),V("li",null,H(e.$t("SSL.index_16")),1)])),_:1})])}}}))}}}));
