System.register(["./public-legacy.js?v=1747989938512","./index-legacy103.js?v=1747989938512","./index-legacy.js?v=1747989938512","./page_layout-legacy.js?v=1747989938512","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1747989938512","./vue-legacy.js?v=1747989938512","./naive-legacy.js?v=1747989938512","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1747989938512","./index.vue_vue_type_script_setup_true_lang-legacy8.js?v=1747989938512","./common-legacy.js?v=1747989938512","./__commonjsHelpers__-legacy.js?v=1747989938512","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1747989938512"],(function(e,t){"use strict";var a,s,n,i,l,o,c,u,r,d,p,y,_,g,m,x,v,h,w,f,k,b,S,I,A,j,C,$,O,P,U,q,R,z,M,T,L,F,K,W,E,H,N,B,D,V,G,J,Q,X,Y,Z,ee,te,ae,se,ne,ie;return{setters:[e=>{a=e.c,s=e.d,n=e.h,i=e.e,l=e.K,o=e.f,c=e._,u=e.a,r=e.b,d=e.F},e=>{p=e._},e=>{y=e._},e=>{_=e.i,g=e.t,m=e.a4,x=e.N,v=e.cC,h=e.m,w=e.c,f=e.b3,k=e._,b=e.p,S=e.u,I=e.q},e=>{A=e._},e=>{j=e.d,C=e.O,$=e.r,O=e.n,P=e.j,U=e.R,q=e.S,R=e.P,z=e.a1,M=e.U,T=e.a2,L=e.V,F=e.aj,K=e._,W=e.w,E=e.F,H=e.c,N=e.a0,B=e.N,D=e.ak,V=e.k,G=e.v,J=e.e},e=>{Q=e.cp,X=e.bU,Y=e._,Z=e.cj,ee=e.T,te=e.bA,ae=e.cm,se=e.c0},e=>{ne=e._},e=>{ie=e._},null,null,null],execute:function(){var t=document.createElement("style");t.textContent=".ul-style[data-v-f9cef105]{margin:0 auto;display:flex;align-items:center;justify-content:center;gap:48px;font-size:16px}.ul-style li[data-v-f9cef105]{display:flex;align-items:center}.item[data-v-f9cef105]{border-left:3px solid #def2e2}.item li[data-v-f9cef105]{width:180px;margin-left:-3px;font-size:14px;line-height:36px;padding:0 20px;cursor:pointer}.item .active[data-v-f9cef105]{border-left:3px solid #20a53a;color:#20a53a;font-weight:700;font-size:16px}\n",document.head.appendChild(t);const{t:le}=_.global,oe=e=>g.post("/plugin?action=a&name=bt_security&s=start_user_security",e,{requestOptions:{loading:le("Security.Api.Index_1"),successMessage:!0}}),ce=e=>g.post("/plugin?action=a&name=bt_security&s=stop_user_security",e,{requestOptions:{loading:le("Security.Api.Index_2"),successMessage:!0}}),ue=e=>g.post("/plugin?action=a&name=bt_security&s=start_user_log",e,{requestOptions:{loading:le("Security.Api.Index_1"),successMessage:!0}}),re=e=>g.post("/plugin?action=a&name=bt_security&s=stop_user_log",e,{requestOptions:{loading:le("Security.Api.Index_2"),successMessage:!0}}),de=e=>g.post("/plugin?action=a&name=bt_security&s=get_logs_list",e,{requestOptions:{loading:le("Site.Api.Index_10"),successMessage:!1}}),pe=e=>g.post("/plugin?action=a&name=bt_security&s=del_porcess_log",e,{requestOptions:{loading:le("Security.Api.Index_3"),successMessage:!0}}),ye=e=>g.post("/plugin?action=a&name=bt_security&s=add_porcess_log",e,{requestOptions:{loading:le("Security.Api.Index_4"),successMessage:!0}}),_e={class:"p-20px"},ge=j({__name:"log",props:{data:{}},setup(e,{expose:t}){const{t:i}=C(),l=e,{date:o,name:c}=l.data,u=$([]),{keys:r,table:d,columns:p}=a([{key:"log",title:i("Ftp.Analysis.Index_27"),render:()=>c},{key:"cwd",title:i("Security.Anti.Index_46")},{key:"cmd",title:i("Security.Anti.Index_47")},{key:"filename",title:i("Security.Anti.Index_48")},{key:"cwd",title:i("Config.Safe.index_152"),render:e=>m(e.timestamp)}]);O((()=>{u.value=o.map((e=>({label:e,value:e})))}));const y=P({p:1,num:999,day:o[0]}),{loading:_,setLoading:v}=s(),h=async()=>{try{v(!0);const{message:t}=await(e={...y,user:c},g.post("/plugin?action=a&name=bt_security&s=get_user_log",e));x(t)&&(d.data=t,d.total=t.length)}finally{r.value=[],v(!1)}var e};return h(),t({init:h}),(e,t)=>{const a=Q,s=X,i=n,l=A;return U(),q("div",_e,[R(s,{class:"flex-nowrap! items-center mb-10px"},{default:z((()=>[M("span",null,T(e.$t("Security.Anti.Index_45")),1),R(a,{class:"w-150px",value:L(y).day,"onUpdate:value":[t[0]||(t[0]=e=>L(y).day=e),h],options:L(u)},null,8,["value","options"])])),_:1}),R(l,null,{table:z((()=>[R(i,{"checked-row-keys":L(r),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>F(r)?r.value=e:null),loading:L(_),data:L(d).data,"max-height":350,columns:L(p)},null,8,["checked-row-keys","loading","data","columns"])])),_:1})])}}}),me=j({__name:"index",setup(e,{expose:t}){const{t:u}=C(),r=v(),{antiForm:d}=K(r),p=i(),{keys:_,table:m,columns:f}=a([{key:"user",title:u("Ftp.Analysis.Index_27")},{key:"total",title:u("Security.Anti.Index_7")},{key:"today",title:u("Public.Search.Today")},l({key:"protection",title:u("Security.Tabs.Index_8"),minWidth:60,onClick:async(e,t)=>{e?await oe({user:t.user}):await ce({user:t.user})}}),l({key:"log",title:u("Security.Anti.Index_8"),minWidth:60,onClick:async(e,t)=>{e?await ue({uid:t.uid}):await re({uid:t.uid})}}),{key:"remark",title:u("Site.Proxy.index_3")},o({width:130,title:u("Public.Table.Operation"),options:e=>[{label:u("Site.Proxy.index_51"),onClick:async()=>{const{message:t}=await de({user:e.user});!x(t)||t.length?(p.title=`[${e.user}] - ${u("Site.Proxy.index_51")}`,p.data.date=t,p.data.name=e.user,p.show=!0):h.error(u("Security.Anti.Index_44"))}}]})]);W((()=>r.isRefresh),(e=>{e&&(r.setRefresh(!1),S())}));const{loading:k,setLoading:b}=s(),S=async()=>{try{b(!0);const{message:e}=await g.post("/plugin?action=a&name=bt_security&s=get_total_all");w(e)&&(d.value.switch=e.open,d.value.times=e.totla_times,d.value.days=e.totla_days,m.data=e.system_user.map((e=>({user:e[0],total:e[4].totla,today:e[4].day_totla,protection:e[3],log:e[5],remark:e[6],uid:e[1]}))))}finally{_.value=[],b(!1)}};return S(),t({init:S}),(e,t)=>{const a=n,s=c,i=y;return U(),q(E,null,[R(a,{"checked-row-keys":L(_),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>F(_)?_.value=e:null),"row-key":"user","max-height":750,loading:L(k),data:L(m).data,columns:L(f)},null,8,["checked-row-keys","loading","data","columns"]),R(s,{class:"mt-16px"},{default:z((()=>[M("li",null,T(e.$t("Security.Anti.Index_4")),1),M("li",null,T(e.$t("Security.Anti.Index_5")),1),M("li",null,T(e.$t("Security.Anti.Index_6")),1)])),_:1}),R(i,{show:L(p).show,"onUpdate:show":t[1]||(t[1]=e=>L(p).show=e),title:L(p).title,data:L(p).data,width:750,"min-height":268,footer:!1,component:ge},null,8,["show","title","data"])],64)}}}),xe={class:"p-20px"},ve={class:"w-280px"},he={class:"color-#ff3333"},we=j({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=C(),s=e,{getList:n}=s.data,i=$(null),l=P({name:""}),o={name:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{await(i.value?.validate()),await ye({cmd:l.name}),n?.(),e()}}),(e,t)=>{const a=Y,s=Z,n=ne,u=c;return U(),q("div",xe,[R(n,{ref_key:"formRef",ref:i,model:L(l),rules:o},{default:z((()=>[R(s,{label:e.$t("Home.index_24"),path:"name"},{default:z((()=>[M("div",ve,[R(a,{type:"text",value:L(l).name,"onUpdate:value":t[0]||(t[0]=e=>L(l).name=e),placeholder:"e.g:/bin/bash"},null,8,["value"])])])),_:1},8,["label"])])),_:1},8,["model"]),R(u,{class:"mt-4px"},{default:z((()=>[M("li",he,T(e.$t("Security.Anti.Index_9")),1)])),_:1})])}}}),fe=j({__name:"index",setup(e,{expose:t}){const{t:l}=C(),{loading:c,setLoading:r}=s(),{keys:d,table:p,columns:_}=a([{key:"whitelist",title:l("Security.Anti.Index_11")},o({width:130,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{u({title:`${l("Security.Anti.Index_12")} [${e.whitelist}]`,content:l("Security.Anti.Index_13"),onConfirm:async({hide:t})=>{await pe({cmd:e.whitelist}),m(),t()}})}}]})]),m=async()=>{try{r(!0);const{message:e}=await g.post("/plugin?action=a&name=bt_security&s=porcess_set_up_log");x(e)&&(p.data=e.map((e=>({whitelist:e}))))}finally{d.value=[],r(!1)}};m(),t({init:m});const v=()=>{h.show=!0},h=i(l("Security.Anti.Index_10"),{getList:m});return(e,t)=>{const a=ee,s=n,i=A,l=y;return U(),q("div",null,[R(i,null,{toolsLeft:z((()=>[R(a,{type:"primary",onClick:v},{default:z((()=>[H(T(e.$t("Security.Anti.Index_10")),1)])),_:1})])),table:z((()=>[R(s,{"checked-row-keys":L(d),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>F(d)?d.value=e:null),"row-key":"whitelist",loading:L(c),"max-height":440,data:L(p).data,columns:L(_)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),R(l,{show:L(h).show,"onUpdate:show":t[1]||(t[1]=e=>L(h).show=e),title:L(h).title,data:L(h).data,width:480,footer:!0,component:we},null,8,["show","title","data"])])}}}),ke=j({__name:"index",setup(e,{expose:t}){const{t:i}=C(),{keys:l,table:o,columns:c}=a([{key:"log",title:i("Public.Table.Operation")},{key:"addtime",align:"right",title:i("Site.Cert.index_68")}]),u=P({p:1,limit:10}),{loading:r,setLoading:d}=s(),p=async()=>{try{d(!0);const{message:t}=await(e=u,g.post("/plugin?action=a&name=bt_security&s=get_log",e));w(t)&&(o.data=t.data,o.total=f(t.page))}finally{l.value=[],d(!1)}var e};return p(),t({init:p}),(e,t)=>{const a=n,s=ie,i=A;return U(),N(i,{feedback:!0},{table:z((()=>[R(a,{"checked-row-keys":L(l),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>F(l)?l.value=e:null),"row-key":"log",loading:L(r),data:L(o).data,columns:L(c)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:z((()=>[R(s,{page:L(u).p,"onUpdate:page":t[1]||(t[1]=e=>L(u).p=e),"page-size":L(u).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>L(u).limit=e),"item-count":L(o).total,"store-key":"security-anti",onRefresh:p},null,8,["page","page-size","item-count"])])),_:1})}}}),be=j({__name:"index",setup(e){const{t:t}=C(),a=$("overview"),s=[{key:"overview",label:t("Security.Tabs.Index_5"),component:me},{key:"whitelist",label:t("Security.Tabs.Index_6"),component:fe},{key:"operation",label:t("Security.Tabs.Index_7"),component:ke}];return(e,t)=>{const n=p;return U(),N(n,{value:L(a),"onUpdate:value":t[0]||(t[0]=e=>F(a)?a.value=e:null),options:s},null,8,["value"])}}}),Se={class:"pt-40px pb-40px"},Ie={class:"mb-16px"},Ae={class:"ul-style"},je={class:"text-center my-24px"},Ce={class:"flex justify-center"},$e={class:"item"},Oe=["onClick"],Pe=b(j({__name:"conversion",setup(e){const t=$(0),a=["Overview","Process whitelist","Operation logs"],s=()=>{r({source:105})};return(e,n)=>{const i=k,l=ee,o=te,c=ae;return U(),N(c,null,{default:z((()=>[M("div",Se,[n[3]||(n[3]=M("div",{class:"mb-24px text-center text-22px font-bold"},"Anti Intrusion prevention features",-1)),M("div",Ie,[M("ul",Ae,[M("li",null,[R(i,{name:"security-lixian",size:"22"}),n[0]||(n[0]=M("span",{class:"ml-4px"},"Prevents the program from hanging",-1))]),M("li",null,[R(i,{name:"security-sanfang",size:"20"}),n[1]||(n[1]=M("span",{class:"ml-4px"},"Stop the mining virus",-1))]),M("li",null,[R(i,{name:"security-webshell",size:"26"}),n[2]||(n[2]=M("span",null,"Prevent Privilege Escalation Attacks",-1))])])]),M("div",je,[R(l,{type:"primary",class:"h-36px text-14px",onClick:s},{default:z((()=>[H(T(e.$t("WP.Transition.index_7")),1)])),_:1})]),M("div",Ce,[M("div",$e,[M("ul",null,[(U(),q(E,null,B(a,((e,a)=>M("li",{class:D({active:L(t)==a}),key:a,onClick:e=>t.value=a},T(e),11,Oe))),64))])]),V(R(o,{width:"100%",src:L("/static/vite/images/overview2.png")},null,8,["src"]),[[G,0==L(t)]]),V(R(o,{width:"100%",src:L("/static/vite/images/whitelist.png")},null,8,["src"]),[[G,1==L(t)]]),V(R(o,{width:"100%",src:L("/static/vite/images/logs.png")},null,8,["src"]),[[G,2==L(t)]])])])])),_:1})}}}),[["__scopeId","data-v-f9cef105"]]),Ue={key:0};e("default",j({__name:"index",setup(e){const t=S(),{isPro:a}=K(t),s=v(),{antiForm:n}=K(s),i=$(n.value.switch),l=J((()=>n.value.switch));W(l,(e=>{i.value=e}));const o=J((()=>n.value.times)),c=J((()=>n.value.days)),u=async e=>{e?await g.post("/plugin?action=a&name=bt_security&s=start_bt_security",{},{requestOptions:{loading:le("Security.Api.Index_1"),successMessage:!0}}):await g.post("/plugin?action=a&name=bt_security&s=stop_bt_security",{},{requestOptions:{loading:le("Security.Api.Index_2"),successMessage:!0}}),await s.setRefresh(!0)};return(async()=>{a.value&&await d("bt_security")})(),(e,t)=>{const s=se,n=I,l=X,r=ae;return L(a)?(U(),q("div",Ue,[R(r,{class:"my-15px"},{default:z((()=>[R(l,{class:"p-15px items-center"},{default:z((()=>[M("span",null,T(e.$t("Security.Anti.Index_1")),1),R(s,{value:L(i),"onUpdate:value":[t[0]||(t[0]=e=>F(i)?i.value=e:null),u],"rubber-band":!1,size:"small"},null,8,["value"]),R(n,{vertical:""}),M("span",null,T(e.$t("Security.Anti.Index_2"))+": "+T(L(o)),1),R(n,{vertical:""}),M("span",null,T(e.$t("Security.Anti.Index_3"))+": "+T(L(c)),1)])),_:1})])),_:1}),R(r,{class:"p-15px"},{default:z((()=>[R(be)])),_:1})])):(U(),N(Pe,{key:1}))}}}))}}}));
