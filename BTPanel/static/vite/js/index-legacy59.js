System.register(["./public-legacy.js?v=1741416570306","./index-legacy104.js?v=1741416570306","./index-legacy.js?v=1741416570306","./index-legacy95.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1741416570306","./page_layout-legacy.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy4.js?v=1741416570306","./vue-legacy.js?v=1741416570306","./naive-legacy.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1741416570306","./common-legacy.js?v=1741416570306","./__commonjsHelpers__-legacy.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy8.js?v=1741416570306"],(function(e,t){"use strict";var a,s,n,i,l,o,u,c,r,d,p,y,_,g,m,x,v,h,w,b,k,f,S,I,A,j,$,C,O,P,U,z,R,q,M,T,L,F,K,W,B,E,G,H,D,N,Q,V,Y,Z,J,X,ee,te,ae,se,ne,ie;return{setters:[e=>{a=e.b,s=e.c,n=e.d,i=e.G,l=e.f,o=e.a,u=e.e,c=e.B},e=>{r=e._},e=>{d=e._},e=>{p=e._},e=>{y=e._},e=>{_=e.d,g=e.az,m=e.U,x=e.G,v=e.bZ,h=e.m,w=e.b,b=e.av,k=e._,f=e.k,S=e.u,I=e.l},e=>{A=e._},e=>{j=e.d,$=e.M,C=e.r,O=e.n,P=e.j,U=e.P,z=e.Q,R=e.N,q=e.$,M=e.R,T=e.a0,L=e.S,F=e.ae,K=e.Y,W=e.w,B=e.F,E=e.c,G=e._,H=e.L,D=e.af,N=e.k,Q=e.v,V=e.e},e=>{Y=e.ch,Z=e.bO,J=e._,X=e.cb,ee=e.T,te=e.bu,ae=e.ce,se=e.bV},e=>{ne=e._},e=>{ie=e._},null,null,null],execute:function(){var t=document.createElement("style");t.textContent=".ul-style[data-v-e7a4054e]{margin:0 auto;display:flex;align-items:center;justify-content:center;gap:48px;font-size:16px}.ul-style li[data-v-e7a4054e]{display:flex;align-items:center}.item[data-v-e7a4054e]{border-left:3px solid #def2e2}.item li[data-v-e7a4054e]{width:180px;margin-left:-3px;font-size:14px;line-height:36px;padding:0 20px;cursor:pointer}.item .active[data-v-e7a4054e]{border-left:3px solid #20a53a;color:#20a53a;font-weight:700;font-size:16px}\n",document.head.appendChild(t);const{t:le}=_.global,oe=e=>g.post("/plugin?action=a&name=bt_security&s=start_user_security",e,{requestOptions:{loading:le("Security.Api.Index_1"),successMessage:!0}}),ue=e=>g.post("/plugin?action=a&name=bt_security&s=stop_user_security",e,{requestOptions:{loading:le("Security.Api.Index_2"),successMessage:!0}}),ce=e=>g.post("/plugin?action=a&name=bt_security&s=start_user_log",e,{requestOptions:{loading:le("Security.Api.Index_1"),successMessage:!0}}),re=e=>g.post("/plugin?action=a&name=bt_security&s=stop_user_log",e,{requestOptions:{loading:le("Security.Api.Index_2"),successMessage:!0}}),de=e=>g.post("/plugin?action=a&name=bt_security&s=get_logs_list",e,{requestOptions:{loading:le("Site.Api.Index_10"),successMessage:!1}}),pe=e=>g.post("/plugin?action=a&name=bt_security&s=del_porcess_log",e,{requestOptions:{loading:le("Security.Api.Index_3"),successMessage:!0}}),ye=e=>g.post("/plugin?action=a&name=bt_security&s=add_porcess_log",e,{requestOptions:{loading:le("Security.Api.Index_4"),successMessage:!0}}),_e={class:"p-20px"},ge=j({__name:"log",props:{data:{}},setup(e,{expose:t}){const{t:n}=$(),i=e,{date:l,name:o}=i.data,u=C([]),{keys:c,table:r,columns:d}=a([{key:"log",title:n("Ftp.Analysis.Index_27"),render:()=>o},{key:"cwd",title:n("Security.Anti.Index_46")},{key:"cmd",title:n("Security.Anti.Index_47")},{key:"filename",title:n("Security.Anti.Index_48")},{key:"cwd",title:n("Config.Safe.index_152"),render:e=>m(e.timestamp)}]);O((()=>{u.value=l.map((e=>({label:e,value:e})))}));const p=P({p:1,num:999,day:l[0]}),{loading:_,setLoading:v}=s(),h=async()=>{try{v(!0);const{message:t}=await(e={...p,user:o},g.post("/plugin?action=a&name=bt_security&s=get_user_log",e));x(t)&&(r.data=t,r.total=t.length)}finally{c.value=[],v(!1)}var e};return h(),t({init:h}),(e,t)=>{const a=Y,s=Z,n=y,i=A;return U(),z("div",_e,[R(s,{class:"flex-nowrap! items-center mb-10px"},{default:q((()=>[M("span",null,T(e.$t("Security.Anti.Index_45")),1),R(a,{class:"w-150px",value:L(p).day,"onUpdate:value":[t[0]||(t[0]=e=>L(p).day=e),h],options:L(u)},null,8,["value","options"])])),_:1}),R(i,null,{table:q((()=>[R(n,{"checked-row-keys":L(c),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>F(c)?c.value=e:null),loading:L(_),data:L(r).data,"max-height":350,columns:L(d)},null,8,["checked-row-keys","loading","data","columns"])])),_:1})])}}}),me=j({__name:"index",setup(e,{expose:t}){const{t:o}=$(),u=v(),{antiForm:c}=K(u),r=n(),{keys:_,table:m,columns:b}=a([{key:"user",title:o("Ftp.Analysis.Index_27")},{key:"total",title:o("Security.Anti.Index_7")},{key:"today",title:o("Public.Search.Today")},i({key:"protection",title:o("Security.Tabs.Index_8"),minWidth:60,onClick:async(e,t)=>{e?await oe({user:t.user}):await ue({user:t.user})}}),i({key:"log",title:o("Security.Anti.Index_8"),minWidth:60,onClick:async(e,t)=>{e?await ce({uid:t.uid}):await re({uid:t.uid})}}),{key:"remark",title:o("Site.Proxy.index_3")},l({width:130,title:o("Public.Table.Operation"),options:e=>[{label:o("Site.Proxy.index_51"),onClick:async()=>{const{message:t}=await de({user:e.user});!x(t)||t.length?(r.title=`[${e.user}] - ${o("Site.Proxy.index_51")}`,r.data.date=t,r.data.name=e.user,r.show=!0):h.error(o("Security.Anti.Index_44"))}}]})]);W((()=>u.isRefresh),(e=>{e&&(u.setRefresh(!1),S())}));const{loading:k,setLoading:f}=s(),S=async()=>{try{f(!0);const{message:e}=await g.post("/plugin?action=a&name=bt_security&s=get_total_all");w(e)&&(c.value.switch=e.open,c.value.times=e.totla_times,c.value.days=e.totla_days,m.data=e.system_user.map((e=>({user:e[0],total:e[4].totla,today:e[4].day_totla,protection:e[3],log:e[5],remark:e[6],uid:e[1]}))))}finally{_.value=[],f(!1)}};return S(),t({init:S}),(e,t)=>{const a=y,s=p,n=d;return U(),z(B,null,[R(a,{"checked-row-keys":L(_),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>F(_)?_.value=e:null),"row-key":"user","max-height":750,loading:L(k),data:L(m).data,columns:L(b)},null,8,["checked-row-keys","loading","data","columns"]),R(s,{class:"mt-16px"},{default:q((()=>[M("li",null,T(e.$t("Security.Anti.Index_4")),1),M("li",null,T(e.$t("Security.Anti.Index_5")),1),M("li",null,T(e.$t("Security.Anti.Index_6")),1)])),_:1}),R(n,{show:L(r).show,"onUpdate:show":t[1]||(t[1]=e=>L(r).show=e),title:L(r).title,data:L(r).data,width:750,"min-height":268,footer:!1,component:ge},null,8,["show","title","data"])],64)}}}),xe={class:"p-20px"},ve={class:"w-280px"},he={class:"color-#ff3333"},we=j({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=$(),s=e,{getList:n}=s.data,i=C(null),l=P({name:""}),o={name:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{await(i.value?.validate()),await ye({cmd:l.name}),n?.(),e()}}),(e,t)=>{const a=J,s=X,n=ne,u=p;return U(),z("div",xe,[R(n,{ref_key:"formRef",ref:i,model:L(l),rules:o},{default:q((()=>[R(s,{label:e.$t("Home.index_24"),path:"name"},{default:q((()=>[M("div",ve,[R(a,{type:"text",value:L(l).name,"onUpdate:value":t[0]||(t[0]=e=>L(l).name=e),placeholder:"e.g:/bin/bash"},null,8,["value"])])])),_:1},8,["label"])])),_:1},8,["model"]),R(u,{class:"mt-4px"},{default:q((()=>[M("li",he,T(e.$t("Security.Anti.Index_9")),1)])),_:1})])}}}),be=j({__name:"index",setup(e,{expose:t}){const{t:i}=$(),{loading:u,setLoading:c}=s(),{keys:r,table:p,columns:_}=a([{key:"whitelist",title:i("Security.Anti.Index_11")},l({width:130,options:e=>[{label:i("Public.Btn.Del"),onClick:()=>{o({title:`${i("Security.Anti.Index_12")} [${e.whitelist}]`,content:i("Security.Anti.Index_13"),onConfirm:async({hide:t})=>{await pe({cmd:e.whitelist}),m(),t()}})}}]})]),m=async()=>{try{c(!0);const{message:e}=await g.post("/plugin?action=a&name=bt_security&s=porcess_set_up_log");x(e)&&(p.data=e.map((e=>({whitelist:e}))))}finally{r.value=[],c(!1)}};m(),t({init:m});const v=()=>{h.show=!0},h=n(i("Security.Anti.Index_10"),{getList:m});return(e,t)=>{const a=ee,s=y,n=A,i=d;return U(),z("div",null,[R(n,null,{toolsLeft:q((()=>[R(a,{type:"primary",onClick:v},{default:q((()=>[E(T(e.$t("Security.Anti.Index_10")),1)])),_:1})])),table:q((()=>[R(s,{"checked-row-keys":L(r),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>F(r)?r.value=e:null),"row-key":"whitelist",loading:L(u),"max-height":440,data:L(p).data,columns:L(_)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),R(i,{show:L(h).show,"onUpdate:show":t[1]||(t[1]=e=>L(h).show=e),title:L(h).title,data:L(h).data,width:480,footer:!0,component:we},null,8,["show","title","data"])])}}}),ke=j({__name:"index",setup(e,{expose:t}){const{t:n}=$(),{keys:i,table:l,columns:o}=a([{key:"log",title:n("Public.Table.Operation")},{key:"addtime",align:"right",title:n("Site.Cert.index_68")}]),u=P({p:1,limit:10}),{loading:c,setLoading:r}=s(),d=async()=>{try{r(!0);const{message:t}=await(e=u,g.post("/plugin?action=a&name=bt_security&s=get_log",e));w(t)&&(l.data=t.data,l.total=b(t.page))}finally{i.value=[],r(!1)}var e};return d(),t({init:d}),(e,t)=>{const a=y,s=ie,n=A;return U(),G(n,{feedback:!0},{table:q((()=>[R(a,{"checked-row-keys":L(i),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>F(i)?i.value=e:null),"row-key":"log",loading:L(c),data:L(l).data,columns:L(o)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:q((()=>[R(s,{page:L(u).p,"onUpdate:page":t[1]||(t[1]=e=>L(u).p=e),"page-size":L(u).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>L(u).limit=e),"item-count":L(l).total,"store-key":"security-anti",onRefresh:d},null,8,["page","page-size","item-count"])])),_:1})}}}),fe=j({__name:"index",setup(e){const{t:t}=$(),a=C("overview"),s=[{key:"overview",label:t("Security.Tabs.Index_5"),component:me},{key:"whitelist",label:t("Security.Tabs.Index_6"),component:be},{key:"operation",label:t("Security.Tabs.Index_7"),component:ke}];return(e,t)=>{const n=r;return U(),G(n,{value:L(a),"onUpdate:value":t[0]||(t[0]=e=>F(a)?a.value=e:null),options:s},null,8,["value"])}}}),Se={class:"pt-40px pb-40px"},Ie={class:"mb-16px"},Ae={class:"ul-style"},je={class:"text-center my-24px"},$e={class:"flex justify-center"},Ce={class:"item"},Oe=["onClick"],Pe=f(j({__name:"conversion",setup(e){const t=C(0),a=["Overview","Process whitelist","Operation logs"],s=()=>{u({source:105})};return(e,n)=>{const i=k,l=ee,o=te,u=ae;return U(),G(u,null,{default:q((()=>[M("div",Se,[n[3]||(n[3]=M("div",{class:"mb-24px text-center text-22px font-bold"},"Anti Intrusion prevention features",-1)),M("div",Ie,[M("ul",Ae,[M("li",null,[R(i,{name:"security-lixian",size:"22"}),n[0]||(n[0]=M("span",{class:"ml-4px"},"Prevents the program from hanging",-1))]),M("li",null,[R(i,{name:"security-sanfang",size:"20"}),n[1]||(n[1]=M("span",{class:"ml-4px"},"Stop the mining virus",-1))]),M("li",null,[R(i,{name:"security-webshell",size:"26"}),n[2]||(n[2]=M("span",null,"Prevent Privilege Escalation Attacks",-1))])])]),M("div",je,[R(l,{type:"primary",class:"h-36px text-14px",onClick:s},{default:q((()=>[E(T(e.$t("WP.Transition.index_7")),1)])),_:1})]),M("div",$e,[M("div",Ce,[M("ul",null,[(U(),z(B,null,H(a,((e,a)=>M("li",{class:D({active:L(t)==a}),key:a,onClick:e=>t.value=a},T(e),11,Oe))),64))])]),N(R(o,{width:"100%",src:L("/static/vite/images/overview2.png")},null,8,["src"]),[[Q,0==L(t)]]),N(R(o,{width:"100%",src:L("/static/vite/images/whitelist.png")},null,8,["src"]),[[Q,1==L(t)]]),N(R(o,{width:"100%",src:L("/static/vite/images/logs.png")},null,8,["src"]),[[Q,2==L(t)]])])])])),_:1})}}}),[["__scopeId","data-v-e7a4054e"]]),Ue={key:0};e("default",j({__name:"index",setup(e){const t=S(),{isPro:a}=K(t),s=v(),{antiForm:n}=K(s),i=C(n.value.switch),l=V((()=>n.value.switch));W(l,(e=>{i.value=e}));const o=V((()=>n.value.times)),u=V((()=>n.value.days)),r=async e=>{e?await g.post("/plugin?action=a&name=bt_security&s=start_bt_security",{},{requestOptions:{loading:le("Security.Api.Index_1"),successMessage:!0}}):await g.post("/plugin?action=a&name=bt_security&s=stop_bt_security",{},{requestOptions:{loading:le("Security.Api.Index_2"),successMessage:!0}}),await s.setRefresh(!0)};return(async()=>{a.value&&await c("bt_security")})(),(e,t)=>{const s=se,n=I,l=Z,c=ae;return L(a)?(U(),z("div",Ue,[R(c,{class:"my-15px"},{default:q((()=>[R(l,{class:"p-15px items-center"},{default:q((()=>[M("span",null,T(e.$t("Security.Anti.Index_1")),1),R(s,{value:L(i),"onUpdate:value":[t[0]||(t[0]=e=>F(i)?i.value=e:null),r],"rubber-band":!1,size:"small"},null,8,["value"]),R(n,{vertical:""}),M("span",null,T(e.$t("Security.Anti.Index_2"))+": "+T(L(o)),1),R(n,{vertical:""}),M("span",null,T(e.$t("Security.Anti.Index_3"))+": "+T(L(u)),1)])),_:1})])),_:1}),R(c,{class:"p-15px"},{default:q((()=>[R(fe)])),_:1})])):(U(),G(Pe,{key:1}))}}}))}}}));
