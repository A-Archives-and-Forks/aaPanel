const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/ssl-log.js?v=1756367574781","js/index105.js?v=1756367574781","js/page_layout.js?v=1756367574781","js/vue.js?v=1756367574781","js/__commonjsHelpers__.js?v=1756367574781","js/naive.js?v=1756367574781","js/common.js?v=1756367574781","js/public.js?v=1756367574781","css/public.css?v=1756367574781","css/page_layout.css?v=1756367574781","css/index19.css?v=1756367574781","js/index212.js?v=1756367574781","js/index.js?v=1756367574781","css/index107.css?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang8.js?v=1756367574781","css/index90.css?v=1756367574781","js/index213.js?v=1756367574781","js/index244.js?v=1756367574781","css/index59.css?v=1756367574781","css/index91.css?v=1756367574781","js/domain-verification.js?v=1756367574781"])))=>i.map(i=>d[i]);
import{dj as e,cr as t,o as a,R as s,a as n,m as i,d as l,p as o,_ as d,u as r,aT as u,w as c}from"./page_layout.js?v=1756367574781";import{_}from"./index.js?v=1756367574781";import{_ as p}from"./index108.js?v=1756367574781";import{c as m,s as S,a as h,g as f,b as v}from"./ssl.js?v=1756367574781";import{C as x}from"./cert.js?v=1756367574781";import{u as y}from"./index240.js?v=1756367574781";import{e as w,_ as L,a as g,ac as C,ad as b,a6 as k,c as $,f as j,a0 as P,a1 as E,a2 as R,h as B,n as D,d as O,ae as N,af as U,u as A,ag as I,ah as T,ai as z,j as M,q as F,a5 as V}from"./public.js?v=1756367574781";import{_ as H}from"./index99.js?v=1756367574781";import{dk as J,e2 as q,dc as G,dj as W,da as X,aC as K,dR as Q,dT as Y,dU as Z,_ as ee,eg as te,G as ae,d5 as se}from"./naive.js?v=1756367574781";import{k as ne,P as ie,r as le,c as oe,y as de,a2 as re,V as ue,a3 as ce,an as _e,W as pe,U as me,S as Se,a4 as he,j as fe,R as ve,ak as xe,_ as ye,F as we,O as Le,H as ge,a0 as Ce,e as be,am as ke,w as $e,o as je,l as Pe,v as Ee,m as Re,x as Be}from"./vue.js?v=1756367574781";import{_ as De}from"./index133.js?v=1756367574781";import{_ as Oe}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1756367574781";import{u as Ne}from"./utils3.js?v=1756367574781";import{A as Ue}from"./index217.js?v=1756367574781";import{_ as Ae}from"./index.vue_vue_type_script_setup_true_lang.js?v=1756367574781";import{a as Ie}from"./ssl-lets-progress.js?v=1756367574781";import{a1 as Te}from"./site.js?v=1756367574781";import"./common.js?v=1756367574781";import"./__commonjsHelpers__.js?v=1756367574781";import"./index244.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang12.js?v=1756367574781";import"./index100.js?v=1756367574781";import"./index101.js?v=1756367574781";import"./file.js?v=1756367574781";import"./theme-monokai.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang10.js?v=1756367574781";import"./index98.js?v=1756367574781";import"./index260.js?v=1756367574781";import"./new.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1756367574781";import"./soft.js?v=1756367574781";import"./index105.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1756367574781";import"./paypal-js.js?v=1756367574781";const ze={class:"cert-info"},Me={class:"cert-label"},Fe={class:"cert-value"},Ve={class:"cert-info"},He={class:"cert-label"},Je={class:"cert-value"},qe={class:"cert-info"},Ge={class:"cert-label"},We={class:"cert-value"},Xe={class:"cert-info"},Ke={class:"cert-label"},Qe={class:"cert-value"},Ye={key:0,class:"text-primary"},Ze={key:1,class:"text-error"},et={class:"cert-info"},tt={class:"cert-label"},at={class:"cert-value"},st={class:"w-48%"},nt={class:"mb-8px"},it={class:"w-48%"},lt={class:"mb-8px"},ot=o(ne({__name:"index",props:{info:{default:null},isRenew:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(o,{expose:d,emit:r}){const u=ye(()=>n(()=>import("./ssl-log.js?v=1756367574781"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),c=o,p=r,{t:f}=ie(),{data:v}=y(),$=w(f("SSL.index_43")),j=e(),P=le(-1),E=le(!1),R=le(!1),B=le(""),D=le("");let O="";const N=le("");let U="";const A=le({issuer:"",notAfter:"",notBefore:"",dns:[],subject:"",endtime:0}),I=oe(()=>P.value===x.LetsEncryptDeploy?f("Site.Cert.index_65"):P.value===x.BusinessDeploy?f("Site.Cert.index_64"):P.value===x.TestDeploy?f("Site.Cert.index_38"):f("Site.Cert.index_37")),T=oe(()=>!!N.value),z=oe(()=>c.isRenew||P.value===x.LetsEncryptDeploy),M=oe(()=>!1),F=oe(()=>E.value),V=async e=>{e?(await S({siteName:v.name}),p("refresh")):g({title:f("Site.Cert.index_12"),content:f("Site.Cert.index_13"),onConfirm:async()=>{await m({siteName:v.name}),p("refresh")},onPublicClose:()=>{R.value=!0}})},Q=()=>{""!==D.value.trim()&&""!==N.value.trim()?D.value!==O&&O||N.value!==U&&U?g({title:f("Site.Cert.index_10"),content:f("Site.Cert.index_11"),onConfirm:async()=>{await Y()}}):Y():i.error(f("Site.Cert.index_9"))},Y=async()=>{const{message:e}=await C({key:D.value,cert:N.value});l(e)&&e.hash&&(await b({hash:e.hash,domains:JSON.stringify([v.name]),append:1}),i.success(f("SSL.index_32"))),te()},Z=async()=>{var e;const{message:t}=await k({hash:(null==(e=c.info)?void 0:e.hash)||""});l(t)&&($.data.path=t.result,$.show=!0)},ee=async()=>{await h({updateOf:1,siteName:v.name}),te()},te=()=>{p("refresh"),j.setRefresh(!0)};return de(()=>{const{info:e}=c;e&&(P.value=e.type,E.value=e.status,R.value=e.httpTohttps,D.value=e.key||"",O=e.key||"",N.value=e.csr||"",U=e.csr||"",A.value=e.cert_data,B.value=e.index)}),d({init:p("refresh")}),(e,n)=>{const i=a,l=q,o=G,d=W,r=t,c=J,p=H,m=X,S=K,h=L,f=_,v=s;return ue(),re(v,{show:e.loading},{default:ce(()=>[me(T)?(ue(),re(c,{key:0,class:"mb-16px",type:"success","show-icon":!1},{default:ce(()=>[pe(r,{"x-gap":12,cols:"15"},{default:ce(()=>[pe(l,{span:"8"},{default:ce(()=>[Se("div",ze,[Se("div",Me,he(e.$t("Site.Cert.index_44"))+he(e.$t("Public.Punctuation.Colon")),1),Se("div",Fe,[pe(i,null,{default:ce(()=>[fe(he(me(I)),1)]),_:1})])])]),_:1}),pe(l,{span:"7"},{default:ce(()=>[Se("div",Ve,[Se("div",He,he(e.$t("Site.Cert.index_45"))+he(e.$t("Public.Punctuation.Colon")),1),Se("div",Je,[pe(o,null,{default:ce(()=>[fe(he(me(A).issuer||"other"),1)]),_:1})])])]),_:1}),pe(l,{span:"8"},{default:ce(()=>[Se("div",qe,[Se("div",Ge,he(e.$t("Site.Cert.index_46"))+he(e.$t("Public.Punctuation.Colon")),1),Se("div",We,[pe(o,null,{default:ce(()=>[fe(he(me(A).dns.join(e.$t("Public.Punctuation.Comma"))),1)]),_:1})])])]),_:1}),pe(l,{span:"7"},{default:ce(()=>[Se("div",Xe,[Se("div",Ke,he(e.$t("Site.Cert.index_47"))+he(e.$t("Public.Punctuation.Colon")),1),Se("div",Qe,[me(A).endtime>0?(ue(),ve("span",Ye,he(e.$t("Site.Cert.index_48",{date:me(A).notAfter,days:me(A).endtime})),1)):(ue(),ve("span",Ze,he(e.$t("Site.Cert.index_47")),1))])])]),_:1}),pe(l,{span:"8"},{default:ce(()=>[Se("div",et,[Se("div",tt,he(e.$t("Site.Cert.index_49"))+he(e.$t("Public.Punctuation.Colon")),1),Se("div",at,[pe(d,{value:me(R),"onUpdate:value":[n[0]||(n[0]=e=>xe(R)?R.value=e:null),V],size:"small"},null,8,["value"])])])]),_:1})]),_:1})]),_:1})):_e("",!0),pe(m,{class:"mb-16px",size:10,justify:"space-between"},{default:ce(()=>[Se("div",st,[Se("div",nt,he(e.$t("Site.Cert.index_50")),1),pe(p,{value:me(D),"onUpdate:value":n[1]||(n[1]=e=>xe(D)?D.value=e:null),rows:10},null,8,["value"])]),Se("div",it,[Se("div",lt,he(e.$t("Site.Cert.index_51")),1),pe(p,{value:me(N),"onUpdate:value":n[2]||(n[2]=e=>xe(N)?N.value=e:null),rows:10},null,8,["value"])])]),_:1}),pe(m,{class:"mb-12px"},{default:ce(()=>[pe(S,{type:"primary",onClick:Q},{default:ce(()=>[fe(he(me(E)?e.$t("Public.Btn.Save"):e.$t("Site.Cert.index_52")),1)]),_:1}),me(z)?(ue(),re(S,{key:0,type:"primary",onClick:Z},{default:ce(()=>[fe(he(e.$t("Site.Cert.index_53")),1)]),_:1})):_e("",!0),me(M)?(ue(),re(S,{key:1},{default:ce(()=>[fe(he(e.$t("Site.Cert.index_54")),1)]),_:1})):_e("",!0),me(F)?(ue(),re(S,{key:2,onClick:ee},{default:ce(()=>[fe(he(e.$t("Site.Cert.index_55")),1)]),_:1})):_e("",!0)]),_:1}),pe(h,null,{default:ce(()=>[Se("li",null,he(e.$t("Site.Cert.index_33")),1),Se("li",null,he(e.$t("Site.Cert.index_34")),1),Se("li",null,he(e.$t("Site.Cert.index_35")),1),Se("li",null,he(e.$t("Site.Cert.index_36")),1)]),_:1}),pe(f,{show:me($).show,"onUpdate:show":n[3]||(n[3]=e=>me($).show=e),title:me($).title,data:me($).data,width:650,"min-height":450,component:me(u)},null,8,["show","title","data","component"])]),_:1},8,["show"])}}}),[["__scopeId","data-v-28bba990"]]),dt={class:"business-top-tips flex flex-wrap border-#d6e9c6 border-1px rounded-5px p-12px"},rt={class:"text-#3c763d w-100%"},ut=o(ne({__name:"top-tips",setup(e){const{t:t}=ie(),a=[t("SSL.SiteSSL.index_5"),t("SSL.SiteSSL.index_6"),t("SSL.SiteSSL.index_7"),t("SSL.SiteSSL.index_8"),t("SSL.SiteSSL.index_9"),t("SSL.SiteSSL.index_10"),t("SSL.SiteSSL.index_11")];return(e,t)=>{const s=d,n=X;return ue(),ve("div",dt,[(ue(),ve(we,null,Le(a,(e,t)=>pe(n,{size:5,key:e,class:ge(["flex-nowrap! leading-20px",{"w-33%":t!==a.length-1}])},{default:ce(()=>[pe(s,{name:"base-tick",size:16,color:"#ff8d00"}),Se("span",rt,he(e),1)]),_:2},1032,["class"])),64))])}}}),[["__scopeId","data-v-12873ea8"]]),ct={class:"my-10px"},_t=ne({__name:"table",setup(t){const a=ye(()=>n(()=>import("./index212.js?v=1756367574781"),__vite__mapDeps([11,12,3,4,6,7,2,5,9,8,13,14,15,16]))),s=ye(()=>n(()=>import("./index213.js?v=1756367574781"),__vite__mapDeps([17,18,3,4,5,6,2,7,8,9,19,20]))),i=ye(()=>n(()=>import("./domain-verification.js?v=1756367574781"),__vite__mapDeps([21,2,3,4,5,6,7,8,9,14]))),o=r(),{userInfo:d}=Ce(o),u=e(),{t:c}=ie(),p=be({p:1,limit:9999}),m=w(c("SSL.Business.index_41"),{onRefresh:(e,t)=>{f.data.request=!0,f.data.uc_id=t,f.data.verify=e,f.show=!0,L()}}),S=w(c("SSL.index_44")),h=w(c("SSL.index_49"),{onRefresh:()=>{L(),u.setRefresh(!0)}}),f=w(c("SSL.Business.index_42"),{onRefresh:()=>{L()}}),{table:v,columns:x}=$([{key:"verify_domains",title:c("Layout.Sider.mail_3"),render:e=>pe("span",{innerHTML:e.verify_domains&&e.verify_domains.length>0?e.verify_domains.join("<br/>"):"--"},null)},{key:"title",title:c("Site.Cert.index_44"),render:e=>e.order_info.title,ellipsis:{tooltip:!0}},Ne({title:c("SSL.index_54")}),{key:"order_status",title:c("SSL.Business.index_43"),render:e=>{const t=e.order_info;return t.certId||t.domains.length?!t.certId&&t.domains.length?pe("span",{class:"color-warning"},[fe(" "),c("SSL.Business.index_45"),fe(" ")]):"PENDING"===t.order_status&&1===t.status?pe("span",{class:"color-warning"},[fe(" "),c("SSL.Business.index_46"),fe(" ")]):"COMPLETE"===t.order_status&&1===t.status?pe("span",{class:"color-#20a53a"},[fe(" "),c("SSL.Business.index_47"),fe(" ")]):"CANCELLED"===t.order_status&&1===t.status||-1===t.status?pe("span",{class:"color-warning"},[fe(" "),c("SSL.Business.index_48"),fe(" ")]):"FAILED"===t.order_status&&1===t.status?pe("span",{class:"color-error"},[fe(" "),c("SSL.Business.index_49"),fe(" ")]):"EXPIRED"===t.order_status&&1===t.status?pe("span",{class:"color-warning"},[fe(" "),c("SSL.Business.index_50"),fe(" ")]):1!==t.status||["PENDING","COMPLETE","CANCELLED","FAILED","EXPIRED"].includes(t.order_status)?0===t.status?pe("span",{class:"color-warning"},[fe(" "),c("SSL.Business.index_52"),fe(" ")]):void 0:pe("span",{class:"color-warning"},[fe(" "),c("SSL.Business.index_51"),fe(" ")]):pe("span",{class:"color-warning cursor-pointer",onClick:()=>y(e)},[" ",c("SSL.Business.index_44")," "])}},j({width:140,options:e=>[{show:!e.order_info.certId&&!e.order_info.domains.length,label:c("SSL.Business.index_53"),onClick:()=>{y(e)}},{show:"PENDING"===e.order_info.order_status&&1===e.order_info.status,label:c("SSL.Business.index_54"),onClick:async()=>{const{message:t}=await P({uc_id:e.order_info.uc_id});l(t)&&(f.data.uc_id=e.order_info.uc_id,f.data.verify=t.data,f.data.paths=t.paths,f.show=!0)}},{show:"COMPLETE"===e.order_info.order_status&&1===e.order_info.status,label:c("SSL.index_58"),onClick:async()=>{h.data.row=e,h.show=!0}},{show:"COMPLETE"===e.order_info.order_status&&1===e.order_info.status,label:c("Ftp.Label.index_11"),onClick:async()=>{const t=window.location.origin+"/v2/business_ssl?action=download_cert&uc_id="+e.order_info.uc_id;window.open(t)}},{show:!1,label:c("Public.Btn.Del"),onClick:()=>{g({title:c("SSL.index_59"),content:c("SSL.index_60"),onConfirm:async()=>{await E({hash:e.hash}),L()}})}}]})]),y=e=>{m.data.row=e,m.show=!0},L=async()=>{try{v.loading=!0;const{message:e}=await R(p);l(e)&&(v.data=e.data,v.total=e.total)}finally{v.loading=!1}};return d.value.status&&L(),(e,t)=>{const n=K,l=B,o=Oe,r=_,u=De;return ue(),ve("div",ct,[pe(u,{install:me(d).status},{desc:ce(()=>[t[5]||(t[5]=Se("span",{class:"mr-10px"},"Business certificates require login panel to start using them",-1)),pe(n,{type:"primary",onClick:me(D)},{default:ce(()=>[fe(he(e.$t("Login.index_3")),1)]),_:1},8,["onClick"])]),default:ce(()=>[pe(o,null,{toolsLeft:ce(()=>[pe(n,{type:"primary",onClick:t[0]||(t[0]=e=>me(S).show=!0)},{default:ce(()=>[fe(he(me(c)("SSL.index_44")),1)]),_:1})]),table:ce(()=>[pe(l,{loading:me(v).loading,data:me(v).data,columns:me(x),"max-height":220},null,8,["loading","data","columns"])]),_:1}),pe(r,{show:me(S).show,"onUpdate:show":t[1]||(t[1]=e=>me(S).show=e),title:me(S).title,data:me(S).data,"min-height":250,component:Ue},null,8,["show","title","data"]),pe(r,{show:me(m).show,"onUpdate:show":t[2]||(t[2]=e=>me(m).show=e),title:me(m).title,data:me(m).data,width:650,"min-height":450,component:me(a)},null,8,["show","title","data","component"]),pe(r,{show:me(h).show,"onUpdate:show":t[3]||(t[3]=e=>me(h).show=e),title:me(h).title,data:me(h).data,width:720,height:530,component:me(s)},null,8,["show","title","data","component"]),pe(r,{show:me(f).show,"onUpdate:show":t[4]||(t[4]=e=>me(f).show=e),title:me(f).title,data:me(f).data,width:650,"min-height":450,component:me(i)},null,8,["show","title","data","component"])]),_:1},8,["install"])])}}}),pt={class:"text-error"};const mt=o({},[["render",function(e,t){const s=a,n=L;return ue(),re(n,null,{default:ce(()=>[Se("li",pt,he(e.$t("SSL.SiteSSL.index_1")),1),Se("li",null,he(e.$t("SSL.SiteSSL.index_2")),1),Se("li",null,he(e.$t("SSL.SiteSSL.index_3")),1),Se("li",null,[fe(he(e.$t("SSL.SiteSSL.index_4"))+" ",1),pe(s,{href:"https://www.aapanel.com/docs/Function/BusinessCertificate.html",target:"_blank"},{default:ce(()=>[fe(he(e.$t("SSL.Business.index_20")),1)]),_:1})])]),_:1})}]]),St=ne({__name:"index",setup:e=>(e,t)=>(ue(),ve("div",null,[pe(ut),pe(_t),pe(mt)]))}),ht={class:"cert-info"},ft={class:"cert-label"},vt={class:"cert-value"},xt={class:"cert-info"},yt={class:"cert-label"},wt={class:"cert-value"},Lt={class:"cert-info"},gt={class:"cert-label"},Ct={class:"cert-value"},bt={class:"cert-info"},kt={class:"cert-label"},$t={class:"cert-value"},jt={key:0,class:"text-primary"},Pt={key:1,class:"text-error"},Et={class:"w-48%"},Rt={class:"mb-8px"},Bt={class:"w-48%"},Dt={class:"mb-8px"},Ot=o(ne({__name:"cert",emits:["update"],setup(a,{emit:i}){const o=ye(()=>n(()=>import("./ssl-log.js?v=1756367574781"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),d=i,{t:r}=ie(),{data:u}=y(),c=w(r("SSL.index_43")),p=e(),m=le(!1),S=le(1),v=le(""),x=le(""),g=be({hash:"",issuer:"",notAfter:"",notBefore:"",dns:[],subject:"",endtime:0}),C=async()=>{const{message:e}=await k({hash:g.hash});l(e)&&(c.data.path=e.result,c.show=!0)},b=async()=>{await h({updateOf:1,siteName:u.name}),d("update"),p.setRefresh(!0)},{loading:$,setLoading:j}=O();return(async()=>{try{j(!0);const{message:e}=await f({siteName:u.name});l(e)&&(m.value=e.status,g.hash=e.hash,g.issuer=e.cert_data.issuer,g.notAfter=e.cert_data.notAfter,g.notBefore=e.cert_data.notBefore,g.dns=e.cert_data.dns,g.subject=e.cert_data.subject,g.endtime=e.cert_data.endtime,v.value=e.key,x.value=e.csr,S.value=e.auto_renew)}finally{j(!1)}})(),(e,a)=>{const n=q,i=G,l=t,d=J,r=H,u=X,p=K,m=L,h=_,f=s;return ue(),re(f,{show:me($)},{default:ce(()=>[pe(d,{class:"mb-16px",type:"success","show-icon":!1},{default:ce(()=>[pe(l,{"x-gap":12,cols:"15"},{default:ce(()=>[me(S)?(ue(),re(n,{key:0,span:"16"},{default:ce(()=>[Se("div",ht,[Se("div",ft,he(e.$t("SSL.SiteSSL.index_22"))+"：",1),Se("div",vt,he(e.$t("SSL.SiteSSL.index_23")),1)])]),_:1})):_e("",!0),pe(n,{span:"7"},{default:ce(()=>[Se("div",xt,[Se("div",yt,he(e.$t("Site.Cert.index_45"))+"：",1),Se("div",wt,[pe(i,null,{default:ce(()=>[fe(he(me(g).issuer),1)]),_:1})])])]),_:1}),pe(n,{span:"8"},{default:ce(()=>[Se("div",Lt,[Se("div",gt,he(e.$t("Site.Cert.index_46"))+"：",1),Se("div",Ct,[pe(i,null,{default:ce(()=>[fe(he(me(g).dns.join(e.$t("Public.Punctuation.Comma"))),1)]),_:1})])])]),_:1}),pe(n,{span:"7"},{default:ce(()=>[Se("div",bt,[Se("div",kt,he(e.$t("Site.Cert.index_47"))+he(e.$t("Public.Punctuation.Colon")),1),Se("div",$t,[me(g).endtime>0?(ue(),ve("span",jt,he(e.$t("Site.Cert.index_48",{date:me(g).notAfter,days:me(g).endtime})),1)):(ue(),ve("span",Pt,he(e.$t("Site.Cert.index_47")),1))])])]),_:1})]),_:1})]),_:1}),pe(u,{class:"mb-16px",size:10,justify:"space-between"},{default:ce(()=>[Se("div",Et,[Se("div",Rt,he(e.$t("Site.Cert.index_50")),1),pe(r,{readonly:"",value:me(v),"onUpdate:value":a[0]||(a[0]=e=>xe(v)?v.value=e:null),rows:14},null,8,["value"])]),Se("div",Bt,[Se("div",Dt,he(e.$t("Site.Cert.index_51")),1),pe(r,{readonly:"",value:me(x),"onUpdate:value":a[1]||(a[1]=e=>xe(x)?x.value=e:null),rows:14},null,8,["value"])])]),_:1}),pe(u,{class:"mb-12px"},{default:ce(()=>[pe(p,{type:"primary",onClick:C},{default:ce(()=>[fe(he(e.$t("Site.Cert.index_53")),1)]),_:1}),pe(p,{onClick:b},{default:ce(()=>[fe(he(e.$t("Site.Cert.index_55")),1)]),_:1})]),_:1}),pe(m,null,{default:ce(()=>[Se("li",null,he(e.$t("SSL.SiteSSL.index_24")),1),Se("li",null,he(e.$t("SSL.SiteSSL.index_25")),1)]),_:1}),pe(h,{show:me(c).show,"onUpdate:show":a[2]||(a[2]=e=>me(c).show=e),title:me(c).title,data:me(c).data,width:650,"min-height":450,component:me(o)},null,8,["show","title","data","component"])]),_:1},8,["show"])}}}),[["__scopeId","data-v-99cd0a05"]]),Nt={class:"flex items-center"},Ut={class:"leading-17px"},At={class:"w-full"},It={class:"w-full"},Tt={class:"text-error"},zt=ne({__name:"apply",emits:["update"],setup(t,{emit:a}){const n=ke(),{t:o}=ie(),{data:r}=y(),_=e(),p=a,m=be({auth_type:"http",dns_manual:0,auto_wildcard:0,domains:[],all:!1}),S={domains:{required:!0,trigger:"change",type:"array",message:o("SSL.SiteSSL.index_16")}},h=le(null),f=le([]),v=e=>{var t;return null==(t=f.value.find(t=>t.name===e))?void 0:t.auto},x=()=>{n.push("/ssl_domain/domain")},w=oe(()=>m.domains.length>0&&m.domains.length<f.value.length);$e(()=>m.domains,e=>{e.length===f.value.length?m.all=!0:e.length||(m.all=!1)}),$e(()=>m.all,e=>{var t;e?(m.domains=f.value.map(e=>e.name),null==(t=h.value)||t.validate()):m.domains=[]}),$e(()=>m.auth_type,e=>{var t;"dns"===e?(m.domains=f.value.filter(e=>e.auto).map(e=>e.name),null==(t=h.value)||t.validate()):m.domains=[]});const g=oe(()=>m.domains.filter(e=>!v(e))),C=async()=>{var e;if(await(null==(e=h.value)?void 0:e.validate()),"dns"===m.auth_type&&g.value.length&&!m.dns_manual)return void i.error({content:()=>Re("span",{innerHTML:"".concat(g.value.join("<br/>")).concat(o("SSL.SiteSSL.index_14"))})});let t={auth_type:m.dns_manual?"dns_manual":m.auth_type,auto_wildcard:m.auto_wildcard,domains:JSON.stringify(m.domains),site_id:m.dns_manual?r.id:void 0,deploy:m.dns_manual?0:1};if(m.dns_manual&&"dns"===m.auth_type){const{message:e}=await N({site_id:r.id,domains:JSON.stringify(m.domains)});if(l(e)&&Object.keys(e).length)return void U(e.auths,r.id,m.domains,()=>{p("update"),_.setRefresh(!0)},!0);const a=A({width:500,height:300,hideClose:!0,component:I});try{const{message:e}=await T(t,!1);l(e)&&(e.deploy?(i.success(e.result||o("SSL.index_32")),p("update"),_.setRefresh(!0)):Array.isArray(e.auths)&&e.auths.length&&U(e.auths,r.id,m.domains,()=>{p("update"),_.setRefresh(!0)}))}catch(s){z(se(s,"message",""))}finally{a.hide()}return}const{message:a}=await T(t);l(a)&&A({hideClose:!0,data:{isJump:!1,task_id:a.task_id,onFinish:()=>{p("update"),_.setRefresh(!0)}},component:Ie})},{loading:b,setLoading:k}=O();return je(()=>{(async()=>{try{k(!0);const{message:e}=await Te({id:r.id});if(c(e)){const t=e.map(async e=>{const{message:t}=await M({domain:e.name});l(t)&&f.value.push({name:e.name,auto:!!t.hash})});await Promise.all(t)}}finally{k(!1)}})()}),(e,t)=>{const a=d,n=J,i=Z,l=u,o=Y,r=Q,c=ee,_=X,p=te,y=ae,k=s,$=K,j=Ae,P=L;return ue(),ve("div",null,[Pe(pe(n,{"show-icon":!1,class:"mb-10px"},{default:ce(()=>[Se("div",Nt,[pe(a,{name:"base-info",size:"17",class:"mr-8px"}),Se("span",Ut,he(e.$t("SSL.SiteSSL.index_12")),1)])]),_:1},512),[[Ee,"dns"===me(m).auth_type]]),pe(j,{ref_key:"formRef",ref:h,model:me(m),rules:S,"label-width":"140"},{default:ce(()=>[pe(r,{label:e.$t("Config.Safe.Ssl.index_2")},{default:ce(()=>[pe(o,{value:me(m).auth_type,"onUpdate:value":t[0]||(t[0]=e=>me(m).auth_type=e)},{default:ce(()=>[pe(l,null,{default:ce(()=>[pe(i,{value:"http"},{default:ce(()=>[fe(he(e.$t("SSL.SiteSSL.index_17")),1)]),_:1}),pe(i,{value:"dns"},{default:ce(()=>[fe(he(e.$t("SSL.index_12"))+" (Wildcard support) ",1)]),_:1})]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),Pe(pe(r,{label:" ","show-feedback":!1},{default:ce(()=>[pe(c,{checked:me(m).dns_manual,"onUpdate:checked":t[1]||(t[1]=e=>me(m).dns_manual=e),"checked-value":1,"unchecked-value":0},{default:ce(()=>[fe(he(e.$t("SSL.index_2")),1)]),_:1},8,["checked"])]),_:1},512),[[Ee,"dns"===me(m).auth_type]]),Pe(pe(r,{label:" "},{default:ce(()=>[pe(c,{checked:me(m).auto_wildcard,"onUpdate:checked":t[2]||(t[2]=e=>me(m).auto_wildcard=e),"checked-value":1,"unchecked-value":0},{default:ce(()=>[fe(he(e.$t("SSL.SiteSSL.index_20")),1)]),_:1},8,["checked"])]),_:1},512),[[Ee,"dns"===me(m).auth_type]]),pe(r,{label:e.$t("Mail.Domain.index_3"),path:"domains"},{default:ce(()=>[pe(k,{show:me(b),class:"p-12px w-300px max-h-300px min-h-100px overflow-auto border border-solid border-#ccc"},{default:ce(()=>[pe(c,{class:"mb-12px",checked:me(m).all,"onUpdate:checked":t[3]||(t[3]=e=>me(m).all=e),label:e.$t("Public.SelectAll"),indeterminate:me(w)},null,8,["checked","label","indeterminate"]),me(f).length?(ue(),re(p,{key:0,value:me(m).domains,"onUpdate:value":t[4]||(t[4]=e=>me(m).domains=e)},{default:ce(()=>[pe(_,{class:"flex-col!",size:12},{default:ce(()=>[(ue(!0),ve(we,null,Le(me(f),e=>(ue(),re(c,{key:e.name,value:e.name,label:e.name},null,8,["value","label"]))),128))]),_:1})]),_:1},8,["value"])):(ue(),re(y,{key:1,description:"No domain name"}))]),_:1},8,["show"])]),_:1},8,["label"]),Pe(pe(r,{label:" "},{default:ce(()=>[pe(n,{"show-icon":!1,type:me(g).length?"warning":"success"},{default:ce(()=>[(ue(!0),ve(we,null,Le(me(m).domains,t=>(ue(),re(_,{key:t},{default:ce(()=>[v(t)?(ue(),re(_,{key:0,class:"flex-nowrap! py-3px"},{default:ce(()=>[pe(a,{name:"base-success",size:"17",color:"#20a53a"}),Se("span",At,"["+he(t)+"] "+he(e.$t("SSL.SiteSSL.index_13")),1)]),_:2},1024)):(ue(),re(_,{key:1,class:"flex-nowrap! py-3px items-center!"},{default:ce(()=>[pe(a,{name:"base-error",size:"17",color:"#E85445"}),Se("span",It,"["+he(t)+"] "+he(e.$t("SSL.SiteSSL.index_14")),1),pe($,{type:"primary",size:"tiny",onClick:x},{default:ce(()=>[fe(he(e.$t("SSL.SiteSSL.index_21")),1)]),_:1})]),_:2},1024))]),_:2},1024))),128))]),_:1},8,["type"])]),_:1},512),[[Ee,"dns"===me(m).auth_type&&me(m).domains.length&&!me(m).dns_manual]]),pe(r,{label:" "},{default:ce(()=>[pe($,{type:"primary",onClick:C},{default:ce(()=>[fe(he(e.$t("Public.Btn.Apply")),1)]),_:1})]),_:1})]),_:1},8,["model"]),Pe(pe(P,{class:"mt-16px"},{default:ce(()=>[Se("li",Tt,he(e.$t("SSL.SiteSSL.index_15")),1),Se("li",null,he(e.$t("Site.Cert.index_21")),1),Se("li",null,he(e.$t("Site.Cert.index_23")),1),Se("li",null,he(e.$t("Site.Cert.index_24")),1)]),_:1},512),[[Ee,"http"===me(m).auth_type]]),Pe(pe(P,{class:"mt-24px"},{default:ce(()=>[t[5]||(t[5]=Se("li",null,"Manually resolved certificates do not support auto-renewal",-1)),Se("li",null,he(e.$t("Site.Cert.index_25")),1),Se("li",null,he(e.$t("Site.Cert.index_26")),1),Se("li",null,he(e.$t("Site.Cert.index_27")),1),Se("li",null,he(e.$t("Site.Cert.index_28")),1)]),_:1,__:[5]},512),[[Ee,"dns"===me(m).auth_type]])])}}}),Mt=ne({__name:"index",props:{isOpen:{type:Boolean},type:{},onRefresh:{type:Function}},setup(e){const t=e,a=()=>{t.onRefresh()};return(e,s)=>(ue(),ve("div",null,[t.isOpen&&"Let's Encrypt"===t.type?(ue(),re(Ot,{key:0,onUpdate:a})):(ue(),re(zt,{key:1,onUpdate:a}))]))}}),Ft=ne({__name:"index",props:{onMenuChange:{type:Function}},setup(e,{expose:t}){const{data:a}=y(),{t:s}=ie(),n=be({p:1,limit:99999}),{columns:o,table:d}=$([{key:"domain",title:s("Site.Cert.index_29"),render:e=>pe("span",{innerHTML:e.verify_domains.length>0?e.verify_domains.join("<br/>"):"--"},null)},Ne({title:s("SSL.index_54"),width:140}),{key:"issuer",title:s("Site.Cert.index_30"),ellipsis:{tooltip:!0}},j({width:150,options:t=>[{label:s("Public.Btn.Deploy"),onClick:async()=>{try{await b({hash:t.hash,domains:JSON.stringify([a.name]),append:1}),i.success(s("SSL.index_32")),setTimeout(()=>{e.onMenuChange()},500)}catch(n){console.log(n)}}},{show:"Let's Encrypt"===t.provider,label:s("Public.Btn.Del"),onClick:()=>{(e=>{F({title:s("Site.Cert.index_31"),content:s("Site.Cert.index_32"),onConfirm:async()=>{await E({hash:e.hash}),c()}})})(t)}}]})]),{loading:r,setLoading:u}=O(!0),c=async()=>{try{u(!0);const{message:e}=await V(n);l(e)&&(d.data=e.data)}finally{u(!1)}};return c(),t({init:c}),(e,t)=>{const a=B;return ue(),ve("div",null,[pe(a,{loading:me(r),columns:me(o),data:me(d).data,"max-height":510},null,8,["loading","columns","data"])])}}}),Vt={class:"mr-12px"},Ht={key:0,class:"mr-12px"},Jt={key:1,class:"mr-12px"},qt=ne({__name:"index",setup(t,{expose:a}){const s=ye(()=>n(()=>import("./ssl-log.js?v=1756367574781"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),i=e(),{data:o}=y(),{t:d}=ie(),r=le("current"),u=le(""),c=w(d("SSL.index_43")),m=le(x.NotDeploy),S=le(""),h=le(!1),f=le(0),L=le(!1),g=le(""),C=async()=>{const{message:e}=await k({hash:u.value});l(e)&&(c.data.path=e.result,c.show=!0)},b=e=>{j.value[0].data&&(j.value[0].data.loading=e)},$=async()=>{try{b(!0);const{message:a}=await v({siteName:o.name});l(a)&&(m.value=a.type,h.value=a.status,f.value=se(a,"cert_data.endtime",0),g.value=a.cert_data.issuer_O||"",L.value=(()=>{let e=!1;return f.value<=30&&(e=!0),m.value===x.TestDeploy&&f.value<0&&(e=!0),m.value!==x.SaveOrHolderDeploy&&m.value!==x.NotDeploy||(e=!1),e})(),S.value=a.cert_data.dns.join(","),u.value=a.hash,t=a,j.value[0].data&&(j.value[0].data.info=t),e=L.value,j.value[0].data&&(j.value[0].data.isRenew=e))}catch(a){h.value=!1,L.value=!1}finally{b(!1)}var e,t},j=le([{key:"current",label:()=>pe("div",null,[pe("span",null,[fe("Current Certs - ")]),pe("span",{class:h.value?"text-#1d9534":"text-red-500"},[fe("["),h.value?"Deployed":"Not Deployed",fe("]")])]),data:{info:null,isRenew:!1,loading:!0,onRefresh:$},component:Be(ot)},{key:"business",label:d("Site.Cert.index_64"),component:Be(St)},{key:"let",label:d("Site.Cert.index_65"),data:{isOpen:oe(()=>h.value),type:oe(()=>g.value),onRefresh:$},component:Be(Mt)},{key:"holder",label:d("Site.Cert.index_66"),component:Be(Ft),data:{onMenuChange:()=>{r.value="current",$(),i.setRefresh(!0)}}}]);return a({init:()=>{$()}}),(e,t)=>{const a=K,n=J,i=p,l=_;return ue(),ve("div",null,[me(h)?_e("",!0):(ue(),re(n,{key:0,class:"mb-12px",type:"error","show-icon":!1,style:{"--n-padding":"9px 16px"}},{default:ce(()=>[Se("span",Vt,he(e.$t("Site.Cert.index_41")),1),pe(a,{size:"tiny",type:"primary",onClick:t[0]||(t[0]=e=>r.value="business")},{default:ce(()=>[fe(he(e.$t("Site.Cert.index_43")),1)]),_:1})]),_:1})),me(h)&&me(L)?(ue(),re(n,{key:1,class:"mb-12px",type:"error","show-icon":!1,style:{"--n-padding":"9px 16px"}},{default:ce(()=>[me(f)>0?(ue(),ve("span",Ht,he(e.$t("SSL.SiteSSL.index_26",[me(S),me(f)])),1)):(ue(),ve("span",Jt,he(e.$t("SSL.SiteSSL.index_19",[me(S)])),1)),pe(a,{size:"tiny",type:"primary",onClick:C},{default:ce(()=>[fe(he(e.$t("Site.Cert.index_53")),1)]),_:1})]),_:1})):_e("",!0),pe(i,{value:me(r),"onUpdate:value":t[1]||(t[1]=e=>xe(r)?r.value=e:null),options:me(j)},null,8,["value","options"]),pe(l,{show:me(c).show,"onUpdate:show":t[2]||(t[2]=e=>me(c).show=e),title:me(c).title,data:me(c).data,width:650,"min-height":450,component:me(s)},null,8,["show","title","data","component"])])}}});export{qt as default};
