System.register(["./page_layout-legacy.js?v=1756367574781","./index-legacy.js?v=1756367574781","./site-legacy4.js?v=1756367574781","./public-legacy.js?v=1756367574781","./site-legacy.js?v=1756367574781","./index-legacy87.js?v=1756367574781","./index-legacy108.js?v=1756367574781","./vue-legacy.js?v=1756367574781","./naive-legacy.js?v=1756367574781","./form.vue_vue_type_script_setup_true_lang-legacy2.js?v=1756367574781","./common-legacy.js?v=1756367574781","./__commonjsHelpers__-legacy.js?v=1756367574781","./index-legacy133.js?v=1756367574781","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1756367574781","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1756367574781","./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1756367574781","./index.vue_vue_type_script_setup_true_lang-legacy12.js?v=1756367574781","./index.vue_vue_type_script_setup_true_lang-legacy8.js?v=1756367574781","./soft-legacy.js?v=1756367574781","./index-legacy244.js?v=1756367574781","./index-legacy99.js?v=1756367574781","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1756367574781","./index.vue_vue_type_script_setup_true_lang-legacy10.js?v=1756367574781","./index-legacy98.js?v=1756367574781","./index-legacy100.js?v=1756367574781","./index-legacy101.js?v=1756367574781","./file-legacy.js?v=1756367574781","./theme-monokai-legacy.js?v=1756367574781","./refersh-legacy.js?v=1756367574781","./php-legacy.js?v=1756367574781","./index.vue_vue_type_script_setup_true_lang-legacy17.js?v=1756367574781","./index-legacy105.js?v=1756367574781","./ssl-legacy.js?v=1756367574781","./cert-legacy.js?v=1756367574781","./utils-legacy3.js?v=1756367574781","./index-legacy217.js?v=1756367574781","./paypal-js-legacy.js?v=1756367574781","./ssl-lets-progress-legacy.js?v=1756367574781","./upload-legacy.js?v=1756367574781","./index.vue_vue_type_script_setup_true_lang-legacy15.js?v=1756367574781"],function(e,t){"use strict";var l,a,s,i,n,o,u,d,r,c,p,_,m,h,f,g,v,y,w,x,b,k,j,P,C,$,O,W,z,R,M,D,q,U,B,F,L,A,S,H,I,E,T,K,N,V,G,J,X,Q,Y,Z,ee,te,le,ae,se,ie,ne,oe,ue;return{setters:[e=>{l=e.t,a=e.i,s=e.d,i=e.bd,n=e.p,o=e.m,u=e.w,d=e.bR,r=e._,c=e.a},e=>{p=e._},e=>{_=e.o},e=>{m=e.d,h=e.c,f=e.h,g=e.f,v=e.a,y=e._,w=e.w,x=e.e,b=e.G,k=e.r},e=>{j=e.X,P=e.aG},e=>{C=e.i,$=e.j,O=e.k,W=e.l,z=e.s,R=e.n,M=e.p},e=>{D=e._},e=>{q=e.i,U=e.p,B=e.k,F=e.W,L=e.R,A=e.V,S=e.S,H=e.U,I=e.a2,E=e.a3,T=e.q,K=e.P,N=e.r,V=e.aj,G=e.ak,J=e.j,X=e.a4,Q=e.t,Y=e.an,Z=e.e,ee=e._},e=>{te=e.dj,le=e.dm,ae=e.dd,se=e.au,ie=e.aC,ne=e.dk,oe=e.bJ},e=>{ue=e._},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var de=document.createElement("style");de.textContent=".n-tag[data-v-c6193199]{--n-height: 16px;--n-padding: 0 5px;--n-font-size: 90%;--n-text-color: #2196f3;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.tools-card[data-v-856e3a0e]{display:flex;align-items:center;padding:12px 24px;border-radius:4px;background-color:var(--color-bg-2)}.tools-card+.tools-card[data-v-856e3a0e]{margin-top:16px}.tools-card .tools-img[data-v-856e3a0e]{display:flex;justify-content:center;width:26px}.tools-card .tools-name[data-v-856e3a0e]{min-width:150px;padding:0 12px;font-size:13px}.tools-card .n-button[data-v-856e3a0e]{margin-left:12px;width:32px;padding:0}.tools-card .tools-desc[data-v-856e3a0e]{margin-left:16px}\n/*$vite$:1*/",document.head.appendChild(de);const re=Symbol("server-list");function ce(){return q(re)}const pe=e=>l.post("/tamper_core/add_black_exts.json",e,{requestOptions:{loading:a.global.t("WP.api.tamper_2"),isOriginalResult:!0,prefix:""}}),_e=e=>l.post("/tamper_core/remove_black_exts.json",e,{requestOptions:{loading:a.global.t("WP.api.tamper_3"),isOriginalResult:!0,prefix:""}}),me=B({__name:"index",setup(e,{expose:t}){const{site:n,setPid:o}=ce(),{loading:u,setLoading:d}=m(),{table:r,columns:c}=h([{key:"name",title:"Name"},{key:"status",title:"Status",align:"right",render:e=>F(te,{value:e.status,size:"small",checkedValue:1,uncheckedValue:0,onUpdateValue:async t=>{const{message:i}=await(n={key:e.key,value:t,path_id:e.id},l.post("/tamper_core/modify_path_config.json",n,{requestOptions:{loading:a.global.t("WP.api.tamper_1"),isOriginalResult:!0,prefix:""}}));var n;s(i)&&i.status&&(e.status=t)}},null)}]),p=[{title:"Create file",name:"create"},{title:"Modify file",name:"modify"},{title:"Delete file",name:"unlink"},{title:"Create directory",name:"mkdir"},{title:"Delete directory",name:"rmdir"},{title:"Rename file",name:"rename"},{title:"Create soft link",name:"link"},{title:"Modify permissions",name:"chmod"},{title:"Modify owner",name:"chown"}],_=async()=>{try{d(!0);const{message:t}=await C({path:n.path});s(t)&&!le(t)?(o(t.pid),e=t,r.data=p.map(t=>{const l=`is_${t.name}`,a=e[l];return{key:l,id:e.pid,name:`Disabled ${t.title}`,status:i(a)?a:0}})):r.data=[]}finally{d(!1)}var e};return _(),t({init:_}),(e,t)=>{const l=f;return A(),L("div",null,[F(l,{loading:H(u),"loading-num":9,"max-height":340,data:H(r).data,columns:H(c)},null,8,["loading","data","columns"]),t[0]||(t[0]=S("div",{class:"mt-16px text-#777"}," Tip: Current config intercepts the above rules by default, please set and config the rules according the current project requirements. ",-1))])}}}),he=n({},[["render",function(e,t){const l=ae;return A(),I(l,{size:"small",bordered:!1},{default:E(()=>[T(e.$slots,"default",{},void 0,!0)]),_:3})}],["__scopeId","data-v-c6193199"]]),fe={class:"flex mb-12px"},ge={class:"w-240px mr-12px"},ve=B({__name:"index",setup(e,{expose:t}){const{t:l}=K(),{site:a,setPid:i}=ce(),n=N("");let d=-1,r="";const c=async()=>{if(""===n.value.trim())return void o.error("Please enter suffix");const{message:e}=await pe({path_id:d,path:r,exts:n.value});s(e)&&(e.status?(o.success(e.msg),n.value="",k()):o.error(e.msg))},{table:p,columns:_}=h([{key:"exts",title:"Suffix"},g({width:100,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{w(e)}}]})]),w=async e=>{v({title:`Delete protected file suffix [${e.exts}]`,content:"Delete protected file suffix, the file whose file name ends with this suffix will lose protection. want to continue?",onConfirm:async()=>{const{message:t}=await _e({path_id:e.id,path:r,exts:e.exts});s(t)&&(t.status?(o.success(t.msg),k()):o.error(t.msg))}})},{loading:x,setLoading:b}=m(),k=async()=>{try{b(!0);const{message:t}=await C({path:a.path});s(t)&&(i(t.pid),d=(e=t).pid,r=e.path,u(e.black_exts)?p.data=e.black_exts.filter(e=>"/"!=e[0]&&-1==e.indexOf("./")).map(t=>({id:e.pid,exts:t})):p.data=[])}finally{b(!1)}var e};return k(),t({init:k}),(e,t)=>{const l=se,a=ie,s=f,i=he,o=y;return A(),L("div",null,[S("div",fe,[S("div",ge,[F(l,{value:H(n),"onUpdate:value":t[0]||(t[0]=e=>G(n)?n.value=e:null),placeholder:"Suffix",onKeyup:V(c,["enter"])},null,8,["value"])]),F(a,{type:"primary",onClick:c},{default:E(()=>[J(X(e.$t("Public.Btn.Add")),1)]),_:1})]),F(s,{loading:H(x),"loading-num":6,"max-height":230,data:H(p).data,columns:H(_)},null,8,["loading","data","columns"]),F(o,{class:"mt-16px"},{default:E(()=>[t[25]||(t[25]=S("li",null," The so-called file suffix refers the string at the end of the file name, not necessarily the extension ",-1)),S("li",null,[t[5]||(t[5]=J(" As: ",-1)),F(i,null,{default:E(()=>t[1]||(t[1]=[J(".php",-1)])),_:1,__:[1]}),t[6]||(t[6]=J(", ",-1)),F(i,null,{default:E(()=>t[2]||(t[2]=[J(".html",-1)])),_:1,__:[2]}),t[7]||(t[7]=J(", ",-1)),F(i,null,{default:E(()=>t[3]||(t[3]=[J(".js?v=1756367574781",-1)])),_:1,__:[3]}),t[8]||(t[8]=J(", ",-1)),F(i,null,{default:E(()=>t[4]||(t[4]=[J("index.php",-1)])),_:1,__:[4]}),t[9]||(t[9]=J(" etc. ",-1))]),t[26]||(t[26]=S("div",null,"Example:",-1)),S("li",null,[F(i,null,{default:E(()=>t[10]||(t[10]=[J(".php",-1)])),_:1,__:[10]}),t[14]||(t[14]=J(" Match: ",-1)),F(i,null,{default:E(()=>t[11]||(t[11]=[J("./1.php",-1)])),_:1,__:[11]}),t[15]||(t[15]=J()),F(i,null,{default:E(()=>t[12]||(t[12]=[J("./test/2.php",-1)])),_:1,__:[12]}),t[16]||(t[16]=J(" Mismatch: ",-1)),F(i,null,{default:E(()=>t[13]||(t[13]=[J("./1.php/1.txt",-1)])),_:1,__:[13]})]),S("li",null,[F(i,null,{default:E(()=>t[17]||(t[17]=[J("index.php",-1)])),_:1,__:[17]}),t[22]||(t[22]=J(" Match: ",-1)),F(i,null,{default:E(()=>t[18]||(t[18]=[J("./index.php",-1)])),_:1,__:[18]}),t[23]||(t[23]=J()),F(i,null,{default:E(()=>t[19]||(t[19]=[J("./test/index.php",-1)])),_:1,__:[19]}),F(i,{class:"ml-0.5em"},{default:E(()=>t[20]||(t[20]=[J("./abc_index.php",-1)])),_:1,__:[20]}),t[24]||(t[24]=J(" Mismatch: ",-1)),F(i,null,{default:E(()=>t[21]||(t[21]=[J("./index.php.tar.gz",-1)])),_:1,__:[21]})])]),_:1,__:[25,26]})])}}}),ye={class:"flex mb-12px"},we={class:"w-240px mr-12px"},xe=B({__name:"index",setup(e,{expose:t}){const{t:l}=K(),{site:a,setPid:i}=ce(),n=N("");let d=-1,r="";const c=async()=>{if(""===n.value.trim())return void o.error("Please enter the full path or relative path of the file");const{message:e}=await pe({path_id:d,path:r,exts:n.value});s(e)&&(e.status?(o.success(e.msg),n.value="",k()):o.error(e.msg))},{table:p,columns:_}=h([{key:"exts",title:"Full file path"},g({width:100,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{w(e)}}]})]),w=async e=>{v({title:`Delete protected files [${e.exts}]`,content:"After deleting a protected file, the file will be unprotected, should I continue the operation?",onConfirm:async()=>{const{message:t}=await _e({path_id:e.id,path:r,exts:e.exts});s(t)&&(t.status?(o.success(t.msg),k()):o.error(t.msg))}})},{loading:x,setLoading:b}=m(),k=async()=>{try{b(!0);const{message:t}=await C({path:a.path});s(t)&&(i(t.pid),d=(e=t).pid,r=e.path,u(e.black_exts)?p.data=e.black_exts.filter(e=>"/"==e[0]||"."==e[0]&&"/"==e[1]).map(t=>({id:e.pid,exts:t})):p.data=[])}finally{b(!1)}var e};return k(),t({init:k}),(e,t)=>{const l=se,a=ie,s=f,i=he,o=y;return A(),L("div",null,[S("div",ye,[S("div",we,[F(l,{value:H(n),"onUpdate:value":t[0]||(t[0]=e=>G(n)?n.value=e:null),placeholder:"Full path Or Relative path",onKeyup:V(c,["enter"])},null,8,["value"])]),F(a,{type:"primary",onClick:c},{default:E(()=>[J(X(e.$t("Public.Btn.Add")),1)]),_:1})]),F(s,{loading:H(x),"loading-num":5,"max-height":200,data:H(p).data,columns:H(_)},null,8,["loading","data","columns"]),F(o,{class:"mt-16px"},{default:E(()=>[t[15]||(t[15]=S("li",{class:"font-bold text-#333"},"The following 4 methods are supported",-1)),S("li",null,[t[2]||(t[2]=J("1. Complete file path, such as: ",-1)),F(i,null,{default:E(()=>t[1]||(t[1]=[J("/www/wwwroot/test/123.log",-1)])),_:1,__:[1]})]),S("li",null,[t[5]||(t[5]=J(" 2. Relative path to the site, such as: Full path ",-1)),F(i,null,{default:E(()=>t[3]||(t[3]=[J("/www/wwwroot/test/app/123.log",-1)])),_:1,__:[3]}),t[6]||(t[6]=J(" Relative path ",-1)),F(i,null,{default:E(()=>t[4]||(t[4]=[J("./app/123.log",-1)])),_:1,__:[4]})]),S("li",null,[t[9]||(t[9]=J(" 3. All files in the specified directory, such as: ",-1)),F(i,null,{default:E(()=>t[7]||(t[7]=[J("/www/wwwroot/test/app/*",-1)])),_:1,__:[7]}),t[10]||(t[10]=J(" Relative path ",-1)),F(i,null,{default:E(()=>t[8]||(t[8]=[J("./app/*",-1)])),_:1,__:[8]})]),S("li",null,[t[13]||(t[13]=J(" 4. the specified directory under the specified file type, such as: ",-1)),F(i,null,{default:E(()=>t[11]||(t[11]=[J("/www/wwwroot/test/app/*.log",-1)])),_:1,__:[11]}),t[14]||(t[14]=J(" Relative path ",-1)),F(i,null,{default:E(()=>t[12]||(t[12]=[J("./app/*.log",-1)])),_:1,__:[12]})]),t[16]||(t[16]=S("li",{class:"text-error"}," Note: files already included in the protected file suffix do not need to be set. ",-1))]),_:1,__:[15,16]})])}}}),be={class:"flex mb-12px"},ke={class:"w-240px mr-12px"},je=B({__name:"index",setup(e,{expose:t}){const{t:i}=K(),{site:n,setPid:d}=ce(),r=N("");let c=-1,p="";const _=async()=>{if(""===r.value.trim())return void o.error("Please enter directory name");const{message:e}=await(t={path_id:c,path:p,dirnames:r.value},l.post("/tamper_core/add_white_dirs.json",t,{requestOptions:{loading:a.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var t;s(e)&&(e.status?(o.success(e.msg),r.value="",$()):o.error(e.msg))},{table:x,columns:b}=h([{key:"dir",title:"Directory",ellipsis:{tooltip:!0}},w({title:"Remark",onBlur:async(e,t)=>{const{message:i}=await(n={path_id:t.id,dir_name:t.dir,ps:e},l.post("/tamper_core/set_white_dir_with_ps.json",n,{requestOptions:{loading:a.global.t("WP.api.tamper_5"),isOriginalResult:!0,prefix:""}}));var n;s(i)&&(i.status?t.ps=e:o.error(i.msg))}}),g({width:80,options:e=>[{label:i("Public.Btn.Del"),onClick:()=>{k(e)}}]})]),k=async e=>{v({title:"Delete directory whitelist",content:e.tip_msg?e.tip_msg:`Delete [${e.dir}] later, All files in the directory will be protected, continue?`,onConfirm:async()=>{const{message:t}=await(i={path_id:e.id,path:p,dirname:e.dir},l.post("/tamper_core/remove_white_dirs.json",i,{requestOptions:{loading:a.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var i;s(t)&&(t.status?(o.success(t.msg),$()):o.error(t.msg))}})},{loading:j,setLoading:P}=m(),$=async()=>{try{P(!0);const{message:t}=await C({path:n.path});s(t)&&(d(t.pid),c=(e=t).pid,p=e.path,u(e.white_dirs)?x.data=e.white_dirs.map(t=>({id:e.pid,ps:t.ps||"",tip_msg:t.tip_msg||"",...t})):x.data=[])}finally{P(!1)}var e};return $(),t({init:$}),(e,t)=>{const l=se,a=ie,s=f,i=he,n=y;return A(),L("div",null,[S("div",be,[S("div",ke,[F(l,{value:H(r),"onUpdate:value":t[0]||(t[0]=e=>G(r)?r.value=e:null),placeholder:"Directory name",onKeyup:V(_,["enter"])},null,8,["value"])]),F(a,{type:"primary",onClick:_},{default:E(()=>[J(X(e.$t("Public.Btn.Add")),1)]),_:1})]),F(s,{loading:H(j),"loading-num":5,"max-height":188,data:H(x).data,columns:H(b)},null,8,["loading","data","columns"]),F(n,{class:"mt-16px"},{default:E(()=>[S("li",null,[t[4]||(t[4]=J(" Full path or directory name or parts path are allowed such as: ",-1)),F(i,null,{default:E(()=>t[1]||(t[1]=[J("/www/abc/cache/test/",-1)])),_:1,__:[1]}),t[5]||(t[5]=J(", ",-1)),F(i,null,{default:E(()=>t[2]||(t[2]=[J("test",-1)])),_:1,__:[2]}),t[6]||(t[6]=J(", ",-1)),F(i,null,{default:E(()=>t[3]||(t[3]=[J("cache/test/",-1)])),_:1,__:[3]})]),S("li",null,[t[10]||(t[10]=J(" The first character of the Full path must be ",-1)),F(i,null,{default:E(()=>t[7]||(t[7]=[J("/",-1)])),_:1,__:[7]}),t[11]||(t[11]=J(", as: ",-1)),F(i,null,{default:E(()=>t[8]||(t[8]=[J("cache/test/",-1)])),_:1,__:[8]}),t[12]||(t[12]=J(" or ",-1)),F(i,null,{default:E(()=>t[9]||(t[9]=[J("test",-1)])),_:1,__:[9]})]),S("li",null,[t[15]||(t[15]=J(" art of directory name or path cannot begin with ",-1)),F(i,null,{default:E(()=>t[13]||(t[13]=[J("/",-1)])),_:1,__:[13]}),t[16]||(t[16]=J(", as: ",-1)),F(i,null,{default:E(()=>t[14]||(t[14]=[J("/www/abc/cache/test/",-1)])),_:1,__:[14]})]),t[39]||(t[39]=S("div",null,"Example:",-1)),S("li",null,[F(i,null,{default:E(()=>t[17]||(t[17]=[J("/www/abc/",-1)])),_:1,__:[17]}),t[21]||(t[21]=J(" Match: ",-1)),F(i,null,{default:E(()=>t[18]||(t[18]=[J("/www/abc/*",-1)])),_:1,__:[18]}),t[22]||(t[22]=J(" Mismatch: ",-1)),F(i,null,{default:E(()=>t[19]||(t[19]=[J("/www/abc",-1)])),_:1,__:[19]}),F(i,{class:"ml-0.5em"},{default:E(()=>t[20]||(t[20]=[J("/www/abc123",-1)])),_:1,__:[20]})]),S("li",null,[F(i,null,{default:E(()=>t[23]||(t[23]=[J("test",-1)])),_:1,__:[23]}),t[27]||(t[27]=J(" Match: ",-1)),F(i,null,{default:E(()=>t[24]||(t[24]=[J("/www/test/1.txt",-1)])),_:1,__:[24]}),t[28]||(t[28]=J()),F(i,null,{default:E(()=>t[25]||(t[25]=[J("/www/test_abc",-1)])),_:1,__:[25]}),t[29]||(t[29]=J(" Mismatch: ",-1)),F(i,null,{default:E(()=>t[26]||(t[26]=[J("/www/1.php",-1)])),_:1,__:[26]})]),S("li",null,[F(i,null,{default:E(()=>t[30]||(t[30]=[J("cache/test/",-1)])),_:1,__:[30]}),t[35]||(t[35]=J(" Match: ",-1)),F(i,null,{default:E(()=>t[31]||(t[31]=[J("/www/cache/test/1.txt",-1)])),_:1,__:[31]}),t[36]||(t[36]=J()),F(i,null,{default:E(()=>t[32]||(t[32]=[J("/cache/test/",-1)])),_:1,__:[32]}),t[37]||(t[37]=J(" Mismatch: ",-1)),F(i,null,{default:E(()=>t[33]||(t[33]=[J("/www/cache/test",-1)])),_:1,__:[33]}),t[38]||(t[38]=J()),F(i,null,{default:E(()=>t[34]||(t[34]=[J("/cache/",-1)])),_:1,__:[34]})])]),_:1,__:[39]})])}}}),Pe={class:"flex mb-12px"},Ce={class:"w-240px mr-12px"},$e=B({__name:"index",setup(e,{expose:t}){const{t:i}=K(),{site:n,setPid:d}=ce(),r=N("");let c=-1,p="";const _=async()=>{if(""===r.value.trim())return void o.error("Please enter file name");const{message:e}=await(t={path_id:c,path:p,filename:r.value},l.post("/tamper_core/add_white_files.json",t,{requestOptions:{loading:a.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var t;s(e)&&(e.status?(o.success(e.msg),r.value="",P()):o.error(e.msg))},{table:w,columns:x}=h([{key:"filename",title:"File name"},g({width:100,options:e=>[{label:i("Public.Btn.Del"),onClick:()=>{b(e)}}]})]),b=async e=>{v({title:`Delete file whitelist [${e.filename}]`,content:"After Delete whitelist, the file will be protected. want to continue?",onConfirm:async()=>{const{message:t}=await(i={path_id:e.id,path:p,filename:e.filename},l.post("/tamper_core/remove_white_files.json",i,{requestOptions:{loading:a.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var i;s(t)&&(t.status?(o.success(t.msg),P()):o.error(t.msg))}})},{loading:k,setLoading:j}=m(),P=async()=>{try{j(!0);const{message:t}=await C({path:n.path});s(t)&&(d(t.pid),c=(e=t).pid,p=e.path,u(e.white_files)?w.data=e.white_files.map(t=>({id:e.pid,filename:t})):w.data=[])}finally{j(!1)}var e};return P(),t({init:P}),(e,t)=>{const l=se,a=ie,s=f,i=he,n=y;return A(),L("div",null,[S("div",Pe,[S("div",Ce,[F(l,{value:H(r),"onUpdate:value":t[0]||(t[0]=e=>G(r)?r.value=e:null),placeholder:"File name",onKeyup:V(_,["enter"])},null,8,["value"])]),F(a,{type:"primary",onClick:_},{default:E(()=>[J(X(e.$t("Public.Btn.Add")),1)]),_:1})]),F(s,{loading:H(k),"loading-num":6,"max-height":230,data:H(w).data,columns:H(x)},null,8,["loading","data","columns"]),F(n,{class:"mt-16px"},{default:E(()=>[S("li",null,[t[3]||(t[3]=J(" Full path or single filename are allowed such as: ",-1)),F(i,null,{default:E(()=>t[1]||(t[1]=[J("/test/index.php",-1)])),_:1,__:[1]}),t[4]||(t[4]=J(", ",-1)),F(i,null,{default:E(()=>t[2]||(t[2]=[J("index.php",-1)])),_:1,__:[2]})]),t[17]||(t[17]=S("li",null,"Note: Only be an absolute path or file name, relative paths are not supported",-1)),t[18]||(t[18]=S("div",null,"Example:",-1)),S("li",null,[F(i,null,{default:E(()=>t[5]||(t[5]=[J("index.php",-1)])),_:1,__:[5]}),t[10]||(t[10]=J(" Match: ",-1)),F(i,null,{default:E(()=>t[6]||(t[6]=[J("./index.php",-1)])),_:1,__:[6]}),t[11]||(t[11]=J()),F(i,null,{default:E(()=>t[7]||(t[7]=[J("./test/index.php",-1)])),_:1,__:[7]}),t[12]||(t[12]=J(" Mismatch: ",-1)),F(i,null,{default:E(()=>t[8]||(t[8]=[J("./abc_index.php",-1)])),_:1,__:[8]}),t[13]||(t[13]=J()),F(i,null,{default:E(()=>t[9]||(t[9]=[J("./index.php/1.txt",-1)])),_:1,__:[9]})]),S("li",null,[F(i,null,{default:E(()=>t[14]||(t[14]=[J("/test/index.php",-1)])),_:1,__:[14]}),t[16]||(t[16]=J(" match only: ",-1)),F(i,null,{default:E(()=>t[15]||(t[15]=[J("/test/index.php",-1)])),_:1,__:[15]})])]),_:1,__:[17,18]})])}}}),Oe={class:"p-20px"},We={class:"flex items-center text-12px text-#666"},ze={key:0,class:"ml-12px"},Re={class:"h-500px"},Me=B({__name:"index",props:{open:{type:Boolean,default:!1},site:{}},emits:["changeOpen"],setup(e,{emit:t}){const l=e,a=t,s=Q(l,"site");let i=-1;const n=N(l.open),o=N(),u=async e=>{e?await $({paths:[{path:s.value.path,ps:s.value.ps}]}):await O({path_id:i}),n.value=e,a("changeOpen",e),o.value.init()},d=N("basic"),r=[{key:"basic",label:"Basic Setting",component:me},{key:"suffix",label:"Protected file suffix",component:ve},{key:"protected file",label:"Protected File",component:xe},{key:"directory whitelist",label:"Directory whitelist",component:je},{key:"file whitelist",label:"File whitelist",component:$e}];var c;return c={site:s.value,setPid:e=>{i=e}},U(re,c),(e,t)=>{const l=te,a=ne,s=D;return A(),L("div",Oe,[F(a,{class:"mb-16px",type:H(n)?"success":"error","show-icon":!1,bordered:!1},{default:E(()=>[S("div",We,[t[1]||(t[1]=S("span",{class:"mr-12px"},"Protection switch",-1)),F(l,{value:H(n),"onUpdate:value":u},null,8,["value"]),H(n)?Y("",!0):(A(),L("span",ze," Protection directory closed, be security risks, Recommended open protection immediately "))])]),_:1},8,["type"]),S("div",Re,[F(s,{ref_key:"tabsRef",ref:o,value:H(d),"onUpdate:value":t[0]||(t[0]=e=>G(d)?d.value=e:null),options:r},null,8,["value"])])])}}}),De=B({__name:"index",props:{site:{}},emits:["changeHotlink"],setup(e,{emit:t}){const l=t,a=Q(e,"site"),s=e=>{l("changeHotlink",e)};return(e,t)=>(A(),L("div",null,[F(ue,{class:"p-20px",site:H(a),onChangeHotlink:s},null,8,["site"])]))}}),qe={class:"p-20px"},Ue={class:"tools-card"},Be={class:"tools-img"},Fe={class:"tools-name"},Le={class:"tools-desc"},Ae={class:"ml-0.5em"},Se={class:"tools-card"},He={class:"tools-img"},Ie={class:"tools-name"},Ee={class:"tools-desc"},Te={class:"ml-0.5em"},Ke={class:"tools-card"},Ne={class:"tools-img"},Ve={class:"tools-name"},Ge={class:"tools-card flex-col!"},Je={class:"flex items-center! w-full pb-10px"},Xe={class:"tools-name"},Qe={class:"tools-card flex-col!"},Ye={class:"flex items-center! w-full pb-10px"},Ze={class:"tools-name min-w-auto!"},et=B({__name:"index",props:{site:{}},setup(e){const l=ee(()=>c(()=>t.import("./index-legacy268.js?v=1756367574781"),void 0)),a=ee(()=>c(()=>t.import("./index-legacy269.js?v=1756367574781"),void 0)),{t:i}=K(),n=Q(e,"site"),o=Z({status:!1,number:0,pid:-1}),u=N(!1),m=N(!1),h=async e=>{try{u.value=!0;const t=i(e?"WP.index_46":"WP.index_47");v({title:i("WP.index_48"),content:t,onConfirm:async()=>{await z({path:n.value.path}),m.value=e}})}finally{u.value=!1}},f=x(i("WP.index_43")),g=async()=>{f.data.row=n.value,f.show=!0},y=x(),w=async()=>{y.title=`${i("WP.index_32")} [${n.value.name}]`,y.data.site=n.value,y.show=!0},D=N(!1),q=async e=>{try{D.value=!0,await b({source:200}),await k("tamper_core"),e?await $({paths:[{path:n.value.path,ps:n.value.ps}]}):await O({path_id:o.pid}),ce()}finally{D.value=!1}},U=x(`File Protection [${n.value.name}]`,{site:n.value,open:!1,onChangeOpen:e=>{o.status=e}}),B=async()=>{await b({source:200}),await k("tamper_core"),U.data.open=o.status,U.show=!0},I=Z({status:!1,number:0}),T=N(!1),V=async e=>{try{T.value=!0,await b({source:201}),await k("btwaf"),e?await R({site_name:n.value.name}):await M({site_name:n.value.name}),ce()}finally{T.value=!1}},G=async()=>{await b({source:201}),await k("btwaf"),_(n.value.name),Y()},Y=()=>{let e=0;const t=setInterval(()=>{e+=.5;const l=document.querySelector(".waf_site_body");if(l){let e=!1;new MutationObserver(t=>{t.forEach(t=>{"childList"!==t.type||document.contains(l)||e||(ce(),e=!0)})}).observe(document.body,{childList:!0,subtree:!0}),clearInterval(t)}e>=20&&clearInterval(t)},500)},le=N(!1),se=N(!1),ne=async e=>{try{se.value=!0;const{message:t}=await j({id:n.value.id,name:n.value.name},!1);if(s(t)){const l={id:n.value.id,name:n.value.name,fix:t.fix,domains:t.domains,return_rule:t.return_rule,status:e,http_status:"true"===t.http_status};await P(l,!1),le.value=e}}finally{se.value=!1}},ue=x(`Hotlink Protection [${n.value.name}]`,{site:n.value,onChangeHotlink:e=>{le.value=e}}),de=()=>{ue.show=!0},re=e=>{D.value=e,T.value=e,se.value=e,u.value=e},ce=async()=>{try{re(!0);const{message:e}=await W({id:n.value.id,path:n.value.path,site_name:n.value.name});if(s(e)&&(o.status=1===e.file_status,o.number=e.file_count,I.status=1===e.firewall_status,I.number=e.firewall_count,le.value=1===e.hotlink_status,m.value=1===e.virus_scanning,1===e.file_status)){const{message:e}=await C({path:n.value.path});s(e)&&(o.pid=e.pid)}}finally{re(!1)}};return ce(),(e,t)=>{const s=oe,i=te,n=r,c=ie,_=ae,v=p;return A(),L("div",qe,[S("div",Ue,[S("div",Be,[F(s,{lazy:!0,"preview-disabled":!0,width:"24",src:`${H(d)}images/soft-ico/ico-tamper_core.png`},null,8,["src"])]),S("div",Fe,X(e.$t("WP.Label.index_5")),1),F(i,{value:H(o).status,loading:H(D),"onUpdate:value":q},null,8,["value","loading"]),F(c,{quaternary:"",size:"small",onClick:B},{default:E(()=>[F(n,{name:"setting",size:"18"})]),_:1}),S("div",Le,[F(_,{type:"error",size:"small",bordered:!1},{default:E(()=>[J(X(H(o).number),1)]),_:1}),S("span",Ae,X(e.$t("WP.Config.index_6")),1)])]),S("div",Se,[S("div",He,[F(s,{lazy:!0,"preview-disabled":!0,width:"26",src:`${H(d)}images/soft-ico/ico-btwaf.png`},null,8,["src"])]),S("div",Ie,X(e.$t("WP.Label.index_6")),1),F(i,{value:H(I).status,loading:H(T),"onUpdate:value":V},null,8,["value","loading"]),F(c,{quaternary:"",size:"small",onClick:G},{default:E(()=>[F(n,{name:"setting",size:"18"})]),_:1}),S("div",Ee,[F(_,{type:"error",size:"small",bordered:!1},{default:E(()=>[J(X(H(I).number),1)]),_:1}),S("span",Te,X(e.$t("WP.Config.index_7")),1)])]),S("div",Ke,[S("div",Ne,[F(n,{name:"soft-hotlink",size:"24"})]),S("div",Ve,X(e.$t("WP.Label.index_7")),1),F(i,{value:H(le),loading:H(se),"onUpdate:value":ne},null,8,["value","loading"]),F(c,{quaternary:"",size:"small",onClick:de},{default:E(()=>[F(n,{name:"setting",size:"18"})]),_:1})]),S("div",Ge,[S("div",Je,[t[4]||(t[4]=S("div",{class:"tools-img"},[S("i",{class:"i-healthicons:health-vulnerability-through-social-determinants-outline-24px text-26px text-primary!"})],-1)),S("div",Xe,X(e.$t("WP.index_43")),1),F(i,{value:H(m),loading:H(u),"onUpdate:value":h},null,8,["value","loading"]),F(c,{quaternary:"",size:"small",onClick:g},{default:E(()=>[F(n,{name:"setting",size:"18"})]),_:1})]),t[5]||(t[5]=S("div",{class:"w-full color-#999"},"Check plugins and themes for security risks",-1))]),S("div",Qe,[S("div",Ye,[t[6]||(t[6]=S("div",{class:"tools-img"},[S("i",{class:"i-material-symbols:library-add-check-outline text-26px text-#20a53a!"})],-1)),S("div",Ze,X(e.$t("WP.TableRow.index_4")),1),F(c,{quaternary:"",size:"small",onClick:w},{default:E(()=>[F(n,{name:"setting",size:"18"})]),_:1})]),t[7]||(t[7]=S("div",{class:"w-full color-#999"}," Check the integrity of the core files of this WP version to ensure they are not infected with malicious viruses! ",-1))]),F(v,{show:H(U).show,"onUpdate:show":t[0]||(t[0]=e=>H(U).show=e),title:H(U).title,data:H(U).data,width:800,component:Me},null,8,["show","title","data"]),F(v,{show:H(ue).show,"onUpdate:show":t[1]||(t[1]=e=>H(ue).show=e),title:H(ue).title,data:H(ue).data,component:De},null,8,["show","title","data"]),F(v,{show:H(f).show,"onUpdate:show":t[2]||(t[2]=e=>H(f).show=e),title:H(f).title,data:H(f).data,width:800,"min-height":500,component:H(l)},null,8,["show","title","data","component"]),F(v,{show:H(y).show,"onUpdate:show":t[3]||(t[3]=e=>H(y).show=e),title:H(y).title,data:H(y).data,width:600,"min-height":190,component:H(a)},null,8,["show","title","data","component"])])}}});e("default",n(et,[["__scopeId","data-v-856e3a0e"]]))}}});
