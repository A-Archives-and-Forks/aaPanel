import{_ as e}from"./index.js?v=1753954525509";import{v as t,i as a,c as l,aZ as s,e as i,m as n,w as o,bk as u,_ as r}from"./page_layout.js?v=1753954525509";import{o as p}from"./site4.js?v=1753954525509";import{c as d,b as c,f as _,h as m,d as f,_ as h,w as v,e as w,G as g,r as x}from"./public.js?v=1753954525509";import{X as y,aG as b}from"./site.js?v=1753954525509";import{h as j,o as k,i as P,j as C,k as O,l as D}from"./index86.js?v=1753954525509";import{_ as R}from"./index102.js?v=1753954525509";import{p as M,i as q,k as z,Q as W,U,V as B,X as F,W as L,a1 as $,a2 as A,q as S,P as H,r as I,ah as E,at as K,j as T,a3 as V,t as N,al as G,e as X}from"./vue.js?v=1753954525509";import{c5 as Q,c7 as Z,c0 as J,aq as Y,ay as ee,c6 as te,bC as ae}from"./naive.js?v=1753954525509";import{_ as le}from"./form.vue_vue_type_script_setup_true_lang2.js?v=1753954525509";import"./common.js?v=1753954525509";import"./__commonjsHelpers__.js?v=1753954525509";import"./index127.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang4.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang11.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1753954525509";import"./soft.js?v=1753954525509";import"./index237.js?v=1753954525509";import"./index100.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang9.js?v=1753954525509";import"./index96.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang14.js?v=1753954525509";import"./theme-chrome.js?v=1753954525509";import"./file2.js?v=1753954525509";import"./refersh.js?v=1753954525509";import"./php.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang17.js?v=1753954525509";import"./index101.js?v=1753954525509";import"./ssl.js?v=1753954525509";import"./cert.js?v=1753954525509";import"./utils3.js?v=1753954525509";import"./index209.js?v=1753954525509";import"./paypal-js.js?v=1753954525509";import"./ssl-lets-progress.js?v=1753954525509";import"./Ssl.vue_vue_type_script_setup_true_lang.js?v=1753954525509";const se=Symbol("server-list");function ie(){return q(se)}const ne=e=>t.post("/tamper_core/add_black_exts.json",e,{requestOptions:{loading:a.global.t("WP.api.tamper_2"),isOriginalResult:!0,prefix:""}}),oe=e=>t.post("/tamper_core/remove_black_exts.json",e,{requestOptions:{loading:a.global.t("WP.api.tamper_3"),isOriginalResult:!0,prefix:""}}),ue=z({__name:"index",setup(e,{expose:i}){const{site:n,setPid:o}=ie(),{loading:u,setLoading:r}=d(),{table:p,columns:m}=c([{key:"name",title:"Name"},{key:"status",title:"Status",align:"right",render:e=>W(Q,{value:e.status,size:"small",checkedValue:1,uncheckedValue:0,onUpdateValue:async s=>{const{message:i}=await(n={key:e.key,value:s,path_id:e.id},t.post("/tamper_core/modify_path_config.json",n,{requestOptions:{loading:a.global.t("WP.api.tamper_1"),isOriginalResult:!0,prefix:""}}));var n;l(i)&&i.status&&(e.status=s)}},null)}]),f=[{title:"Create file",name:"create"},{title:"Modify file",name:"modify"},{title:"Delete file",name:"unlink"},{title:"Create directory",name:"mkdir"},{title:"Delete directory",name:"rmdir"},{title:"Rename file",name:"rename"},{title:"Create soft link",name:"link"},{title:"Modify permissions",name:"chmod"},{title:"Modify owner",name:"chown"}],h=async()=>{try{r(!0);const{message:t}=await j({path:n.path});l(t)&&!Z(t)?(o(t.pid),e=t,p.data=f.map((t=>{const a="is_".concat(t.name),l=e[a];return{key:a,id:e.pid,name:"Disabled ".concat(t.title),status:s(l)?l:0}}))):p.data=[]}finally{r(!1)}var e};return h(),i({init:h}),(e,t)=>{const a=_;return U(),B("div",null,[W(a,{loading:F(u),"loading-num":9,"max-height":340,data:F(p).data,columns:F(m)},null,8,["loading","data","columns"]),t[0]||(t[0]=L("div",{class:"mt-16px text-#777"}," Tip: Current config intercepts the above rules by default, please set and config the rules according the current project requirements. ",-1))])}}});const re=i({},[["render",function(e,t){const a=J;return U(),$(a,{size:"small",bordered:!1},{default:A((()=>[S(e.$slots,"default",{},void 0,!0)])),_:3})}],["__scopeId","data-v-c6193199"]]),pe={class:"flex mb-12px"},de={class:"w-240px mr-12px"},ce=z({__name:"index",setup(e,{expose:t}){const{t:a}=H(),{site:s,setPid:i}=ie(),u=I("");let r=-1,p="";const v=async()=>{if(""===u.value.trim())return void n.error("Please enter suffix");const{message:e}=await ne({path_id:r,path:p,exts:u.value});l(e)&&(e.status?(n.success(e.msg),u.value="",k()):n.error(e.msg))},{table:w,columns:g}=c([{key:"exts",title:"Suffix"},m({width:100,options:e=>[{label:a("Public.Btn.Del"),onClick:()=>{x(e)}}]})]),x=async e=>{f({title:"Delete protected file suffix [".concat(e.exts,"]"),content:"Delete protected file suffix, the file whose file name ends with this suffix will lose protection. want to continue?",onConfirm:async()=>{const{message:t}=await oe({path_id:e.id,path:p,exts:e.exts});l(t)&&(t.status?(n.success(t.msg),k()):n.error(t.msg))}})},{loading:y,setLoading:b}=d(),k=async()=>{try{b(!0);const{message:t}=await j({path:s.path});l(t)&&(i(t.pid),r=(e=t).pid,p=e.path,o(e.black_exts)?w.data=e.black_exts.filter((e=>"/"!=e[0]&&-1==e.indexOf("./"))).map((t=>({id:e.pid,exts:t}))):w.data=[])}finally{b(!1)}var e};return k(),t({init:k}),(e,t)=>{const a=Y,l=ee,s=_,i=re,n=h;return U(),B("div",null,[L("div",pe,[L("div",de,[W(a,{value:F(u),"onUpdate:value":t[0]||(t[0]=e=>E(u)?u.value=e:null),placeholder:"Suffix",onKeyup:K(v,["enter"])},null,8,["value"])]),W(l,{type:"primary",onClick:v},{default:A((()=>[T(V(e.$t("Public.Btn.Add")),1)])),_:1})]),W(s,{loading:F(y),"loading-num":6,"max-height":230,data:F(w).data,columns:F(g)},null,8,["loading","data","columns"]),W(n,{class:"mt-16px"},{default:A((()=>[t[25]||(t[25]=L("li",null," The so-called file suffix refers the string at the end of the file name, not necessarily the extension ",-1)),L("li",null,[t[5]||(t[5]=T(" As: ")),W(i,null,{default:A((()=>t[1]||(t[1]=[T(".php")]))),_:1,__:[1]}),t[6]||(t[6]=T(", ")),W(i,null,{default:A((()=>t[2]||(t[2]=[T(".html")]))),_:1,__:[2]}),t[7]||(t[7]=T(", ")),W(i,null,{default:A((()=>t[3]||(t[3]=[T(".js?v=1753954525509")]))),_:1,__:[3]}),t[8]||(t[8]=T(", ")),W(i,null,{default:A((()=>t[4]||(t[4]=[T("index.php")]))),_:1,__:[4]}),t[9]||(t[9]=T(" etc. "))]),t[26]||(t[26]=L("div",null,"Example:",-1)),L("li",null,[W(i,null,{default:A((()=>t[10]||(t[10]=[T(".php")]))),_:1,__:[10]}),t[14]||(t[14]=T(" Match: ")),W(i,null,{default:A((()=>t[11]||(t[11]=[T("./1.php")]))),_:1,__:[11]}),t[15]||(t[15]=T()),W(i,null,{default:A((()=>t[12]||(t[12]=[T("./test/2.php")]))),_:1,__:[12]}),t[16]||(t[16]=T(" Mismatch: ")),W(i,null,{default:A((()=>t[13]||(t[13]=[T("./1.php/1.txt")]))),_:1,__:[13]})]),L("li",null,[W(i,null,{default:A((()=>t[17]||(t[17]=[T("index.php")]))),_:1,__:[17]}),t[22]||(t[22]=T(" Match: ")),W(i,null,{default:A((()=>t[18]||(t[18]=[T("./index.php")]))),_:1,__:[18]}),t[23]||(t[23]=T()),W(i,null,{default:A((()=>t[19]||(t[19]=[T("./test/index.php")]))),_:1,__:[19]}),W(i,{class:"ml-0.5em"},{default:A((()=>t[20]||(t[20]=[T("./abc_index.php")]))),_:1,__:[20]}),t[24]||(t[24]=T(" Mismatch: ")),W(i,null,{default:A((()=>t[21]||(t[21]=[T("./index.php.tar.gz")]))),_:1,__:[21]})])])),_:1,__:[25,26]})])}}}),_e={class:"flex mb-12px"},me={class:"w-240px mr-12px"},fe=z({__name:"index",setup(e,{expose:t}){const{t:a}=H(),{site:s,setPid:i}=ie(),u=I("");let r=-1,p="";const v=async()=>{if(""===u.value.trim())return void n.error("Please enter the full path or relative path of the file");const{message:e}=await ne({path_id:r,path:p,exts:u.value});l(e)&&(e.status?(n.success(e.msg),u.value="",k()):n.error(e.msg))},{table:w,columns:g}=c([{key:"exts",title:"Full file path"},m({width:100,options:e=>[{label:a("Public.Btn.Del"),onClick:()=>{x(e)}}]})]),x=async e=>{f({title:"Delete protected files [".concat(e.exts,"]"),content:"After deleting a protected file, the file will be unprotected, should I continue the operation?",onConfirm:async()=>{const{message:t}=await oe({path_id:e.id,path:p,exts:e.exts});l(t)&&(t.status?(n.success(t.msg),k()):n.error(t.msg))}})},{loading:y,setLoading:b}=d(),k=async()=>{try{b(!0);const{message:t}=await j({path:s.path});l(t)&&(i(t.pid),r=(e=t).pid,p=e.path,o(e.black_exts)?w.data=e.black_exts.filter((e=>"/"==e[0]||"."==e[0]&&"/"==e[1])).map((t=>({id:e.pid,exts:t}))):w.data=[])}finally{b(!1)}var e};return k(),t({init:k}),(e,t)=>{const a=Y,l=ee,s=_,i=re,n=h;return U(),B("div",null,[L("div",_e,[L("div",me,[W(a,{value:F(u),"onUpdate:value":t[0]||(t[0]=e=>E(u)?u.value=e:null),placeholder:"Full path Or Relative path",onKeyup:K(v,["enter"])},null,8,["value"])]),W(l,{type:"primary",onClick:v},{default:A((()=>[T(V(e.$t("Public.Btn.Add")),1)])),_:1})]),W(s,{loading:F(y),"loading-num":5,"max-height":200,data:F(w).data,columns:F(g)},null,8,["loading","data","columns"]),W(n,{class:"mt-16px"},{default:A((()=>[t[15]||(t[15]=L("li",{class:"font-bold text-#333"},"The following 4 methods are supported",-1)),L("li",null,[t[2]||(t[2]=T("1. Complete file path, such as: ")),W(i,null,{default:A((()=>t[1]||(t[1]=[T("/www/wwwroot/test/123.log")]))),_:1,__:[1]})]),L("li",null,[t[5]||(t[5]=T(" 2. Relative path to the site, such as: Full path ")),W(i,null,{default:A((()=>t[3]||(t[3]=[T("/www/wwwroot/test/app/123.log")]))),_:1,__:[3]}),t[6]||(t[6]=T(" Relative path ")),W(i,null,{default:A((()=>t[4]||(t[4]=[T("./app/123.log")]))),_:1,__:[4]})]),L("li",null,[t[9]||(t[9]=T(" 3. All files in the specified directory, such as: ")),W(i,null,{default:A((()=>t[7]||(t[7]=[T("/www/wwwroot/test/app/*")]))),_:1,__:[7]}),t[10]||(t[10]=T(" Relative path ")),W(i,null,{default:A((()=>t[8]||(t[8]=[T("./app/*")]))),_:1,__:[8]})]),L("li",null,[t[13]||(t[13]=T(" 4. the specified directory under the specified file type, such as: ")),W(i,null,{default:A((()=>t[11]||(t[11]=[T("/www/wwwroot/test/app/*.log")]))),_:1,__:[11]}),t[14]||(t[14]=T(" Relative path ")),W(i,null,{default:A((()=>t[12]||(t[12]=[T("./app/*.log")]))),_:1,__:[12]})]),t[16]||(t[16]=L("li",{class:"text-error"}," Note: files already included in the protected file suffix do not need to be set. ",-1))])),_:1,__:[15,16]})])}}}),he={class:"flex mb-12px"},ve={class:"w-240px mr-12px"},we=z({__name:"index",setup(e,{expose:s}){const{t:i}=H(),{site:u,setPid:r}=ie(),p=I("");let w=-1,g="";const x=async()=>{if(""===p.value.trim())return void n.error("Please enter directory name");const{message:e}=await(s={path_id:w,path:g,dirnames:p.value},t.post("/tamper_core/add_white_dirs.json",s,{requestOptions:{loading:a.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var s;l(e)&&(e.status?(n.success(e.msg),p.value="",O()):n.error(e.msg))},{table:y,columns:b}=c([{key:"dir",title:"Directory",ellipsis:{tooltip:!0}},v({title:"Remark",onBlur:async(e,s)=>{const{message:i}=await(o={path_id:s.id,dir_name:s.dir,ps:e},t.post("/tamper_core/set_white_dir_with_ps.json",o,{requestOptions:{loading:a.global.t("WP.api.tamper_5"),isOriginalResult:!0,prefix:""}}));var o;l(i)&&(i.status?s.ps=e:n.error(i.msg))}}),m({width:80,options:e=>[{label:i("Public.Btn.Del"),onClick:()=>{k(e)}}]})]),k=async e=>{f({title:"Delete directory whitelist",content:e.tip_msg?e.tip_msg:"Delete [".concat(e.dir,"] later, All files in the directory will be protected, continue?"),onConfirm:async()=>{const{message:s}=await(i={path_id:e.id,path:g,dirname:e.dir},t.post("/tamper_core/remove_white_dirs.json",i,{requestOptions:{loading:a.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var i;l(s)&&(s.status?(n.success(s.msg),O()):n.error(s.msg))}})},{loading:P,setLoading:C}=d(),O=async()=>{try{C(!0);const{message:t}=await j({path:u.path});l(t)&&(r(t.pid),w=(e=t).pid,g=e.path,o(e.white_dirs)?y.data=e.white_dirs.map((t=>({id:e.pid,ps:t.ps||"",tip_msg:t.tip_msg||"",...t}))):y.data=[])}finally{C(!1)}var e};return O(),s({init:O}),(e,t)=>{const a=Y,l=ee,s=_,i=re,n=h;return U(),B("div",null,[L("div",he,[L("div",ve,[W(a,{value:F(p),"onUpdate:value":t[0]||(t[0]=e=>E(p)?p.value=e:null),placeholder:"Directory name",onKeyup:K(x,["enter"])},null,8,["value"])]),W(l,{type:"primary",onClick:x},{default:A((()=>[T(V(e.$t("Public.Btn.Add")),1)])),_:1})]),W(s,{loading:F(P),"loading-num":5,"max-height":188,data:F(y).data,columns:F(b)},null,8,["loading","data","columns"]),W(n,{class:"mt-16px"},{default:A((()=>[L("li",null,[t[4]||(t[4]=T(" Full path or directory name or parts path are allowed such as: ")),W(i,null,{default:A((()=>t[1]||(t[1]=[T("/www/abc/cache/test/")]))),_:1,__:[1]}),t[5]||(t[5]=T(", ")),W(i,null,{default:A((()=>t[2]||(t[2]=[T("test")]))),_:1,__:[2]}),t[6]||(t[6]=T(", ")),W(i,null,{default:A((()=>t[3]||(t[3]=[T("cache/test/")]))),_:1,__:[3]})]),L("li",null,[t[10]||(t[10]=T(" The first character of the Full path must be ")),W(i,null,{default:A((()=>t[7]||(t[7]=[T("/")]))),_:1,__:[7]}),t[11]||(t[11]=T(", as: ")),W(i,null,{default:A((()=>t[8]||(t[8]=[T("cache/test/")]))),_:1,__:[8]}),t[12]||(t[12]=T(" or ")),W(i,null,{default:A((()=>t[9]||(t[9]=[T("test")]))),_:1,__:[9]})]),L("li",null,[t[15]||(t[15]=T(" art of directory name or path cannot begin with ")),W(i,null,{default:A((()=>t[13]||(t[13]=[T("/")]))),_:1,__:[13]}),t[16]||(t[16]=T(", as: ")),W(i,null,{default:A((()=>t[14]||(t[14]=[T("/www/abc/cache/test/")]))),_:1,__:[14]})]),t[39]||(t[39]=L("div",null,"Example:",-1)),L("li",null,[W(i,null,{default:A((()=>t[17]||(t[17]=[T("/www/abc/")]))),_:1,__:[17]}),t[21]||(t[21]=T(" Match: ")),W(i,null,{default:A((()=>t[18]||(t[18]=[T("/www/abc/*")]))),_:1,__:[18]}),t[22]||(t[22]=T(" Mismatch: ")),W(i,null,{default:A((()=>t[19]||(t[19]=[T("/www/abc")]))),_:1,__:[19]}),W(i,{class:"ml-0.5em"},{default:A((()=>t[20]||(t[20]=[T("/www/abc123")]))),_:1,__:[20]})]),L("li",null,[W(i,null,{default:A((()=>t[23]||(t[23]=[T("test")]))),_:1,__:[23]}),t[27]||(t[27]=T(" Match: ")),W(i,null,{default:A((()=>t[24]||(t[24]=[T("/www/test/1.txt")]))),_:1,__:[24]}),t[28]||(t[28]=T()),W(i,null,{default:A((()=>t[25]||(t[25]=[T("/www/test_abc")]))),_:1,__:[25]}),t[29]||(t[29]=T(" Mismatch: ")),W(i,null,{default:A((()=>t[26]||(t[26]=[T("/www/1.php")]))),_:1,__:[26]})]),L("li",null,[W(i,null,{default:A((()=>t[30]||(t[30]=[T("cache/test/")]))),_:1,__:[30]}),t[35]||(t[35]=T(" Match: ")),W(i,null,{default:A((()=>t[31]||(t[31]=[T("/www/cache/test/1.txt")]))),_:1,__:[31]}),t[36]||(t[36]=T()),W(i,null,{default:A((()=>t[32]||(t[32]=[T("/cache/test/")]))),_:1,__:[32]}),t[37]||(t[37]=T(" Mismatch: ")),W(i,null,{default:A((()=>t[33]||(t[33]=[T("/www/cache/test")]))),_:1,__:[33]}),t[38]||(t[38]=T()),W(i,null,{default:A((()=>t[34]||(t[34]=[T("/cache/")]))),_:1,__:[34]})])])),_:1,__:[39]})])}}}),ge={class:"flex mb-12px"},xe={class:"w-240px mr-12px"},ye=z({__name:"index",setup(e,{expose:s}){const{t:i}=H(),{site:u,setPid:r}=ie(),p=I("");let v=-1,w="";const g=async()=>{if(""===p.value.trim())return void n.error("Please enter file name");const{message:e}=await(s={path_id:v,path:w,filename:p.value},t.post("/tamper_core/add_white_files.json",s,{requestOptions:{loading:a.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var s;l(e)&&(e.status?(n.success(e.msg),p.value="",C()):n.error(e.msg))},{table:x,columns:y}=c([{key:"filename",title:"File name"},m({width:100,options:e=>[{label:i("Public.Btn.Del"),onClick:()=>{b(e)}}]})]),b=async e=>{f({title:"Delete file whitelist [".concat(e.filename,"]"),content:"After Delete whitelist, the file will be protected. want to continue?",onConfirm:async()=>{const{message:s}=await(i={path_id:e.id,path:w,filename:e.filename},t.post("/tamper_core/remove_white_files.json",i,{requestOptions:{loading:a.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var i;l(s)&&(s.status?(n.success(s.msg),C()):n.error(s.msg))}})},{loading:k,setLoading:P}=d(),C=async()=>{try{P(!0);const{message:t}=await j({path:u.path});l(t)&&(r(t.pid),v=(e=t).pid,w=e.path,o(e.white_files)?x.data=e.white_files.map((t=>({id:e.pid,filename:t}))):x.data=[])}finally{P(!1)}var e};return C(),s({init:C}),(e,t)=>{const a=Y,l=ee,s=_,i=re,n=h;return U(),B("div",null,[L("div",ge,[L("div",xe,[W(a,{value:F(p),"onUpdate:value":t[0]||(t[0]=e=>E(p)?p.value=e:null),placeholder:"File name",onKeyup:K(g,["enter"])},null,8,["value"])]),W(l,{type:"primary",onClick:g},{default:A((()=>[T(V(e.$t("Public.Btn.Add")),1)])),_:1})]),W(s,{loading:F(k),"loading-num":6,"max-height":230,data:F(x).data,columns:F(y)},null,8,["loading","data","columns"]),W(n,{class:"mt-16px"},{default:A((()=>[L("li",null,[t[3]||(t[3]=T(" Full path or single filename are allowed such as: ")),W(i,null,{default:A((()=>t[1]||(t[1]=[T("/test/index.php")]))),_:1,__:[1]}),t[4]||(t[4]=T(", ")),W(i,null,{default:A((()=>t[2]||(t[2]=[T("index.php")]))),_:1,__:[2]})]),t[17]||(t[17]=L("li",null,"Note: Only be an absolute path or file name, relative paths are not supported",-1)),t[18]||(t[18]=L("div",null,"Example:",-1)),L("li",null,[W(i,null,{default:A((()=>t[5]||(t[5]=[T("index.php")]))),_:1,__:[5]}),t[10]||(t[10]=T(" Match: ")),W(i,null,{default:A((()=>t[6]||(t[6]=[T("./index.php")]))),_:1,__:[6]}),t[11]||(t[11]=T()),W(i,null,{default:A((()=>t[7]||(t[7]=[T("./test/index.php")]))),_:1,__:[7]}),t[12]||(t[12]=T(" Mismatch: ")),W(i,null,{default:A((()=>t[8]||(t[8]=[T("./abc_index.php")]))),_:1,__:[8]}),t[13]||(t[13]=T()),W(i,null,{default:A((()=>t[9]||(t[9]=[T("./index.php/1.txt")]))),_:1,__:[9]})]),L("li",null,[W(i,null,{default:A((()=>t[14]||(t[14]=[T("/test/index.php")]))),_:1,__:[14]}),t[16]||(t[16]=T(" match only: ")),W(i,null,{default:A((()=>t[15]||(t[15]=[T("/test/index.php")]))),_:1,__:[15]})])])),_:1,__:[17,18]})])}}}),be={class:"p-20px"},je={class:"flex items-center text-12px text-#666"},ke={key:0,class:"ml-12px"},Pe={class:"h-500px"},Ce=z({__name:"index",props:{open:{type:Boolean,default:!1},site:{}},emits:["changeOpen"],setup(e,{emit:t}){const a=e,l=t,s=N(a,"site");let i=-1;const n=I(a.open),o=I(),u=async e=>{e?await k({paths:[{path:s.value.path,ps:s.value.ps}]}):await P({path_id:i}),n.value=e,l("changeOpen",e),o.value.init()},r=I("basic"),p=[{key:"basic",label:"Basic Setting",component:ue},{key:"suffix",label:"Protected file suffix",component:ce},{key:"protected file",label:"Protected File",component:fe},{key:"directory whitelist",label:"Directory whitelist",component:we},{key:"file whitelist",label:"File whitelist",component:ye}];var d;return d={site:s.value,setPid:e=>{i=e}},M(se,d),(e,t)=>{const a=Q,l=te,s=R;return U(),B("div",be,[W(l,{class:"mb-16px",type:F(n)?"success":"error","show-icon":!1,bordered:!1},{default:A((()=>[L("div",je,[t[1]||(t[1]=L("span",{class:"mr-12px"},"Protection switch",-1)),W(a,{value:F(n),"onUpdate:value":u},null,8,["value"]),F(n)?G("",!0):(U(),B("span",ke," Protection directory closed, be security risks, Recommended open protection immediately "))])])),_:1},8,["type"]),L("div",Pe,[W(s,{ref_key:"tabsRef",ref:o,value:F(r),"onUpdate:value":t[0]||(t[0]=e=>E(r)?r.value=e:null),options:p},null,8,["value"])])])}}}),Oe=z({__name:"index",props:{site:{}},emits:["changeHotlink"],setup(e,{emit:t}){const a=t,l=N(e,"site"),s=e=>{a("changeHotlink",e)};return(e,t)=>(U(),B("div",null,[W(le,{class:"p-20px",site:F(l),onChangeHotlink:s},null,8,["site"])]))}}),De={class:"p-20px"},Re={class:"tools-card"},Me={class:"tools-img"},qe={class:"tools-name"},ze={class:"tools-desc"},We={class:"ml-0.5em"},Ue={class:"tools-card"},Be={class:"tools-img"},Fe={class:"tools-name"},Le={class:"tools-desc"},$e={class:"ml-0.5em"},Ae={class:"tools-card"},Se={class:"tools-img"},He={class:"tools-name"},Ie=i(z({__name:"index",props:{site:{}},setup(t){const a=N(t,"site"),s=X({status:!1,number:0,pid:-1}),i=I(!1),n=async e=>{try{i.value=!0,await g({source:200}),await x("tamper_core"),e?await k({paths:[{path:a.value.path,ps:a.value.ps}]}):await P({path_id:s.pid}),S()}finally{i.value=!1}},o=w("File Protection [".concat(a.value.name,"]"),{site:a.value,open:!1,onChangeOpen:e=>{s.status=e}}),d=async()=>{await g({source:200}),await x("tamper_core"),o.data.open=s.status,o.show=!0},c=X({status:!1,number:0}),_=I(!1),m=async e=>{try{_.value=!0,await g({source:201}),await x("btwaf"),e?await C({site_name:a.value.name}):await O({site_name:a.value.name}),S()}finally{_.value=!1}},f=async()=>{await g({source:201}),await x("btwaf"),p(a.value.name),h()},h=()=>{let e=0;const t=setInterval((()=>{e+=.5;const a=document.querySelector(".waf_site_body");if(a){let e=!1;new MutationObserver((t=>{t.forEach((t=>{"childList"!==t.type||document.contains(a)||e||(S(),e=!0)}))})).observe(document.body,{childList:!0,subtree:!0}),clearInterval(t)}e>=20&&clearInterval(t)}),500)},v=I(!1),R=I(!1),M=async e=>{try{R.value=!0;const{message:t}=await y({id:a.value.id,name:a.value.name},!1);if(l(t)){const l={id:a.value.id,name:a.value.name,fix:t.fix,domains:t.domains,return_rule:t.return_rule,status:e,http_status:"true"===t.http_status};await b(l,!1),v.value=e}}finally{R.value=!1}},q=w("Hotlink Protection [".concat(a.value.name,"]"),{site:a.value,onChangeHotlink:e=>{v.value=e}}),z=()=>{q.show=!0},$=e=>{i.value=e,_.value=e,R.value=e},S=async()=>{try{$(!0);const{message:e}=await D({id:a.value.id,path:a.value.path,site_name:a.value.name});if(l(e)&&(s.status=1===e.file_status,s.number=e.file_count,c.status=1===e.firewall_status,c.number=e.firewall_count,v.value=1===e.hotlink_status,1===e.file_status)){const{message:e}=await j({path:a.value.path});l(e)&&(s.pid=e.pid)}}finally{$(!1)}};return S(),(t,a)=>{const l=ae,p=Q,h=r,w=ee,g=J,x=e;return U(),B("div",De,[L("div",Re,[L("div",Me,[W(l,{lazy:!0,"preview-disabled":!0,width:"24",src:"".concat(F(u),"images/soft-ico/ico-tamper_core.png")},null,8,["src"])]),L("div",qe,V(t.$t("WP.Label.index_5")),1),W(p,{value:F(s).status,loading:F(i),"onUpdate:value":n},null,8,["value","loading"]),W(w,{quaternary:"",size:"small",onClick:d},{default:A((()=>[W(h,{name:"setting",size:"18"})])),_:1}),L("div",ze,[W(g,{type:"error",size:"small",bordered:!1},{default:A((()=>[T(V(F(s).number),1)])),_:1}),L("span",We,V(t.$t("WP.Config.index_6")),1)])]),L("div",Ue,[L("div",Be,[W(l,{lazy:!0,"preview-disabled":!0,width:"26",src:"".concat(F(u),"images/soft-ico/ico-btwaf.png")},null,8,["src"])]),L("div",Fe,V(t.$t("WP.Label.index_6")),1),W(p,{value:F(c).status,loading:F(_),"onUpdate:value":m},null,8,["value","loading"]),W(w,{quaternary:"",size:"small",onClick:f},{default:A((()=>[W(h,{name:"setting",size:"18"})])),_:1}),L("div",Le,[W(g,{type:"error",size:"small",bordered:!1},{default:A((()=>[T(V(F(c).number),1)])),_:1}),L("span",$e,V(t.$t("WP.Config.index_7")),1)])]),L("div",Ae,[L("div",Se,[W(h,{name:"soft-hotlink",size:"24"})]),L("div",He,V(t.$t("WP.Label.index_7")),1),W(p,{value:F(v),loading:F(R),"onUpdate:value":M},null,8,["value","loading"]),W(w,{quaternary:"",size:"small",onClick:z},{default:A((()=>[W(h,{name:"setting",size:"18"})])),_:1})]),W(x,{show:F(o).show,"onUpdate:show":a[0]||(a[0]=e=>F(o).show=e),title:F(o).title,data:F(o).data,width:800,component:Ce},null,8,["show","title","data"]),W(x,{show:F(q).show,"onUpdate:show":a[1]||(a[1]=e=>F(q).show=e),title:F(q).title,data:F(q).data,component:Oe},null,8,["show","title","data"])])}}}),[["__scopeId","data-v-3d92e7a2"]]);export{Ie as default};
