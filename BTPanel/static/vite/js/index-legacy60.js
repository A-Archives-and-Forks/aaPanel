System.register(["./public-legacy.js?v=1747989938512","./index-legacy103.js?v=1747989938512","./index-legacy.js?v=1747989938512","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1747989938512","./page_layout-legacy.js?v=1747989938512","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1747989938512","./index.vue_vue_type_script_setup_true_lang-legacy11.js?v=1747989938512","./vue-legacy.js?v=1747989938512","./naive-legacy.js?v=1747989938512","./index.vue_vue_type_script_setup_true_lang-legacy8.js?v=1747989938512","./common-legacy.js?v=1747989938512","./__commonjsHelpers__-legacy.js?v=1747989938512","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1747989938512","./index-legacy96.js?v=1747989938512"],(function(e,t){"use strict";var a,n,l,i,s,o,d,u,c,r,p,_,y,m,g,x,h,f,v,w,b,k,S,I,A,$,C,U,j,H,R,q,L,O,T,P,M,z,K,D,B,F,N,E,V,W,Y,G,J,Q,X,Z,ee,te,ae,ne,le,ie;return{setters:[e=>{a=e.c,n=e.f,l=e.d,i=e.e,s=e.h,o=e._,d=e.K,u=e.b,c=e.F},e=>{r=e._},e=>{p=e._},e=>{_=e._},e=>{y=e.i,m=e.t,g=e.c,x=e.q,h=e.p,f=e.N,v=e.cC,w=e.m,b=e.b3,k=e._,S=e.u},e=>{I=e._},e=>{A=e._},e=>{$=e.d,C=e.O,U=e.r,j=e.j,H=e.R,R=e.S,q=e.P,L=e.a1,O=e.V,T=e.c,P=e.a2,M=e.aj,z=e.U,K=e.M,D=e._,B=e.w,F=e.F,N=e.a0,E=e.N,V=e.ak,W=e.k,Y=e.v,G=e.e},e=>{J=e.cj,Q=e.cp,X=e._,Z=e.T,ee=e.bY,te=e.bU,ae=e.bA,ne=e.cm,le=e.c0},e=>{ie=e._},null,null,null,null],execute:function(){var t=document.createElement("style");t.textContent=".form[data-v-201446e2] .n-form-item{margin-right:5px!important}.form[data-v-201446e2] .n-form-item-label{width:auto!important;padding:5px!important}.ul-style[data-v-f55518e2]{margin:0 auto;display:flex;align-items:center;justify-content:center;gap:48px;font-size:16px}.ul-style li[data-v-f55518e2]{display:flex;align-items:center}.item[data-v-f55518e2]{border-left:3px solid #def2e2}.item li[data-v-f55518e2]{width:180px;margin-left:-3px;font-size:14px;line-height:36px;padding:0 20px;cursor:pointer}.item .active[data-v-f55518e2]{border-left:3px solid #20a53a;color:#20a53a;font-weight:700;font-size:16px}\n",document.head.appendChild(t);const{t:se}=y.global,oe=e=>m.post("/plugin?name=syssafe&action=a&s=set_safe_status",e,{requestOptions:{loading:se("Security.Api.Index_5"),successMessage:!0}}),de=e=>m.post("/plugin?name=syssafe&action=a&s=remove_safe_path",e,{requestOptions:{loading:se("Security.Api.Index_3"),successMessage:!0}}),ue=e=>m.post("/plugin?name=syssafe&action=a&s=add_safe_path",e,{requestOptions:{loading:se("Security.Api.Index_4"),successMessage:!0}}),ce=e=>m.post("/plugin?name=syssafe&action=a&s=add_ssh_limit",e,{requestOptions:{loading:se("Security.Api.Index_4"),successMessage:!0}}),re=e=>m.post("/plugin?name=syssafe&action=a&s=remove_ssh_limit",e,{requestOptions:{loading:se("Security.Api.Index_3"),successMessage:!0}}),pe=e=>m.post("/plugin?name=syssafe&action=a&s=save_ssh_config",e,{requestOptions:{loading:se("Security.Api.Index_6"),successMessage:!0}}),_e=e=>m.post("/plugin?name=syssafe&action=a&s=remove_process_white",e,{requestOptions:{loading:se("Security.Api.Index_3"),successMessage:!0}}),ye=e=>m.post("/plugin?name=syssafe&action=a&s=add_process_white",e,{requestOptions:{loading:se("Security.Api.Index_4"),successMessage:!0}}),me={class:"p-20px"},ge=$({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=C(),n=[{label:a("Security.Anti.Index_28"),value:"i"},{label:a("Security.Anti.Index_29"),value:"a"}],l=e,{getList:i}=l.data,{row:s}=l.data,o=U(null),d=j({path:"",chattr:"i",d_mode:""}),u={path:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]},d_mode:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{await(o.value?.validate()),await ue({...d,s_key:s.key}),i?.(),e()}}),(e,t)=>{const a=A,l=J,i=Q,s=X,c=I;return H(),R("div",me,[q(c,{ref_key:"formRef",ref:o,model:O(d),rules:u},{default:L((()=>[q(l,{label:e.$t("Site.DelSite.index_2"),path:"path"},{default:L((()=>[q(a,{class:"w-280px",value:O(d).path,"onUpdate:value":t[0]||(t[0]=e=>O(d).path=e),placeholder:e.$t("Security.Anti.Index_26")},null,8,["value","placeholder"])])),_:1},8,["label"]),q(l,{label:e.$t("Security.Hardening.Index_8")},{default:L((()=>[q(i,{class:"w-280px",value:O(d).chattr,"onUpdate:value":t[1]||(t[1]=e=>O(d).chattr=e),options:n},null,8,["value"])])),_:1},8,["label"]),q(l,{label:e.$t("Security.Hardening.Index_9"),path:"d_mode"},{default:L((()=>[q(s,{class:"w-280px!",value:O(d).d_mode,"onUpdate:value":t[2]||(t[2]=e=>O(d).d_mode=e),type:"text",placeholder:e.$t("Security.Anti.Index_27")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),xe={class:"p-20px"},he=$({__name:"index",props:{data:{}},setup(e){const{t:t}=C(),d=e,{data:u}=d,{keys:c,table:r,columns:y}=a([{key:"path",title:t("Site.DelSite.index_2")},{key:"chattr",title:t("Security.Hardening.Index_8"),render:e=>"i"==e.chattr?t("Security.Anti.Index_28"):t("Security.Anti.Index_29")},{key:"s_mode",title:t("Security.Hardening.Index_9"),render:e=>e.s_mode!==e.d_mode?`${e.s_mode} >> ${e.d_mode}`:e.d_mode},{key:"state",title:t("Config.Safe.index_156"),render:e=>q("span",{style:{color:e.state?"#20a53a":"#ff0029"}},[e.state?t("Security.Anti.Index_35"):t("Security.Anti.Index_36")])},n({width:130,title:t("Public.Table.Operation"),options:e=>[{label:t("Public.Btn.Del"),onClick:async()=>{await de({s_key:u.key,path:e.path}),await v()}}]})]),x=async()=>{w.data.row=u,w.show=!0},{loading:h,setLoading:f}=l(),v=async()=>{try{f(!0);const{message:e}=await(e=>m.post("/plugin?name=syssafe&action=a&s=get_safe_config",e))({s_key:u.key});g(e)&&(r.data=e.paths)}finally{c.value=[],f(!1)}};v();const w=i(t("Security.Anti.Index_30"),{getList:v});return(e,t)=>{const a=Z,n=s,l=o,i=_,d=p;return H(),R("div",xe,[q(i,null,{toolsLeft:L((()=>[q(a,{type:"primary",onClick:x},{default:L((()=>[T(P(e.$t("Security.Anti.Index_30")),1)])),_:1})])),table:L((()=>[q(n,{"checked-row-keys":O(c),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>M(c)?c.value=e:null),loading:O(h),"loading-num":3,"max-height":340,data:O(r).data,columns:O(y)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:L((()=>[q(l,null,{default:L((()=>[z("li",null,P(e.$t("Security.Anti.Index_31")),1),z("li",null,P(e.$t("Security.Anti.Index_32")),1),z("li",null,P(e.$t("Security.Anti.Index_33")),1),z("li",null,P(e.$t("Security.Anti.Index_34")),1)])),_:1})])),_:1}),q(d,{show:O(w).show,"onUpdate:show":t[1]||(t[1]=e=>O(w).show=e),title:O(w).title,data:O(w).data,width:500,footer:!0,component:ge},null,8,["show","title","data"])])}}}),fe={class:"p-20px"},ve={class:"leading-32px"},we=$({__name:"index",setup(e){const{t:t}=C(),a=U(null),n=j({cycle:120,limit_count:3,limit:3600}),l={cycle:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]},limit_count:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]},limit:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]}},i=async()=>{await(a.value?.validate()),await pe(K(n))};return(async()=>{const{message:e}=await m.post("/plugin?name=syssafe&action=a&s=get_ssh_config");g(e)&&(n.cycle=e.cycle,n.limit=e.limit,n.limit_count=e.limit_count)})(),(e,t)=>{const s=ee,d=J,u=Z,c=I,r=x,p=o;return H(),R("div",fe,[q(c,{ref_key:"formRef",ref:a,model:O(n),rules:l,inline:"","label-width":"auto",class:"form"},{default:L((()=>[q(d,{label:e.$t("Security.Anti.Index_37"),path:"cycle"},{default:L((()=>[q(s,{"show-button":!1,value:O(n).cycle,"onUpdate:value":t[0]||(t[0]=e=>O(n).cycle=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),q(d,{label:e.$t("Security.Anti.Index_38"),path:"limit_count"},{default:L((()=>[q(s,{"show-button":!1,value:O(n).limit_count,"onUpdate:value":t[1]||(t[1]=e=>O(n).limit_count=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),q(d,{label:e.$t("Security.Anti.Index_39"),path:"limit"},{default:L((()=>[q(s,{"show-button":!1,value:O(n).limit,"onUpdate:value":t[2]||(t[2]=e=>O(n).limit=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),z("span",ve,P(e.$t("Security.Anti.Index_40")),1),q(u,{type:"primary",class:"ml-auto",onClick:i},{default:L((()=>[T(P(e.$t("Site.Cert.index_60")),1)])),_:1})])),_:1},8,["model"]),q(r,{class:"mb-15px!"}),q(p,null,{default:L((()=>[z("li",null,P(e.$t("Security.Anti.Index_41")),1),z("li",null,P(e.$t("Security.Anti.Index_42")),1),z("li",null,P(e.$t("Security.Anti.Index_43")),1)])),_:1})])}}}),be=h(we,[["__scopeId","data-v-201446e2"]]),ke={class:"p-20px"},Se=$({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=C(),n=e,{getList:l}=n.data,i=U(null),s=j({process_name:""}),o={process_name:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{await(i.value?.validate()),await ye(K(s)),l?.(),e()}}),(e,t)=>{const a=X,n=J,l=I;return H(),R("div",ke,[q(l,{ref_key:"formRef",ref:i,model:O(s),rules:o},{default:L((()=>[q(n,{label:e.$t("Home.index_24"),path:"process_name"},{default:L((()=>[q(a,{class:"w-280px!",value:O(s).process_name,"onUpdate:value":t[0]||(t[0]=e=>O(s).process_name=e),type:"text",placeholder:e.$t("Security.Anti.Index_22")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),Ie={class:"p-20px"},Ae=$({__name:"index",setup(e){const{t:t}=C(),{keys:d,table:u,columns:c}=a([{key:"name",title:t("Home.index_24")},n({width:130,title:t("Public.Table.Operation"),options:e=>[{label:t("Public.Btn.Del"),onClick:async()=>{await _e({process_name:e.name}),await x()}}]})]),r=async()=>{h.show=!0},{loading:y,setLoading:g}=l(),x=async()=>{try{g(!0);const{message:e}=await m.post("/plugin?name=syssafe&action=a&s=get_process_white");f(e)&&(u.data=e.map((e=>({name:e}))))}finally{d.value=[],g(!1)}};x();const h=i(t("Security.Anti.Index_23"),{getList:x});return(e,t)=>{const a=Z,n=s,l=o,i=_,m=p;return H(),R("div",Ie,[q(i,null,{toolsLeft:L((()=>[q(a,{type:"primary",onClick:r},{default:L((()=>[T(P(e.$t("Security.Anti.Index_23")),1)])),_:1})])),table:L((()=>[q(n,{"checked-row-keys":O(d),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>M(d)?d.value=e:null),loading:O(y),"loading-num":3,"max-height":340,data:O(u).data,columns:O(c)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:L((()=>[q(l,null,{default:L((()=>[z("li",null,P(e.$t("Security.Anti.Index_24")),1),z("li",null,P(e.$t("Security.Anti.Index_25")),1)])),_:1})])),_:1}),q(m,{show:O(h).show,"onUpdate:show":t[1]||(t[1]=e=>O(h).show=e),title:O(h).title,data:O(h).data,width:500,footer:!0,component:Se},null,8,["show","title","data"])])}}}),$e={class:"color-#ff3333"},Ce=$({__name:"index",setup(e,{expose:t}){const{t:u}=C(),c=v(),{systemHardening:r}=D(c),y=i(),x=i(),h=i(),{keys:f,table:b,columns:k}=a([{key:"name",width:"10%",title:u("Site.TableRow.index_2")},{key:"ps",title:u("Security.Hardening.Index_5"),ellipsis:{tooltip:{width:"trigger"}}},d({key:"open",title:u("Site.TableRow.index_14"),onClick:async(e,t)=>{if(!r.value)return w.error(u("Security.Hardening.Index_6")),void A();await oe({s_key:t.key})}}),n({width:130,title:u("Site.TableRow.index_30"),options:e=>[{label:u("Site.TableOP.index_3"),onClick:()=>"ssh"===e.key?(x.title=`${u("Security.Hardening.Index_7")} [${e.name}]`,void(x.show=!0)):"process"===e.key?(h.title=`${u("Security.Hardening.Index_7")} [${e.name}]`,void(h.show=!0)):(y.title=`${u("Security.Hardening.Index_7")} [${e.name}]`,y.data=e,void(y.show=!0))}]})]);B((()=>c.isRefresh),(e=>{e&&(c.setRefresh(!1),A())}));const{loading:S,setLoading:I}=l(),A=async()=>{try{I(!0);const{message:e}=await m.post("/plugin?name=syssafe&action=a&s=get_safe_status");g(e)&&(r.value=e.open,b.data=e.list)}finally{f.value=[],I(!1)}};return A(),t({init:A}),(e,t)=>{const a=s,n=_,l=o,i=p;return H(),R(F,null,[q(n,{feedback:!0},{table:L((()=>[q(a,{"checked-row-keys":O(f),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>M(f)?f.value=e:null),"row-key":"title",loading:O(S),data:O(b).data,columns:O(k)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),q(l,{class:"mt-16px"},{default:L((()=>[z("li",null,P(e.$t("Security.Hardening.Index_1")),1),z("li",null,P(e.$t("Security.Hardening.Index_2")),1),z("li",null,P(e.$t("Security.Hardening.Index_3")),1),z("li",$e,P(e.$t("Security.Hardening.Index_4")),1)])),_:1}),q(i,{show:O(y).show,"onUpdate:show":t[1]||(t[1]=e=>O(y).show=e),title:O(y).title,data:O(y).data,width:700,"min-height":500,footer:!1,component:he},null,8,["show","title","data"]),q(i,{show:O(x).show,"onUpdate:show":t[2]||(t[2]=e=>O(x).show=e),title:O(x).title,data:O(x).data,width:800,footer:!1,component:be},null,8,["show","title","data"]),q(i,{show:O(h).show,"onUpdate:show":t[3]||(t[3]=e=>O(h).show=e),title:O(h).title,data:O(h).data,width:700,"min-height":580,footer:!1,component:Ae},null,8,["show","title","data"])],64)}}}),Ue=$({__name:"index",setup(e,{expose:t}){const{t:i}=C(),{loading:d,setLoading:u}=l(),c=U(""),r=/^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$/,{keys:p,table:y,columns:g}=a([{key:"address",title:i("Security.Anti.Index_15"),width:"70%"},{key:"end",title:i("Security.History.Index_12"),render:e=>0==e.end?i("Security.Anti.Index_18"):e.end},n({width:130,title:i("Site.TableRow.index_30"),options:e=>[{label:i("Security.Anti.Index_19"),onClick:async()=>{await re({ip:e.address}),h()}}]})]),x=async()=>{r.test(c.value)?(await ce({ip:c.value}),h(),c.value=""):w.error(i("Security.Anti.Index_20"))},h=async()=>{try{u(!0);const{message:e}=await m.post("/plugin?name=syssafe&action=a&s=get_ssh_limit_info");f(e)&&(y.data=e)}finally{p.value=[],u(!1)}};return h(),t({init:h}),(e,t)=>{const a=X,n=Z,l=te,i=s,u=_,r=o;return H(),R("div",null,[q(u,null,{toolsLeft:L((()=>[q(l,{class:"flex-nowrap!"},{default:L((()=>[q(a,{value:O(c),"onUpdate:value":t[0]||(t[0]=e=>M(c)?c.value=e:null),type:"text",placeholder:e.$t("Security.Anti.Index_15"),class:"w-280px!"},null,8,["value","placeholder"]),q(n,{type:"primary",onClick:x},{default:L((()=>[T(P(e.$t("Public.Btn.Add")),1)])),_:1})])),_:1})])),table:L((()=>[q(i,{"checked-row-keys":O(p),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>M(p)?p.value=e:null),"row-key":"address",loading:O(d),"max-height":440,data:O(y).data,columns:O(g)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),q(r,{class:"mt-16px"},{default:L((()=>[z("li",null,P(e.$t("Security.Anti.Index_16")),1),z("li",null,P(e.$t("Security.Anti.Index_17")),1)])),_:1})])}}}),je=$({__name:"index",setup(e,{expose:t}){const{t:n}=C(),{keys:i,table:o,columns:d}=a([{key:"addtime",title:n("Site.Cert.index_68"),width:"20%"},{key:"log",title:n("Security.Anti.Index_21")}]),u=j({p:1,limit:10,search:"System hardening"}),{loading:c,setLoading:r}=l(),p=async()=>{try{r(!0);const{message:t}=await(e=K(u),m.post("/data?action=getData",{...e,table:"logs",order:"id desc"}));g(t)&&(o.data=t.data,o.total=b(t.page))}finally{i.value=[],r(!1)}var e};return p(),t({init:p}),(e,t)=>{const a=s,n=ie,l=_;return H(),N(l,{feedback:!0},{table:L((()=>[q(a,{"checked-row-keys":O(i),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>M(i)?i.value=e:null),"row-key":"addtime",loading:O(c),data:O(o).data,columns:O(d)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:L((()=>[q(n,{page:O(u).p,"onUpdate:page":t[1]||(t[1]=e=>O(u).p=e),"page-size":O(u).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>O(u).limit=e),"item-count":O(o).total,"store-key":"security-log",onRefresh:p},null,8,["page","page-size","item-count"])])),_:1})}}}),He=$({__name:"index",setup(e){const{t:t}=C(),a=U("protection"),n=[{key:"protection",label:t("Security.Tabs.Index_8"),component:Ce},{key:"block",label:t("Security.Tabs.Index_9"),component:Ue},{key:"operation",label:t("Security.Tabs.Index_10"),component:je}];return(e,t)=>{const l=r;return H(),N(l,{value:O(a),"onUpdate:value":t[0]||(t[0]=e=>M(a)?a.value=e:null),options:n},null,8,["value"])}}}),Re={class:"pt-40px pb-40px"},qe={class:"mb-16px"},Le={class:"ul-style"},Oe={class:"text-center my-24px"},Te={class:"flex justify-center"},Pe={class:"item"},Me=["onClick"],ze=h($({__name:"conversion",setup(e){const t=U(0),a=["Protection","Block IP","Operation logs"],n=()=>{u({source:102})};return(e,l)=>{const i=k,s=Z,o=ae,d=ne;return H(),N(d,null,{default:L((()=>[z("div",Re,[l[2]||(l[2]=z("div",{class:"mb-24px text-center text-22px font-bold"}," System Hardening prevention features ",-1)),z("div",qe,[z("ul",Le,[z("li",null,[q(i,{name:"security-system",size:"18"}),l[0]||(l[0]=z("span",{class:"ml-8px"},"Prevents the system from being implanted with a Trojan",-1))]),z("li",null,[q(i,{name:"security-surety",size:"30"}),l[1]||(l[1]=z("span",null,"Harden the system security configuration",-1))])])]),z("div",Oe,[q(s,{type:"primary",class:"h-36px text-14px",onClick:n},{default:L((()=>[T(P(e.$t("WP.Transition.index_7")),1)])),_:1})]),z("div",Te,[z("div",Pe,[z("ul",null,[(H(),R(F,null,E(a,((e,a)=>z("li",{class:V({active:O(t)==a}),key:a,onClick:e=>t.value=a},P(e),11,Me))),64))])]),W(q(o,{width:"100%",src:O("/static/vite/images/protection.png")},null,8,["src"]),[[Y,0==O(t)]]),W(q(o,{width:"100%",src:O("/static/vite/images/block.png")},null,8,["src"]),[[Y,1==O(t)]]),W(q(o,{width:"100%",src:O("/static/vite/images/log.png")},null,8,["src"]),[[Y,2==O(t)]])])])])),_:1})}}}),[["__scopeId","data-v-f55518e2"]]),Ke={key:0};e("default",$({__name:"index",setup(e){const t=S(),{isPro:a}=D(t),n=v(),{systemHardening:l}=D(n),i=U(l.value),s=G((()=>l.value));B(s,(e=>{i.value=e}));const o=async()=>{await m.post("/plugin?name=syssafe&action=a&s=set_open",{},{requestOptions:{loading:se("Security.Api.Index_5"),successMessage:!0}}),await n.setRefresh(!0)};return(async()=>{a.value&&await c("syssafe")})(),(e,t)=>{const n=le,l=te,s=ne;return O(a)?(H(),R("div",Ke,[q(s,{class:"my-15px"},{default:L((()=>[q(l,{class:"p-15px items-center"},{default:L((()=>[z("span",null,P(e.$t("Security.Anti.Index_14")),1),q(n,{value:O(i),"onUpdate:value":[t[0]||(t[0]=e=>M(i)?i.value=e:null),o],"rubber-band":!1,size:"small"},null,8,["value"])])),_:1})])),_:1}),q(s,{class:"p-15px"},{default:L((()=>[q(He)])),_:1})])):(H(),N(ze,{key:1}))}}}))}}}));
