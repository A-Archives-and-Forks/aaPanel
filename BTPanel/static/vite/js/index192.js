import{b as a,c as e,j as l,f as t,a as i,_ as s}from"./public.js?v=1753954525509";import{_ as o}from"./index.vue_vue_type_script_setup_true_lang.js?v=1753954525509";import{c as r,O as d,u as n,m as u,n as c,k as m,_ as p}from"./page_layout.js?v=1753954525509";import{k as _,aj as v,r as f,c as y,U as h,a1 as x,a2 as b,X as w,V as g,al as k,Q as M,W as j,j as D,P as q,e as A,l as $,v as E,a3 as S}from"./vue.js?v=1753954525509";import{ac as U,ad as X}from"./mail2.js?v=1753954525509";import{g as T}from"./index50.js?v=1753954525509";import{ay as B,bY as P,c6 as C,cF as R,cE as G,cA as N,aq as W,c1 as z,cG as F}from"./naive.js?v=1753954525509";import"./common.js?v=1753954525509";import"./__commonjsHelpers__.js?v=1753954525509";import"./index.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang4.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1753954525509";const Y={key:0,class:"color-desc"},L={key:3,class:"color-desc"},O=_({__name:"automatic",props:{domain:{}},setup(i,{expose:s}){const o=v(),n=i,{table:u,columns:c}=a([{key:"type",title:"Type",width:50},{key:"record",title:"Record",width:120,ellipsis:{tooltip:!0}},{key:"value",title:"Value",ellipsis:{tooltip:!0}},{key:"priority",title:"MX priority",render:a=>-1!==a.priority?a.priority:"-",width:90},{key:"status",title:"Status",width:110}]),m=f(),p=y((()=>{var a;return null==(a=m.value)?void 0:a.support.includes("auto")})),_=()=>{o.push("/ssl_domain/domain")},{loading:q,setLoading:A}=e();return s({getParseStatus:async()=>{const{message:a}=await l({domain:n.domain});if(r(a)&&(m.value=a,p.value))try{A(!0);const{message:e}=await T({domain:n.domain,hash:a.hash});r(e)&&(u.data=[{type:"A",record:e.A.record,value:e.A.record_value,priority:e.A.priority,status:e.A.status?"Added":"Waiting to add"},{type:"MX",record:e.MX.record,value:e.MX.record_value,priority:e.MX.priority,status:e.MX.status?"Added":"Waiting to add"},...e.TXT.map((a=>({type:"TXT",record:a.record,value:a.record_value,priority:a.priority,status:a.status?"Added":"Waiting to add"})))])}finally{A(!1)}},parseStatus:m,isSupportAuto:p}),(a,e)=>{const l=B,i=P,s=C,o=d,r=t;return h(),x(i,null,{default:b((()=>[w(m)?k("",!0):(h(),g("span",Y," *The program will use the APl to automatically add the required DNS records forthe mail server and complete the installation of the SSL certifcate. ")),w(m)?(h(),x(i,{key:1},{default:b((()=>[w(p)?(h(),x(s,{key:1,type:"success"},{default:b((()=>e[2]||(e[2]=[D(" Your domain has been connccted to the domain managementccnter, and you can use this fcature to complcte onc-click deployment. ")]))),_:1,__:[2]})):(h(),x(s,{key:0,type:"error"},{default:b((()=>[M(i,{class:"items-center flex-nowrap!"},{default:b((()=>[e[1]||(e[1]=j("span",null,"Your domain has not yet been integrated with the Domain Name Management Center.",-1)),M(l,{type:"primary",size:"small",ghost:"",onClick:_},{default:b((()=>e[0]||(e[0]=[D("Add Now")]))),_:1,__:[0]})])),_:1,__:[1]})])),_:1})),w(q)?(h(),x(i,{key:2,class:"items-center!"},{default:b((()=>[e[3]||(e[3]=j("span",{class:"color-desc"},"Checking for records to be added",-1)),M(o,{size:"small"})])),_:1,__:[3]})):k("",!0),!w(q)&&w(p)?(h(),g("span",L,"The records that will be automatically added")):k("",!0),!w(q)&&w(p)?(h(),x(r,{key:4,data:w(u).data,columns:w(c)},null,8,["data","columns"])):k("",!0)])),_:1})):k("",!0)])),_:1})}}}),V={class:"p-20px"},H={class:"flex h-15px items-center mr-16px"},I={class:"w-320px"},Q={class:"w-100px ml-20px"},J={class:"w-320px"},K={class:"text-error"},Z=_({__name:"index",props:{row:{},isEdit:{type:Boolean}},emits:["refresh"],setup(a,{expose:e,emit:l}){const t=a,r=l,d=n(),_=f(null),v=f(""),y=()=>{var a;""!==C.domain.trim()?v.value!==C.domain&&2===C.dns_record&&(null==(a=_.value)||a.getParseStatus(),v.value=C.domain):v.value=""},{t:T}=q(),B=f(null),C=A({domain:"",a_record:"",dns_record:2,quota:5,quota_unit:"GB",mailboxes:50,email:"",ips:""}),Y=[{label:"GB",value:"GB"},{label:"MB",value:"MB"}],L={domain:{trigger:["blur","input"],validator:()=>""!==C.domain.trim()||new Error(T("Mail.Domain.index_27"))}},Z=()=>{i({source:351})},aa=()=>{var a,e;return{domain:C.domain,a_record:C.a_record,ips:t.isEdit&&!C.ips?"del":C.ips,quota:C.quota+" "+C.quota_unit,mailboxes:C.mailboxes,email:C.email,automatic:2===C.dns_record?1:null,hash:2===C.dns_record?null==(e=null==(a=_.value)?void 0:a.parseStatus)?void 0:e.hash:null}};return(()=>{const{isEdit:a,row:e}=t;if(a&&e){const a=e.ip_address.ipv4.join(""),l=e.ip_address.ipv6.join("");C.domain=e.domain,C.a_record=e.a_record,C.ips=a.length>0?a:l;const t=c(e.quota);C.quota=m(t.split(" ")[0]),C.quota_unit=t.split(" ")[1],C.mailboxes=e.mailboxes,C.email=e.email,C.dns_record=1}})(),e({onConfirm:async()=>{var a,e;if(await(null==(a=B.value)?void 0:a.validate()),!(null==(e=_.value)?void 0:e.isSupportAuto)&&2===C.dns_record&&!t.isEdit)return u.error("This domain does not support automatic resolution, please choose manual resolution"),!1;const{isEdit:l}=t;l?await U(aa()):await X(aa()),r("refresh")}}),(a,e)=>{const l=p,t=R,i=G,r=N,n=W,u=P,c=z,m=F,v=o,f=s;return h(),g("div",V,[M(v,{ref_key:"formRef",ref:B,model:w(C),rules:L,"label-width":"150px"},{default:b((()=>[a.isEdit?k("",!0):(h(),x(r,{key:0,label:"DNS record"},{default:b((()=>[M(i,{value:w(C).dns_record,"onUpdate:value":[e[0]||(e[0]=a=>w(C).dns_record=a),y]},{default:b((()=>[M(t,{value:2},{default:b((()=>[j("div",H,[e[8]||(e[8]=j("div",null,"Automatic",-1)),M(l,{name:"ssl-stars",size:22})])])),_:1}),M(t,{value:1},{default:b((()=>e[9]||(e[9]=[D("Manual")]))),_:1,__:[9]})])),_:1},8,["value"])])),_:1})),M(r,{label:a.$t("Mail.Domain.index_3"),path:"domain"},{default:b((()=>[j("div",I,[M(n,{value:w(C).domain,"onUpdate:value":e[1]||(e[1]=a=>w(C).domain=a),disabled:a.isEdit,placeholder:a.$t("Mail.Domain.index_18"),onBlur:y},null,8,["value","disabled","placeholder"])])])),_:1},8,["label"]),$(M(r,{label:a.$t("Mail.Domain.index_19")},{default:b((()=>[M(u,null,{default:b((()=>[M(n,{class:"w-320px!",value:w(C).a_record,"onUpdate:value":e[2]||(e[2]=a=>w(C).a_record=a),disabled:a.isEdit,placeholder:a.$t("Mail.Domain.index_20")},null,8,["value","disabled","placeholder"]),e[10]||(e[10]=j("span",{class:"color-#777777"}," *Resolve the domain to the mail server's lP address for server communication ormail client connections. ",-1))])),_:1,__:[10]})])),_:1},8,["label"]),[[E,1===w(C).dns_record]]),$(M(r,{label:" "},{default:b((()=>[M(O,{ref_key:"automaticRef",ref:_,domain:w(C).domain},null,8,["domain"])])),_:1},512),[[E,2===w(C).dns_record]]),a.isEdit?(h(),x(r,{key:1,label:"IP"},{default:b((()=>[M(u,{class:"items-center"},{default:b((()=>[M(n,{class:"w-320px!",value:w(C).ips,"onUpdate:value":e[3]||(e[3]=a=>w(C).ips=a),disabled:w(d).isFree,placeholder:a.$t("Mail.Domain.index_65")},null,8,["value","disabled","placeholder"]),w(d).isFree?(h(),g("span",{key:0,class:"cursor-pointer color-#ffb800",onClick:Z}," PRO ")):k("",!0)])),_:1})])),_:1})):k("",!0),M(r,{label:a.$t("Mail.Domain.index_21")},{default:b((()=>[M(c,{value:w(C).quota,"onUpdate:value":e[4]||(e[4]=a=>w(C).quota=a),class:"w-200px",min:0,"show-button":!1},null,8,["value"]),j("div",Q,[M(m,{value:w(C).quota_unit,"onUpdate:value":e[5]||(e[5]=a=>w(C).quota_unit=a),options:Y},null,8,["value"])])])),_:1},8,["label"]),M(r,{label:a.$t("Mail.Domain.index_22")},{default:b((()=>[M(c,{value:w(C).mailboxes,"onUpdate:value":e[6]||(e[6]=a=>w(C).mailboxes=a),class:"w-320px",min:0,"show-button":!1},null,8,["value"])])),_:1},8,["label"]),M(r,{label:a.$t("Mail.Domain.index_7")},{default:b((()=>[j("div",J,[M(n,{value:w(C).email,"onUpdate:value":e[7]||(e[7]=a=>w(C).email=a),placeholder:a.$t("Mail.Domain.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"])])),_:1},8,["model"]),M(f,null,{default:b((()=>[j("li",K,S(a.$t("Mail.Domain.index_24")),1),j("li",null,S(a.$t("Mail.Domain.index_25")),1),j("li",null,S(a.$t("Mail.Domain.index_26")),1)])),_:1})])}}});export{Z as default};
