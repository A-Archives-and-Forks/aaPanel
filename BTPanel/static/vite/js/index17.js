const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index108.js?v=1753954525509","js/index101.js?v=1753954525509","js/vue.js?v=1753954525509","js/__commonjsHelpers__.js?v=1753954525509","js/page_layout.js?v=1753954525509","js/naive.js?v=1753954525509","js/common.js?v=1753954525509","js/public.js?v=1753954525509","css/public.css?v=1753954525509","css/page_layout.css?v=1753954525509","css/index18.css?v=1753954525509","js/index.js?v=1753954525509","css/index99.css?v=1753954525509","js/index.vue_vue_type_script_setup_true_lang.js?v=1753954525509","js/backup-info.js?v=1753954525509","js/utils.js?v=1753954525509","js/soft.js?v=1753954525509","css/backup-info.css?v=1753954525509","js/migrate-success.js?v=1753954525509","js/migrate-error.js?v=1753954525509"])))=>i.map(i=>d[i]);
import{n as e,_ as a,O as t,v as s,i as o,c as l,a as r}from"./page_layout.js?v=1753954525509";import{_ as i}from"./index.js?v=1753954525509";import{e as n,q as p,_ as d}from"./public.js?v=1753954525509";import{_ as u}from"./index.vue_vue_type_script_setup_true_lang.js?v=1753954525509";import _ from"./backup-info.js?v=1753954525509";import{u as c}from"./utils.js?v=1753954525509";import{k as m,P as g,$ as h,U as w,a1 as f,a2 as x,Q as b,X as v,j as C,a3 as y,W as k,r as M,e as j,a4 as T,_ as q}from"./vue.js?v=1753954525509";import{c0 as D,c3 as O,bY as P,cA as U,cD as $,c6 as R,aq as E,c1 as A,ay as I}from"./naive.js?v=1753954525509";const L=m({__name:"index",setup(s){const{t:o}=g(),l=c(),{loading:r,backupData:i}=h(l);return l.getData(),(s,l)=>{const n=D,p=a,d=O,c=P,m=U,g=u,h=t;return w(),f(h,{show:v(r),class:"p-16px"},{default:x((()=>[b(g,{ref:"formRef"},{default:x((()=>[b(m,{label:v(o)("Config.Migrate.index_10")},{default:x((()=>[b(c,null,{default:x((()=>[b(n,{class:"mr-8px"},{default:x((()=>[C(y(v(e)(v(i).disk_use)),1)])),_:1}),k("div",null,[k("span",null,y(v(o)("Config.Migrate.index_11")),1),b(n,{type:"success",class:"ml-16px mr-8px"},{default:x((()=>[C(y(v(e)(v(i).disk_free)),1)])),_:1}),b(d,{trigger:"hover",placement:"top-start"},{trigger:x((()=>[b(p,{name:"base-warning",class:"text-warning mr-4px",size:"16"})])),default:x((()=>[k("span",null,[k("li",null,y(v(o)("Config.Migrate.index_12"))+" "+y(v(e)(1.5*v(i).disk_use)),1),k("li",null,y(v(o)("Config.Migrate.index_13")),1)])])),_:1})])])),_:1})])),_:1},8,["label"]),b(m,{label:"Backup Data"},{default:x((()=>[b(_,{class:"w-600px"})])),_:1})])),_:1},512)])),_:1},8,["show"])}}}),S=()=>s.post("/mod/backup_restore/com/get_migrate_progress"),V=()=>s.post("/mod/backup_restore/com/stop_migrate",{},{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!0}}),z=()=>s.post("/mod/backup_restore/com/close_migrate_popup",{},{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!1}}),B=m({__name:"index",setup(e){const a=q((()=>r((()=>import("./index108.js?v=1753954525509")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17])))),t=q((()=>r((()=>import("./migrate-success.js?v=1753954525509")),__vite__mapDeps([18,7,4,2,3,5,6,9,8,11,12,13,14,15,16,17])))),_=q((()=>r((()=>import("./migrate-error.js?v=1753954525509")),__vite__mapDeps([19,7,4,2,3,5,6,9,8,11,12,13,14,15,16,17])))),{t:c}=g(),m=n(c("Config.Migrate.index_4")),h=n(c("Config.Migrate.index_5"),{onRefresh:(e,a)=>{"success"===e?(D.data=a,D.show=!0):(O.data.errData=a,O.show=!0)}}),D=n(c("Config.Migrate.index_6")),O=n(c("Config.Migrate.index_7"),{onRetry:e=>{O.show=!1,h.show=!1,V.ip=e.server_ip,V.port=e.ssh_port,V.account=e.ssh_user,V.password=e.password,W()}}),S=M(null),V=j({ip:"",port:22,account:"",password:""}),z={ip:{required:!0,message:c("Term.index_9"),trigger:["blur","input"]},port:{required:!0,type:"number",message:c("Security.Conf.Index_28"),trigger:["blur","input"]},account:{required:!0,message:c("Term.index_11"),trigger:["blur","input"]},password:{required:!0,message:c("Term.index_14"),trigger:["blur","input"]}},B=()=>{m.show=!0},Q=()=>({auth_type:"password",server_ip:V.ip,ssh_port:V.port,ssh_user:V.account,password:V.password,ps:V.ip}),W=async()=>{var e;await(null==(e=S.value)?void 0:e.validate()),p({title:c("Config.Migrate.index_8"),content:()=>b("span",null,[b(T("i18n-t"),{keypath:"Config.Migrate.index_9",scope:"global"},{default:()=>[b("b",{class:"color-warning text-2xl"},[C(" "),V.ip,C(" ")])]})]),onConfirm:async()=>{var e;await(e=Q(),s.post("/mod/backup_restore/com/ssh_auth_check",e,{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!0}})),await(e=>s.post("/mod/backup_restore/com/add_migrate_task",e,{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!0}}))(Q()),h.show=!0}})};return(async()=>{const{message:e}=await s.post("/mod/backup_restore/com/get_migrate_status");l(e)&&e.is_running&&(h.show=!0,V.ip=e.server_ip,V.port=e.ssh_port,V.account=e.ssh_user,V.password=e.password)})(),(e,s)=>{const o=E,l=U,r=A,n=P,p=I,g=u,M=d,j=i,T=$;return w(),f(T,{class:"p-16px"},{default:x((()=>[b(v(R),{type:"warning",class:"mb-16px"},{default:x((()=>[k("span",null,y(v(c)("Config.Migrate.index_1")),1)])),_:1}),b(g,{ref_key:"formRef",ref:S,model:v(V),rules:z},{default:x((()=>[b(n,null,{default:x((()=>[b(l,{label:e.$t("Term.index_8"),path:"ip"},{default:x((()=>[b(o,{class:"w-190px!",value:v(V).ip,"onUpdate:value":s[0]||(s[0]=e=>v(V).ip=e),placeholder:e.$t("Term.index_9")},null,8,["value","placeholder"])])),_:1},8,["label"]),b(l,{path:"port"},{default:x((()=>[b(r,{"show-button":!1,class:"w-80px!",value:v(V).port,"onUpdate:value":s[1]||(s[1]=e=>v(V).port=e),placeholder:e.$t("Docker.Container.create.index_7")},null,8,["value","placeholder"])])),_:1})])),_:1}),b(l,{label:e.$t("Term.index_10"),path:"account"},{default:x((()=>[b(o,{class:"w-280px!",value:v(V).account,"onUpdate:value":s[2]||(s[2]=e=>v(V).account=e),placeholder:e.$t("Term.index_11")},null,8,["value","placeholder"])])),_:1},8,["label"]),b(l,{label:e.$t("Database.index_14"),path:"password"},{default:x((()=>[b(o,{class:"w-280px!",value:v(V).password,"onUpdate:value":s[3]||(s[3]=e=>v(V).password=e),placeholder:e.$t("Term.index_14")},null,8,["value","placeholder"])])),_:1},8,["label"]),b(l,{label:" "},{default:x((()=>[b(p,{type:"primary",onClick:W},{default:x((()=>[C(y(v(c)("Config.Migrate.index_2")),1)])),_:1})])),_:1})])),_:1},8,["model"]),b(M,null,{default:x((()=>[s[8]||(s[8]=k("li",{class:"text-warning font-bold"},"Please use root user",-1)),k("li",null,[b(p,{type:"primary",text:"",onClick:B},{default:x((()=>[C(y(v(c)("Config.Migrate.index_3")),1)])),_:1})])])),_:1,__:[8]}),b(j,{show:v(m).show,"onUpdate:show":s[4]||(s[4]=e=>v(m).show=e),title:v(m).title,data:v(m).data,width:"850","min-height":250,component:L},null,8,["show","title","data"]),b(j,{show:v(h).show,"onUpdate:show":s[5]||(s[5]=e=>v(h).show=e),title:v(h).title,hideClose:!0,data:v(h).data,width:"750","min-height":250,component:v(a)},null,8,["show","title","data","component"]),b(j,{show:v(D).show,"onUpdate:show":s[6]||(s[6]=e=>v(D).show=e),title:v(D).title,hideClose:!0,data:v(D).data,width:"750","min-height":250,component:v(t)},null,8,["show","title","data","component"]),b(j,{show:v(O).show,"onUpdate:show":s[7]||(s[7]=e=>v(O).show=e),title:v(O).title,hideClose:!0,data:v(O).data,width:"750","min-height":250,component:v(_)},null,8,["show","title","data","component"])])),_:1})}}}),Q=Object.freeze(Object.defineProperty({__proto__:null,default:B},Symbol.toStringTag,{value:"Module"}));export{z as a,V as c,S as g,Q as i};
