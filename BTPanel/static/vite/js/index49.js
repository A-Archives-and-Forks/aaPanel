const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/batch2.js?v=1742891699271","js/index.vue_vue_type_script_setup_true_lang.js?v=1742891699271","js/vue.js?v=1742891699271","js/__commonjsHelpers__.js?v=1742891699271","js/naive.js?v=1742891699271","js/common.js?v=1742891699271","js/index.vue_vue_type_script_setup_true_lang2.js?v=1742891699271","js/index96.js?v=1742891699271","js/page_layout.js?v=1742891699271","js/public.js?v=1742891699271","css/public.css?v=1742891699271","css/page_layout.css?v=1742891699271","css/index15.css?v=1742891699271","js/index.vue_vue_type_script_setup_true_lang17.js?v=1742891699271","js/mail.js?v=1742891699271"])))=>i.map(i=>d[i]);
import{bh as a,d as e,u as l,b as i,k as t,I as s,h as n,J as o,b7 as u,a as r,cy as d}from"./page_layout.js?v=1742891699271";import{_ as c}from"./index.js?v=1742891699271";import{_ as p}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1742891699271";import{_ as m}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1742891699271";import{_}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1742891699271";import{_ as v}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1742891699271";import{_ as x}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1742891699271";import{e as w,d as h,b as f,F as b,f as M,h as g,a as y,u as B}from"./public.js?v=1742891699271";import{o as k}from"./upload.js?v=1742891699271";import{q as j,r as q,c as P,t as U,u as $,v as E,w as C,x as A}from"./mail.js?v=1742891699271";import{T as z,_ as S,ch as R,bY as D,cn as T,b$ as I,ck as L}from"./naive.js?v=1742891699271";import{d as V,t as G,R as O,S as W,P as F,a1 as K,U as Y,a2 as Z,c as H,O as J,r as N,j as Q,V as X,a0 as aa,ai as ea,ab as la,ap as ia,af as ta,Y as sa}from"./vue.js?v=1742891699271";import{_ as na}from"./index.vue_vue_type_script_setup_true_lang.js?v=1742891699271";import"./common.js?v=1742891699271";import"./__commonjsHelpers__.js?v=1742891699271";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1742891699271";const oa={class:"flex justify-center p-32px"},ua=t(V({__name:"login",props:{row:{},info:{}},setup(t){const s=G(t,"row"),n=l(),o=async()=>{if(n.isFree)return void w({source:221});const{message:l}=await(t={rc_user:s.value.username,rc_pass:s.value.password},a.post("/plugin?action=a&name=mail_sys&s=login_roundcube_multiple",t,{requestOptions:{loading:e.global.t("Mail.Api.index_36")}}));var t;i(l)&&window.open("".concat(l.result))},u=()=>{s.value.webmail_url&&window.open("".concat(s.value.webmail_url.url))};return(a,e)=>{const l=z;return O(),W("div",oa,[F(l,{onClick:o},{default:K((()=>[Y("span",null,Z(a.$t("Database.PhpAdmin.index_11")),1),e[0]||(e[0]=Y("span",{class:"bg-recommend"},null,-1))])),_:1}),F(l,{class:"ml-32px",onClick:u},{default:K((()=>[H(Z(a.$t("Database.PhpAdmin.index_6")),1)])),_:1})])}}}),[["__scopeId","data-v-559afaf8"]]),ra={class:"p-20px"},da={class:"w-280px"},ca={class:"w-100px ml-10px"},pa={class:"w-280px"},ma={class:"w-130px"},_a={class:"w-140px ml-10px"},va={class:"w-280px"},xa=V({__name:"index",props:{row:{},isEdit:{type:Boolean}},emits:["refresh"],setup(a,{expose:e,emit:l}){const i=a,t=l,{isEdit:u}=i,{t:r}=J(),d=N(null),c=Q({full_name:"",domain:null,quota:5,quota_unit:"GB",is_admin:0,username:"",password:"",active:1}),p=N([]),m=[{label:"GB",value:"GB"},{label:"MB",value:"MB"}],_=[{label:r("Mail.MailBox.index_19"),value:0},{label:r("Mail.MailBox.index_20"),value:1}],v={full_name:{trigger:["blur","input"],validator:()=>""!==c.full_name.trim()||new Error(r("Mail.MailBox.index_21"))},username:{trigger:["blur","input"],validator:()=>""!==c.username.trim()||new Error(r("Mail.MailBox.index_22"))},quota:{trigger:["blur","input"],validator:()=>(console.log(c.quota),!!c.quota||new Error(r("Mail.MailBox.index_23")))},password:{trigger:["blur","input"],validator:()=>{if(u){if(c.password&&c.password.trim().length<8)return new Error(r("Mail.MailBox.index_26"));const a=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/;if(c.password&&!a.test(c.password))return new Error(r("Mail.MailBox.index_27"))}else{if(c.password.trim().length<8)return new Error(r("Mail.MailBox.index_24"));if(!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/.test(c.password))return new Error(r("Mail.MailBox.index_25"))}return!0}}},x=()=>({full_name:c.full_name,quota:c.quota+" "+c.quota_unit,is_admin:c.is_admin,username:c.username+"@"+c.domain,password:c.password,active:c.active});return(async()=>{const{message:a}=await P();s(a)&&(p.value=a.map((a=>({label:a,value:a}))),null===c.domain&&(c.domain=a[0]))})(),(()=>{const{row:a,isEdit:e}=i;if(e&&a){c.full_name=a.full_name,c.is_admin=a.is_admin,c.username=a.username.split("@")[0],c.active=a.active;const[e,l]=a.username.split("@");c.username=e,c.domain=l;const i=n(a.quota),[t,s]=i.split(" ");c.quota=o(t),c.quota_unit=s}})(),e({onConfirm:async()=>{var a;await(null==(a=d.value)?void 0:a.validate()),u?await j(x()):await q(x()),t("refresh")}}),(a,e)=>{const l=S,i=R,t=D,s=T,n=I,o=na;return O(),W("div",ra,[F(o,{ref_key:"formRef",ref:d,model:X(c),rules:v},{default:K((()=>[F(i,{label:a.$t("Mail.MailBox.index_10"),path:"full_name"},{default:K((()=>[Y("div",da,[F(l,{value:X(c).full_name,"onUpdate:value":e[0]||(e[0]=a=>X(c).full_name=a),placeholder:a.$t("Mail.MailBox.index_11")},null,8,["value","placeholder"])])])),_:1},8,["label"]),F(i,{label:a.$t("Mail.MailBox.index_3"),path:"quota"},{default:K((()=>[F(t,{value:X(c).quota,"onUpdate:value":e[1]||(e[1]=a=>X(c).quota=a),class:"w-170px",min:0,"show-button":!1,placeholder:a.$t("Mail.MailBox.index_12")},null,8,["value","placeholder"]),Y("div",ca,[F(s,{value:X(c).quota_unit,"onUpdate:value":e[2]||(e[2]=a=>X(c).quota_unit=a),options:m},null,8,["value"])])])),_:1},8,["label"]),F(i,{label:a.$t("Mail.MailBox.index_13"),path:"is_admin"},{default:K((()=>[Y("div",pa,[F(s,{value:X(c).is_admin,"onUpdate:value":e[3]||(e[3]=a=>X(c).is_admin=a),options:_},null,8,["value"])])])),_:1},8,["label"]),F(i,{label:a.$t("Mail.MailBox.index_14"),path:"username"},{default:K((()=>[Y("div",ma,[F(l,{value:X(c).username,"onUpdate:value":e[4]||(e[4]=a=>X(c).username=a),disabled:X(u),placeholder:a.$t("Mail.MailBox.index_15")},null,8,["value","disabled","placeholder"])]),Y("div",_a,[F(s,{value:X(c).domain,"onUpdate:value":e[5]||(e[5]=a=>X(c).domain=a),disabled:X(u),filterable:!0,options:X(p)},null,8,["value","disabled","options"])])])),_:1},8,["label"]),F(i,{label:a.$t("Mail.MailBox.index_16"),path:"password"},{default:K((()=>[Y("div",va,[F(l,{value:X(c).password,"onUpdate:value":e[6]||(e[6]=a=>X(c).password=a),placeholder:X(u)?a.$t("Mail.MailBox.index_17"):a.$t("Mail.MailBox.index_18")},null,8,["value","placeholder"])])])),_:1},8,["label"]),F(i,{label:a.$t("Public.Table.Status"),path:"active","show-feedback":!1},{default:K((()=>[F(n,{value:X(c).active,"onUpdate:value":e[7]||(e[7]=a=>X(c).active=a),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),wa={class:"w-220px mr-8px"},ha="/www/server/panel/data/mail",fa=V({__name:"index",setup(a){const e=sa((()=>r((()=>import("./batch2.js?v=1742891699271")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14])))),{t:t}=J(),o=l(),q=ea(),S=N([]),R=()=>{S.value.unshift({label:t("Public.All"),value:"all"})},D=({option:a})=>"".concat(t("Mail.MailBox.index_29")).concat(a.label),V=()=>{k({path:ha,uploadData:{accept:".json",multiple:!1},onUploadSuccess:async a=>{const e=ha+a[0].fullPath;await A({file:e}),ya()}})},G=async()=>{const{message:a}=await E({domain:W.domain});i(a)&&d(a.result)},W=Q({p:1,size:10,domain:"all",search:""}),na=h("",{isEdit:!1,row:void 0,onRefresh:()=>{ya()}}),oa=()=>{na.data.isEdit=!1,na.data.row=void 0,na.title=t("Mail.MailBox.index_1"),na.show=!0},ra=()=>{o.isFree?w({source:327}):Ba.show=!0},{keys:da,table:ca,columns:pa}=f([{type:"selection",width:40},{key:"username",title:t("Public.Table.Username"),ellipsis:{tooltip:!0}},b({width:160}),{key:"info",title:t("Mail.MailBox.index_2"),width:180,render:a=>F("a",{class:"bt-link",href:"javascript:;",onClick:()=>{va(a)}},[t("Public.Btn.Copy")])},{key:"quota",title:t("Mail.MailBox.index_3"),render:a=>n(a.quota)},{key:"is_admin",title:t("Mail.MailBox.index_4"),render:a=>1===a.is_admin?"Admin":"General user"},{key:"active",title:t("Public.Table.Status"),render:a=>F(I,{value:a.active,size:"small",checkedValue:1,uncheckedValue:0,onUpdateValue:async e=>{await j({username:a.username,full_name:a.full_name,quota:n(a.quota),active:e,is_admin:a.is_admin}),a.active=e}},null)},M({width:150,options:a=>[{label:"WebMail",onClick:()=>{a.webmail_url?fa(a):ma()}},{label:t("Public.Btn.Edit"),onClick:()=>{ba(a)}},{label:t("Public.Btn.Del"),onClick:()=>{Ma(a)}}]})]),ma=()=>{const{hide:a}=y({title:t("Mail.MailBox.index_5"),content:()=>F(la,{tag:"div",keypath:"Mail.MailBox.index_6",scope:"global"},{link_1:()=>F("a",{class:"bt-link",href:"javascript:;",onClick:()=>{q.push("/mail/domain"),a()}},[t("Layout.Sider.mail_1"),H(" > Mail Domain")])}),onConfirm:()=>{q.push("/mail/domain")}})},_a=[{key:"delete",type:"confirm",label:t("Site.Batch.index_21"),confirm:{title:t("Site.Batch.index_21"),desc:t("Site.Batch.index_11"),columns:[{...pa.value[1],width:"auto"}],api:a=>U({username:a.username},!1),done:()=>{ya()}}}],va=a=>{const e=a.webmail_url?a.webmail_url.url:"Not installed WebMail";g("WebMail: ".concat(e,"\nUsername: ").concat(a.username,"\nPassword: ").concat(a.password,"\nPOP service [ Address: ").concat(a.mx," Port: 110/995 ]\nIMAP service [ Address: ").concat(a.mx," Port: 143/993 ]\nSMTP service [ Address: ").concat(a.mx," Port: 25/465/587 ]\n"))},fa=async a=>{B({title:"WebMail",width:400,data:{row:a,info:ga},component:ua})},ba=a=>{na.data.isEdit=!0,na.data.row=a,na.title=t("Mail.MailBox.index_7"),na.show=!0},Ma=async a=>{y({title:t("Mail.MailBox.index_8"),content:t("Mail.MailBox.index_9",[a.username]),onConfirm:async()=>{await U({username:a.username}),ya()}})},ga=Q({id:0,site_name:"",status:!1,ssl_status:!1}),ya=async()=>{try{ca.loading=!0;const{message:a}=await $({p:W.p,size:W.size,search:W.search,..."all"!==W.domain?{domain:W.domain}:{}});i(a)&&(ca.data=s(a.data)?a.data:[],a.page?ca.total=u(a.page):ca.total=a.total)}finally{ca.loading=!1,da.value=[]}},Ba=h(t("Mail.MailBox.index_31"),{getList:ya}),ka=()=>{W.p=1,ya()};return R(),(async()=>{const{message:a}=await P();s(a)&&(S.value=a.map((a=>({label:a,value:a}))),R())})(),(async()=>{try{ca.loading=!0,await(async()=>{const{message:a}=await C();i(a)&&(ga.id=a.id,ga.status=a.status,ga.site_name=a.site_name,ga.ssl_status=a.ssl_status)})(),await ya()}finally{ca.loading=!1}})(),(a,l)=>{const i=z,t=T,s=x,n=v,o=_,u=m,r=p,d=c,w=L;return O(),aa(w,{class:"p-16px"},{default:K((()=>[F(r,null,{toolsLeft:K((()=>[F(i,{type:"primary",onClick:oa},{default:K((()=>[H(Z(a.$t("Mail.MailBox.index_1")),1)])),_:1}),F(i,{onClick:ra},{default:K((()=>[H(Z(a.$t("Mail.MailBox.index_30")),1)])),_:1}),ia("",!0),F(i,{onClick:V},{default:K((()=>[H(Z(a.$t("Public.Btn.Import")),1)])),_:1}),F(i,{onClick:G},{default:K((()=>[H(Z(a.$t("Public.Btn.Export")),1)])),_:1})])),toolsRight:K((()=>[Y("div",wa,[F(t,{value:X(W).domain,"onUpdate:value":[l[0]||(l[0]=a=>X(W).domain=a),ka],options:X(S),"render-tag":D,filterable:!0},null,8,["value","options"])]),F(s,{value:X(W).search,"onUpdate:value":l[1]||(l[1]=a=>X(W).search=a),width:"280",placeholder:a.$t("Mail.MailBox.index_28"),onSearch:ka},null,8,["value","placeholder"])])),table:K((()=>[F(n,{"row-key":"username","checked-row-keys":X(da),"onUpdate:checkedRowKeys":l[2]||(l[2]=a=>ta(da)?da.value=a:null),loading:X(ca).loading,data:X(ca).data,columns:X(pa)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:K((()=>[F(o,{page:X(W).p,"onUpdate:page":l[3]||(l[3]=a=>X(W).p=a),"page-size":X(W).size,"onUpdate:pageSize":l[4]||(l[4]=a=>X(W).size=a),"item-count":X(ca).total,onRefresh:ya},null,8,["page","page-size","item-count"])])),pageLeft:K((()=>[F(u,{"row-key":"username","checked-row-keys":X(da),"onUpdate:checkedRowKeys":l[5]||(l[5]=a=>ta(da)?da.value=a:null),data:X(ca).data,options:_a},null,8,["checked-row-keys","data"])])),_:1}),F(d,{show:X(na).show,"onUpdate:show":l[6]||(l[6]=a=>X(na).show=a),title:X(na).title,data:X(na).data,width:480,"min-height":236,footer:!0,component:xa},null,8,["show","title","data"]),F(d,{show:X(Ba).show,"onUpdate:show":l[7]||(l[7]=a=>X(Ba).show=a),title:X(Ba).title,data:X(Ba).data,width:480,"min-height":236,footer:!0,component:X(e)},null,8,["show","title","data","component"])])),_:1})}}});export{fa as default};
