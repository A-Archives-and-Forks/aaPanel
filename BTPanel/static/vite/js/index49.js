const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/batch2.js?v=1741416570306","js/index.vue_vue_type_script_setup_true_lang.js?v=1741416570306","js/vue.js?v=1741416570306","js/__commonjsHelpers__.js?v=1741416570306","js/naive.js?v=1741416570306","js/common.js?v=1741416570306","js/index.vue_vue_type_script_setup_true_lang2.js?v=1741416570306","js/index96.js?v=1741416570306","js/page_layout.js?v=1741416570306","js/public.js?v=1741416570306","css/public.css?v=1741416570306","css/page_layout.css?v=1741416570306","css/index15.css?v=1741416570306","js/index.vue_vue_type_script_setup_true_lang17.js?v=1741416570306","js/mail.js?v=1741416570306"])))=>i.map(i=>d[i]);
import{u as a,b as e,k as l,G as t,h as i,H as s,av as n,a as o,bQ as u}from"./page_layout.js?v=1741416570306";import{_ as d}from"./index.js?v=1741416570306";import{_ as r}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1741416570306";import{_ as c}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1741416570306";import{_ as p}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1741416570306";import{_}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1741416570306";import{_ as m}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1741416570306";import{e as v,d as x,b as h,F as w,f,h as M,a as b,u as g}from"./public.js?v=1741416570306";import{q as y,r as B,t as k,c as j,u as P,v as q,w as $,x as U,y as C}from"./mail.js?v=1741416570306";import{T as E,_ as S,cb as z,bS as A,ch as R,bV as L,ce as T}from"./naive.js?v=1741416570306";import{d as D,t as G,P as V,Q as W,N as I,$ as F,R as H,a0 as K,c as O,M as Q,r as Z,j as N,S as J,_ as X,ah as Y,aa,ae as ea,W as la}from"./vue.js?v=1741416570306";import{_ as ta}from"./index.vue_vue_type_script_setup_true_lang.js?v=1741416570306";import{o as ia}from"./upload.js?v=1741416570306";import"./common.js?v=1741416570306";import"./__commonjsHelpers__.js?v=1741416570306";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1741416570306";const sa={class:"flex justify-center p-32px"},na=l(D({__name:"login",props:{row:{},info:{}},setup(l){const t=l,i=G(t,"row"),s=G(t,"info"),n=a(),o=async()=>{if(n.isFree)return void v({source:221});const{message:a}=await y({rc_user:i.value.username,rc_pass:i.value.password});e(a)&&window.open("".concat(s.value.ssl_status?"https":"http","://").concat(a.result))},u=()=>{window.open("".concat(s.value.ssl_status?"https":"http","://").concat(s.value.site_name))};return(a,e)=>{const l=E;return V(),W("div",sa,[I(l,{onClick:o},{default:F((()=>[H("span",null,K(a.$t("Database.PhpAdmin.index_11")),1),e[0]||(e[0]=H("span",{class:"bg-recommend"},null,-1))])),_:1}),I(l,{class:"ml-32px",onClick:u},{default:F((()=>[O(K(a.$t("Database.PhpAdmin.index_6")),1)])),_:1})])}}}),[["__scopeId","data-v-1fc88131"]]),oa={class:"p-20px"},ua={class:"w-280px"},da={class:"w-100px ml-10px"},ra={class:"w-280px"},ca={class:"w-130px"},pa={class:"w-140px ml-10px"},_a={class:"w-280px"},ma=D({__name:"index",props:{row:{},isEdit:{type:Boolean}},emits:["refresh"],setup(a,{expose:e,emit:l}){const n=a,o=l,{isEdit:u}=n,{t:d}=Q(),r=Z(null),c=N({full_name:"",domain:null,quota:5,quota_unit:"GB",is_admin:0,username:"",password:"",active:1}),p=Z([]),_=[{label:"GB",value:"GB"},{label:"MB",value:"MB"}],m=[{label:d("Mail.MailBox.index_19"),value:0},{label:d("Mail.MailBox.index_20"),value:1}],v={full_name:{trigger:["blur","input"],validator:()=>""!==c.full_name.trim()||new Error(d("Mail.MailBox.index_21"))},username:{trigger:["blur","input"],validator:()=>""!==c.username.trim()||new Error(d("Mail.MailBox.index_22"))},quota:{trigger:["blur","input"],validator:()=>(console.log(c.quota),!!c.quota||new Error(d("Mail.MailBox.index_23")))},password:{trigger:["blur","input"],validator:()=>{if(u){if(c.password&&c.password.trim().length<8)return new Error(d("Mail.MailBox.index_26"));const a=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/;if(c.password&&!a.test(c.password))return new Error(d("Mail.MailBox.index_27"))}else{if(c.password.trim().length<8)return new Error(d("Mail.MailBox.index_24"));if(!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/.test(c.password))return new Error(d("Mail.MailBox.index_25"))}return!0}}},x=()=>({full_name:c.full_name,quota:c.quota+" "+c.quota_unit,is_admin:c.is_admin,username:c.username+"@"+c.domain,password:c.password,active:c.active});return(async()=>{const{message:a}=await j();t(a)&&(p.value=a.map((a=>({label:a,value:a}))),null===c.domain&&(c.domain=a[0]))})(),(()=>{const{row:a,isEdit:e}=n;if(e&&a){c.full_name=a.full_name,c.is_admin=a.is_admin,c.username=a.username.split("@")[0],c.active=a.active;const[e,l]=a.username.split("@");c.username=e,c.domain=l;const t=i(a.quota),[n,o]=t.split(" ");c.quota=s(n),c.quota_unit=o}})(),e({onConfirm:async()=>{var a;await(null==(a=r.value)?void 0:a.validate()),u?await B(x()):await k(x()),o("refresh")}}),(a,e)=>{const l=S,t=z,i=A,s=R,n=L,o=ta;return V(),W("div",oa,[I(o,{ref_key:"formRef",ref:r,model:J(c),rules:v},{default:F((()=>[I(t,{label:a.$t("Mail.MailBox.index_10"),path:"full_name"},{default:F((()=>[H("div",ua,[I(l,{value:J(c).full_name,"onUpdate:value":e[0]||(e[0]=a=>J(c).full_name=a),placeholder:a.$t("Mail.MailBox.index_11")},null,8,["value","placeholder"])])])),_:1},8,["label"]),I(t,{label:a.$t("Mail.MailBox.index_3"),path:"quota"},{default:F((()=>[I(i,{value:J(c).quota,"onUpdate:value":e[1]||(e[1]=a=>J(c).quota=a),class:"w-170px",min:0,"show-button":!1,placeholder:a.$t("Mail.MailBox.index_12")},null,8,["value","placeholder"]),H("div",da,[I(s,{value:J(c).quota_unit,"onUpdate:value":e[2]||(e[2]=a=>J(c).quota_unit=a),options:_},null,8,["value"])])])),_:1},8,["label"]),I(t,{label:a.$t("Mail.MailBox.index_13"),path:"is_admin"},{default:F((()=>[H("div",ra,[I(s,{value:J(c).is_admin,"onUpdate:value":e[3]||(e[3]=a=>J(c).is_admin=a),options:m},null,8,["value"])])])),_:1},8,["label"]),I(t,{label:a.$t("Mail.MailBox.index_14"),path:"username"},{default:F((()=>[H("div",ca,[I(l,{value:J(c).username,"onUpdate:value":e[4]||(e[4]=a=>J(c).username=a),disabled:J(u),placeholder:a.$t("Mail.MailBox.index_15")},null,8,["value","disabled","placeholder"])]),H("div",pa,[I(s,{value:J(c).domain,"onUpdate:value":e[5]||(e[5]=a=>J(c).domain=a),disabled:J(u),filterable:!0,options:J(p)},null,8,["value","disabled","options"])])])),_:1},8,["label"]),I(t,{label:a.$t("Mail.MailBox.index_16"),path:"password"},{default:F((()=>[H("div",_a,[I(l,{value:J(c).password,"onUpdate:value":e[6]||(e[6]=a=>J(c).password=a),placeholder:J(u)?a.$t("Mail.MailBox.index_17"):a.$t("Mail.MailBox.index_18")},null,8,["value","placeholder"])])])),_:1},8,["label"]),I(t,{label:a.$t("Public.Table.Status"),path:"active","show-feedback":!1},{default:F((()=>[I(n,{value:J(c).active,"onUpdate:value":e[7]||(e[7]=a=>J(c).active=a),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),va={class:"w-220px mr-8px"},xa="/www/server/panel/data/mail",ha=D({__name:"index",setup(l){const s=la((()=>o((()=>import("./batch2.js?v=1741416570306")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14])))),{t:y}=Q(),k=a(),S=Y(),z=Z([]),A=()=>{z.value.unshift({label:y("Public.All"),value:"all"})},D=({option:a})=>"".concat(y("Mail.MailBox.index_29")).concat(a.label),G=()=>{ia({path:xa,uploadData:{accept:".json",multiple:!1},onUploadSuccess:async a=>{const e=xa+a[0].fullPath;await C({file:e}),ga()}})},W=async()=>{const{message:a}=await $({domain:ta.domain});e(a)&&u(a.result)},ta=N({p:1,size:10,domain:"all",search:""}),sa=x("",{isEdit:!1,row:void 0,onRefresh:()=>{ga()}}),oa=()=>{sa.data.isEdit=!1,sa.data.row=void 0,sa.title=y("Mail.MailBox.index_1"),sa.show=!0},ua=()=>{k.isFree?v({source:327}):ya.show=!0},da=()=>{if(ba.site_name)window.open("".concat(ba.ssl_status?"https":"http","://").concat(ba.site_name));else{const{hide:a}=b({title:y("Mail.MailBox.index_5"),content:()=>I(aa,{tag:"div",keypath:"Mail.MailBox.index_6",scope:"global"},{link_1:()=>I("a",{class:"bt-link",href:"javascript:;",onClick:()=>{S.push("/mail/settings"),a()}},[y("Layout.Sider.mail_1"),O(" > "),y("Layout.Sider.mail_12")])}),onConfirm:()=>{S.push("/mail/settings")}})}},{keys:ra,table:ca,columns:pa}=h([{type:"selection",width:40},{key:"username",title:y("Public.Table.Username"),ellipsis:{tooltip:!0}},w({width:160}),{key:"info",title:y("Mail.MailBox.index_2"),width:180,render:a=>I("a",{class:"bt-link",href:"javascript:;",onClick:()=>{ha(a)}},[y("Public.Btn.Copy")])},{key:"quota",title:y("Mail.MailBox.index_3"),render:a=>i(a.quota)},{key:"is_admin",title:y("Mail.MailBox.index_4"),render:a=>1===a.is_admin?"Admin":"General user"},{key:"active",title:y("Public.Table.Status"),render:a=>I(L,{value:a.active,size:"small",checkedValue:1,uncheckedValue:0,onUpdateValue:async e=>{await B({username:a.username,full_name:a.full_name,quota:i(a.quota),active:e,is_admin:a.is_admin}),a.active=e}},null)},f({width:150,options:a=>[{label:"WebMail",onClick:()=>{if(ba.status)wa(a);else{const{hide:a}=b({title:y("Mail.MailBox.index_5"),content:()=>I(aa,{tag:"div",keypath:"Mail.MailBox.index_6",scope:"global"},{link_1:()=>I("a",{class:"bt-link",href:"javascript:;",onClick:()=>{S.push("/mail/settings"),a()}},[y("Layout.Sider.mail_1"),O(" > "),y("Layout.Sider.mail_12")])}),onConfirm:()=>{S.push("/mail/settings")}})}}},{label:y("Public.Btn.Edit"),onClick:()=>{fa(a)}},{label:y("Public.Btn.Del"),onClick:()=>{Ma(a)}}]})]),_a=[{key:"delete",type:"confirm",label:y("Site.Batch.index_21"),confirm:{title:y("Site.Batch.index_21"),desc:y("Site.Batch.index_11"),columns:[{...pa.value[1],width:"auto"}],api:a=>P({username:a.username},!1),done:()=>{ga()}}}],ha=a=>{M("WebMail: ".concat(ba.ssl_status?"https":"http","://").concat(ba.site_name,"\nUsername: ").concat(a.username,"\nPassword: ").concat(a.password,"\nPOP service [ Address: ").concat(a.mx," Port: 110/995 ]\nIMAP service [ Address: ").concat(a.mx," Port: 143/993 ]\nSMTP service [ Address: ").concat(a.mx," Port: 25/465/587 ]\n"))},wa=async a=>{g({title:"WebMail",width:400,data:{row:a,info:ba},component:na})},fa=a=>{sa.data.isEdit=!0,sa.data.row=a,sa.title=y("Mail.MailBox.index_7"),sa.show=!0},Ma=async a=>{b({title:y("Mail.MailBox.index_8"),content:y("Mail.MailBox.index_9",[a.username]),onConfirm:async()=>{await P({username:a.username}),ga()}})},ba=N({id:0,site_name:"",status:!1,ssl_status:!1}),ga=async()=>{try{ca.loading=!0;const{message:a}=await q({p:ta.p,size:ta.size,search:ta.search,..."all"!==ta.domain?{domain:ta.domain}:{}});e(a)&&(ca.data=t(a.data)?a.data:[],ca.total=n(a.page))}finally{ca.loading=!1,ra.value=[]}},ya=x(y("Mail.MailBox.index_31"),{getList:ga}),Ba=()=>{ta.p=1,ga()};return A(),(async()=>{const{message:a}=await j();t(a)&&(z.value=a.map((a=>({label:a,value:a}))),A())})(),(async()=>{try{ca.loading=!0,await(async()=>{const{message:a}=await U();e(a)&&(ba.id=a.id,ba.status=a.status,ba.site_name=a.site_name,ba.ssl_status=a.ssl_status)})(),await ga()}finally{ca.loading=!1}})(),(a,e)=>{const l=E,t=R,i=m,n=_,o=p,u=c,v=r,x=d,h=T;return V(),X(h,{class:"p-16px"},{default:F((()=>[I(v,null,{toolsLeft:F((()=>[I(l,{type:"primary",onClick:oa},{default:F((()=>[O(K(a.$t("Mail.MailBox.index_1")),1)])),_:1}),I(l,{onClick:ua},{default:F((()=>[O(K(a.$t("Mail.MailBox.index_30")),1)])),_:1}),I(l,{onClick:da},{default:F((()=>e[8]||(e[8]=[O("WebMail")]))),_:1}),I(l,{onClick:G},{default:F((()=>[O(K(a.$t("Public.Btn.Import")),1)])),_:1}),I(l,{onClick:W},{default:F((()=>[O(K(a.$t("Public.Btn.Export")),1)])),_:1})])),toolsRight:F((()=>[H("div",va,[I(t,{value:J(ta).domain,"onUpdate:value":[e[0]||(e[0]=a=>J(ta).domain=a),Ba],options:J(z),"render-tag":D,filterable:!0},null,8,["value","options"])]),I(i,{value:J(ta).search,"onUpdate:value":e[1]||(e[1]=a=>J(ta).search=a),width:"280",placeholder:a.$t("Mail.MailBox.index_28"),onSearch:Ba},null,8,["value","placeholder"])])),table:F((()=>[I(n,{"row-key":"username","checked-row-keys":J(ra),"onUpdate:checkedRowKeys":e[2]||(e[2]=a=>ea(ra)?ra.value=a:null),loading:J(ca).loading,data:J(ca).data,columns:J(pa)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:F((()=>[I(o,{page:J(ta).p,"onUpdate:page":e[3]||(e[3]=a=>J(ta).p=a),"page-size":J(ta).size,"onUpdate:pageSize":e[4]||(e[4]=a=>J(ta).size=a),"item-count":J(ca).total,onRefresh:ga},null,8,["page","page-size","item-count"])])),pageLeft:F((()=>[I(u,{"row-key":"username","checked-row-keys":J(ra),"onUpdate:checkedRowKeys":e[5]||(e[5]=a=>ea(ra)?ra.value=a:null),data:J(ca).data,options:_a},null,8,["checked-row-keys","data"])])),_:1}),I(x,{show:J(sa).show,"onUpdate:show":e[6]||(e[6]=a=>J(sa).show=a),title:J(sa).title,data:J(sa).data,width:480,"min-height":236,footer:!0,component:ma},null,8,["show","title","data"]),I(x,{show:J(ya).show,"onUpdate:show":e[7]||(e[7]=a=>J(ya).show=a),title:J(ya).title,data:J(ya).data,width:480,"min-height":236,footer:!0,component:J(s)},null,8,["show","title","data","component"])])),_:1})}}});export{ha as default};
