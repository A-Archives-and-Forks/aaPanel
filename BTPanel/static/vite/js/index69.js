const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/shell.js?v=1744703330658","js/index.vue_vue_type_script_setup_true_lang6.js?v=1744703330658","js/page_layout.js?v=1744703330658","js/vue.js?v=1744703330658","js/__commonjsHelpers__.js?v=1744703330658","js/naive.js?v=1744703330658","js/common.js?v=1744703330658","js/public.js?v=1744703330658","css/public.css?v=1744703330658","css/page_layout.css?v=1744703330658","js/site2.js?v=1744703330658","js/site3.js?v=1744703330658","js/cc.js?v=1744703330658"])))=>i.map(i=>d[i]);
import{k as e,cU as t,l as a,bh as l,W as s,a9 as o,cV as i,K as n,J as r,a as c,cW as d,j as u,cp as p}from"./page_layout.js?v=1744703330658";import{R as v,$ as f,a0 as m,m as x,d as _,ai as h,j as y,U as w,a1 as b,V as g,P as k,r as O,O as S,as as W,y as j,S as L,F as C,N as $,c as T,af as E,_ as I,aC as D,ap as A,ag as R,Y as q}from"./vue.js?v=1744703330658";import{ck as N,bz as z,bZ as P,cs as U,cl as G,ae as M,cz as V}from"./naive.js?v=1744703330658";import{_ as F}from"./index.vue_vue_type_script_setup_true_lang16.js?v=1744703330658";import{j as H,d as B,b as Y}from"./public.js?v=1744703330658";import{_ as J}from"./index.js?v=1744703330658";import{_ as K}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1744703330658";import{a as Q}from"./tools2.js?v=1744703330658";import"./common.js?v=1744703330658";import"./__commonjsHelpers__.js?v=1744703330658";import"./rules.js?v=1744703330658";const Z=e({},[["render",function(e,t){const a=N;return v(),f(a,{class:"wap-card"},{header:m((()=>[x(e.$slots,"header",{},void 0,!0)])),default:m((()=>[x(e.$slots,"default",{},void 0,!0)])),_:3})}],["__scopeId","data-v-2f1d0213"]]),X={class:"flex items-center h-184px text-#888"},ee={class:"flex-1 flex-center flex-col"},te={class:"flex items-center mb-16px"},ae={class:"ml-8px text-14px"},le={class:"text-22px font-bold"},se={class:"flex-1 flex-center flex-col"},oe={class:"flex items-center mb-16px"},ie={class:"ml-8px text-14px"},ne=_({__name:"index",setup(e){const l=t(),s=h(),o=y({request:0,malicious:0}),i=()=>{s.push("/waf/block")};return l.onReady("total",(e=>{o.request=e.count.today_request,o.malicious=e.count.malicious_request})),(e,t)=>{const l=a;return v(),f(Z,null,{default:m((()=>[w("div",X,[w("div",ee,[w("div",te,[t[0]||(t[0]=w("img",{class:"icon",src:"/static/vite/images/today.svg"},null,-1)),w("span",ae,b(e.$t("Waf.Overview.index_1")),1)]),w("div",le,b(g(o).request),1)]),k(l,{class:"text-106px",vertical:""}),w("div",se,[w("div",oe,[t[1]||(t[1]=w("img",{class:"icon",src:"/static/vite/images/malicious.svg"},null,-1)),w("span",ie,b(e.$t("Waf.Overview.index_2")),1)]),w("div",{class:"text-22px font-bold cursor-pointer",onClick:i},b(g(o).malicious),1)])])])),_:1})}}}),re={class:"text-desc text-12px leading-1"},ce=e(_({__name:"auto-refresh",props:{open:{type:Boolean,default:!0},seconds:{default:3},refresh:{}},setup(e){const t=e,a=t.seconds,l=O(0),s=O(a),o=O(!1),{loop:i}=H((async()=>{var e;if(0===s.value)try{o.value=!0,await(null==(e=t.refresh)?void 0:e.call(t))}finally{l.value=0,s.value=a,o.value=!1}else s.value-=1,l.value=(a-s.value)/a*100}),1);return i(),(e,t)=>{const i=z,n=P;return v(),f(n,{placement:"bottom"},{trigger:m((()=>[k(i,{class:"refresh-progress",type:"circle",status:"success",processing:g(o),"rail-color":"#e8e8e8","stroke-width":12,"offset-degree":180,percentage:g(l)},{default:m((()=>[w("span",re,b(g(s)),1)])),_:1},8,["processing","percentage"])])),default:m((()=>[w("span",null,b(e.$t("Waf.Overview.index_8",[g(a)])),1)])),_:1})}}}),[["__scopeId","data-v-8898e53f"]]),de={class:"flex"},ue=e(_({__name:"query-date",props:{value:{default:"today"},valueModifiers:{}},emits:["update:value"],setup(e){const{t:t}=S(),a=O("today"),i=O(null),n=W(e,"value"),r=[{label:t("Public.Search.Yesterday"),value:"yesterday"},{label:t("Public.Search.Today"),value:"today"}],c=e=>{i.value=null,n.value=e},d=e=>{a.value=e?"":"today",n.value=l(e)?s(e,"yyyy-MM-dd"):"today"};return j((()=>{r.map((e=>e.value)).includes(n.value)?(a.value=n.value,i.value=null):(a.value="",i.value=new Date(n.value).getTime())})),(e,t)=>{const l=U,s=G,n=o;return v(),L("div",de,[k(s,{value:g(a),"onUpdate:value":[t[0]||(t[0]=e=>E(a)?a.value=e:null),c],size:"small",class:"bt-radio"},{default:m((()=>[(v(),L(C,null,$(r,(e=>k(l,{key:e.value,value:e.value},{default:m((()=>[T(b(e.label),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"]),k(n,{value:g(i),"onUpdate:value":[t[1]||(t[1]=e=>E(i)?i.value=e:null),d],type:"date",size:"small",class:"bt-date-picker",clearable:!0},null,8,["value"])])}}}),[["__scopeId","data-v-f8a2b372"]]),pe={class:"flex justify-between flex-1"},ve={class:"flex items-center"},fe={class:"mr-10px"},me={class:"flex-center h-134px p-10px"},xe=_({__name:"index",setup(e){const{t:a}=S(),l=t(),{loading:o,startTime:r}=I(l),c=O(!0),d=()=>{l.getInfo()},u=async()=>{await l.getNewInfo()},p=(e=[])=>({type:"category",boundaryGap:!1,data:e,axisLabel:{color:"#666"},nameTextStyle:{color:"#666"},axisLine:{show:!0,lineStyle:{color:"#666"}},axisTick:{show:!0,lineStyle:{color:"#666"}}}),x=(e=[],t=[])=>[{name:a("Waf.Overview.index_4"),type:"line",data:e,symbol:"none",sampling:"average",smooth:!0,showSymbol:!1,itemStyle:{color:"#A0BFE0"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(242, 242, 242, 0.6)"},{offset:.8,color:"rgba(242, 242, 242, 0)"}]}}},{name:a("Waf.Overview.index_5"),type:"line",data:t,sampling:"average",smooth:!0,symbol:"none",showSymbol:!1,itemStyle:{color:"#20a53a"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(32, 164, 58, 0.6)"},{offset:1,color:"rgba(32, 164, 58, 0)"}]}}}],_=D({grid:{left:"5%",right:"4%",bottom:"3%",top:"20%",containLabel:!0},legend:{icon:"circle",data:[a("Waf.Overview.index_5"),a("Waf.Overview.index_4")],top:"-2%",itemWidth:10,itemHeight:10,itemGap:16,textStyle:{lineHeight:12,padding:[0,0,-2,0],rich:{a:{verticalAlign:"middle"}}}},tooltip:{trigger:"axis",formatter(e){let t="";const l=Object.entries(e);return l.forEach((([,e],o)=>{0===o&&(t+="".concat(a("Waf.Overview.index_6",[s(i(r.value),"yyyy-MM-dd"),e.name]),"<br />")),t+='<span style="display: inline-block; width: 10px; height: 10px; margin-right:10px; border-radius: 50%;background: '.concat(e.color,';"></span>').concat(e.seriesName,": ").concat(e.value,"<br />"),o===l.length-1&&(t+='<div style="padding-left: 20px;">'.concat(a("Waf.Overview.index_7_1",[e.data.err_499]),"<br />").concat(a("Waf.Overview.index_7_2",[e.data.err_502]),"</div>"))})),t}},xAxis:p(),yAxis:{type:"value",nameGap:8,splitNumber:4,splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:"#ebeef5"}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#666"},nameTextStyle:{color:"#666"}},series:x()});return l.onReady("flow",(e=>{0===e.traffic_filter.length?c.value=!0:(c.value=!1,(e=>{const t=[],a=[],l=[];e.forEach((e=>{const s=e.hour<10?"0"+e.hour:e.hour,o=e.minute<10?"0"+e.minute:e.minute;t.push("".concat(s,":").concat(o)),a.push(e.proxy_count),l.push({value:e.request,err_499:e.err_499,err_502:e.err_502})})),_.xAxis=p(t),_.series=x(a,l)})(e.traffic_filter))})),(e,t)=>{const a=M,l=n;return v(),f(Z,null,{header:m((()=>[w("div",pe,[w("div",ve,[w("div",fe,b(e.$t("Waf.Overview.index_3")),1),k(ue,{value:g(r),"onUpdate:value":[t[0]||(t[0]=e=>E(r)?r.value=e:null),d]},null,8,["value"])]),k(ce,{refresh:u})])])),default:m((()=>[k(l,{show:g(o)},{default:m((()=>[w("div",me,[g(c)?(v(),f(a,{key:0})):(v(),f(F,{key:1,type:"line",height:"100%",option:g(_)},null,8,["option"]))])])),_:1},8,["show"])])),_:1})}}}),_e={class:"h-134px p-10px"},he=_({__name:"index",setup(e){const{t:a}=S(),l=t(),o=O(0),i=(e=[])=>({type:"category",boundaryGap:!1,data:e,axisLabel:{color:"#666",formatter:e=>s(r(e),"hh:mm:ss")},nameTextStyle:{color:"#666"},axisLine:{show:!0,lineStyle:{color:"#666"}},axisTick:{show:!0,lineStyle:{color:"#666"}}}),n=(e=[])=>[{name:"QPS",type:"line",stack:"Total",data:e,itemStyle:{color:"#20a53a"},smooth:!0,showSymbol:!1,sampling:"average",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(32, 164, 58, 0.4)"},{offset:.7,color:"rgba(32, 164, 58, 0)"}]}}}],c=D({grid:{left:"5%",right:"10%",bottom:"3%",top:"20%",containLabel:!0},tooltip:{trigger:"axis",formatter(e){let t="";return Object.entries(e).forEach((([,e],l)=>{0===l&&(t+="".concat(a("Waf.Overview.index_22",[s(e.axisValue)]),"<br>")),t+='<span style="display: inline-block; width: 10px; height: 10px; margin-right:10px; border-radius: 50%;background: '.concat(e.color,';"></span>').concat(e.seriesName,": ").concat(e.value)})),t}},xAxis:i(),yAxis:{type:"value",nameGap:8,splitNumber:4,splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:"#ebeef5"}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#666"},nameTextStyle:{color:"#666"}},series:n()}),d=[],u=[],p=()=>{var e;d.length>0&&(e=d[0],(new Date).getTime()-e>6e4)&&(d.shift(),u.shift()),c.xAxis=i(d),c.series=n(u)};return l.onReady("qps",(e=>{o.value=e.qps,d.push(Date.now()),u.push(e.qps),p()})),(e,t)=>(v(),f(Z,null,{header:m((()=>[w("span",null,b(e.$t("Waf.Overview.index_21",[g(o)])),1)])),default:m((()=>[w("div",_e,[k(F,{type:"line",height:"100%",option:g(c)},null,8,["option"])])])),_:1}))}}),ye={class:"flex-center h-292px p-10px"},we=_({__name:"index",setup(e){const{t:a}=S(),l=t(),s=O(!1),o=D({backgroundColor:"#fff",title:i(),tooltip:{trigger:"item",confine:!0,formatter(e){const t=e;return"".concat(t.marker," ").concat(t.name,": ").concat(t.value," (").concat(t.percent,"%)")}},series:r()});function i(e=0){return{text:a("Waf.Overview.index_32"),textStyle:{color:"#484848",fontSize:17},subtext:"".concat(e),subtextStyle:{color:"#717171",fontSize:15},itemGap:20,left:"center",top:"42%"}}const n=["#6ec71e","#4885FF","#fc8b40","#818af8","#31c9d7","#f35e7a","#ab7aee","#14d68b","#cde5ff"];function r(e=[]){return[{type:"pie",data:e,radius:["45%","55%"],center:["50%","50%"],clockwise:!0,avoidLabelOverlap:!0,label:{show:!0,position:"outside",color:"#999",lineHeight:18,formatter:e=>""!==e.name?0===e.percent?"":a("Waf.Overview.index_33",[e.name,e.value,e.percent]):""},labelLine:{length:30,length2:30,lineStyle:{width:1,color:"#CDCDCD"}},itemStyle:{labelLine:{length:30,length2:30,lineStyle:{width:1,color:"#CDCDCD"}},color:e=>n[e.dataIndex]},emphasis:{scaleSize:15}}]}return l.onReady("block",(e=>{s.value=0===e.type.length,(e=>{let t=0;const a=[];e.forEach((e=>{t+=e[1],a.push({name:e[0],value:e[1]})})),o.title=i(t),o.series=r(a)})(e.type)})),(e,t)=>{const a=M;return v(),f(Z,{class:"mb-16px"},{header:m((()=>[w("span",null,b(e.$t("Waf.Overview.index_31")),1)])),default:m((()=>[w("div",ye,[g(s)?(v(),f(a,{key:0})):(v(),f(F,{key:1,type:"pie",height:"100%",option:g(o)},null,8,["option"]))])])),_:1})}}}),be={class:"flex flex-col justify-center h-306px p-20px"},ge={class:"count-item"},ke={class:"count-tit"},Oe={class:"count-val"},Se={class:"count-item"},We={class:"count-tit"},je={class:"count-val"},Le={class:"count-item"},Ce={class:"count-tit"},$e={class:"count-val"},Te=e(_({__name:"index",setup(e){const a=q((()=>c((()=>import("./shell.js?v=1744703330658")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])))),l=q((()=>c((()=>import("./site2.js?v=1744703330658")),__vite__mapDeps([10,1,2,3,4,5,6,7,8,9,11])))),s=q((()=>c((()=>import("./cc.js?v=1744703330658")),__vite__mapDeps([12,1,2,3,4,5,6,7,8,9])))),{t:o}=S(),i=t(),n=y({webshell:0,site:0,siteList:[],cc:0,ccList:[]}),r=B(o("Waf.Overview.index_14")),p=()=>{},x=B(o("Waf.Overview.index_15")),_=async()=>{await d(),i.getNewInfo()},h=()=>{x.data.list=n.siteList,x.show=!0},O=B(o("Waf.Overview.index_16")),W=()=>{O.data.list=n.ccList,O.show=!0};return i.onReady("count",(e=>{n.webshell=e.count.webshell,n.site=e.count.unprotected_site,n.siteList=e.count.unprotected_site_list,n.cc=e.count.maybe_err_cc,n.ccList=e.count.maybe_err_cc_list})),(e,t)=>{const o=u,i=J;return v(),f(Z,null,{default:m((()=>[w("div",be,[w("div",ge,[w("div",ke,b(e.$t("Waf.Overview.index_9")),1),w("div",Oe,[w("div",{class:"count-num",onClick:p},b(g(n).webshell),1)])]),w("div",Se,[w("div",We,b(e.$t("Waf.Overview.index_10")),1),w("div",je,[w("div",{class:"count-num",onClick:h},b(g(n).site),1),g(n).site>0?(v(),L(C,{key:0},[k(o,{class:"ml-20px",onClick:_},{default:m((()=>[T(b(e.$t("Waf.Overview.index_11")),1)])),_:1}),k(o,{class:"ml-20px",onClick:h},{default:m((()=>[T(b(e.$t("Waf.Overview.index_12")),1)])),_:1})],64)):A("",!0)])]),w("div",Le,[w("div",Ce,b(e.$t("Waf.Overview.index_13")),1),w("div",$e,[w("div",{class:R(["count-num",{"text-error":g(n).cc>0}]),onClick:W},b(g(n).cc),3),g(n).cc>0?(v(),f(o,{key:0,class:"ml-20px",onClick:W},{default:m((()=>[T(b(e.$t("Waf.Overview.index_12")),1)])),_:1})):A("",!0)])])]),k(i,{show:g(r).show,"onUpdate:show":t[0]||(t[0]=e=>g(r).show=e),title:g(r).title,width:800,"min-height":236,component:g(a)},null,8,["show","title","component"]),k(i,{show:g(x).show,"onUpdate:show":t[1]||(t[1]=e=>g(x).show=e),title:g(x).title,data:g(x).data,width:440,"min-height":236,component:g(l)},null,8,["show","title","data","component"]),k(i,{show:g(O).show,"onUpdate:show":t[2]||(t[2]=e=>g(O).show=e),title:g(O).title,data:g(O).data,width:800,"min-height":236,component:g(s)},null,8,["show","title","data","component"])])),_:1})}}}),[["__scopeId","data-v-c6ff642a"]]),Ee={class:"flex items-center justify-between flex-1"},Ie={class:"bt-link text-12px",href:"/btwaf/content_report.html",target:"_blank"},De={class:"flex h-616px p-10px"},Ae={class:"flex-1"},Re={class:"district-legend"},qe={class:"mr-2"},Ne={class:"ml-2"},ze={class:"w-320px min-w-320px pt-10px"},Pe=e(_({__name:"index",setup(e){const{t:a}=S(),l=t(),s=D({title:{left:"center",top:"top"},grid:{top:70,bottom:40,left:0,right:0},tooltip:{padding:4,borderColor:"rgba(50, 50, 50, 0)",backgroundColor:"rgba(50, 50, 50, 0.7)",textStyle:{color:"#fff"},formatter:e=>{const t=e;let l="";const s="".concat(t.value).split(".");return l="NaN"===s[0]?t.name:"".concat(t.name,"<br />").concat(a("Waf.Overview.index_26",[s[0]])),l}},visualMap:{min:0,max:100,left:-200,range:null,inRange:{color:["rgba(62, 183, 82, 0.13)","rgba(62, 183, 82, 0.5)","#3eb752"]}},series:o()});function o(e=[]){return[{name:"World Population (2010)",type:"map",map:"world",zoom:1.2,itemStyle:{borderColor:"#ffffff",areaColor:"#E6E6E6"},label:{show:!1},emphasis:{itemStyle:{borderColor:"#ffffff",areaColor:"#20a53a"}},data:e}]}const{table:i,columns:n}=Y([{key:"ip",width:120,title:a("Waf.Overview.index_27"),ellipsis:{tooltip:!0},render:e=>k("a",{class:"bt-link",href:"javascript:;",onClick:()=>{Q({ip:e.ip})}},[e.ip])},{key:"count",width:90,title:a("Waf.Overview.index_28")},{key:"address",title:a("Waf.Overview.index_29"),ellipsis:{tooltip:!0}}]);return l.onReady("map",(e=>{var t;i.data=e.attack_details,t=e.map,s.series=o(t)})),(e,t)=>{const a=K;return v(),f(Z,null,{header:m((()=>[w("div",Ee,[w("div",null,b(e.$t("Waf.Overview.index_23")),1),w("a",Ie,b(e.$t("Waf.Overview.index_30")),1)])])),default:m((()=>[w("div",De,[w("div",Ae,[k(F,{type:"map",height:"100%",option:g(s)},null,8,["option"]),w("div",Re,[w("span",qe,b(e.$t("Waf.Overview.index_24")),1),t[0]||(t[0]=w("div",{class:"item"},null,-1)),t[1]||(t[1]=w("div",{class:"item"},null,-1)),t[2]||(t[2]=w("div",{class:"item"},null,-1)),w("span",Ne,b(e.$t("Waf.Overview.index_25")),1)])]),w("div",ze,[k(a,{"max-height":520,bordered:!1,data:g(i).data,columns:g(n)},null,8,["data","columns"])])])])),_:1})}}}),[["__scopeId","data-v-1e7bcc80"]]),Ue=_({__name:"index",setup:e=>(t().getInfo(),(e,t)=>{const a=V,l=p;return v(),L("div",null,[k(l,{"x-gap":"16","y-gap":"16"},{default:m((()=>[k(a,{span:"6 992:24"},{default:m((()=>[k(ne)])),_:1}),k(a,{span:"12 992:24"},{default:m((()=>[k(xe)])),_:1}),k(a,{span:"6 992:24"},{default:m((()=>[k(he)])),_:1}),k(a,{span:"6 992:24"},{default:m((()=>[k(we),k(Te)])),_:1}),k(a,{span:"18 992:24"},{default:m((()=>[k(Pe)])),_:1})])),_:1})])})});export{Ue as default};
