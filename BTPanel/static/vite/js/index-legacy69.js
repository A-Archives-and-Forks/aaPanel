System.register(["./page_layout-legacy.js?v=1744703330658","./vue-legacy.js?v=1744703330658","./naive-legacy.js?v=1744703330658","./index.vue_vue_type_script_setup_true_lang-legacy16.js?v=1744703330658","./public-legacy.js?v=1744703330658","./index-legacy.js?v=1744703330658","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1744703330658","./tools-legacy2.js?v=1744703330658","./common-legacy.js?v=1744703330658","./__commonjsHelpers__-legacy.js?v=1744703330658","./rules-legacy.js?v=1744703330658"],(function(e,t){"use strict";var a,l,i,o,s,n,r,c,d,u,p,f,v,x,m,h,y,g,b,_,w,k,S,$,O,W,j,C,L,T,z,q,I,D,E,N,A,R,U,G,M,P,F,H,V,B,Y,J,K,Q,Z,X;return{setters:[e=>{a=e.k,l=e.cU,i=e.l,o=e.bh,s=e.W,n=e.a9,r=e.cV,c=e.K,d=e.J,u=e.a,p=e.cW,f=e.j,v=e.cp},e=>{x=e.R,m=e.$,h=e.a0,y=e.m,g=e.d,b=e.ai,_=e.j,w=e.U,k=e.a1,S=e.V,$=e.P,O=e.r,W=e.O,j=e.as,C=e.y,L=e.S,T=e.F,z=e.N,q=e.c,I=e.af,D=e._,E=e.aC,N=e.ap,A=e.ag,R=e.Y},e=>{U=e.ck,G=e.bz,M=e.bZ,P=e.cs,F=e.cl,H=e.ae,V=e.cz},e=>{B=e._},e=>{Y=e.j,J=e.d,K=e.b},e=>{Q=e._},e=>{Z=e._},e=>{X=e.a},null,null,null],execute:function(){var ee=document.createElement("style");ee.textContent=".wap-card[data-v-2f1d0213]{--n-border-radius: 6px;--n-title-font-size: 14px;border:1px #f7f7f7 solid;box-shadow:0 1px 3px 1px rgba(0,0,0,.05)}.wap-card[data-v-2f1d0213] .n-card-header{height:50px;padding:0 16px}.refresh-progress[data-v-8898e53f]{width:28px;cursor:pointer}.bt-radio[data-v-f8a2b372] .n-radio-button:last-child{border-right:none;border-top-right-radius:0;border-bottom-right-radius:0}.bt-date-picker[data-v-f8a2b372] .n-input{border-top-left-radius:0;border-bottom-left-radius:0}.count-item[data-v-c6ff642a]{color:#888}.count-item+.count-item[data-v-c6ff642a]{padding-top:20px;margin-top:20px;border-top:1px solid #dcdcdc}.count-item .count-tit[data-v-c6ff642a]{margin-bottom:12px;font-size:14px}.count-item .count-val[data-v-c6ff642a]{display:flex;align-items:baseline;padding-left:12px}.count-item .count-num[data-v-c6ff642a]{font-size:22px;font-weight:700;cursor:pointer}.district-legend[data-v-1e7bcc80]{position:absolute;left:4%;bottom:4%;display:flex;align-items:center;color:#7b7d98}.district-legend .item[data-v-1e7bcc80]{width:15px;height:4px}.district-legend .item+.item[data-v-1e7bcc80]{margin-left:6px}.district-legend .item[data-v-1e7bcc80]:nth-of-type(1){background-color:rgba(62,183,82,.125)}.district-legend .item[data-v-1e7bcc80]:nth-of-type(2){background-color:rgba(62,183,82,.5)}.district-legend .item[data-v-1e7bcc80]:nth-of-type(3){background-color:#3eb752}\n",document.head.appendChild(ee);const te=a({},[["render",function(e,t){const a=U;return x(),m(a,{class:"wap-card"},{header:h((()=>[y(e.$slots,"header",{},void 0,!0)])),default:h((()=>[y(e.$slots,"default",{},void 0,!0)])),_:3})}],["__scopeId","data-v-2f1d0213"]]),ae={class:"flex items-center h-184px text-#888"},le={class:"flex-1 flex-center flex-col"},ie={class:"flex items-center mb-16px"},oe={class:"ml-8px text-14px"},se={class:"text-22px font-bold"},ne={class:"flex-1 flex-center flex-col"},re={class:"flex items-center mb-16px"},ce={class:"ml-8px text-14px"},de=g({__name:"index",setup(e){const t=l(),a=b(),o=_({request:0,malicious:0}),s=()=>{a.push("/waf/block")};return t.onReady("total",(e=>{o.request=e.count.today_request,o.malicious=e.count.malicious_request})),(e,t)=>{const a=i;return x(),m(te,null,{default:h((()=>[w("div",ae,[w("div",le,[w("div",ie,[t[0]||(t[0]=w("img",{class:"icon",src:"/static/vite/images/today.svg"},null,-1)),w("span",oe,k(e.$t("Waf.Overview.index_1")),1)]),w("div",se,k(S(o).request),1)]),$(a,{class:"text-106px",vertical:""}),w("div",ne,[w("div",re,[t[1]||(t[1]=w("img",{class:"icon",src:"/static/vite/images/malicious.svg"},null,-1)),w("span",ce,k(e.$t("Waf.Overview.index_2")),1)]),w("div",{class:"text-22px font-bold cursor-pointer",onClick:s},k(S(o).malicious),1)])])])),_:1})}}}),ue={class:"text-desc text-12px leading-1"},pe=g({__name:"auto-refresh",props:{open:{type:Boolean,default:!0},seconds:{default:3},refresh:{}},setup(e){const t=e,a=t.seconds,l=O(0),i=O(a),o=O(!1),{loop:s}=Y((async()=>{if(0===i.value)try{o.value=!0,await(t.refresh?.())}finally{l.value=0,i.value=a,o.value=!1}else i.value-=1,l.value=(a-i.value)/a*100}),1);return s(),(e,t)=>{const s=G,n=M;return x(),m(n,{placement:"bottom"},{trigger:h((()=>[$(s,{class:"refresh-progress",type:"circle",status:"success",processing:S(o),"rail-color":"#e8e8e8","stroke-width":12,"offset-degree":180,percentage:S(l)},{default:h((()=>[w("span",ue,k(S(i)),1)])),_:1},8,["processing","percentage"])])),default:h((()=>[w("span",null,k(e.$t("Waf.Overview.index_8",[S(a)])),1)])),_:1})}}}),fe=a(pe,[["__scopeId","data-v-8898e53f"]]),ve={class:"flex"},xe=a(g({__name:"query-date",props:{value:{default:"today"},valueModifiers:{}},emits:["update:value"],setup(e){const{t:t}=W(),a=O("today"),l=O(null),i=j(e,"value"),r=[{label:t("Public.Search.Yesterday"),value:"yesterday"},{label:t("Public.Search.Today"),value:"today"}],c=e=>{l.value=null,i.value=e},d=e=>{a.value=e?"":"today",i.value=o(e)?s(e,"yyyy-MM-dd"):"today"};return C((()=>{r.map((e=>e.value)).includes(i.value)?(a.value=i.value,l.value=null):(a.value="",l.value=new Date(i.value).getTime())})),(e,t)=>{const i=P,o=F,s=n;return x(),L("div",ve,[$(o,{value:S(a),"onUpdate:value":[t[0]||(t[0]=e=>I(a)?a.value=e:null),c],size:"small",class:"bt-radio"},{default:h((()=>[(x(),L(T,null,z(r,(e=>$(i,{key:e.value,value:e.value},{default:h((()=>[q(k(e.label),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"]),$(s,{value:S(l),"onUpdate:value":[t[1]||(t[1]=e=>I(l)?l.value=e:null),d],type:"date",size:"small",class:"bt-date-picker",clearable:!0},null,8,["value"])])}}}),[["__scopeId","data-v-f8a2b372"]]),me={class:"flex justify-between flex-1"},he={class:"flex items-center"},ye={class:"mr-10px"},ge={class:"flex-center h-134px p-10px"},be=g({__name:"index",setup(e){const{t:t}=W(),a=l(),{loading:i,startTime:o}=D(a),n=O(!0),d=()=>{a.getInfo()},u=async()=>{await a.getNewInfo()},p=(e=[])=>({type:"category",boundaryGap:!1,data:e,axisLabel:{color:"#666"},nameTextStyle:{color:"#666"},axisLine:{show:!0,lineStyle:{color:"#666"}},axisTick:{show:!0,lineStyle:{color:"#666"}}}),f=(e=[],a=[])=>[{name:t("Waf.Overview.index_4"),type:"line",data:e,symbol:"none",sampling:"average",smooth:!0,showSymbol:!1,itemStyle:{color:"#A0BFE0"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(242, 242, 242, 0.6)"},{offset:.8,color:"rgba(242, 242, 242, 0)"}]}}},{name:t("Waf.Overview.index_5"),type:"line",data:a,sampling:"average",smooth:!0,symbol:"none",showSymbol:!1,itemStyle:{color:"#20a53a"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(32, 164, 58, 0.6)"},{offset:1,color:"rgba(32, 164, 58, 0)"}]}}}],v=E({grid:{left:"5%",right:"4%",bottom:"3%",top:"20%",containLabel:!0},legend:{icon:"circle",data:[t("Waf.Overview.index_5"),t("Waf.Overview.index_4")],top:"-2%",itemWidth:10,itemHeight:10,itemGap:16,textStyle:{lineHeight:12,padding:[0,0,-2,0],rich:{a:{verticalAlign:"middle"}}}},tooltip:{trigger:"axis",formatter(e){let a="";const l=Object.entries(e);return l.forEach((([,e],i)=>{0===i&&(a+=`${t("Waf.Overview.index_6",[s(r(o.value),"yyyy-MM-dd"),e.name])}<br />`),a+=`<span style="display: inline-block; width: 10px; height: 10px; margin-right:10px; border-radius: 50%;background: ${e.color};"></span>${e.seriesName}: ${e.value}<br />`,i===l.length-1&&(a+=`<div style="padding-left: 20px;">${t("Waf.Overview.index_7_1",[e.data.err_499])}<br />${t("Waf.Overview.index_7_2",[e.data.err_502])}</div>`)})),a}},xAxis:p(),yAxis:{type:"value",nameGap:8,splitNumber:4,splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:"#ebeef5"}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#666"},nameTextStyle:{color:"#666"}},series:f()});return a.onReady("flow",(e=>{0===e.traffic_filter.length?n.value=!0:(n.value=!1,(e=>{const t=[],a=[],l=[];e.forEach((e=>{const i=e.hour<10?"0"+e.hour:e.hour,o=e.minute<10?"0"+e.minute:e.minute;t.push(`${i}:${o}`),a.push(e.proxy_count),l.push({value:e.request,err_499:e.err_499,err_502:e.err_502})})),v.xAxis=p(t),v.series=f(a,l)})(e.traffic_filter))})),(e,t)=>{const a=H,l=c;return x(),m(te,null,{header:h((()=>[w("div",me,[w("div",he,[w("div",ye,k(e.$t("Waf.Overview.index_3")),1),$(xe,{value:S(o),"onUpdate:value":[t[0]||(t[0]=e=>I(o)?o.value=e:null),d]},null,8,["value"])]),$(fe,{refresh:u})])])),default:h((()=>[$(l,{show:S(i)},{default:h((()=>[w("div",ge,[S(n)?(x(),m(a,{key:0})):(x(),m(B,{key:1,type:"line",height:"100%",option:S(v)},null,8,["option"]))])])),_:1},8,["show"])])),_:1})}}}),_e={class:"h-134px p-10px"},we=g({__name:"index",setup(e){const{t:t}=W(),a=l(),i=O(0),o=(e=[])=>({type:"category",boundaryGap:!1,data:e,axisLabel:{color:"#666",formatter:e=>s(d(e),"hh:mm:ss")},nameTextStyle:{color:"#666"},axisLine:{show:!0,lineStyle:{color:"#666"}},axisTick:{show:!0,lineStyle:{color:"#666"}}}),n=(e=[])=>[{name:"QPS",type:"line",stack:"Total",data:e,itemStyle:{color:"#20a53a"},smooth:!0,showSymbol:!1,sampling:"average",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(32, 164, 58, 0.4)"},{offset:.7,color:"rgba(32, 164, 58, 0)"}]}}}],r=E({grid:{left:"5%",right:"10%",bottom:"3%",top:"20%",containLabel:!0},tooltip:{trigger:"axis",formatter(e){let a="";return Object.entries(e).forEach((([,e],l)=>{0===l&&(a+=`${t("Waf.Overview.index_22",[s(e.axisValue)])}<br>`),a+=`<span style="display: inline-block; width: 10px; height: 10px; margin-right:10px; border-radius: 50%;background: ${e.color};"></span>${e.seriesName}: ${e.value}`})),a}},xAxis:o(),yAxis:{type:"value",nameGap:8,splitNumber:4,splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:"#ebeef5"}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#666"},nameTextStyle:{color:"#666"}},series:n()}),c=[],u=[],p=()=>{var e;c.length>0&&(e=c[0],(new Date).getTime()-e>6e4)&&(c.shift(),u.shift()),r.xAxis=o(c),r.series=n(u)};return a.onReady("qps",(e=>{i.value=e.qps,c.push(Date.now()),u.push(e.qps),p()})),(e,t)=>(x(),m(te,null,{header:h((()=>[w("span",null,k(e.$t("Waf.Overview.index_21",[S(i)])),1)])),default:h((()=>[w("div",_e,[$(B,{type:"line",height:"100%",option:S(r)},null,8,["option"])])])),_:1}))}}),ke={class:"flex-center h-292px p-10px"},Se=g({__name:"index",setup(e){const{t:t}=W(),a=l(),i=O(!1),o=E({backgroundColor:"#fff",title:s(),tooltip:{trigger:"item",confine:!0,formatter(e){const t=e;return`${t.marker} ${t.name}: ${t.value} (${t.percent}%)`}},series:r()});function s(e=0){return{text:t("Waf.Overview.index_32"),textStyle:{color:"#484848",fontSize:17},subtext:`${e}`,subtextStyle:{color:"#717171",fontSize:15},itemGap:20,left:"center",top:"42%"}}const n=["#6ec71e","#4885FF","#fc8b40","#818af8","#31c9d7","#f35e7a","#ab7aee","#14d68b","#cde5ff"];function r(e=[]){return[{type:"pie",data:e,radius:["45%","55%"],center:["50%","50%"],clockwise:!0,avoidLabelOverlap:!0,label:{show:!0,position:"outside",color:"#999",lineHeight:18,formatter:e=>""!==e.name?0===e.percent?"":t("Waf.Overview.index_33",[e.name,e.value,e.percent]):""},labelLine:{length:30,length2:30,lineStyle:{width:1,color:"#CDCDCD"}},itemStyle:{labelLine:{length:30,length2:30,lineStyle:{width:1,color:"#CDCDCD"}},color:e=>n[e.dataIndex]},emphasis:{scaleSize:15}}]}return a.onReady("block",(e=>{i.value=0===e.type.length,(e=>{let t=0;const a=[];e.forEach((e=>{t+=e[1],a.push({name:e[0],value:e[1]})})),o.title=s(t),o.series=r(a)})(e.type)})),(e,t)=>{const a=H;return x(),m(te,{class:"mb-16px"},{header:h((()=>[w("span",null,k(e.$t("Waf.Overview.index_31")),1)])),default:h((()=>[w("div",ke,[S(i)?(x(),m(a,{key:0})):(x(),m(B,{key:1,type:"pie",height:"100%",option:S(o)},null,8,["option"]))])])),_:1})}}}),$e={class:"flex flex-col justify-center h-306px p-20px"},Oe={class:"count-item"},We={class:"count-tit"},je={class:"count-val"},Ce={class:"count-item"},Le={class:"count-tit"},Te={class:"count-val"},ze={class:"count-item"},qe={class:"count-tit"},Ie={class:"count-val"},De=a(g({__name:"index",setup(e){const a=R((()=>u((()=>t.import("./shell-legacy.js?v=1744703330658")),void 0))),i=R((()=>u((()=>t.import("./site-legacy2.js?v=1744703330658")),void 0))),o=R((()=>u((()=>t.import("./cc-legacy.js?v=1744703330658")),void 0))),{t:s}=W(),n=l(),r=_({webshell:0,site:0,siteList:[],cc:0,ccList:[]}),c=J(s("Waf.Overview.index_14")),d=()=>{},v=J(s("Waf.Overview.index_15")),y=async()=>{await p(),n.getNewInfo()},g=()=>{v.data.list=r.siteList,v.show=!0},b=J(s("Waf.Overview.index_16")),O=()=>{b.data.list=r.ccList,b.show=!0};return n.onReady("count",(e=>{r.webshell=e.count.webshell,r.site=e.count.unprotected_site,r.siteList=e.count.unprotected_site_list,r.cc=e.count.maybe_err_cc,r.ccList=e.count.maybe_err_cc_list})),(e,t)=>{const l=f,s=Q;return x(),m(te,null,{default:h((()=>[w("div",$e,[w("div",Oe,[w("div",We,k(e.$t("Waf.Overview.index_9")),1),w("div",je,[w("div",{class:"count-num",onClick:d},k(S(r).webshell),1)])]),w("div",Ce,[w("div",Le,k(e.$t("Waf.Overview.index_10")),1),w("div",Te,[w("div",{class:"count-num",onClick:g},k(S(r).site),1),S(r).site>0?(x(),L(T,{key:0},[$(l,{class:"ml-20px",onClick:y},{default:h((()=>[q(k(e.$t("Waf.Overview.index_11")),1)])),_:1}),$(l,{class:"ml-20px",onClick:g},{default:h((()=>[q(k(e.$t("Waf.Overview.index_12")),1)])),_:1})],64)):N("",!0)])]),w("div",ze,[w("div",qe,k(e.$t("Waf.Overview.index_13")),1),w("div",Ie,[w("div",{class:A(["count-num",{"text-error":S(r).cc>0}]),onClick:O},k(S(r).cc),3),S(r).cc>0?(x(),m(l,{key:0,class:"ml-20px",onClick:O},{default:h((()=>[q(k(e.$t("Waf.Overview.index_12")),1)])),_:1})):N("",!0)])])]),$(s,{show:S(c).show,"onUpdate:show":t[0]||(t[0]=e=>S(c).show=e),title:S(c).title,width:800,"min-height":236,component:S(a)},null,8,["show","title","component"]),$(s,{show:S(v).show,"onUpdate:show":t[1]||(t[1]=e=>S(v).show=e),title:S(v).title,data:S(v).data,width:440,"min-height":236,component:S(i)},null,8,["show","title","data","component"]),$(s,{show:S(b).show,"onUpdate:show":t[2]||(t[2]=e=>S(b).show=e),title:S(b).title,data:S(b).data,width:800,"min-height":236,component:S(o)},null,8,["show","title","data","component"])])),_:1})}}}),[["__scopeId","data-v-c6ff642a"]]),Ee={class:"flex items-center justify-between flex-1"},Ne={class:"bt-link text-12px",href:"/btwaf/content_report.html",target:"_blank"},Ae={class:"flex h-616px p-10px"},Re={class:"flex-1"},Ue={class:"district-legend"},Ge={class:"mr-2"},Me={class:"ml-2"},Pe={class:"w-320px min-w-320px pt-10px"},Fe=a(g({__name:"index",setup(e){const{t:t}=W(),a=l(),i=E({title:{left:"center",top:"top"},grid:{top:70,bottom:40,left:0,right:0},tooltip:{padding:4,borderColor:"rgba(50, 50, 50, 0)",backgroundColor:"rgba(50, 50, 50, 0.7)",textStyle:{color:"#fff"},formatter:e=>{const a=e;let l="";const i=`${a.value}`.split(".");return l="NaN"===i[0]?a.name:`${a.name}<br />${t("Waf.Overview.index_26",[i[0]])}`,l}},visualMap:{min:0,max:100,left:-200,range:null,inRange:{color:["rgba(62, 183, 82, 0.13)","rgba(62, 183, 82, 0.5)","#3eb752"]}},series:o()});function o(e=[]){return[{name:"World Population (2010)",type:"map",map:"world",zoom:1.2,itemStyle:{borderColor:"#ffffff",areaColor:"#E6E6E6"},label:{show:!1},emphasis:{itemStyle:{borderColor:"#ffffff",areaColor:"#20a53a"}},data:e}]}const{table:s,columns:n}=K([{key:"ip",width:120,title:t("Waf.Overview.index_27"),ellipsis:{tooltip:!0},render:e=>$("a",{class:"bt-link",href:"javascript:;",onClick:()=>{X({ip:e.ip})}},[e.ip])},{key:"count",width:90,title:t("Waf.Overview.index_28")},{key:"address",title:t("Waf.Overview.index_29"),ellipsis:{tooltip:!0}}]);return a.onReady("map",(e=>{var t;s.data=e.attack_details,t=e.map,i.series=o(t)})),(e,t)=>{const a=Z;return x(),m(te,null,{header:h((()=>[w("div",Ee,[w("div",null,k(e.$t("Waf.Overview.index_23")),1),w("a",Ne,k(e.$t("Waf.Overview.index_30")),1)])])),default:h((()=>[w("div",Ae,[w("div",Re,[$(B,{type:"map",height:"100%",option:S(i)},null,8,["option"]),w("div",Ue,[w("span",Ge,k(e.$t("Waf.Overview.index_24")),1),t[0]||(t[0]=w("div",{class:"item"},null,-1)),t[1]||(t[1]=w("div",{class:"item"},null,-1)),t[2]||(t[2]=w("div",{class:"item"},null,-1)),w("span",Me,k(e.$t("Waf.Overview.index_25")),1)])]),w("div",Pe,[$(a,{"max-height":520,bordered:!1,data:S(s).data,columns:S(n)},null,8,["data","columns"])])])])),_:1})}}}),[["__scopeId","data-v-1e7bcc80"]]);e("default",g({__name:"index",setup:e=>(l().getInfo(),(e,t)=>{const a=V,l=v;return x(),L("div",null,[$(l,{"x-gap":"16","y-gap":"16"},{default:h((()=>[$(a,{span:"6 992:24"},{default:h((()=>[$(de)])),_:1}),$(a,{span:"12 992:24"},{default:h((()=>[$(be)])),_:1}),$(a,{span:"6 992:24"},{default:h((()=>[$(we)])),_:1}),$(a,{span:"6 992:24"},{default:h((()=>[$(Se),$(De)])),_:1}),$(a,{span:"18 992:24"},{default:h((()=>[$(Fe)])),_:1})])),_:1})])})}))}}}));
