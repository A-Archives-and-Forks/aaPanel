import{_ as e}from"./index.vue_vue_type_script_setup_true_lang.js?v=1721298337096";import{_ as a}from"./index.vue_vue_type_script_setup_true_lang2.js?v=1721298337096";import{u as t,_ as i}from"./useTableData.js?v=1721298337096";import{u as s,L as o,h as l,dv as n,dw as p,dx as r,dy as m,j as d,k as u,m as c,t as f,B as g}from"./index.js?v=1721298337096";import{u as _}from"./useLoading.js?v=1721298337096";import{b as j}from"./useTableColumns.js?v=1721298337096";import{l as y,f as b,t as k,S as h,Z as w,P as v,V as x,q as C,W as D}from"./vue.js?v=1721298337096";import"./DataTable.js?v=1721298337096";import"./Checkbox.js?v=1721298337096";import"./Ellipsis.js?v=1721298337096";import"./Select.js?v=1721298337096";import"./Tag.js?v=1721298337096";import"./Empty.js?v=1721298337096";import"./omit.js?v=1721298337096";import"./Skeleton.js?v=1721298337096";import"./pinia.js?v=1721298337096";import"./Progress.js?v=1721298337096";const z={class:"p-20px"},R=y({__name:"index",props:{data:{}},setup(y){const R=y,{row:L}=R.data,S=s(),T=async()=>{await f(S.type,{id:L.id}),q(),S.setRefresh(!0)},B=b({p:1,limit:10,search:L.id}),{table:E,columns:F}=t([{key:"filename",title:"File name",ellipsis:{tooltip:{width:"trigger"}}},{key:"size",title:"File size",width:90,render:e=>o(e.size)},{key:"addtime",title:"Backup time",width:146},j({width:154,options:e=>[{label:"Repair",onClick:()=>{l({title:"Import Database",content:"Database will be overwritten, continue?",onConfirm:async({hide:a})=>{await n(S.type,{file:e.filename,name:L.name}),S.setRefresh(!0),a()}})}},{label:"Download",onClick:()=>{p(e.filename,e.name)}},{label:"Del",onClick:()=>{l({title:"Delete backup file",content:"Are you sure to delete backup file?",onConfirm:async({hide:a})=>{await r({id:e.id}),q(),S.setRefresh(!0),a()}})}}]})]),{loading:P,setLoading:U}=_(),q=async()=>{try{U(!0);const{message:e}=await m(k(B));d(e)?(E.data=u(e.data)?e.data:[],E.total=c(e.page)):(E.data=[],E.total=0),L.backup_count=E.total}finally{U(!1)}};return q(),(t,s)=>{const o=g,l=i,n=a,p=e;return h(),w("div",z,[v(p,null,{toolsLeft:x((()=>[v(o,{type:"primary",onClick:T},{default:x((()=>[C("Backup")])),_:1})])),table:x((()=>[v(l,{loading:D(P),"loading-num":6,data:D(E).data,columns:D(F)},null,8,["loading","data","columns"])])),pageRight:x((()=>[v(n,{page:D(B).p,"onUpdate:page":s[0]||(s[0]=e=>D(B).p=e),"page-size":D(B).limit,"onUpdate:pageSize":s[1]||(s[1]=e=>D(B).limit=e),"item-count":D(E).total,onRefresh:q},null,8,["page","page-size","item-count"])])),_:1})])}}});export{R as default};
