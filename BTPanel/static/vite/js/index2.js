import{_ as e}from"./index223.js?v=1741416570306";import{u as s,l as a,cu as t,cv as n,n as l,cw as o,k as i,cx as u,b as p,I as c}from"./page_layout.js?v=1741416570306";import{i as r,s as A,c as _}from"./public.js?v=1741416570306";import{ae as d,bO as g,T as m}from"./naive.js?v=1741416570306";import{d as x,M as f,N as y,F as v,i as C,r as k,w as b,o as j,aj as w,P as h,_ as B,$ as L,R as M,Q,L as R,S as I,a0 as D,c as E,k as z,ao as F,Y as N,j as O,x as S,ae as U}from"./vue.js?v=1741416570306";import{_ as H}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1741416570306";import{_ as P}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1741416570306";import{_ as $}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1741416570306";import{_ as T}from"./index103.js?v=1741416570306";import"./common.js?v=1741416570306";import"./__commonjsHelpers__.js?v=1741416570306";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1741416570306";const V=x({name:"EmptyBox",setup(e,{slots:t}){const n=s(),{t:l}=f(),o=()=>{r()};return()=>{var e;let s;return y(v,null,[0===n.taskCount?y(d,{class:"pt-80px",size:"huge",description:l("Layout.MessageBox.index_1")},null):y(v,null,[y(g,{class:"justify-between! flex-nowrap!"},{default:()=>{return[y("span",null,[l("Layout.MessageBox.index_2")]),y(m,{text:!0,type:"primary",onClick:o},(e=s=l("Public.Status.Restart"),"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!C(e)?s:{default:()=>[s]}))];var e}}),y(a,{class:"mt-12px! mb-16px!"},null),null==(e=t.default)?void 0:e.call(t)])])}}}),G={class:"h-460px overflow-auto"},J={class:"install"},K={key:0,class:"cmd"},Y=i(x({__name:"index",setup(e,{expose:a}){const i=s(),u=t(),p=n(),c=k(""),{send:r,close:_}=A("/sock_shell",{onMessage:(e,s)=>{const a=s.data;l(a)&&(c.value+=a)}}),d=()=>{if(p.taskList.length){const{type:e,status:s}=p.taskList[0];"execshell"===e&&("-1"===s?(c.value="",r("tail -n 100 -f /tmp/panelExec.log")):setTimeout((async()=>{await p.getList(),d()}),2e3))}};b((()=>i.taskCount),(e=>{e&&d(),u.getMessageCount()})),j((()=>{_()}));const x=async()=>{await p.getList(),0!==i.taskCount&&(d(),p.onRepetion())};return x(),a({init:x}),(e,s)=>{const a=m,t=g,n=w("scroll-bottom");return h(),B(I(V),null,{default:L((()=>[M("div",G,[(h(!0),Q(v,null,R(I(p).taskList,(l=>(h(),Q("div",{key:l.id},["execshell"===l.type?(h(),Q(v,{key:0},[y(t,{class:"justify-between! mb-8px"},{default:L((()=>[M("span",J,D(l.name),1),M("div",null,[E(D("0"===l.status?"waiting":e.$t("Soft.index_40"))+" ",1),s[0]||(s[0]=M("img",{src:"data:image/gif;base64,R0lGODlhDgACAIAAAHNzcwAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFDgABACwAAAAAAgACAAACAoRRACH5BAUOAAEALAQAAAACAAIAAAIChFEAIfkEBQ4AAQAsCAAAAAIAAgAAAgKEUQAh+QQJDgABACwAAAAADgACAAACBoyPBpu9BQA7"},null,-1)),s[1]||(s[1]=M("span",{class:"px-5px"},"|",-1)),y(a,{text:"",color:"#20a53a",onClick:e=>(async e=>{_(),await o({id:e}),await p.getList()})(l.id)},{default:L((()=>[E(D(e.$t("Public.Btn.Del")),1)])),_:2},1032,["onClick"])])])),_:2},1024),"-1"===l.status?z((h(),Q("pre",K,[E(D(I(c)),1)])),[[n]]):F("",!0)],64)):F("",!0)])))),128))])])),_:1})}}}),[["__scopeId","data-v-7b9da2ab"]]),q=x({__name:"index",setup(e,{expose:s}){const a=t(),{loading:n,table:l,columns:o,search:i}=N(a),u=()=>{a.getMessageCount()};return s({init:u}),(e,s)=>{const a=$,t=P,p=H;return h(),B(p,null,{table:L((()=>[y(a,{loading:I(n),data:I(l).data,columns:I(o)},null,8,["loading","data","columns"])])),pageRight:L((()=>[y(t,{page:I(i).p,"onUpdate:page":s[0]||(s[0]=e=>I(i).p=e),"page-size":I(i).limit,"onUpdate:pageSize":s[1]||(s[1]=e=>I(i).limit=e),"item-count":I(l).total,"page-slot":5,"show-size-picker":!1,onRefresh:u},null,8,["page","page-size","item-count"])])),_:1})}}}),W=i(x({__name:"index",setup(e,{expose:s}){const a=k("None"),{loading:t,setLoading:n}=_(),o=async()=>{try{n(!0);const{message:e}=await u();p(e)&&(a.value=l(e.result)?e.result:"None")}finally{n(!1)}};return o(),s({init:o}),(e,s)=>{const n=T,l=c;return h(),B(l,{class:"h-full",show:I(t)},{default:L((()=>[y(n,{log:I(a)},null,8,["log"])])),_:1},8,["show"])}}}),[["__scopeId","data-v-8405edde"]]),X={class:"h-550px"},Z=x({__name:"index",setup(a){const{t:n}=f(),l=s(),o=t(),i=k("task"),u=O([{key:"task",label:()=>y("span",null,[n("Layout.MessageBox.index_3"),E(" ("),l.taskCount,E(")")]),component:S(Y)},{key:"message",label:()=>y("span",null,[n("Layout.MessageBox.index_4"),E(" ("),o.listConut,E(")")]),component:S(q)},{key:"log",label:n("Layout.MessageBox.index_5"),component:S(W)}]);return o.getMessageCount(),(s,a)=>{const t=e;return h(),Q("div",X,[y(t,{value:I(i),"onUpdate:value":a[0]||(a[0]=e=>U(i)?i.value=e:null),ref:"tabsRef",data:I(u)},null,8,["value","data"])])}}});export{Z as default};
