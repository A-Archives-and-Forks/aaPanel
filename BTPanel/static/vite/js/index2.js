import{_ as e}from"./index226.js?v=1742891699271";import{u as s,l as a,de as t,df as n,n as l,dg as o,k as i,dh as u,b as p,K as r}from"./page_layout.js?v=1742891699271";import{i as c,s as A,c as d}from"./public.js?v=1742891699271";import{ae as _,bU as g,T as m}from"./naive.js?v=1742891699271";import{d as x,O as f,P as y,F as v,i as k,r as C,w as b,o as h,ak as j,R as w,a0 as B,a1 as L,U as M,S as Q,N as R,V as D,a2 as E,c as I,k as U,ap as z,_ as F,j as N,x as O,af as S}from"./vue.js?v=1742891699271";import{_ as H}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1742891699271";import{_ as P}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1742891699271";import{_ as V}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1742891699271";import{_ as K}from"./index103.js?v=1742891699271";import"./common.js?v=1742891699271";import"./__commonjsHelpers__.js?v=1742891699271";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1742891699271";const T=x({name:"EmptyBox",setup(e,{slots:t}){const n=s(),{t:l}=f(),o=()=>{c()};return()=>{var e;let s;return y(v,null,[0===n.taskCount?y(_,{class:"pt-80px",size:"huge",description:l("Layout.MessageBox.index_1")},null):y(v,null,[y(g,{class:"justify-between! flex-nowrap!"},{default:()=>{return[y("span",null,[l("Layout.MessageBox.index_2")]),y(m,{text:!0,type:"primary",onClick:o},(e=s=l("Public.Status.Restart"),"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!k(e)?s:{default:()=>[s]}))];var e}}),y(a,{class:"mt-12px! mb-16px!"},null),null==(e=t.default)?void 0:e.call(t)])])}}}),$={class:"h-460px overflow-auto"},G={class:"install"},J={key:0,class:"cmd"},q=i(x({__name:"index",setup(e,{expose:a}){const i=s(),u=t(),p=n(),r=C(""),{send:c,close:d}=A("/sock_shell",{onMessage:(e,s)=>{const a=s.data;l(a)&&(r.value+=a)}}),_=()=>{if(p.taskList.length){const{type:e,status:s}=p.taskList[0];"execshell"===e&&("-1"===s?(r.value="",c("tail -n 100 -f /tmp/panelExec.log")):setTimeout((async()=>{await p.getList(),_()}),2e3))}};b((()=>i.taskCount),(e=>{e&&_(),u.getMessageCount()})),h((()=>{d()}));const x=async()=>{await p.getList(),0!==i.taskCount&&(_(),p.onRepetion())};return x(),a({init:x}),(e,s)=>{const a=m,t=g,n=j("scroll-bottom");return w(),B(D(T),null,{default:L((()=>[M("div",$,[(w(!0),Q(v,null,R(D(p).taskList,(l=>(w(),Q("div",{key:l.id},["execshell"===l.type?(w(),Q(v,{key:0},[y(t,{class:"justify-between! mb-8px"},{default:L((()=>[M("span",G,E(l.name),1),M("div",null,[I(E("0"===l.status?"waiting":e.$t("Soft.index_40"))+" ",1),s[0]||(s[0]=M("img",{src:"data:image/gif;base64,R0lGODlhDgACAIAAAHNzcwAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFDgABACwAAAAAAgACAAACAoRRACH5BAUOAAEALAQAAAACAAIAAAIChFEAIfkEBQ4AAQAsCAAAAAIAAgAAAgKEUQAh+QQJDgABACwAAAAADgACAAACBoyPBpu9BQA7"},null,-1)),s[1]||(s[1]=M("span",{class:"px-5px"},"|",-1)),y(a,{text:"",color:"#20a53a",onClick:e=>(async e=>{d(),await o({id:e}),await p.getList()})(l.id)},{default:L((()=>[I(E(e.$t("Public.Btn.Del")),1)])),_:2},1032,["onClick"])])])),_:2},1024),"-1"===l.status?U((w(),Q("pre",J,[I(E(D(r)),1)])),[[n]]):z("",!0)],64)):z("",!0)])))),128))])])),_:1})}}}),[["__scopeId","data-v-7b9da2ab"]]),W=x({__name:"index",setup(e,{expose:s}){const a=t(),{loading:n,table:l,columns:o,search:i}=F(a),u=()=>{a.getMessageCount()};return s({init:u}),(e,s)=>{const a=V,t=P,p=H;return w(),B(p,null,{table:L((()=>[y(a,{loading:D(n),data:D(l).data,columns:D(o)},null,8,["loading","data","columns"])])),pageRight:L((()=>[y(t,{page:D(i).p,"onUpdate:page":s[0]||(s[0]=e=>D(i).p=e),"page-size":D(i).limit,"onUpdate:pageSize":s[1]||(s[1]=e=>D(i).limit=e),"item-count":D(l).total,"page-slot":5,"show-size-picker":!1,onRefresh:u},null,8,["page","page-size","item-count"])])),_:1})}}}),X=i(x({__name:"index",setup(e,{expose:s}){const a=C("None"),{loading:t,setLoading:n}=d(),o=async()=>{try{n(!0);const{message:e}=await u();p(e)&&(a.value=l(e.result)?e.result:"None")}finally{n(!1)}};return o(),s({init:o}),(e,s)=>{const n=K,l=r;return w(),B(l,{class:"h-full",show:D(t)},{default:L((()=>[y(n,{log:D(a)},null,8,["log"])])),_:1},8,["show"])}}}),[["__scopeId","data-v-8405edde"]]),Y={class:"h-550px"},Z=x({__name:"index",setup(a){const{t:n}=f(),l=s(),o=t(),i=C("task"),u=N([{key:"task",label:()=>y("span",null,[n("Layout.MessageBox.index_3"),I(" ("),l.taskCount,I(")")]),component:O(q)},{key:"message",label:()=>y("span",null,[n("Layout.MessageBox.index_4"),I(" ("),o.listConut,I(")")]),component:O(W)},{key:"log",label:n("Layout.MessageBox.index_5"),component:O(X)}]);return o.getMessageCount(),(s,a)=>{const t=e;return w(),Q("div",Y,[y(t,{value:D(i),"onUpdate:value":a[0]||(a[0]=e=>S(i)?i.value=e:null),ref:"tabsRef",data:D(u)},null,8,["value","data"])])}}});export{Z as default};
