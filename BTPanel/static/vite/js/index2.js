import{_ as e}from"./index226.js?v=1744703330658";import{u as s,l as a,de as t,df as n,n as l,dg as o,k as i,dh as u,d as p,K as r}from"./page_layout.js?v=1744703330658";import{i as c,s as A,c as d,R as _}from"./public.js?v=1744703330658";import{ae as g,bU as m,T as x}from"./naive.js?v=1744703330658";import{d as f,O as y,P as v,F as C,i as k,r as b,w as h,o as j,ak as w,R as B,$ as L,a0 as M,U as Q,S as R,N as D,V as E,a1 as I,c as U,k as z,ap as F,_ as N,j as O,x as S,af as H}from"./vue.js?v=1744703330658";import{_ as P}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1744703330658";import{_ as V}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1744703330658";import{_ as $}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1744703330658";import{_ as K}from"./index103.js?v=1744703330658";import"./common.js?v=1744703330658";import"./__commonjsHelpers__.js?v=1744703330658";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1744703330658";const T=f({name:"EmptyBox",setup(e,{slots:t}){const n=s(),{t:l}=y(),o=()=>{c()};return()=>{var e;let s;return v(C,null,[0===n.taskCount?v(g,{class:"pt-80px",size:"huge",description:l("Layout.MessageBox.index_1")},null):v(C,null,[v(m,{class:"justify-between! flex-nowrap!"},{default:()=>{return[v("span",null,[l("Layout.MessageBox.index_2")]),v(x,{text:!0,type:"primary",onClick:o},(e=s=l("Public.Status.Restart"),"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!k(e)?s:{default:()=>[s]}))];var e}}),v(a,{class:"mt-12px! mb-16px!"},null),null==(e=t.default)?void 0:e.call(t)])])}}}),G={class:"h-460px overflow-auto"},J={class:"install"},q={key:0,class:"cmd"},W=i(f({__name:"index",setup(e,{expose:a}){const i=s(),u=t(),p=n(),r=b(""),{send:c,close:d}=A("/sock_shell",{onMessage:(e,s)=>{const a=s.data;l(a)&&(r.value+=a)}}),_=()=>{if(p.taskList.length){const{type:e,status:s}=p.taskList[0];"execshell"===e&&("-1"===s?(r.value="",c("tail -n 100 -f /tmp/panelExec.log")):setTimeout((async()=>{await p.getList(),_()}),2e3))}};h((()=>i.taskCount),(e=>{e&&_(),u.getMessageCount()})),j((()=>{d()}));const g=async()=>{await p.getList(),0!==i.taskCount&&(_(),p.onRepetion())};return g(),a({init:g}),(e,s)=>{const a=x,t=m,n=w("scroll-bottom");return B(),L(E(T),null,{default:M((()=>[Q("div",G,[(B(!0),R(C,null,D(E(p).taskList,(l=>(B(),R("div",{key:l.id},["execshell"===l.type?(B(),R(C,{key:0},[v(t,{class:"justify-between! mb-8px"},{default:M((()=>[Q("span",J,I(l.name),1),Q("div",null,[U(I("0"===l.status?"waiting":e.$t("Soft.index_40"))+" ",1),s[0]||(s[0]=Q("img",{src:"data:image/gif;base64,R0lGODlhDgACAIAAAHNzcwAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFDgABACwAAAAAAgACAAACAoRRACH5BAUOAAEALAQAAAACAAIAAAIChFEAIfkEBQ4AAQAsCAAAAAIAAgAAAgKEUQAh+QQJDgABACwAAAAADgACAAACBoyPBpu9BQA7"},null,-1)),s[1]||(s[1]=Q("span",{class:"px-5px"},"|",-1)),v(a,{text:"",color:"#20a53a",onClick:e=>(async e=>{d(),await o({id:e}),await p.getList()})(l.id)},{default:M((()=>[U(I(e.$t("Public.Btn.Del")),1)])),_:2},1032,["onClick"])])])),_:2},1024),"-1"===l.status?z((B(),R("pre",q,[U(I(E(r)),1)])),[[n]]):F("",!0)],64)):F("",!0)])))),128))])])),_:1})}}}),[["__scopeId","data-v-7b9da2ab"]]),X=f({__name:"index",setup(e,{expose:s}){const a=t(),{loading:n,table:l,columns:o,search:i}=N(a),u=()=>{a.getMessageCount()};return s({init:u}),(e,s)=>{const a=$,t=V,p=P;return B(),L(p,null,{table:M((()=>[v(a,{loading:E(n),data:E(l).data,columns:E(o)},null,8,["loading","data","columns"])])),pageRight:M((()=>[v(t,{page:E(i).p,"onUpdate:page":s[0]||(s[0]=e=>E(i).p=e),"page-size":E(i).limit,"onUpdate:pageSize":s[1]||(s[1]=e=>E(i).limit=e),"item-count":E(l).total,"page-slot":5,"show-size-picker":!1,onRefresh:u},null,8,["page","page-size","item-count"])])),_:1})}}}),Y=i(f({__name:"index",setup(e,{expose:s}){const a=b("None"),{loading:t,setLoading:n}=d(),o=async()=>{try{n(!0);const{message:e}=await u();p(e)&&(a.value=l(e.result)?e.result:"None")}finally{n(!1)}};return o(),s({init:o}),(e,s)=>{const n=K,l=r;return B(),L(l,{class:"h-full",show:E(t)},{default:M((()=>[v(n,{log:E(a)},null,8,["log"])])),_:1},8,["show"])}}}),[["__scopeId","data-v-8405edde"]]),Z={class:"h-550px"},ee=f({__name:"index",setup(a,{expose:n}){const{t:l}=y(),o=s(),i=t(),u=b("task"),p=O([{key:"task",label:()=>v("span",null,[l("Layout.MessageBox.index_3"),U(" ("),o.taskCount,U(")")]),component:S(W)},{key:"message",label:()=>v("span",null,[l("Layout.MessageBox.index_4"),U(" ("),i.listConut,U(")")]),component:S(X)},{key:"log",label:l("Layout.MessageBox.index_5"),component:S(Y)}]);return i.getMessageCount(),n({onClose:()=>{_()}}),(s,a)=>{const t=e;return B(),R("div",Z,[v(t,{value:E(u),"onUpdate:value":a[0]||(a[0]=e=>H(u)?u.value=e:null),ref:"tabsRef",data:E(p)},null,8,["value","data"])])}}});export{ee as default};
