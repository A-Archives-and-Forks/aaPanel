import{_ as e}from"./index72.js?v=1721298337096";import{_ as a}from"./index136.js?v=1721298337096";import{_ as l,a as s}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1721298337096";import{l as o,ad as t,f as n,r as c,k as r,S as d,Z as m,P as u,V as i,_ as p,W as _,ap as g,q as v,a3 as x,b}from"./vue.js?v=1721298337096";import{K as f,z as k,n as D,V as y,k as I,ab as j,B as L,ed as h}from"./index.js?v=1721298337096";import{u as w}from"./useSocket.js?v=1721298337096";import{_ as S}from"./Select.js?v=1721298337096";import{_ as $}from"./InputGroup.js?v=1721298337096";import"./Tabs.js?v=1721298337096";import"./omit.js?v=1721298337096";import"./Spin.js?v=1721298337096";import"./pinia.js?v=1721298337096";import"./data.js?v=1721298337096";import"./Tag.js?v=1721298337096";import"./Empty.js?v=1721298337096";const C={class:"pt-4px"},W={class:"w-440px"},U={class:"w-440px"},E={class:"px-2px py-4px"},R={class:"h-420px"},K=o({__name:"index",setup(e){const{t:o}=t(),b=f(),h=n({name:null,image:""}),K={name:{trigger:"change",validator:()=>null!==h.name||new Error(o("Docker.LocalImage.pull.index_8"))},image:{trigger:["input","blur"],validator:()=>""!==h.image||new Error(o("Docker.LocalImage.pull.index_9"))}},M=c(null),T=c(o("Docker.LocalImage.pull.index_10")),V=c(!1),q=c([]),z=async()=>{var e;await(null==(e=M.value)?void 0:e.validate()),T.value="",B.value=!0,P(),F()},B=c(!1),G=r((()=>B.value)),{createWebSocket:P,sendSocket:Z,closeWebSocket:A}=w({url:"/ws_model",onMessage:(e,a)=>{const{data:l}=a;if(k(l)&&(T.value+=a.data,l.includes("bt_successful")||l.includes("bt_failed"))){B.value=!1;const e={status:l.includes("bt_successful"),msg:l.includes("bt_successful")?o("Docker.Container.create.command_7"):o("Docker.Container.create.command_6")};e.status?(D.success(e.msg),b.setRefresh(!0)):D.error(e.msg),A()}},onDisconnected:()=>{B.value=!1}}),F=()=>{Z({model_index:"btdocker",mod_name:"image",def_name:"pull_from_some_registry",ws_callback:111,name:h.name,image:h.image})};return(async()=>{try{V.value=!0;const{message:e}=await y();I(e)&&e.length>0&&(q.value=e.map((e=>({label:e.name,value:e.name}))),h.name=e[0].name)}finally{V.value=!1}})(),(e,o)=>{const t=S,n=l,c=j,r=L,b=$,f=s,k=a;return d(),m("div",C,[u(f,{ref_key:"formRef",ref:M,model:_(h),rules:K},{default:i((()=>[u(n,{label:e.$t("Docker.LocalImage.pull.index_3"),path:"name"},{default:i((()=>[p("div",W,[u(t,{value:_(h).name,"onUpdate:value":o[0]||(o[0]=e=>_(h).name=e),loading:_(V),disabled:_(G),options:_(q)},null,8,["value","loading","disabled","options"])])])),_:1},8,["label"]),u(n,{label:e.$t("Docker.LocalImage.pull.index_4"),path:"image"},{default:i((()=>[p("div",U,[u(b,null,{default:i((()=>[u(c,{value:_(h).image,"onUpdate:value":o[1]||(o[1]=e=>_(h).image=e),disabled:_(G),placeholder:e.$t("Docker.LocalImage.pull.index_5"),onKeyup:g(z,["enter"])},null,8,["value","disabled","placeholder"]),u(r,{type:"primary",disabled:_(G),onClick:z},{default:i((()=>[v(x(e.$t("Docker.LocalImage.pull.index_6")),1)])),_:1},8,["disabled"])])),_:1})])])),_:1},8,["label"])])),_:1},8,["model"]),p("div",E,x(e.$t("Docker.LocalImage.pull.index_7")),1),p("div",R,[u(k,{log:_(T)},null,8,["log"])])])}}}),M={class:"pt-4px"},T={class:"px-2px py-4px"},V={class:"h-456px"},q=o({__name:"index",setup(e){const{t:l}=t(),s=f(),o=n({cmd:""}),g=c(l("Docker.LocalImage.pull.index_10")),b=c(!1),y=r((()=>b.value)),I=async()=>{if(""!==o.cmd.trim())try{b.value=!0,g.value=l("Docker.Container.create.command_8"),await h({cmd:o.cmd}),S(),U()}catch(e){b.value=!1}else D.error(l("Docker.LocalImage.pull.index_13"))},{createWebSocket:S,sendSocket:C,closeWebSocket:W}=w({url:"/ws_model",onMessage:(e,a)=>{const{data:o}=a;if(k(o)&&(g.value+=a.data,o.includes("bt_successful")||o.includes("bt_failed"))){b.value=!1;const e={status:o.includes("bt_successful"),msg:o.includes("bt_successful")?l("Docker.Container.create.command_7"):l("Docker.Container.create.command_6")};e.status?(D.success(e.msg),s.setRefresh(!0)):D.error(e.msg),W()}}}),U=()=>{C({model_index:"btdocker",mod_name:"image",def_name:"get_cmd_log",ws_callback:111,name:"",image:""})};return(e,l)=>{const s=j,t=L,n=$,c=a;return d(),m("div",M,[u(n,{class:"mb-16px"},{default:i((()=>[u(s,{value:_(o).cmd,"onUpdate:value":l[0]||(l[0]=e=>_(o).cmd=e),disabled:_(y),placeholder:e.$t("Docker.LocalImage.pull.index_11")},null,8,["value","disabled","placeholder"]),u(t,{type:"primary",disabled:_(y),onClick:I},{default:i((()=>[v(x(e.$t("Docker.LocalImage.pull.index_12")),1)])),_:1},8,["disabled"])])),_:1}),p("div",T,x(e.$t("Docker.LocalImage.pull.index_7")),1),p("div",V,[u(c,{log:_(g)},null,8,["log"])])])}}}),z={class:"p-16px"},B=o({__name:"index",setup(a){const{t:l}=t(),s=c("normal"),o=[{key:"normal",label:l("Docker.LocalImage.pull.index_1"),component:K},{key:"command",label:l("Docker.LocalImage.pull.index_2"),component:q}];return(a,l)=>{const t=e;return d(),m("div",z,[u(t,{value:_(s),"onUpdate:value":l[0]||(l[0]=e=>b(s)?s.value=e:null),options:o},null,8,["value"])])}}});export{B as default};
