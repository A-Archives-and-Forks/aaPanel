import{c as e,f as t,d as a,e as s,h as n,_ as l,K as i,b as o,F as u}from"./public.js?v=1747989938512";import{_ as d}from"./index103.js?v=1747989938512";import{_ as c}from"./index.js?v=1747989938512";import{_ as r}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1747989938512";import{i as p,t as _,c as y,q as m,p as g,N as x,cC as h,m as f,b3 as v,_ as w,u as k}from"./page_layout.js?v=1747989938512";import{_ as S}from"./index.vue_vue_type_script_setup_true_lang.js?v=1747989938512";import{_ as b}from"./index.vue_vue_type_script_setup_true_lang11.js?v=1747989938512";import{d as I,O as A,r as $,j as C,R as U,S as H,P as j,a1 as R,V as q,c as L,a2 as O,aj as T,U as P,M,_ as z,w as K,F as D,a0 as B,N as F,ak as N,k as V,v as W,e as Y}from"./vue.js?v=1747989938512";import{cj as E,cp as G,_ as J,T as Q,bY as X,bU as Z,bA as ee,cm as te,c0 as ae}from"./naive.js?v=1747989938512";import{_ as se}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1747989938512";import"./common.js?v=1747989938512";import"./__commonjsHelpers__.js?v=1747989938512";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1747989938512";import"./index96.js?v=1747989938512";const{t:ne}=p.global,le={class:"p-20px"},ie=I({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=A(),s=[{label:a("Security.Anti.Index_28"),value:"i"},{label:a("Security.Anti.Index_29"),value:"a"}],n=e,{getList:l}=n.data,{row:i}=n.data,o=$(null),u=C({path:"",chattr:"i",d_mode:""}),d={path:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]},d_mode:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{var t,a;await(null==(t=o.value)?void 0:t.validate()),await(a={...u,s_key:i.key},_.post("/plugin?name=syssafe&action=a&s=add_safe_path",a,{requestOptions:{loading:ne("Security.Api.Index_4"),successMessage:!0}})),null==l||l(),e()}}),(e,t)=>{const a=b,n=E,l=G,i=J,c=S;return U(),H("div",le,[j(c,{ref_key:"formRef",ref:o,model:q(u),rules:d},{default:R((()=>[j(n,{label:e.$t("Site.DelSite.index_2"),path:"path"},{default:R((()=>[j(a,{class:"w-280px",value:q(u).path,"onUpdate:value":t[0]||(t[0]=e=>q(u).path=e),placeholder:e.$t("Security.Anti.Index_26")},null,8,["value","placeholder"])])),_:1},8,["label"]),j(n,{label:e.$t("Security.Hardening.Index_8")},{default:R((()=>[j(l,{class:"w-280px",value:q(u).chattr,"onUpdate:value":t[1]||(t[1]=e=>q(u).chattr=e),options:s},null,8,["value"])])),_:1},8,["label"]),j(n,{label:e.$t("Security.Hardening.Index_9"),path:"d_mode"},{default:R((()=>[j(i,{class:"w-280px!",value:q(u).d_mode,"onUpdate:value":t[2]||(t[2]=e=>q(u).d_mode=e),type:"text",placeholder:e.$t("Security.Anti.Index_27")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),oe={class:"p-20px"},ue=I({__name:"index",props:{data:{}},setup(i){const{t:o}=A(),u=i,{data:d}=u,{keys:p,table:m,columns:g}=e([{key:"path",title:o("Site.DelSite.index_2")},{key:"chattr",title:o("Security.Hardening.Index_8"),render:e=>"i"==e.chattr?o("Security.Anti.Index_28"):o("Security.Anti.Index_29")},{key:"s_mode",title:o("Security.Hardening.Index_9"),render:e=>e.s_mode!==e.d_mode?"".concat(e.s_mode," >> ").concat(e.d_mode):e.d_mode},{key:"state",title:o("Config.Safe.index_156"),render:e=>j("span",{style:{color:e.state?"#20a53a":"#ff0029"}},[e.state?o("Security.Anti.Index_35"):o("Security.Anti.Index_36")])},t({width:130,title:o("Public.Table.Operation"),options:e=>[{label:o("Public.Btn.Del"),onClick:async()=>{await(e=>_.post("/plugin?name=syssafe&action=a&s=remove_safe_path",e,{requestOptions:{loading:ne("Security.Api.Index_3"),successMessage:!0}}))({s_key:d.key,path:e.path}),await v()}}]})]),x=async()=>{w.data.row=d,w.show=!0},{loading:h,setLoading:f}=a(),v=async()=>{try{f(!0);const{message:e}=await(e=>_.post("/plugin?name=syssafe&action=a&s=get_safe_config",e))({s_key:d.key});y(e)&&(m.data=e.paths)}finally{p.value=[],f(!1)}};v();const w=s(o("Security.Anti.Index_30"),{getList:v});return(e,t)=>{const a=Q,s=n,i=l,o=r,u=c;return U(),H("div",oe,[j(o,null,{toolsLeft:R((()=>[j(a,{type:"primary",onClick:x},{default:R((()=>[L(O(e.$t("Security.Anti.Index_30")),1)])),_:1})])),table:R((()=>[j(s,{"checked-row-keys":q(p),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>T(p)?p.value=e:null),loading:q(h),"loading-num":3,"max-height":340,data:q(m).data,columns:q(g)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:R((()=>[j(i,null,{default:R((()=>[P("li",null,O(e.$t("Security.Anti.Index_31")),1),P("li",null,O(e.$t("Security.Anti.Index_32")),1),P("li",null,O(e.$t("Security.Anti.Index_33")),1),P("li",null,O(e.$t("Security.Anti.Index_34")),1)])),_:1})])),_:1}),j(u,{show:q(w).show,"onUpdate:show":t[1]||(t[1]=e=>q(w).show=e),title:q(w).title,data:q(w).data,width:500,footer:!0,component:ie},null,8,["show","title","data"])])}}}),de={class:"p-20px"},ce={class:"leading-32px"},re=g(I({__name:"index",setup(e){const{t:t}=A(),a=$(null),s=C({cycle:120,limit_count:3,limit:3600}),n={cycle:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]},limit_count:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]},limit:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]}},i=async()=>{var e,t;await(null==(e=a.value)?void 0:e.validate()),await(t=M(s),_.post("/plugin?name=syssafe&action=a&s=save_ssh_config",t,{requestOptions:{loading:ne("Security.Api.Index_6"),successMessage:!0}}))};return(async()=>{const{message:e}=await _.post("/plugin?name=syssafe&action=a&s=get_ssh_config");y(e)&&(s.cycle=e.cycle,s.limit=e.limit,s.limit_count=e.limit_count)})(),(e,t)=>{const o=X,u=E,d=Q,c=S,r=m,p=l;return U(),H("div",de,[j(c,{ref_key:"formRef",ref:a,model:q(s),rules:n,inline:"","label-width":"auto",class:"form"},{default:R((()=>[j(u,{label:e.$t("Security.Anti.Index_37"),path:"cycle"},{default:R((()=>[j(o,{"show-button":!1,value:q(s).cycle,"onUpdate:value":t[0]||(t[0]=e=>q(s).cycle=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),j(u,{label:e.$t("Security.Anti.Index_38"),path:"limit_count"},{default:R((()=>[j(o,{"show-button":!1,value:q(s).limit_count,"onUpdate:value":t[1]||(t[1]=e=>q(s).limit_count=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),j(u,{label:e.$t("Security.Anti.Index_39"),path:"limit"},{default:R((()=>[j(o,{"show-button":!1,value:q(s).limit,"onUpdate:value":t[2]||(t[2]=e=>q(s).limit=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),P("span",ce,O(e.$t("Security.Anti.Index_40")),1),j(d,{type:"primary",class:"ml-auto",onClick:i},{default:R((()=>[L(O(e.$t("Site.Cert.index_60")),1)])),_:1})])),_:1},8,["model"]),j(r,{class:"mb-15px!"}),j(p,null,{default:R((()=>[P("li",null,O(e.$t("Security.Anti.Index_41")),1),P("li",null,O(e.$t("Security.Anti.Index_42")),1),P("li",null,O(e.$t("Security.Anti.Index_43")),1)])),_:1})])}}}),[["__scopeId","data-v-201446e2"]]),pe={class:"p-20px"},_e=I({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=A(),s=e,{getList:n}=s.data,l=$(null),i=C({process_name:""}),o={process_name:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{var t,a;await(null==(t=l.value)?void 0:t.validate()),await(a=M(i),_.post("/plugin?name=syssafe&action=a&s=add_process_white",a,{requestOptions:{loading:ne("Security.Api.Index_4"),successMessage:!0}})),null==n||n(),e()}}),(e,t)=>{const a=J,s=E,n=S;return U(),H("div",pe,[j(n,{ref_key:"formRef",ref:l,model:q(i),rules:o},{default:R((()=>[j(s,{label:e.$t("Home.index_24"),path:"process_name"},{default:R((()=>[j(a,{class:"w-280px!",value:q(i).process_name,"onUpdate:value":t[0]||(t[0]=e=>q(i).process_name=e),type:"text",placeholder:e.$t("Security.Anti.Index_22")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),ye={class:"p-20px"},me=I({__name:"index",setup(i){const{t:o}=A(),{keys:u,table:d,columns:p}=e([{key:"name",title:o("Home.index_24")},t({width:130,title:o("Public.Table.Operation"),options:e=>[{label:o("Public.Btn.Del"),onClick:async()=>{var t;await(t={process_name:e.name},_.post("/plugin?name=syssafe&action=a&s=remove_process_white",t,{requestOptions:{loading:ne("Security.Api.Index_3"),successMessage:!0}})),await h()}}]})]),y=async()=>{f.show=!0},{loading:m,setLoading:g}=a(),h=async()=>{try{g(!0);const{message:e}=await _.post("/plugin?name=syssafe&action=a&s=get_process_white");x(e)&&(d.data=e.map((e=>({name:e}))))}finally{u.value=[],g(!1)}};h();const f=s(o("Security.Anti.Index_23"),{getList:h});return(e,t)=>{const a=Q,s=n,i=l,o=r,_=c;return U(),H("div",ye,[j(o,null,{toolsLeft:R((()=>[j(a,{type:"primary",onClick:y},{default:R((()=>[L(O(e.$t("Security.Anti.Index_23")),1)])),_:1})])),table:R((()=>[j(s,{"checked-row-keys":q(u),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>T(u)?u.value=e:null),loading:q(m),"loading-num":3,"max-height":340,data:q(d).data,columns:q(p)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:R((()=>[j(i,null,{default:R((()=>[P("li",null,O(e.$t("Security.Anti.Index_24")),1),P("li",null,O(e.$t("Security.Anti.Index_25")),1)])),_:1})])),_:1}),j(_,{show:q(f).show,"onUpdate:show":t[1]||(t[1]=e=>q(f).show=e),title:q(f).title,data:q(f).data,width:500,footer:!0,component:_e},null,8,["show","title","data"])])}}}),ge={class:"color-#ff3333"},xe=I({__name:"index",setup(o,{expose:u}){const{t:d}=A(),p=h(),{systemHardening:m}=z(p),g=s(),x=s(),v=s(),{keys:w,table:k,columns:S}=e([{key:"name",width:"10%",title:d("Site.TableRow.index_2")},{key:"ps",title:d("Security.Hardening.Index_5"),ellipsis:{tooltip:{width:"trigger"}}},i({key:"open",title:d("Site.TableRow.index_14"),onClick:async(e,t)=>{if(!m.value)return f.error(d("Security.Hardening.Index_6")),void $();var a;await(a={s_key:t.key},_.post("/plugin?name=syssafe&action=a&s=set_safe_status",a,{requestOptions:{loading:ne("Security.Api.Index_5"),successMessage:!0}}))}}),t({width:130,title:d("Site.TableRow.index_30"),options:e=>[{label:d("Site.TableOP.index_3"),onClick:()=>"ssh"===e.key?(x.title="".concat(d("Security.Hardening.Index_7")," [").concat(e.name,"]"),void(x.show=!0)):"process"===e.key?(v.title="".concat(d("Security.Hardening.Index_7")," [").concat(e.name,"]"),void(v.show=!0)):(g.title="".concat(d("Security.Hardening.Index_7")," [").concat(e.name,"]"),g.data=e,void(g.show=!0))}]})]);K((()=>p.isRefresh),(e=>{e&&(p.setRefresh(!1),$())}));const{loading:b,setLoading:I}=a(),$=async()=>{try{I(!0);const{message:e}=await _.post("/plugin?name=syssafe&action=a&s=get_safe_status");y(e)&&(m.value=e.open,k.data=e.list)}finally{w.value=[],I(!1)}};return $(),u({init:$}),(e,t)=>{const a=n,s=r,i=l,o=c;return U(),H(D,null,[j(s,{feedback:!0},{table:R((()=>[j(a,{"checked-row-keys":q(w),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>T(w)?w.value=e:null),"row-key":"title",loading:q(b),data:q(k).data,columns:q(S)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),j(i,{class:"mt-16px"},{default:R((()=>[P("li",null,O(e.$t("Security.Hardening.Index_1")),1),P("li",null,O(e.$t("Security.Hardening.Index_2")),1),P("li",null,O(e.$t("Security.Hardening.Index_3")),1),P("li",ge,O(e.$t("Security.Hardening.Index_4")),1)])),_:1}),j(o,{show:q(g).show,"onUpdate:show":t[1]||(t[1]=e=>q(g).show=e),title:q(g).title,data:q(g).data,width:700,"min-height":500,footer:!1,component:ue},null,8,["show","title","data"]),j(o,{show:q(x).show,"onUpdate:show":t[2]||(t[2]=e=>q(x).show=e),title:q(x).title,data:q(x).data,width:800,footer:!1,component:re},null,8,["show","title","data"]),j(o,{show:q(v).show,"onUpdate:show":t[3]||(t[3]=e=>q(v).show=e),title:q(v).title,data:q(v).data,width:700,"min-height":580,footer:!1,component:me},null,8,["show","title","data"])],64)}}}),he=I({__name:"index",setup(s,{expose:i}){const{t:o}=A(),{loading:u,setLoading:d}=a(),c=$(""),p=/^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$/,{keys:y,table:m,columns:g}=e([{key:"address",title:o("Security.Anti.Index_15"),width:"70%"},{key:"end",title:o("Security.History.Index_12"),render:e=>0==e.end?o("Security.Anti.Index_18"):e.end},t({width:130,title:o("Site.TableRow.index_30"),options:e=>[{label:o("Security.Anti.Index_19"),onClick:async()=>{var t;await(t={ip:e.address},_.post("/plugin?name=syssafe&action=a&s=remove_ssh_limit",t,{requestOptions:{loading:ne("Security.Api.Index_3"),successMessage:!0}})),v()}}]})]),h=async()=>{var e;p.test(c.value)?(await(e={ip:c.value},_.post("/plugin?name=syssafe&action=a&s=add_ssh_limit",e,{requestOptions:{loading:ne("Security.Api.Index_4"),successMessage:!0}})),v(),c.value=""):f.error(o("Security.Anti.Index_20"))},v=async()=>{try{d(!0);const{message:e}=await _.post("/plugin?name=syssafe&action=a&s=get_ssh_limit_info");x(e)&&(m.data=e)}finally{y.value=[],d(!1)}};return v(),i({init:v}),(e,t)=>{const a=J,s=Q,i=Z,o=n,d=r,p=l;return U(),H("div",null,[j(d,null,{toolsLeft:R((()=>[j(i,{class:"flex-nowrap!"},{default:R((()=>[j(a,{value:q(c),"onUpdate:value":t[0]||(t[0]=e=>T(c)?c.value=e:null),type:"text",placeholder:e.$t("Security.Anti.Index_15"),class:"w-280px!"},null,8,["value","placeholder"]),j(s,{type:"primary",onClick:h},{default:R((()=>[L(O(e.$t("Public.Btn.Add")),1)])),_:1})])),_:1})])),table:R((()=>[j(o,{"checked-row-keys":q(y),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>T(y)?y.value=e:null),"row-key":"address",loading:q(u),"max-height":440,data:q(m).data,columns:q(g)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),j(p,{class:"mt-16px"},{default:R((()=>[P("li",null,O(e.$t("Security.Anti.Index_16")),1),P("li",null,O(e.$t("Security.Anti.Index_17")),1)])),_:1})])}}}),fe=I({__name:"index",setup(t,{expose:s}){const{t:l}=A(),{keys:i,table:o,columns:u}=e([{key:"addtime",title:l("Site.Cert.index_68"),width:"20%"},{key:"log",title:l("Security.Anti.Index_21")}]),d=C({p:1,limit:10,search:"System hardening"}),{loading:c,setLoading:p}=a(),m=async()=>{try{p(!0);const{message:t}=await(e=M(d),_.post("/data?action=getData",{...e,table:"logs",order:"id desc"}));y(t)&&(o.data=t.data,o.total=v(t.page))}finally{i.value=[],p(!1)}var e};return m(),s({init:m}),(e,t)=>{const a=n,s=se,l=r;return U(),B(l,{feedback:!0},{table:R((()=>[j(a,{"checked-row-keys":q(i),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>T(i)?i.value=e:null),"row-key":"addtime",loading:q(c),data:q(o).data,columns:q(u)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:R((()=>[j(s,{page:q(d).p,"onUpdate:page":t[1]||(t[1]=e=>q(d).p=e),"page-size":q(d).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>q(d).limit=e),"item-count":q(o).total,"store-key":"security-log",onRefresh:m},null,8,["page","page-size","item-count"])])),_:1})}}}),ve=I({__name:"index",setup(e){const{t:t}=A(),a=$("protection"),s=[{key:"protection",label:t("Security.Tabs.Index_8"),component:xe},{key:"block",label:t("Security.Tabs.Index_9"),component:he},{key:"operation",label:t("Security.Tabs.Index_10"),component:fe}];return(e,t)=>{const n=d;return U(),B(n,{value:q(a),"onUpdate:value":t[0]||(t[0]=e=>T(a)?a.value=e:null),options:s},null,8,["value"])}}}),we={class:"pt-40px pb-40px"},ke={class:"mb-16px"},Se={class:"ul-style"},be={class:"text-center my-24px"},Ie={class:"flex justify-center"},Ae={class:"item"},$e=["onClick"],Ce=g(I({__name:"conversion",setup(e){const t=$(0),a=["Protection","Block IP","Operation logs"],s=()=>{o({source:102})};return(e,n)=>{const l=w,i=Q,o=ee,u=te;return U(),B(u,null,{default:R((()=>[P("div",we,[n[2]||(n[2]=P("div",{class:"mb-24px text-center text-22px font-bold"}," System Hardening prevention features ",-1)),P("div",ke,[P("ul",Se,[P("li",null,[j(l,{name:"security-system",size:"18"}),n[0]||(n[0]=P("span",{class:"ml-8px"},"Prevents the system from being implanted with a Trojan",-1))]),P("li",null,[j(l,{name:"security-surety",size:"30"}),n[1]||(n[1]=P("span",null,"Harden the system security configuration",-1))])])]),P("div",be,[j(i,{type:"primary",class:"h-36px text-14px",onClick:s},{default:R((()=>[L(O(e.$t("WP.Transition.index_7")),1)])),_:1})]),P("div",Ie,[P("div",Ae,[P("ul",null,[(U(),H(D,null,F(a,((e,a)=>P("li",{class:N({active:q(t)==a}),key:a,onClick:e=>t.value=a},O(e),11,$e))),64))])]),V(j(o,{width:"100%",src:q("/static/vite/images/protection.png")},null,8,["src"]),[[W,0==q(t)]]),V(j(o,{width:"100%",src:q("/static/vite/images/block.png")},null,8,["src"]),[[W,1==q(t)]]),V(j(o,{width:"100%",src:q("/static/vite/images/log.png")},null,8,["src"]),[[W,2==q(t)]])])])])),_:1})}}}),[["__scopeId","data-v-f55518e2"]]),Ue={key:0},He=I({__name:"index",setup(e){const t=k(),{isPro:a}=z(t),s=h(),{systemHardening:n}=z(s),l=$(n.value),i=Y((()=>n.value));K(i,(e=>{l.value=e}));const o=async()=>{await _.post("/plugin?name=syssafe&action=a&s=set_open",{},{requestOptions:{loading:ne("Security.Api.Index_5"),successMessage:!0}}),await s.setRefresh(!0)};return(async()=>{a.value&&await u("syssafe")})(),(e,t)=>{const s=ae,n=Z,i=te;return q(a)?(U(),H("div",Ue,[j(i,{class:"my-15px"},{default:R((()=>[j(n,{class:"p-15px items-center"},{default:R((()=>[P("span",null,O(e.$t("Security.Anti.Index_14")),1),j(s,{value:q(l),"onUpdate:value":[t[0]||(t[0]=e=>T(l)?l.value=e:null),o],"rubber-band":!1,size:"small"},null,8,["value"])])),_:1})])),_:1}),j(i,{class:"p-15px"},{default:R((()=>[j(ve)])),_:1})])):(U(),B(Ce,{key:1}))}}});export{He as default};
