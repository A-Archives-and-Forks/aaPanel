System.register(["./index-legacy68.js?v=1721298337096","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1721298337096","./useTableData-legacy.js?v=1721298337096","./index-legacy.js?v=1721298337096","./file-legacy2.js?v=1721298337096","./useLoading-legacy.js?v=1721298337096","./useTableColumns-legacy.js?v=1721298337096","./file-legacy.js?v=1721298337096","./vue-legacy.js?v=1721298337096","./Skeleton-legacy.js?v=1721298337096","./DataTable-legacy.js?v=1721298337096","./Checkbox-legacy.js?v=1721298337096","./Ellipsis-legacy.js?v=1721298337096","./Select-legacy.js?v=1721298337096","./Tag-legacy.js?v=1721298337096","./Empty-legacy.js?v=1721298337096","./omit-legacy.js?v=1721298337096","./pinia-legacy.js?v=1721298337096","./Progress-legacy.js?v=1721298337096"],(function(e,t){"use strict";var l,a,i,s,n,o,c,r,u,g,d,p,y,m,f,h,j,b,w,z,_,k,v,x,S,q;return{setters:[e=>{l=e._},e=>{a=e._},e=>{i=e.u,s=e._},e=>{n=e.u,o=e.M,c=e.L,r=e.h,u=e.dv,g=e.j,d=e.k,p=e.cj,y=e.B},e=>{m=e.d,f=e.a},e=>{h=e.u},e=>{j=e.b},e=>{b=e.o},e=>{w=e.l,z=e.S,_=e.Z,k=e.P,v=e.V,x=e.q,S=e.W,q=e._},null,null,null,null,null,null,null,null,null,null],execute:function(){const t={class:"p-20px"},C=q("li",null,"Only support sql, zip, (tar.gz|gz|tgz)",-1),D=q("li",null," Structure of zip, tar.gz archive: test.sql must be contained in test.zip or test.tar.gz ",-1),E=q("li",null," If the file is oversized, you can also upload database archives to /www/backup/database with SFTP tools ",-1);e("default",w({__name:"index",props:{data:{}},setup(e){const w=e,{row:q}=w.data,L=n(),T=()=>{if(!L.backupPath)throw new Error("No backup directory");return L.backupPath+"/database"},F=()=>{const e=T(),t="pgsql"==L.type?".sql":".sql,.gz,.tar.gz,.zip";b(e,t,(()=>{$()}))},{table:I,columns:P}=i([{key:"filename",title:"File name",ellipsis:{tooltip:{width:"trigger"}}},{key:"addtime",title:"Modification time",width:150,render:e=>o(e.etime)},{key:"size",title:"Size",width:100,render:e=>c(e.size)},j({width:100,options:e=>[{label:"Import",onClick:()=>{r({title:"Import Database",content:"Database will be overwritten, continue?",onConfirm:async({hide:t})=>{await(async e=>{await u(L.type,{file:T()+"/"+e.filename,name:q.name})})(e),t()}})}},{label:"Del",onClick:()=>{r({title:`Delete file [${e.filename}]`,content:`Are you sure to put this file [${e.filename}] to recycle bin?`,onConfirm:async({hide:t})=>{await(async e=>{await m({path:T()+"/"+e.filename}),$(),L.setRefresh(!0)})(e),t()}})}}]})]),{loading:M,setLoading:R}=h(),$=async()=>{try{R(!0);const{message:e}=await f({p:1,reverse:"True",sort:"mtime",tojs:"GetFiles",showRow:100,path:T()});I.data=[],g(e)&&d(e.FILES)&&e.FILES.forEach((e=>{if(!e)return;const t=e.split(";"),l=(e=>{const t=e.split(".");return t[t.length-1]})(t[0]);"sql"!=l&&"zip"!=l&&"gz"!=l&&"tgz"!=l||I.data.push({filename:t[0],size:p(t[1]),etime:p(t[2])})}))}finally{R(!1)}};return $(),(e,i)=>{const n=y,o=s,c=a,r=l;return z(),_("div",t,[k(c,null,{toolsLeft:v((()=>[k(n,{onClick:F},{default:v((()=>[x("Upload from local")])),_:1})])),table:v((()=>[k(o,{"max-height":348,loading:S(M),data:S(I).data,columns:S(P)},null,8,["loading","data","columns"])])),_:1}),k(r,{class:"mt-16px"},{default:v((()=>[C,D,E])),_:1})])}}}))}}}));
