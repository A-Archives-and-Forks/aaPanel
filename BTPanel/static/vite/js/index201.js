import{_ as e}from"./index95.js?v=1744703330658";import{_ as a}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1744703330658";import{i as t,d as i,n,bP as s}from"./page_layout.js?v=1744703330658";import{b as l,w as o,a as g,f as p}from"./public.js?v=1744703330658";import{b as f,h as c}from"./site3.js?v=1744703330658";import{d as r,e as _,f as m,g as b,h as u,i as d,j as y,k as S,c as W,l as x,b as v,a as h}from"./useModal2.js?v=1744703330658";import{d as k,t as j,O as N,r as C,P as w,ab as P,F as R,R as U,S as $,U as M,a1 as T,V,a0 as z}from"./vue.js?v=1744703330658";import{b$ as B}from"./naive.js?v=1744703330658";import"./common.js?v=1744703330658";import"./__commonjsHelpers__.js?v=1744703330658";const F=[{name:t.global.t("Waf.Setting.config_1"),type:"cc",ps:t.global.t("Waf.Setting.config_2")},{name:t.global.t("Waf.Setting.config_3"),type:"cc_tolerate",ps:t.global.t("Waf.Setting.config_4")},{name:t.global.t("Waf.Setting.config_5"),type:"xss_injection",ps:t.global.t("Waf.Setting.config_6")},{name:t.global.t("Waf.Setting.config_7"),type:"post",ps:t.global.t("Waf.Setting.config_8")},{name:t.global.t("Waf.Setting.config_9"),type:"rce_injection",ps:t.global.t("Waf.Setting.config_10")},{name:t.global.t("Waf.Setting.config_11"),type:"file_upload",ps:t.global.t("Waf.Setting.config_12"),status:"",open:""},{name:t.global.t("Waf.Setting.config_13"),type:"get",ps:t.global.t("Waf.Setting.config_14")},{name:t.global.t("Waf.Setting.config_15"),type:"user-agent",ps:t.global.t("Waf.Setting.config_16")},{name:t.global.t("Waf.Setting.config_17"),type:"cookie",ps:t.global.t("Waf.Setting.config_207")},{name:t.global.t("Waf.Setting.config_18"),type:"scan",ps:t.global.t("Waf.Setting.config_208")},{name:t.global.t("Waf.Setting.config_19"),type:"spider_status",ps:t.global.t("Waf.Setting.config_20")},{name:t.global.t("Waf.Setting.config_21"),type:"cdn",ps:t.global.t("Waf.Setting.config_22")},{name:t.global.t("Waf.Setting.config_23"),type:"cdn_baidu",ps:t.global.t("Waf.Setting.config_24")},{name:t.global.t("Waf.Setting.config_25"),type:"disable_php_path",ps:t.global.t("Waf.Setting.config_26")},{name:t.global.t("Waf.Setting.config_27"),type:"disable_path",ps:t.global.t("Waf.Setting.config_28")},{name:t.global.t("Waf.Setting.config_29"),type:"disable_ext",ps:t.global.t("Waf.Setting.config_30")},{name:t.global.t("Waf.Setting.config_31"),type:"disable_upload_ext",ps:t.global.t("Waf.Setting.config_32")},{name:t.global.t("Waf.Setting.config_33"),type:"url_tell",ps:t.global.t("Waf.Setting.config_34")},{name:t.global.t("Waf.Setting.config_35"),type:"url_rule",ps:t.global.t("Waf.Setting.config_36")}],H=new Map([["xss_injection","args"],["get","url"],["user-agent","user_agent"],["cookie","cookie"]]),L={class:"p-20px"},O={class:"flex mb-16px"},q={class:"mr-10px text-16px"},A=k({__name:"index",props:{siteName:{default:""}},emits:["refresh"],setup(t,{emit:k}){const A=k,D=j(t,"siteName"),{t:E}=N(),G=C(!1),I=C(null),{table:J,columns:K,setLoading:Q}=l([{key:"name",title:E("Waf.Site.Config.index_3"),width:130},{key:"ps",title:E("Waf.Site.Config.index_4"),render:e=>{const{data:a,ps:t}=e;return"cc"===e.type&&i(a)?w(P,{tag:"div",keypath:"Waf.Site.Config.index_8",scope:"global"},{index_1:()=>w("span",{class:"text-error"},[a.cycle]),index_2:()=>w("span",{class:"text-error"},[a.limit]),index_3:()=>w("span",{class:"text-error"},[a.endtime])}):t}},{key:"open",title:E("Waf.Site.Config.index_5"),width:60,render:e=>n(e.open)?"--":w(B,{size:"small",value:e.open,onUpdateValue:a=>{"spider_status"!==e.type||a?"readonly"===e.type&&a?g({title:E("Public.Confirm.Title"),content:E("Waf.Site.Config.index_6"),onConfirm:async()=>{await X(e.type)}}):X(e.type):o({title:E("Public.Confirm.Title"),content:()=>w(R,null,[w("div",{class:"mb-4px text-#111 text-14px font-bold"},[E("Waf.Site.Config.index_9")]),w("div",{class:"text-error text-12px"},[E("Waf.Site.Config.index_10")])]),onConfirm:async()=>{await X(e.type)}})}},null)},p({width:60,options:e=>[{label:"get"===e.type||"post"===e.type||"user-agent"===e.type?E("Waf.Site.Config.index_7"):E("Public.Btn.Set"),show:!("cdn_baidu"==e.type||"file_upload"==e.type||"rce_injection"==e.type||"readonly"==e.type),onClick:()=>{if(I.value)switch(e.type){case"cc":h({siteName:D.value,config:I.value,onRefresh:Z});break;case"cc_tolerate":v({siteName:D.value,config:I.value,onRefresh:Z});break;case"xss_injection":case"post":case"get":case"user-agent":case"cookie":x({name:e.name,rule:H.get(e.type)||e.type,siteName:D.value});break;case"scan":W();break;case"spider_status":S({name:e.name,spider:I.value.spider,siteName:D.value});break;case"cdn":y({siteName:D.value});break;case"disable_php_path":d({siteName:D.value});break;case"disable_path":u({siteName:D.value});break;case"disable_ext":b({siteName:D.value});break;case"disable_upload_ext":m({siteName:D.value});break;case"url_tell":_({siteName:D.value});break;case"url_rule":r({siteName:D.value})}}}]})]),X=async e=>{await f({siteName:D.value,obj:e}),Z(),A("refresh")},Y=async e=>{await f({siteName:D.value,obj:"open"}),G.value=e,Z(),A("refresh")},Z=async()=>{try{Q(!0);const{message:e}=await c({siteName:D.value});i(e)&&(G.value=e.open,I.value=e,ee(e))}finally{Q(!1)}},ee=e=>{J.data=F.map((a=>{const t=e[a.type],n=e.top[a.type];return{...a,data:t,ps:a.ps?a.ps:i(n)?n.ps:"",open:s(t)?t:i(t)?t.open:""}}))};return Z(),(t,i)=>{const n=a,s=e;return U(),$("div",L,[M("div",O,[M("span",q,T(t.$t("Waf.Site.Config.index_1")),1),w(V(B),{value:V(G),loading:V(J).loading,"onUpdate:value":Y},null,8,["value","loading"])]),w(n,{loading:V(J).loading,data:V(J).data,"max-height":410,columns:V(K)},null,8,["loading","data","columns"]),w(s,{class:"mt-10px"},{default:z((()=>[M("li",null,T(t.$t("Waf.Site.Config.index_2")),1)])),_:1})])}}});export{A as default};
