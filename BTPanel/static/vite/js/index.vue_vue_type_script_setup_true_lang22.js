import{_ as e}from"./index.js?v=1753954525509";import{_ as l}from"./index172.js?v=1753954525509";import{X as a,T as t,q as i,ff as s,o as n,fg as o,c as u,fh as r,p as _,cH as p}from"./page_layout.js?v=1753954525509";import{cJ as d,cE as c,ay as v,c3 as f,bY as m,bP as g,cA as h,cF as y,c1 as x,cI as k,av as b,c5 as w}from"./naive.js?v=1753954525509";import{k as C,ac as D,P as $,r as z,c as P,U,a1 as j,a2 as S,Q as M,X as E,ah as B,V as R,F as T,O as L,j as O,a3 as A,t as F,e as X,W as q,al as H}from"./vue.js?v=1753954525509";import{_ as I,e as J,c as Q,d as V}from"./public.js?v=1753954525509";import{_ as W}from"./index.vue_vue_type_script_setup_true_lang.js?v=1753954525509";const Y=C({__name:"index",props:{value:{default:()=>[]},valueModifiers:{}},emits:["update:value"],setup(e){const l=D(e,"value"),{t:i}=$(),s=z(null),n=z("all"),o=z(null),u=P((()=>""===n.value?"primary":"default")),r=P((()=>{if(""===n.value){const[e,t]=l.value;if(e!==t)return"".concat(a(e,"yyyy-MM-dd")," ~ ").concat(a(t,"yyyy-MM-dd"))}return i("Public.Search.CustomTime")})),_=e=>e>Date.now(),p=[{label:i("Public.All"),value:"all"},{label:i("Public.Search.Last7"),value:"l7"},{label:i("Public.Search.Last30"),value:"l30"}],g=e=>{switch(o.value=null,e){case"all":l.value=[];break;case"l7":l.value=[Date.now()-6048e5,Date.now()];break;case"l30":l.value=[Date.now()-2592e6,Date.now()]}},h=e=>{var a;e&&e[0]!==e[1]&&(n.value="",l.value=e,null==(a=s.value)||a.setShow(!1))},y=e=>{e||o.value&&o.value[0]===o.value[1]&&(o.value=null)};return(e,l)=>{const a=d,i=c,x=v,k=t,b=f,w=m;return U(),j(w,{size:8},{default:S((()=>[M(i,{value:E(n),"onUpdate:value":[l[0]||(l[0]=e=>B(n)?n.value=e:null),g],class:"bt-radio"},{default:S((()=>[(U(),R(T,null,L(p,(e=>M(a,{key:e.value,value:e.value},{default:S((()=>[O(A(e.label),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"]),M(b,{ref_key:"popoverRef",ref:s,trigger:"click",placement:"bottom-end",style:{padding:0},"arrow-point-to-center":!0,"onUpdate:show":y},{trigger:S((()=>[M(x,{type:E(u)},{default:S((()=>[O(A(E(r)),1)])),_:1},8,["type"])])),default:S((()=>[M(k,{value:E(o),"onUpdate:value":[l[1]||(l[1]=e=>B(o)?o.value=e:null),h],type:"daterange",panel:!0,actions:null,"is-date-disabled":_},null,8,["value"])])),_:1},512)])),_:1})}}}),G={class:"p-20px"},K={key:0},N={key:1},Z=C({__name:"config",props:{info:{}},emits:["refresh"],setup(e,{expose:l,emit:a}){const t=e,o=a,{t:u}=$(),r=F(t,"info"),_=z(null),p=X({split_type:"day",split_hour:2,split_minute:2,save:180,split_size:10}),d={split_size:{trigger:["input","blur"],validator:()=>!("size"===p.split_type&&p.split_size<0)||new Error(u("Docker.Container.log.index_23"))},split_day:{trigger:["input","blur"],validator:()=>{if("day"===p.split_type){if(p.split_hour>23||p.split_hour<0)return new Error(u("Docker.Container.log.index_24"));if(p.split_minute>59||p.split_minute<0)return new Error(u("Docker.Container.log.index_25"))}return!0}},save:{trigger:["input","blur"],validator:()=>!(p.save>1800||p.save<0)||new Error(u("Docker.Container.log.index_26"))}},v=()=>{i("Path","/var/lib/docker/containers/history_logs"),window.location.href=window.location.origin+"/files"};return p.split_type=r.value.split_type,p.split_size=r.value.split_size,p.split_hour=r.value.split_hour,p.split_minute=r.value.split_minute,p.save=g(r.value.save),l({onConfirm:async()=>{var e;await(null==(e=_.value)?void 0:e.validate()),await s({pid:r.value.id,type:"add",log_path:r.value.logs_path,split_type:p.split_type,split_size:p.split_size,split_hour:p.split_hour,split_minute:p.split_minute,save:"".concat(p.save)}),o("refresh")}}),(e,l)=>{const a=n,t=h,i=y,s=c,o=x,u=k,r=b,f=W,m=I;return U(),R("div",G,[M(f,{ref_key:"formRef",ref:_,model:E(p),rules:d},{default:S((()=>[M(t,{label:e.$t("Docker.Container.log.index_8")},{default:S((()=>[l[5]||(l[5]=q("div",{class:"mr-16px"},"/var/lib/docker/containers/history_logs",-1)),M(a,{onClick:v},{default:S((()=>[O(A(e.$t("Docker.Container.log.index_9")),1)])),_:1})])),_:1,__:[5]},8,["label"]),M(t,{label:e.$t("Docker.Container.log.index_10")},{default:S((()=>[M(s,{value:E(p).split_type,"onUpdate:value":l[0]||(l[0]=e=>E(p).split_type=e)},{default:S((()=>[M(i,{value:"size"},{default:S((()=>[O(A(e.$t("Docker.Container.log.index_11")),1)])),_:1}),M(i,{value:"day"},{default:S((()=>[O(A(e.$t("Docker.Container.log.index_12")),1)])),_:1})])),_:1},8,["value"])])),_:1},8,["label"]),"size"===E(p).split_type?(U(),j(t,{key:0,label:e.$t("Docker.Container.log.index_13"),path:"split_size"},{default:S((()=>[M(r,{class:"w-120px"},{default:S((()=>[M(o,{value:E(p).split_size,"onUpdate:value":l[1]||(l[1]=e=>E(p).split_size=e),min:0,"show-button":!1},null,8,["value"]),M(u,null,{default:S((()=>l[6]||(l[6]=[O("MB")]))),_:1,__:[6]})])),_:1})])),_:1},8,["label"])):H("",!0),"day"===E(p).split_type?(U(),j(t,{key:1,label:e.$t("Docker.Container.log.index_14"),path:"split_day"},{default:S((()=>[M(r,{class:"w-auto"},{default:S((()=>[M(u,null,{default:S((()=>[O(A(e.$t("Docker.Container.log.index_15")),1)])),_:1})])),_:1}),M(r,{class:"w-120px ml-12px"},{default:S((()=>[M(o,{value:E(p).split_hour,"onUpdate:value":l[2]||(l[2]=e=>E(p).split_hour=e),min:0,max:23,"show-button":!1},null,8,["value"]),M(u,null,{default:S((()=>[O(A(e.$t("Docker.Container.log.index_16")),1)])),_:1})])),_:1}),M(r,{class:"w-120px ml-12px"},{default:S((()=>[M(o,{value:E(p).split_minute,"onUpdate:value":l[3]||(l[3]=e=>E(p).split_minute=e),min:0,max:59,"show-button":!1},null,8,["value"]),M(u,null,{default:S((()=>[O(A(e.$t("Docker.Container.log.index_17")),1)])),_:1})])),_:1})])),_:1},8,["label"])):H("",!0),M(t,{label:e.$t("Docker.Container.log.index_18"),path:"save"},{default:S((()=>[M(r,{class:"w-120px"},{default:S((()=>[M(o,{value:E(p).save,"onUpdate:value":l[4]||(l[4]=e=>E(p).save=e),min:0,max:1800,"show-button":!1},null,8,["value"]),M(u,null,{default:S((()=>[O(A(e.$t("Docker.Container.log.index_19")),1)])),_:1})])),_:1})])),_:1},8,["label"])])),_:1},8,["model"]),M(m,{class:"mt-8px"},{default:S((()=>["size"===E(p).split_type?(U(),R("li",K,A(e.$t("Docker.Container.log.index_20")),1)):H("",!0),"day"===E(p).split_type?(U(),R("li",N,A(e.$t("Docker.Container.log.index_21")),1)):H("",!0),q("li",null,A(e.$t("Docker.Container.log.index_22")),1)])),_:1})])}}}),ee={class:"ml-4px"},le={class:"mt-12px mb-16px"},ae={class:"h-500px"},te=C({__name:"index",props:{id:{default:""}},setup(a,{expose:t}){const i=F(a,"id"),{t:d}=$(),c=X({time_search:[]}),f=z({logs:d("Docker.Container.log.index_4"),split_status:!1,split_type:"",split_size:0,split_hour:0,split_minute:0,save:"",id:"",name:"",logs_path:"",size:0}),g=J(d("Docker.Container.log.index_5"),{info:f.value,onRefresh:()=>{k()}}),{loading:h,setLoading:y}=Q();function x(e){return String(e).padStart(2,"0")}const k=async()=>{if(i.value)try{y(!0),f.value.logs="";const{message:e}=await o(0===c.time_search.length?{id:i.value}:{id:i.value,time_search:c.time_search.map((e=>Math.round(e/1e3)))});u(e)&&(f.value=e,f.value.logs=e.logs||d("Docker.Container.log.index_4"))}finally{y(!1)}},b=e=>{V({title:d("Docker.Container.log.index_6",[d(e?"Public.Status.TurnOn":"Public.Status.TurnOff")]),content:d(e?"Docker.Container.log.index_7.index_1":"Docker.Container.log.index_7.index_2"),onConfirm:async()=>{try{await s({pid:f.value.id,type:e?"add":"del",log_path:f.value.logs_path,split_type:f.value.split_type,split_size:f.value.split_size,split_hour:f.value.split_hour,split_minute:f.value.split_minute,save:f.value.save})}catch(l){f.value.split_status=!e,console.error(l)}},onPublicClose:()=>{f.value.split_status=!e}})},C=()=>{g.data.info=f.value,g.show=!0},D=()=>{k()},P=()=>{const e=p();window.open("".concat(e,"/download?filename=").concat(f.value.logs_path))},j=async()=>{await r({log_path:f.value.logs_path}),k()},B=()=>{k()};return k(),t({getContent:k}),(a,t)=>{const i=w,s=n,o=m,u=_,r=v,p=Y,d=l,y=e;return U(),R("div",null,[M(o,{class:"items-center"},{default:S((()=>[q("div",null,A(a.$t("Docker.Container.log.index_1")),1),M(i,{value:E(f).split_status,"onUpdate:value":[t[0]||(t[0]=e=>E(f).split_status=e),b]},null,8,["value"]),q("div",ee,[O(A(a.$t("Docker.Container.log.index_2",[x(E(f).split_hour),x(E(f).split_minute)]))+" ",1),M(s,{onClick:C},{default:S((()=>[O(A(a.$t("Docker.Container.log.index_3")),1)])),_:1})])])),_:1}),q("div",le,[M(u)]),M(o,{class:"mb-16px",justify:"space-between"},{default:S((()=>[M(o,{class:"items-center"},{default:S((()=>[M(r,{onClick:D},{default:S((()=>[O(A(a.$t("Public.Btn.Refresh")),1)])),_:1}),M(u,{class:"mx-0!",vertical:""}),M(r,{onClick:P},{default:S((()=>[O(A(a.$t("Public.Btn.Download")),1)])),_:1}),M(r,{onClick:j},{default:S((()=>[O(A(a.$t("Public.Btn.Clear")),1)])),_:1})])),_:1}),M(p,{value:E(c).time_search,"onUpdate:value":[t[1]||(t[1]=e=>E(c).time_search=e),B]},null,8,["value"])])),_:1}),q("div",ae,[M(d,{class:"h-full",lang:"log","font-size":"12",loading:E(h),content:E(f).logs},null,8,["loading","content"])]),M(y,{show:E(g).show,"onUpdate:show":t[2]||(t[2]=e=>E(g).show=e),title:E(g).title,data:E(g).data,width:520,footer:!0,component:Z},null,8,["show","title","data"])])}}});export{te as _};
