const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/count.js?v=1756367574781","js/public.js?v=1756367574781","js/page_layout.js?v=1756367574781","js/vue.js?v=1756367574781","js/__commonjsHelpers__.js?v=1756367574781","js/naive.js?v=1756367574781","js/common.js?v=1756367574781","css/page_layout.css?v=1756367574781","css/public.css?v=1756367574781","js/record.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang5.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang6.js?v=1756367574781","css/index15.css?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang7.js?v=1756367574781","js/site3.js?v=1756367574781","js/tools2.js?v=1756367574781","js/rules.js?v=1756367574781","css/record.css?v=1756367574781"])))=>i.map(i=>d[i]);
import{d as e,bS as t,d5 as a,a as i,w as l,m as n,x as s}from"./page_layout.js?v=1756367574781";import{_ as o}from"./index133.js?v=1756367574781";import{_ as d}from"./index.js?v=1756367574781";import{_ as r,a as u,e as p,c,f as m,h as f,u as x}from"./public.js?v=1756367574781";import{_}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1756367574781";import{_ as v}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1756367574781";import{_ as h}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1756367574781";import{k as W,t as w,P as S,e as y,R as g,V as b,W as R,a3 as $,S as j,l as k,U as P,j as U,a4 as C,v as N,N as q,a0 as E,r as O,F as V,o as z,a2 as L,_ as T,u as D}from"./vue.js?v=1756367574781";import{u as A}from"./soft2.js?v=1756367574781";import{u as F}from"./useModal2.js?v=1756367574781";import{s as I,a as B,b as H,g as J,c as M,d as G,e as K}from"./site3.js?v=1756367574781";import{_ as Q}from"./index198.js?v=1756367574781";import{_ as X}from"./index.vue_vue_type_script_setup_true_lang.js?v=1756367574781";import{dR as Y,dj as Z,dT as ee,dU as te,au as ae,ee as ie,ef as le,df as ne,dh as se,_ as oe,dS as de,aC as re}from"./naive.js?v=1756367574781";import"./common.js?v=1756367574781";import"./__commonjsHelpers__.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1756367574781";import"./soft.js?v=1756367574781";const ue={class:"p-20px"},pe={class:"flex-1"},ce={class:"flex items-center h-32px"},me={class:"flex items-center h-32px"},fe={class:"w-320px mt-6px"},xe={class:"flex-1"},_e={class:"flex items-center h-32px"},ve={class:"flex items-center h-32px"},he={class:"w-320px mt-6px"},We={class:"text-error"},we=W({__name:"index",props:{row:{},onRefresh:{}},setup(t,{expose:a}){const i=t,l=w(i,"row"),{t:n}=S(),s=y({html:!1,html_fast:!1,js:!1,picture:!1}),o=y({type:"default",text:""}),d=y({type:"default",text:""});(()=>{if(!l.value)return;const{crawler:e}=l.value;e&&(s.html=e.html,s.picture=e.picture,e.htmlnew&&(o.type=e.htmlnew.type,o.text=e.htmlnew.text),e.picturenew&&(d.type=e.picturenew.type,d.text=e.picturenew.text))})();const p=async()=>{var t;const a=(()=>{const t={site:l.value.siteName,html:s.html,html_fast:!1,js:!1,picture:s.picture,htmlnew:q(o),picturenew:q(d)};return ie(l.value.crawler,t,(t,a)=>{if(e(t))return JSON.stringify(le(t,a))})})();await I(a),null==(t=i.onRefresh)||t.call(i)};return a({onConfirm:async({hide:e})=>(s.html||s.picture?u({title:n("Public.Confirm.Title"),width:408,content:()=>R("div",{class:"relative pb-40px"},[R("div",null,[U("效果：每次访问网页内容随机加密、有效防止爬虫")]),R("div",null,[U("影响：开启后会导致比之前流量增加1倍")]),R("div",null,[U("建议：线上业务建议不要开启")]),R(r,{class:"absolute left-[-21px] bottom-0 mt-16px "},{default:()=>[R("li",{class:"text-error"},[U("当前的功能为测试功能建议不要在线上业务开启！！")])]})]),onConfirm:async({hide:t})=>{await p(),t(),e()}}):(await p(),e()),!1)}),(e,t)=>{const a=Z,i=te,l=ee,n=ae,u=Y,p=X;return b(),g("div",ue,[R(p,{"label-width":"160px"},{default:$(()=>[R(u,{label:e.$t("Waf.Site.ReptileProtection.index_1")},{default:$(()=>[j("div",pe,[j("div",ce,[R(a,{value:P(s).html,"onUpdate:value":t[0]||(t[0]=e=>P(s).html=e)},null,8,["value"])]),k(j("div",me,[R(l,{value:P(o).type,"onUpdate:value":t[1]||(t[1]=e=>P(o).type=e)},{default:$(()=>[R(i,{value:"default"},{default:$(()=>[U(C(e.$t("Waf.Site.ReptileProtection.index_2")),1)]),_:1}),R(i,{value:"text"},{default:$(()=>[U(C(e.$t("Waf.Site.ReptileProtection.index_3")),1)]),_:1})]),_:1},8,["value"])],512),[[N,P(s).html]]),k(j("div",fe,[R(n,{value:P(o).text,"onUpdate:value":t[2]||(t[2]=e=>P(o).text=e),placeholder:e.$t("Waf.Site.ReptileProtection.index_4")},null,8,["value","placeholder"])],512),[[N,P(s).html&&"text"===P(o).type]])])]),_:1},8,["label"]),R(u,{label:e.$t("Waf.Site.ReptileProtection.index_5")},{default:$(()=>[j("div",xe,[j("div",_e,[R(a,{value:P(s).picture,"onUpdate:value":t[3]||(t[3]=e=>P(s).picture=e)},null,8,["value"])]),k(j("div",ve,[R(l,{value:P(d).type,"onUpdate:value":t[4]||(t[4]=e=>P(d).type=e)},{default:$(()=>[R(i,{value:"default"},{default:$(()=>[U(C(e.$t("Waf.Site.ReptileProtection.index_6")),1)]),_:1}),R(i,{value:"text"},{default:$(()=>[U(C(e.$t("Waf.Site.ReptileProtection.index_7")),1)]),_:1})]),_:1},8,["value"])],512),[[N,P(s).picture]]),k(j("div",he,[R(n,{value:P(d).text,"onUpdate:value":t[5]||(t[5]=e=>P(d).text=e),placeholder:e.$t("Waf.Site.ReptileProtection.index_8")},null,8,["value","placeholder"])],512),[[N,P(s).picture&&"text"===P(d).type]])])]),_:1},8,["label"])]),_:1}),R(r,{class:"mt-16px"},{default:$(()=>[j("li",We,C(e.$t("Waf.Site.ReptileProtection.index_9")),1),j("li",null,[j("b",null,C(e.$t("Waf.Site.ReptileProtection.index_10")),1),U(C(e.$t("Waf.Site.ReptileProtection.index_11")),1)]),j("li",null,[j("b",null,C(e.$t("Waf.Site.ReptileProtection.index_12")),1),U(C(e.$t("Waf.Site.ReptileProtection.index_13")),1)]),j("li",null,[j("b",null,C(e.$t("Waf.Site.ReptileProtection.index_14")),1),U(C(e.$t("Waf.Site.ReptileProtection.index_15")),1)])]),_:1})])}}}),Se={class:"p-20px"},ye={class:"w-40px"},ge={class:"mx-8px"},be={class:"w-40px"},Re={class:"mx-8px"},$e={class:"w-40px"},je={class:"ml-8px"},ke={class:"flex-1"},Pe={class:"flex items-center h-32px"},Ue={class:"w-320px mt-6px"},Ce={class:"text-error"},Ne=W({__name:"index",props:{row:{},onRefresh:{}},setup(e,{expose:a}){const i=e,l=w(i,"row"),n=y({open:!1,user:50,time:10,qps:1,identity:{type:"default",text:""}});(()=>{if(!l.value)return;const{limiting:e}=l.value;if(!e)return;const{timeout:t}=e;t&&(n.open=t.open,n.user=t.user,n.time=t.time,n.qps=t.qps,n.identity.type=t.identity.type,n.identity.text=t.identity.text)})();return a({onConfirm:async()=>{var e;await B({site:l.value.siteName,limiting:{open:n.open,user:n.user,time:n.time,qps:n.qps,identity:{type:n.identity.type,text:n.identity.text}}}),null==(e=i.onRefresh)||e.call(i)}}),(e,a)=>{const i=Z,l=Y,s=ne,o=te,d=ee,u=ae,p=t,c=X,m=r;return b(),g("div",Se,[R(c,{"label-width":"160px"},{default:$(()=>[R(l,{label:e.$t("Waf.Site.WaitingRoom.index_1")},{default:$(()=>[R(i,{value:P(n).open,"onUpdate:value":a[0]||(a[0]=e=>P(n).open=e)},null,8,["value"])]),_:1},8,["label"]),R(p,{show:P(n).open},{default:$(()=>[R(l,{label:e.$t("Waf.Site.WaitingRoom.index_2")},{default:$(()=>[j("div",ye,[R(s,{value:P(n).user,"onUpdate:value":a[1]||(a[1]=e=>P(n).user=e),min:0,"show-button":!1,placeholder:""},null,8,["value"])]),j("div",ge,C(e.$t("Waf.Site.WaitingRoom.index_3")),1),j("div",be,[R(s,{value:P(n).time,"onUpdate:value":a[2]||(a[2]=e=>P(n).time=e),min:0,"show-button":!1,placeholder:""},null,8,["value"])]),j("div",Re,C(e.$t("Waf.Site.WaitingRoom.index_4")),1),j("div",$e,[R(s,{value:P(n).qps,"onUpdate:value":a[3]||(a[3]=e=>P(n).qps=e),min:0,"show-button":!1,placeholder:""},null,8,["value"])]),j("div",je,C(e.$t("Waf.Site.WaitingRoom.index_5")),1)]),_:1},8,["label"]),R(l,{label:e.$t("Waf.Site.WaitingRoom.index_6")},{default:$(()=>[j("div",ke,[j("div",Pe,[R(d,{value:P(n).identity.type,"onUpdate:value":a[4]||(a[4]=e=>P(n).identity.type=e)},{default:$(()=>[R(o,{value:"default"},{default:$(()=>[U(C(e.$t("Waf.Site.WaitingRoom.index_7")),1)]),_:1}),R(o,{value:"text"},{default:$(()=>[U(C(e.$t("Waf.Site.WaitingRoom.index_8")),1)]),_:1})]),_:1},8,["value"])]),k(j("div",Ue,[R(u,{value:P(n).identity.text,"onUpdate:value":a[5]||(a[5]=e=>P(n).identity.text=e),placeholder:e.$t("Waf.Site.WaitingRoom.index_9")},null,8,["value","placeholder"])],512),[[N,"text"===P(n).identity.type]])])]),_:1},8,["label"])]),_:1},8,["show"])]),_:1}),R(m,{class:"mt-16px"},{default:$(()=>[j("li",Ce,C(e.$t("Waf.Site.WaitingRoom.index_10")),1),j("li",null,[j("b",null,C(e.$t("Waf.Site.WaitingRoom.index_11")),1),U(C(e.$t("Waf.Site.WaitingRoom.index_12")),1)]),j("li",null,[j("b",null,C(e.$t("Waf.Site.WaitingRoom.index_13")),1),U(C(e.$t("Waf.Site.WaitingRoom.index_14")),1)]),j("li",null,[j("b",null,C(e.$t("Waf.Site.WaitingRoom.index_15")),1),U(C(e.$t("Waf.Site.WaitingRoom.index_16")),1)]),j("li",null,[j("b",null,C(e.$t("Waf.Site.WaitingRoom.index_17")),1),U(C(e.$t("Waf.Site.WaitingRoom.index_18")),1)]),j("li",null,C(e.$t("Waf.Site.WaitingRoom.index_19")),1)]),_:1})])}}}),qe={class:"mr-8px"},Ee={class:"cursor-pointer"};function Oe(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!D(e)}const Ve=W({__name:"index",setup(t){const W=T(()=>i(()=>import("./count.js?v=1756367574781"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),w=T(()=>i(()=>import("./record.js?v=1756367574781"),__vite__mapDeps([9,10,11,2,3,4,5,6,1,8,7,12,13,14,15,16,17]))),{t:g}=S(),k=a(),{isNewVersion:N,version:D,lastVersion:I}=E(k),B=()=>{A("btwaf",()=>{window.location.reload()})},X=O(!1),Y=async e=>{await H({obj:"malicious_ip"}),X.value=e},ee=y({p:1,limit:10,search:""}),te=p(""),ae=p(""),ie=async(e,t)=>{await M({siteName:e.siteName,obj:t})},{table:le,columns:ne,setLoading:ue}=c([{key:"siteName",title:g("Waf.Site.index_8"),minWidth:150,ellipsis:{tooltip:!0},render:e=>R("a",{class:"bt-link",href:"javascript:;",onClick:()=>{F({row:e,onRefresh:fe})}},[e.siteName])},{key:"total",title:g("Waf.Site.index_9"),width:"10%",minWidth:140,render:e=>{let t=0;return e.total.forEach(e=>{t+=e.value}),R(se,{placement:"bottom-start","arrow-point-to-center":!0},{trigger:()=>R(V,null,[t>0?R("a",{class:"bt-link error",href:"javascript:;",onClick:()=>{(e=>{te.data.list=e.total,te.title=g("Waf.Site.index_5",[e.siteName]),te.show=!0})(e)}},[t]):t]),default:()=>R("div",null,[e.total.map(e=>R("div",{class:"leading-18px"},[e.name,U(": "),e.value,g("Waf.Site.index_35")]))])})}},{key:"not_spider",width:"12%",minWidth:120,title:()=>{let e;return R(V,null,[R("span",{class:"mr-6px"},[g("Waf.Site.index_36")]),R(Q,null,Oe(e=g("Waf.Site.index_37"))?e:{default:()=>[e]})])},render:e=>R(oe,{checked:e.not_spider,onUpdateChecked:async t=>{await ie(e,"not_spider"),e.not_spider=t}},null)},{key:"cdn",width:"12%",minWidth:120,title:()=>{let e;return R(V,null,[R("span",{class:"mr-6px"},[g("Waf.Site.index_38")]),R(Q,null,Oe(e=g("Waf.Site.index_39"))?e:{default:()=>[e]})])},render:e=>R(oe,{checked:e.cdn,onUpdateChecked:async t=>{await ie(e,"cdn"),e.cdn=t}},null)},{key:"smart_cc",width:"14%",minWidth:140,title:()=>R(V,null,[R("span",{class:"mr-6px"},[g("Waf.Site.index_40")]),R(Q,null,{default:()=>[R("div",{class:"w-500px"},[g("Waf.Site.index_41")])]})]),render:e=>R("div",{class:"inline-flex items-center"},[R(oe,{class:"mr-6px",checked:e.smart_cc.open,onUpdateChecked:async t=>{t?u({title:g("Public.Confirm.Title"),content:g("Waf.Site.index_10"),onConfirm:async()=>{await ie(e,"smart_cc"),e.smart_cc.open=t}}):(await ie(e,"smart_cc"),e.smart_cc.open=t)}},null),R(se,{placement:"bottom-start","arrow-point-to-center":!0},{trigger:()=>R("span",{class:"text-desc text-13px"},[e.total[9].value]),default:()=>R(V,null,[g("Waf.Site.index_42",[e.total[9].value])])})])},{key:"crawler",title:g("Waf.Site.index_43"),width:"9%",minWidth:100,render:e=>{const t=(e.crawler?Object.entries(e.crawler):[]).some(([e,t])=>t&&"picturenew"!==e&&"htmlnew"!==e);return R("a",{class:["bt-link",t?"":"error"],href:"javascript:;",onClick:()=>{pe(e)}},[g(t?"Public.Status.Enable":"Public.Status.Disable")])}},{key:"limiting",title:g("Waf.Site.index_44"),width:"10%",minWidth:170,render:e=>{var t,a,i,l;return R("a",{class:["bt-link",(null==(a=null==(t=null==e?void 0:e.limiting)?void 0:t.timeout)?void 0:a.open)?"":"error"],href:"javascript:;",onClick:()=>{ce(e)}},[(null==(l=null==(i=null==e?void 0:e.limiting)?void 0:i.timeout)?void 0:l.open)?g("Public.Status.Enable"):g("Public.Status.Disable")])}},{key:"cc",width:"8%",minWidth:100,title:g("Waf.Site.index_11"),render:e=>R("div",{class:"inline-flex items-center"},[R(oe,{class:"mr-6px",checked:e.cc.open,onUpdateChecked:async t=>{await ie(e,"cc"),e.cc.open=t}},null),R(se,{placement:"bottom-start","arrow-point-to-center":!0},{trigger:()=>R("span",{class:"text-desc text-13px"},[e.total[2].value]),default:()=>R(V,null,[g("Waf.Site.index_42",[e.total[2].value])])})])},{key:"open",width:"6%",minWidth:70,title:g("Waf.Site.index_12"),render:e=>R(Z,{size:"small",value:e.open,onUpdateValue:async t=>{await ie(e,"open"),e.open=t}},null)},m({width:100,options:e=>[{label:g("Waf.Site.index_13"),onClick:()=>{(async e=>{const{message:t}=await J({siteName:e.siteName});l(t)&&t.length>0?(ae.data.timeList=t,ae.data.siteName=e.siteName,ae.title=g("Waf.Site.index_6",[e.siteName]),ae.show=!0):n.success(g("Waf.Site.index_7"))})(e)}},{label:g("Public.Btn.Set"),onClick:()=>{F({row:e,onRefresh:fe})}}]})]),pe=e=>{x({title:g("Waf.Site.index_45",[e.siteName]),width:620,footer:!0,data:{row:e,onRefresh:fe},component:we})},ce=e=>{x({title:g("Waf.Site.index_46",[e.siteName]),width:700,footer:!0,data:{row:e,onRefresh:fe},component:Ne})},me=()=>{ee.p=1,fe()},fe=async()=>{try{ue(!0);const{message:t}=await K(q(ee));e(t)&&(le.data=t.data,le.total=s(t.page))}finally{ue(!1)}};return(async()=>{const{message:t}=await G();e(t)&&(X.value=t.malicious_ip)})(),z(()=>{fe()}),(e,t)=>{const a=re,i=h,l=f,n=v,s=_,u=r,p=d,c=de,m=o;return b(),L(m,{install:P(N)},{desc:$(()=>[j("span",qe," Current Nginx WAF version is v"+C(P(D))+", latest is v"+C(P(I))+". Please update. ",1),R(a,{class:"px-8px h-24px",type:"primary",size:"small",onClick:B},{default:$(()=>t[6]||(t[6]=[U(" Upgrade ",-1)])),_:1,__:[6]})]),default:$(()=>[R(c,{class:"p-16px"},{default:$(()=>[R(s,null,{toolsLeft:$(()=>[j("div",Ee,[j("span",{class:"mr-8px text-desc",onClick:t[0]||(t[0]=e=>Y(!P(X)))},C(e.$t("Waf.Site.index_1")),1),R(P(oe),{checked:P(X),"onUpdate:checked":Y},null,8,["checked"])])]),toolsRight:$(()=>[R(i,{value:P(ee).search,"onUpdate:value":t[1]||(t[1]=e=>P(ee).search=e),placeholder:e.$t("Waf.Site.index_2"),onSearch:me},null,8,["value","placeholder"])]),table:$(()=>[R(l,{loading:P(le).loading,data:P(le).data,columns:P(ne)},null,8,["loading","data","columns"])]),pageRight:$(()=>[R(n,{page:P(ee).p,"onUpdate:page":t[2]||(t[2]=e=>P(ee).p=e),"page-size":P(ee).limit,"onUpdate:pageSize":t[3]||(t[3]=e=>P(ee).limit=e),"item-count":P(le).total,"store-key":"waf-site",onRefresh:fe},null,8,["page","page-size","item-count"])]),_:1}),R(u,{class:"mt-16px"},{default:$(()=>[j("li",null,C(e.$t("Waf.Site.index_3")),1),j("li",null,C(e.$t("Waf.Site.index_4")),1)]),_:1}),R(p,{show:P(te).show,"onUpdate:show":t[4]||(t[4]=e=>P(te).show=e),title:P(te).title,width:480,"min-height":688,data:P(te).data,component:P(W)},null,8,["show","title","data","component"]),R(p,{show:P(ae).show,"onUpdate:show":t[5]||(t[5]=e=>P(ae).show=e),title:P(ae).title,data:P(ae).data,width:1e3,"min-height":552,component:P(w)},null,8,["show","title","data","component"])]),_:1})]),_:1},8,["install"])}}});export{Ve as default};
