import{_ as a}from"./index95.js?v=1744703330658";import{I as e,j as l,K as s}from"./page_layout.js?v=1744703330658";import{_ as i}from"./index.vue_vue_type_script_setup_true_lang.js?v=1744703330658";import{d as t,O as n,r as u,e as r,j as o,R as p,$ as d,a0 as m,P as _,V as c,U as v,ap as f,k as h,v as b,c as k,a1 as y}from"./vue.js?v=1744703330658";import{e as g,q as w,t as x}from"./ssl.js?v=1744703330658";import{c as S}from"./public.js?v=1744703330658";import{b$ as j,ch as P,cn as D,_ as L}from"./naive.js?v=1744703330658";import"./common.js?v=1744703330658";import"./__commonjsHelpers__.js?v=1744703330658";const $={class:"w-300px"},I={class:"w-300px"},U={class:"w-300px"},A=t({__name:"form",props:{row:{},isEdit:{type:Boolean}},emits:["refresh"],setup(t,{expose:A,emit:C}){const q=t,E=C,{isEdit:F,row:B}=q,{t:K}=n(),N=u(null),R=u([]),T=r((()=>"CloudFlareDns"===V.name)),V=o({name:"",api_user:"",api_key:"",alias:"",permission:"global",status:1}),W={api_user:{required:!0,trigger:"blur",validator:(a,e)=>!("CloudFlareDns"!==V.name&&!e)||new Error(K("SSL.Domain.index_1"))},api_key:{required:!0,trigger:"blur",message:K("SSL.Domain.index_2")},alias:{required:!0,trigger:"blur",message:K("SSL.Domain.index_6")}},H=()=>{var a;null==(a=N.value)||a.restoreValidation()},O=u(""),z=u(!0),G=()=>{z.value&&(V.api_user="")},J=()=>{!V.api_user&&z.value?V.api_user=O.value:V.api_user&&(z.value=!1)},M=()=>({id:F&&B?B.id:null,name:F&&B&&V.name===B.name?null:V.name,api_user:F&&B&&V.api_user===B.api_user?null:"limit"===V.permission?"":V.api_user,api_key:F&&B&&V.api_key===B.api_key?null:V.api_key,permission:F&&B&&V.permission===B.permission?null:"CloudFlareDns"===V.name?V.permission:"",status:F&&B&&V.status===B.status?null:V.status,alias:F&&B&&V.alias===B.alias?null:V.alias}),{loading:Q,setLoading:X}=S();return(async()=>{try{X(!0);const{message:a}=await x();e(a)&&a.length>0&&(V.name=a[0],R.value=a.map((a=>({label:a,value:a}))))}finally{(()=>{const{row:a,isEdit:e}=q;e&&a&&(V.name=a.name,V.api_user=a.api_user,O.value=a.api_user,V.api_key=a.api_key,V.permission=a.permission,V.status=a.status,V.alias=a.alias)})(),X(!1)}})(),A({onConfirm:async()=>{var a;await(null==(a=N.value)?void 0:a.validate()),F&&B?await g(M()):await w(M()),E("refresh")}}),(e,t)=>{const n=j,u=P,r=D,o=L,g=i,w=l,x=a,S=s;return p(),d(S,{class:"p-20px",show:c(Q)},{default:m((()=>[_(g,{ref_key:"formRef",ref:N,model:c(V),rules:W},{default:m((()=>[_(u,{label:e.$t("Public.Table.Status"),path:"status"},{default:m((()=>[_(n,{value:c(V).status,"onUpdate:value":t[0]||(t[0]=a=>c(V).status=a),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1},8,["label"]),_(u,{label:e.$t("Config.Alarm.index_43"),path:"name"},{default:m((()=>[_(r,{class:"w-300px",value:c(V).name,"onUpdate:value":[t[1]||(t[1]=a=>c(V).name=a),H],options:c(R),disabled:c(F)},null,8,["value","options","disabled"])])),_:1},8,["label"]),"global"===c(V).permission?(p(),d(u,{key:0,label:"API User",path:"api_user"},{default:m((()=>[v("div",$,[_(o,{value:c(V).api_user,"onUpdate:value":t[2]||(t[2]=a=>c(V).api_user=a),placeholder:e.$t("SSL.Domain.index_1"),onFocus:G,onBlur:J},null,8,["value","placeholder"])])])),_:1})):f("",!0),_(u,{label:"API Key",path:"api_key"},{default:m((()=>[v("div",I,[_(o,{value:c(V).api_key,"onUpdate:value":t[3]||(t[3]=a=>c(V).api_key=a),placeholder:e.$t("SSL.Domain.index_2")},null,8,["value","placeholder"])])])),_:1}),_(u,{label:e.$t("Config.Panel.index_36"),path:"alias"},{default:m((()=>[v("div",U,[_(o,{value:c(V).alias,"onUpdate:value":t[4]||(t[4]=a=>c(V).alias=a),placeholder:e.$t("SSL.Domain.index_6")},null,8,["value","placeholder"])])])),_:1},8,["label"]),h(_(u,{label:"API-Limit",path:"permission"},{default:m((()=>[_(n,{value:c(V).permission,"onUpdate:value":t[5]||(t[5]=a=>c(V).permission=a),"checked-value":"limit","unchecked-value":"global"},null,8,["value"])])),_:1},512),[[b,c(T)]])])),_:1},8,["model"]),c(T)?(p(),d(x,{key:0},{default:m((()=>[v("li",null,[_(w,{target:"_blank",href:"https://www.aapanel.com/forum/d/3375-3375-set-the-clouldflare-apt-token-for-dns-editing-permissions"},{default:m((()=>[k(y(e.$t("SSL.Domain.index_3")),1)])),_:1})])])),_:1})):(p(),d(x,{key:1},{default:m((()=>[t[6]||(t[6]=v("li",null," Namecheap API needs added in Whitelisted IPs (only IPv4): Profile > Tools menu > Namecheap API Access > Whitelisted IPs, please check: ",-1)),v("li",null,[_(w,{target:"_blank",href:"https://www.namecheap.com/support/api/intro/"},{default:m((()=>[k(y(e.$t("SSL.Domain.index_3")),1)])),_:1})])])),_:1}))])),_:1},8,["show"])}}});export{A as default};
