import{d as a,U as e,ao as l,ap as s,_ as i}from"./public.js?v=1749179669910";import{N as n,o as t,O as u}from"./page_layout.js?v=1749179669910";import{_ as o}from"./index.vue_vue_type_script_setup_true_lang.js?v=1749179669910";import{d as r,O as p,r as m,e as d,j as _,R as c,a0 as v,a1 as f,P as h,V as k,U as y,ao as b,k as g,v as S,c as w,a2 as x}from"./vue.js?v=1749179669910";import{c0 as D,cj as P,cp as L,_ as j}from"./naive.js?v=1749179669910";import"./common.js?v=1749179669910";import"./__commonjsHelpers__.js?v=1749179669910";const I={class:"w-300px"},U={class:"w-300px"},$={class:"w-300px"},A=r({__name:"form",props:{row:{},isEdit:{type:Boolean}},emits:["refresh"],setup(r,{expose:A,emit:C}){const N=r,F=C,{isEdit:B,row:E}=N,{t:T}=p(),q=m(null),K=m([]),O=d((()=>"CloudFlareDns"===W.name)),R=d((()=>"NameSiloDns"!==W.name&&"global"===W.permission)),V=d((()=>"PorkBunDns"===W.name)),W=_({name:"",api_user:"",api_key:"",alias:"",permission:"global",status:1}),H={api_user:{required:!0,trigger:"blur",validator:(a,e)=>!("CloudFlareDns"!==W.name&&!e)||new Error(T("SSL.Domain.index_1"))},api_key:{required:!0,trigger:"blur",message:T("SSL.Domain.index_2")},alias:{required:!0,trigger:"blur",message:T("SSL.Domain.index_6")}},z=a=>{var e;"CloudFlareDns"!==a&&"limit"===W.permission&&(W.permission="global"),null==(e=q.value)||e.restoreValidation()},G=m(""),J=m(!0),M=()=>{J.value&&(W.api_user="")},Q=()=>{!W.api_user&&J.value?W.api_user=G.value:W.api_user&&(J.value=!1)},X=()=>({id:B&&E?E.id:null,name:B&&E&&W.name===E.name?null:W.name,api_user:B&&E&&W.api_user===E.api_user?null:R.value?W.api_user:"",api_key:B&&E&&W.api_key===E.api_key?null:W.api_key,permission:B&&E&&W.permission===E.permission?null:"CloudFlareDns"===W.name?W.permission:"",status:B&&E&&W.status===E.status?null:W.status,alias:B&&E&&W.alias===E.alias?null:W.alias}),{loading:Y,setLoading:Z}=a();return(async()=>{try{Z(!0);const{message:a}=await s();n(a)&&a.length>0&&(W.name=a[0],K.value=a.map((a=>({label:a,value:a}))))}finally{(()=>{const{row:a,isEdit:e}=N;e&&a&&(W.name=a.name,W.api_user=a.api_user,G.value=a.api_user,W.api_key=a.api_key,W.permission=a.permission,W.status=a.status,W.alias=a.alias)})(),Z(!1)}})(),A({onConfirm:async()=>{var a;await(null==(a=q.value)?void 0:a.validate()),B&&E?await e(X()):await l(X()),F("refresh")}}),(a,e)=>{const l=D,s=P,n=L,r=j,p=o,m=t,d=i,_=u;return c(),v(_,{class:"p-20px",show:k(Y)},{default:f((()=>[h(p,{ref_key:"formRef",ref:q,model:k(W),rules:H},{default:f((()=>[h(s,{label:a.$t("Public.Table.Status"),path:"status"},{default:f((()=>[h(l,{value:k(W).status,"onUpdate:value":e[0]||(e[0]=a=>k(W).status=a),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1},8,["label"]),h(s,{label:a.$t("Config.Alarm.index_43"),path:"name"},{default:f((()=>[h(n,{class:"w-300px",value:k(W).name,"onUpdate:value":[e[1]||(e[1]=a=>k(W).name=a),z],options:k(K),disabled:k(B)},null,8,["value","options","disabled"])])),_:1},8,["label"]),k(R)?(c(),v(s,{key:0,label:k(V)?"Secret Key":"API User",path:"api_user"},{default:f((()=>[y("div",I,[h(r,{value:k(W).api_user,"onUpdate:value":e[2]||(e[2]=a=>k(W).api_user=a),placeholder:k(V)?"Please enter Secret Key":a.$t("SSL.Domain.index_1"),onFocus:M,onBlur:Q},null,8,["value","placeholder"])])])),_:1},8,["label"])):b("",!0),h(s,{label:"API Key",path:"api_key"},{default:f((()=>[y("div",U,[h(r,{value:k(W).api_key,"onUpdate:value":e[3]||(e[3]=a=>k(W).api_key=a),placeholder:a.$t("SSL.Domain.index_2")},null,8,["value","placeholder"])])])),_:1}),h(s,{label:a.$t("Config.Panel.index_36"),path:"alias"},{default:f((()=>[y("div",$,[h(r,{value:k(W).alias,"onUpdate:value":e[4]||(e[4]=a=>k(W).alias=a),placeholder:a.$t("SSL.Domain.index_6")},null,8,["value","placeholder"])])])),_:1},8,["label"]),g(h(s,{label:"API-Limit",path:"permission"},{default:f((()=>[h(l,{value:k(W).permission,"onUpdate:value":e[5]||(e[5]=a=>k(W).permission=a),"checked-value":"limit","unchecked-value":"global"},null,8,["value"])])),_:1},512),[[S,k(O)]])])),_:1},8,["model"]),k(O)?(c(),v(d,{key:0},{default:f((()=>[y("li",null,[h(m,{target:"_blank",href:"https://www.aapanel.com/forum/d/3375-3375-set-the-clouldflare-apt-token-for-dns-editing-permissions"},{default:f((()=>[w(x(a.$t("SSL.Domain.index_3")),1)])),_:1})])])),_:1})):b("",!0),"NameCheapDns"===k(W).name?(c(),v(d,{key:1},{default:f((()=>[e[6]||(e[6]=y("li",null," Namecheap API needs added in Whitelisted IPs (only IPv4): Profile > Tools menu > Namecheap API Access > Whitelisted IPs, please check: ",-1)),y("li",null,[h(m,{target:"_blank",href:"https://www.namecheap.com/support/api/intro/"},{default:f((()=>[w(x(a.$t("SSL.Domain.index_3")),1)])),_:1})])])),_:1})):b("",!0),"NameSiloDns"===k(W).name||"PorkBunDns"===k(W).name?(c(),v(d,{key:2},{default:f((()=>[y("li",null,[h(m,{target:"_blank",href:"https://www.aapanel.com/docs/Function/Tutorial/DNS_API_Tutorial.html"},{default:f((()=>[w(x(a.$t("SSL.Domain.index_3")),1)])),_:1})])])),_:1})):b("",!0)])),_:1},8,["show"])}}});export{A as default};
