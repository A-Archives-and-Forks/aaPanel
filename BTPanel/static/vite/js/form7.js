import{_ as a}from"./index.vue_vue_type_script_setup_true_lang.js?v=1742891699271";import{d as e,O as l,r as s,e as i,j as u,R as r,a0 as n,a1 as t,P as o,V as p,U as m,k as d,v as _}from"./vue.js?v=1742891699271";import{e as v,l as c,m as f}from"./ssl.js?v=1742891699271";import{I as h,K as b}from"./page_layout.js?v=1742891699271";import{c as y}from"./public.js?v=1742891699271";import{b$ as g,ch as k,cn as x,_ as w}from"./naive.js?v=1742891699271";import"./__commonjsHelpers__.js?v=1742891699271";import"./common.js?v=1742891699271";const S={class:"w-300px"},j={class:"w-300px"},D={class:"w-300px"},L=e({__name:"form",props:{row:{},isEdit:{type:Boolean}},emits:["refresh"],setup(e,{expose:L,emit:U}){const $=e,C=U,{isEdit:P,row:A}=$,{t:E}=l(),F=s(null),I=s([]),q=i((()=>"CloudFlareDns"===B.name)),B=u({name:"",api_user:"",api_key:"",alias:"",permission:"global",status:1}),K={api_user:{required:!0,trigger:"blur",validator:(a,e)=>!("CloudFlareDns"!==B.name&&!e)||new Error(E("SSL.Domain.index_1"))},api_key:{required:!0,trigger:"blur",message:E("SSL.Domain.index_2")},alias:{required:!0,trigger:"blur",message:E("SSL.Domain.index_6")}},R=()=>{var a;null==(a=F.value)||a.restoreValidation()},V=s(""),H=s(!0),O=()=>{H.value&&(B.api_user="")},T=()=>{!B.api_user&&H.value?B.api_user=V.value:B.api_user&&(H.value=!1)},z=()=>({id:P&&A?A.id:null,name:P&&A&&B.name===A.name?null:B.name,api_user:P&&A&&B.api_user===A.api_user?null:B.api_user,api_key:P&&A&&B.api_key===A.api_key?null:B.api_key,permission:P&&A&&B.permission===A.permission?null:"CloudFlareDns"===B.name?B.permission:"",status:P&&A&&B.status===A.status?null:B.status,alias:P&&A&&B.alias===A.alias?null:B.alias}),{loading:G,setLoading:J}=y();return(async()=>{try{J(!0);const{message:a}=await f();h(a)&&a.length>0&&(B.name=a[0],I.value=a.map((a=>({label:a,value:a}))))}finally{(()=>{const{row:a,isEdit:e}=$;e&&a&&(B.name=a.name,B.api_user=a.api_user,V.value=a.api_user,B.api_key=a.api_key,B.permission=a.permission,B.status=a.status,B.alias=a.alias)})(),J(!1)}})(),L({onConfirm:async()=>{var a;await(null==(a=F.value)?void 0:a.validate()),P&&A?await v(z()):await c(z()),C("refresh")}}),(e,l)=>{const s=g,i=k,u=x,v=w,c=a,f=b;return r(),n(f,{class:"p-20px",show:p(G)},{default:t((()=>[o(c,{ref_key:"formRef",ref:F,model:p(B),rules:K},{default:t((()=>[o(i,{label:e.$t("Public.Table.Status"),path:"status"},{default:t((()=>[o(s,{value:p(B).status,"onUpdate:value":l[0]||(l[0]=a=>p(B).status=a),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1},8,["label"]),o(i,{label:e.$t("Config.Alarm.index_43"),path:"name"},{default:t((()=>[o(u,{class:"w-300px",value:p(B).name,"onUpdate:value":[l[1]||(l[1]=a=>p(B).name=a),R],options:p(I),disabled:p(P)},null,8,["value","options","disabled"])])),_:1},8,["label"]),o(i,{label:"API User",path:"api_user"},{default:t((()=>[m("div",S,[o(v,{value:p(B).api_user,"onUpdate:value":l[2]||(l[2]=a=>p(B).api_user=a),placeholder:e.$t("SSL.Domain.index_1"),onFocus:O,onBlur:T},null,8,["value","placeholder"])])])),_:1}),o(i,{label:"API Key",path:"api_key"},{default:t((()=>[m("div",j,[o(v,{value:p(B).api_key,"onUpdate:value":l[3]||(l[3]=a=>p(B).api_key=a),placeholder:e.$t("SSL.Domain.index_2")},null,8,["value","placeholder"])])])),_:1}),o(i,{label:e.$t("Config.Panel.index_36"),path:"alias"},{default:t((()=>[m("div",D,[o(v,{value:p(B).alias,"onUpdate:value":l[4]||(l[4]=a=>p(B).alias=a),placeholder:e.$t("SSL.Domain.index_6")},null,8,["value","placeholder"])])])),_:1},8,["label"]),d(o(i,{label:"API-Limit",path:"permission"},{default:t((()=>[o(s,{value:p(B).permission,"onUpdate:value":l[5]||(l[5]=a=>p(B).permission=a),"checked-value":"limit","unchecked-value":"global"},null,8,["value"])])),_:1},512),[[_,p(q)]])])),_:1},8,["model"])])),_:1},8,["show"])}}});export{L as default};
