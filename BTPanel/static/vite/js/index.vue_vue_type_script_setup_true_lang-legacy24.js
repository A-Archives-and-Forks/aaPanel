System.register(["./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1753954525509","./page_layout-legacy.js?v=1753954525509","./index-legacy237.js?v=1753954525509","./vue-legacy.js?v=1753954525509","./index-legacy41.js?v=1753954525509","./index-legacy.js?v=1753954525509","./public-legacy.js?v=1753954525509","./index.vue_vue_type_script_setup_true_lang-legacy4.js?v=1753954525509","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1753954525509","./index.vue_vue_type_script_setup_true_lang-legacy11.js?v=1753954525509","./index.vue_vue_type_script_setup_true_lang-legacy9.js?v=1753954525509","./index-legacy102.js?v=1753954525509","./naive-legacy.js?v=1753954525509","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1753954525509","./index.vue_vue_type_script_setup_true_lang-legacy10.js?v=1753954525509","./index.vue_vue_type_script_setup_true_lang-legacy15.js?v=1753954525509","./soft-legacy.js?v=1753954525509","./echarts-legacy.js?v=1753954525509"],(function(e,t){"use strict";var a,i,l,s,r,n,o,c,u,d,m,p,g,v,y,x,f,M,h,b,w,k,_,I,N,D,j,S,A,z,T,C,L,O,Q,U,H,Y,P,W,E,R,Z,B,G,J,V,F,$,X,K,q,ee,te,ae,ie,le,se,re,ne,oe,ce,ue,de,me,pe,ge,ve,ye,xe,fe,Me,he,be,we,ke,_e,Ie,Ne,De,je,Se,Ae,ze,Te,Ce,Le,Oe,Qe,Ue,He,Ye,Pe,We,Ee,Re,Ze,Be,Ge,Je,Ve,Fe,$e,Xe,Ke,qe,et,tt,at,it,lt,st;return{setters:[e=>{a=e.a},e=>{i=e.c,l=e._,s=e.e,r=e.w,n=e.u,o=e.m,c=e.a,u=e.O,d=e.X,m=e.p,p=e.o,g=e.bz,v=e.bA,y=e.bl,x=e.ce},e=>{f=e._},e=>{M=e.S,h=e.r,b=e.$,w=e.k,k=e.Q,_=e.F,I=e.U,N=e.V,D=e.W,j=e.a3,S=e.X,A=e.O,z=e.I,T=e.P,C=e.c,L=e.ah,O=e.ax,Q=e.a2,U=e.j,H=e.al,Y=e.n,P=e.e,W=e._,E=e.a1,R=e.aD,Z=e.H,B=e.o,G=e.b,J=e.w,V=e.l,F=e.v,$=e.d},e=>{X=e.a,K=e.b,q=e.c,ee=e.s,te=e.e,ae=e.f,ie=e.h,le=e.i,se=e.j,re=e.k,ne=e.l,oe=e.g,ce=e.m,ue=e.n,de=e.o,me=e.p,pe=e.q,ge=e.r,ve=e.t,ye=e.u,xe=e.v,fe=e.w,Me=e.x,he=e.y,be=e.z,we=e.A},e=>{ke=e._},e=>{_e=e.b,Ie=e.h,Ne=e.d,De=e.c,je=e.f,Se=e._,Ae=e.e,ze=e.a,Te=e.u,Ce=e.r,Le=e.$,Oe=e.z},e=>{Qe=e._},e=>{Ue=e._},e=>{He=e._},e=>{Ye=e._},e=>{Pe=e._},e=>{We=e.c5,Ee=e.ay,Re=e.c0,Ze=e.cG,Be=e.cA,Ge=e._,Je=e.d1,Ve=e.bY,Fe=e.bC,$e=e.c3,Xe=e.D,Ke=e.cB,qe=e.cC,et=e.bA},e=>{tt=e._},e=>{at=e._},e=>{it=e._},e=>{lt=e.u},e=>{st=e.aj}],execute:function(){var rt=document.createElement("style");rt.textContent='.infoList[data-v-ab2cfe5b]{margin-bottom:1.6rem;display:flex;border-radius:.4rem;padding:1.6rem;border:1px solid #efefef}.item-list[data-v-ab2cfe5b]{border-right:1px solid #efefef}.item-list[data-v-ab2cfe5b]:last-child{border-right:none}.loading-icon[data-v-a91fb030]{position:absolute;width:80px;height:80px;animation:spin 1s linear infinite;--un-bg-opacity:0;background-color:rgb(204 204 204 / var(--un-bg-opacity));border-radius:50%;border:2px solid #20a53a;clip-path:inset(0 20%)}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}[data-v-216c3aa4] .n-collapse .n-collapse-item .n-collapse-item__header .n-collapse-item__header-main{justify-content:space-between!important}.scrollable[data-v-216c3aa4]::-webkit-scrollbar{width:10px}.scrollable[data-v-216c3aa4]::-webkit-scrollbar-track{background:#efefef}.scrollable[data-v-216c3aa4]::-webkit-scrollbar-thumb{background:#bfbfbf;border-radius:10px}.scrollable[data-v-216c3aa4]::-webkit-scrollbar-thumb:hover{background:#555}.risk-chart[data-v-cd7f811e]{padding:2px}.risk-chart .circle-box[data-v-cd7f811e]{position:relative;display:flex;width:110px;height:110px;justify-content:center;align-items:center}.risk-chart .circle-box[data-v-cd7f811e]:before,.risk-chart .circle-box[data-v-cd7f811e]:after,.risk-chart .circle-box .circle-box-bg[data-v-cd7f811e]{position:absolute;top:0;left:0;display:block;width:100%;height:100%;content:""}.risk-chart .circle-box[data-v-cd7f811e]:before{border-radius:56% 56% 52% 54%;opacity:.8;animation:wave-cd7f811e 12s infinite linear}.risk-chart .circle-box[data-v-cd7f811e]:after{border-radius:44% 44% 42% 46%;opacity:.6;animation:wave-cd7f811e 10s infinite linear}.risk-chart .circle-box .circle-box-bg[data-v-cd7f811e]{border-radius:46% 46% 42% 44%;opacity:.4;animation:wave-cd7f811e 8s infinite linear}.risk-chart .circle-box .circle-box-inner[data-v-cd7f811e]{z-index:1;display:flex;width:101px;height:101px;border-radius:70% 60% 60%;flex-direction:column;justify-content:center;align-items:center;background:#fff}.risk-chart .circle-box .circle-box-value[data-v-cd7f811e]{display:inline-flex;font-size:32px;line-height:1;align-items:flex-end}.risk-chart .circle-box .circle-box-value .unit[data-v-cd7f811e]{margin-left:4px;font-size:12px;color:#999;transform:translateY(-6px)}.risk-chart .circle-box .circle-box-desc[data-v-cd7f811e]{margin-top:4px}.circle-danger .risk-chart .circle-box[data-v-cd7f811e]:before,.circle-danger .risk-chart .circle-box[data-v-cd7f811e]:after,.circle-danger .risk-chart .circle-box .circle-box-bg[data-v-cd7f811e]{background-color:#ef0808}.circle-danger .risk-chart .circle-box .circle-box-inner[data-v-cd7f811e]{color:#e01616}.circle-warn .risk-chart .circle-box[data-v-cd7f811e]:before,.circle-warn .risk-chart .circle-box[data-v-cd7f811e]:after,.circle-warn .risk-chart .circle-box .circle-box-bg[data-v-cd7f811e]{background-color:#f0ad4e}.circle-warn .risk-chart .circle-box .circle-box-inner[data-v-cd7f811e]{color:#f0ad4e}.circle-alert .risk-chart .circle-box[data-v-cd7f811e]:before,.circle-alert .risk-chart .circle-box[data-v-cd7f811e]:after,.circle-alert .risk-chart .circle-box .circle-box-bg[data-v-cd7f811e]{background-color:#e8d544}.circle-alert .risk-chart .circle-box .circle-box-inner[data-v-cd7f811e]{color:#e8d544}.circle-safe .risk-chart .circle-box[data-v-cd7f811e]:before,.circle-safe .risk-chart .circle-box[data-v-cd7f811e]:after,.circle-safe .risk-chart .circle-box .circle-box-bg[data-v-cd7f811e]{background-color:#20a53a}.circle-safe .risk-chart .circle-box .circle-box-inner[data-v-cd7f811e]{color:#20a53a}@keyframes wave-cd7f811e{0%{transform:rotate(0)}50%{transform:rotate(180deg)}to{transform:rotate(360deg)}}@keyframes rotate-13e5c800{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.absolute-center[data-v-13e5c800]{position:absolute;top:0;left:0;bottom:0;right:0;margin:auto}.scan-icon-img[data-v-13e5c800]{position:absolute;left:0;right:0;top:0;bottom:0;z-index:99;margin:auto;width:58px;height:67px;background-position:100%}.icon-img-safe[data-v-13e5c800]{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTguMDAwMDAwIiBoZWlnaHQ9IjY3LjAwMDAwMCIgdmlld0JveD0iMCAwIDU4IDY3IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KCTxkZXNjPgoJCQlDcmVhdGVkIHdpdGggUGl4c28uCgk8L2Rlc2M+Cgk8ZGVmcz4KCQk8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50X2xpbmVhcl8zN182NDhfMCIgeDE9IjI5LjAwMDAwMCIgeTE9IjAuMDAwMDAwIiB4Mj0iMjkuMDAwMDAwIiB5Mj0iNjcuMDAwMDAwIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CgkJCTxzdG9wIHN0b3AtY29sb3I9IiNCMkVFQkQiLz4KCQkJPHN0b3Agb2Zmc2V0PSIwLjk5MDU5MCIgc3RvcC1jb2xvcj0iIzYyREI3QSIgc3RvcC1vcGFjaXR5PSIwLjE3NjQ3MSIvPgoJCTwvbGluZWFyR3JhZGllbnQ+CgkJPGxpbmVhckdyYWRpZW50IGlkPSJwYWludF9saW5lYXJfMzdfNjQ5XzAiIHgxPSIyOS4wMDQxOTgiIHkxPSI3LjczMDcxMyIgeDI9IjI5LjAwNDE5OCIgeTI9IjYwLjEyODE0NyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgoJCQk8c3RvcCBzdG9wLWNvbG9yPSIjOThFM0E3IiBzdG9wLW9wYWNpdHk9IjAuMjIzNTI5Ii8+CgkJCTxzdG9wIG9mZnNldD0iMS4wMDAwMDAiIHN0b3AtY29sb3I9IiM4N0UxOTgiIHN0b3Atb3BhY2l0eT0iMC45MTc2NDciLz4KCQk8L2xpbmVhckdyYWRpZW50PgoJPC9kZWZzPgoJPHBhdGggaWQ9InBhdGgiIGQ9Ik0yOS4xOTcgMEMyMi4zNjc3IDUuMzcyNDQgMTIuNTkyNyAxMC42MzQ5IDAgMTAuNjM0OUwwIDM1Ljg5ODFDMCA0Ny4xNDU4IDE2LjYwNDQgNjcgMjkuMjA0MyA2N0M0MS44MDQ0IDY3IDU4IDQ3LjEzODMgNTggMzUuODk4MUw1OCAxMC42MzQ5QzQ1LjM4NTMgMTAuNjM0OSAzNi4wMjY0IDUuMzcyNDQgMjkuMTk3IDBaTTUyLjAyOTQgMzUuNjQ3NUM1Mi4wMjk0IDQ1LjI4OTQgMzkuNjI1NCA2MC4yOTIyIDI4LjgyNjMgNjAuMjkyMkMxOC4wMiA2MC4yOTIyIDYuMjUzNzggNDUuNDEyNSA2LjI1Mzc4IDM1Ljc3MDVMNi4yNTM3OCAxNS41NTYyQzE3LjA1MjcgMTUuNTU2MiAyMy4zNDU1IDEyLjM1MjIgMjkuMjA0MyA3LjczNzU1QzM1LjA0ODYgMTIuMzM3MiA0MS4yMzA1IDE1LjQ2MTUgNTIuMDI5NCAxNS40NjE1TDUyLjAyOTQgMzUuNjQ3NVoiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0idXJsKCNwYWludF9saW5lYXJfMzdfNjQ4XzApIiBmaWxsLW9wYWNpdHk9IjAuMzUwMDAwIi8+Cgk8cGF0aCBpZD0icGF0aCIgZD0iTTI5LjEzNDUgNy43MzA3MUMyMy40NTU5IDEyLjg4NDUgMTUuNjYzIDE1LjQ2MTQgNS45NzkgMTUuNDYxNEw2LjM5NzA5IDM2LjUwNjNDNi44MjM0OSA0My44MDc2IDE2LjA4NDQgNjAuMTI4MiAyOC44NDM5IDYwLjEyODJDMzguODA4OCA2MC4xMjgyIDUyLjQ1NTggNDYuMzg0NSA1MS45NzU4IDM0Ljk5MDFMNTIuMDI5NCAxNS40NjE0QzQwLjE0MTggMTUuNDYxNCAzNC4zODY1IDExLjY5NTggMjkuMTM0NSA3LjczMDcxWk00Ni43NzI2IDM0Ljk5QzQ2Ljc3MjYgNDIuMTA2MiAzNy4xNDg0IDUzLjA4ODEgMjguODQzOSA1My4wODgxQzIwLjUzMzcgNTMuMDg4MSAxMS40ODUyIDQyLjEwNjIgMTEuNDg1MiAzNC45OUwxMS40ODUyIDIwLjA3MDlDMTkuNzg5OCAyMC4wNzA5IDI0LjYyODkgMTcuNzA2MiAyOS4xMzQ1IDE0LjMwMDRDMzMuNjI4OSAxNy42OTUxIDM4LjQ3MzYgMjAuMDcwOSA0Ni43NzgzIDIwLjA3MDlMNDYuNzcyNiAzNC45OVoiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0idXJsKCNwYWludF9saW5lYXJfMzdfNjQ5XzApIiBmaWxsLW9wYWNpdHk9IjAuNDAwMDAwIi8+Cjwvc3ZnPgo=)}.icon-img-danger[data-v-13e5c800]{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTguMDAwMDAwIiBoZWlnaHQ9IjY3LjAwMDAwMCIgdmlld0JveD0iMCAwIDU4IDY3IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KCTxkZXNjPgoJCQlDcmVhdGVkIHdpdGggUGl4c28uCgk8L2Rlc2M+Cgk8ZGVmcz4KCQk8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50X2xpbmVhcl82NF85M18wIiB4MT0iMjkuMDAwMDAwIiB5MT0iMC4wMDAwMDAiIHgyPSIyOS4wMDAwMDAiIHkyPSI2Ny4wMDAwMDAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KCQkJPHN0b3Agc3RvcC1jb2xvcj0iI0ZGQjNCMyIgc3RvcC1vcGFjaXR5PSIwLjkxNzY0NyIvPgoJCQk8c3RvcCBvZmZzZXQ9IjEuMDAwMDAwIiBzdG9wLWNvbG9yPSIjRjc5Njk2IiBzdG9wLW9wYWNpdHk9IjAuMjMxMzczIi8+CgkJPC9saW5lYXJHcmFkaWVudD4KCQk8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50X2xpbmVhcl82NF85NF8wIiB4MT0iMjkuMDA0MTk4IiB5MT0iNy43MzA3MTMiIHgyPSIyOS4wMDQxOTgiIHkyPSI2MC4xMjgxNDciIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KCQkJPHN0b3Agc3RvcC1jb2xvcj0iI0UzOTg5OCIgc3RvcC1vcGFjaXR5PSIwLjIyMzUyOSIvPgoJCQk8c3RvcCBvZmZzZXQ9IjEuMDAwMDAwIiBzdG9wLWNvbG9yPSIjRkZCM0IzIiBzdG9wLW9wYWNpdHk9IjAuOTE3NjQ3Ii8+CgkJPC9saW5lYXJHcmFkaWVudD4KCTwvZGVmcz4KCTxwYXRoIGlkPSJwYXRoIiBkPSJNMjkuMTk3IDBDMjIuMzY3NyA1LjM3MjQ0IDEyLjU5MjcgMTAuNjM0OSAwIDEwLjYzNDlMMCAzNS44OTgxQzAgNDcuMTQ1OCAxNi42MDQ0IDY3IDI5LjIwNDMgNjdDNDEuODA0NCA2NyA1OCA0Ny4xMzgzIDU4IDM1Ljg5ODFMNTggMTAuNjM0OUM0NS4zODUzIDEwLjYzNDkgMzYuMDI2NCA1LjM3MjQ0IDI5LjE5NyAwWk01Mi4wMjk0IDM1LjY0NzVDNTIuMDI5NCA0NS4yODk0IDM5LjYyNTQgNjAuMjkyMiAyOC44MjYzIDYwLjI5MjJDMTguMDIgNjAuMjkyMiA2IDQ1LjY0MiA2IDM2TDYgMTUuNUMxNi43OTkgMTUuNSAyMy4zNDU1IDEyLjM1MjIgMjkuMjA0MyA3LjczNzU1QzM1LjA0ODYgMTIuMzM3MiA0MS4yMzA1IDE1LjQ2MTUgNTIuMDI5NCAxNS40NjE1TDUyLjAyOTQgMzUuNjQ3NVoiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0idXJsKCNwYWludF9saW5lYXJfNjRfOTNfMCkiIGZpbGwtb3BhY2l0eT0iMC4zNTAwMDAiLz4KCTxwYXRoIGlkPSJwYXRoIiBkPSJNMjkuMTM0NSA3LjczMDcxQzIzLjQ1NTkgMTIuODg0NSAxNS42NjMgMTUuNDYxNCA1Ljk3OSAxNS40NjE0TDUuOTc5IDM2LjVDNi40MDU1MiA0My44MDEzIDE2LjA4NDQgNjAuMTI4MiAyOC44NDM5IDYwLjEyODJDMzguODA4OCA2MC4xMjgyIDUyLjQ1NTggNDYuMzg0NSA1MS45NzU4IDM0Ljk5MDFMNTIuMDI5NCAxNS40NjE0QzQwLjE0MTggMTUuNDYxNCAzNC4zODY1IDExLjY5NTggMjkuMTM0NSA3LjczMDcxWk00Ni43NzI2IDM0Ljk5QzQ2Ljc3MjYgNDIuMTA2MiAzNy4xNDg0IDUzLjA4ODEgMjguODQzOSA1My4wODgxQzIwLjUzMzcgNTMuMDg4MSAxMS40ODUyIDQyLjEwNjIgMTEuNDg1MiAzNC45OUwxMS40ODUyIDIwLjA3MDlDMTkuNzg5OCAyMC4wNzA5IDI0LjYyODkgMTcuNzA2MiAyOS4xMzQ1IDE0LjMwMDRDMzMuNjI4OSAxNy42OTUxIDM4LjQ3MzYgMjAuMDcwOSA0Ni43NzgzIDIwLjA3MDlMNDYuNzcyNiAzNC45OVoiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0idXJsKCNwYWludF9saW5lYXJfNjRfOTRfMCkiIGZpbGwtb3BhY2l0eT0iMC4zNDAwMDAiLz4KPC9zdmc+Cg==)}.icon-img-warn[data-v-13e5c800]{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTguMDAwMDAwIiBoZWlnaHQ9IjY3LjAwMDAwMCIgdmlld0JveD0iMCAwIDU4IDY3IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KCTxkZXNjPgoJCQlDcmVhdGVkIHdpdGggUGl4c28uCgk8L2Rlc2M+Cgk8ZGVmcz4KCQk8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50X2xpbmVhcl83Nl81Nl8wIiB4MT0iMjkuMDAwMDAwIiB5MT0iMC4wMDAwMDAiIHgyPSIyOS4wMDAwMDAiIHkyPSI2Ny4wMDAwMDAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KCQkJPHN0b3Agc3RvcC1jb2xvcj0iI0YwQUQ0RSIvPgoJCQk8c3RvcCBvZmZzZXQ9IjEuMDAwMDAwIiBzdG9wLWNvbG9yPSIjRkNGMERGIi8+CgkJPC9saW5lYXJHcmFkaWVudD4KCQk8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50X2xpbmVhcl83Nl81N18wIiB4MT0iMjkuMDA0NTcyIiB5MT0iNy41MDAwMDAiIHgyPSIyOS4wMDQ1NzIiIHkyPSI2MC4zOTc0MzQiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KCQkJPHN0b3Agc3RvcC1jb2xvcj0iI0ZDRjBERiIvPgoJCQk8c3RvcCBvZmZzZXQ9IjEuMDAwMDAwIiBzdG9wLWNvbG9yPSIjRjBBRDRFIi8+CgkJPC9saW5lYXJHcmFkaWVudD4KCTwvZGVmcz4KCTxwYXRoIGlkPSJwYXRoIiBkPSJNMjkuMTk3IDBDMjIuMzY3NyA1LjM3MjQ0IDEyLjU5MjcgMTAuNjM0OSAwIDEwLjYzNDlMMCAzNS44OTgxQzAgNDcuMTQ1OCAxNi42MDQ0IDY3IDI5LjIwNDMgNjdDNDEuODA0NCA2NyA1OCA0Ny4xMzgzIDU4IDM1Ljg5ODFMNTggMTAuNjM0OUM0NS4zODUzIDEwLjYzNDkgMzYuMDI2NCA1LjM3MjQ0IDI5LjE5NyAwWk01Mi4wMjk0IDM1LjY0NzVDNTIuMDI5NCA0NS4yODk0IDM5LjYyNTQgNjAuMjkyMiAyOC44MjYzIDYwLjI5MjJDMTguMDIgNjAuMjkyMiA2IDQ1LjY0MiA2IDM2TDYgMTUuNUMxNi43OTkgMTUuNSAyMy4zNDU1IDEyLjM1MjIgMjkuMjA0MyA3LjczNzU1QzM1LjA0ODYgMTIuMzM3MiA0MS4yMzA1IDE1LjQ2MTUgNTIuMDI5NCAxNS40NjE1TDUyLjAyOTQgMzUuNjQ3NVoiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0idXJsKCNwYWludF9saW5lYXJfNzZfNTZfMCkiIGZpbGwtb3BhY2l0eT0iMC4zNTAwMDAiLz4KCTxwYXRoIGlkPSJwYXRoIiBkPSJNMjkuMTU1NSA3LjVDMjMuNDc2OSAxMi42NTM4IDE1LjY4NCAxNS41IDYgMTUuNUw2IDM2Ljc2OTNDNi40MjY1MSA0NC4wNzA2IDE2LjEwNTMgNjAuMzk3NSAyOC44NjQ5IDYwLjM5NzVDMzguODI5OCA2MC4zOTc1IDUyLjQ3NjggNDYuNjUzOCA1MS45OTY4IDM1LjI1OTRMNTEuOTk2OCAxNS41QzQwLjEwOTMgMTUuNSAzNC40MDc1IDExLjQ2NTEgMjkuMTU1NSA3LjVaTTQ2Ljc5MzYgMzUuMjU5M0M0Ni43OTM2IDQyLjM3NTUgMzcuMTY5NCA1My4zNTc0IDI4Ljg2NDkgNTMuMzU3NEMyMC41NTQ3IDUzLjM1NzQgMTEuNTA2MiA0Mi4zNzU1IDExLjUwNjIgMzUuMjU5M0wxMS41MDYyIDIwLjM0MDJDMTkuODEwOCAyMC4zNDAyIDI0LjY0OTkgMTcuOTc1NSAyOS4xNTU1IDE0LjU2OTdDMzMuNjQ5OSAxNy45NjQ0IDM4LjQ5NDYgMjAuMzQwMiA0Ni43OTkzIDIwLjM0MDJMNDYuNzkzNiAzNS4yNTkzWiIgZmlsbC1ydWxlPSJub256ZXJvIiBmaWxsPSJ1cmwoI3BhaW50X2xpbmVhcl83Nl81N18wKSIgZmlsbC1vcGFjaXR5PSIwLjM0MDAwMCIvPgo8L3N2Zz4K)}.icon-img-low-risk[data-v-13e5c800]{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTguMDAwMDAwIiBoZWlnaHQ9IjY3LjAwMDAwMCIgdmlld0JveD0iMCAwIDU4IDY3IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KCTxkZXNjPgoJCQlDcmVhdGVkIHdpdGggUGl4c28uCgk8L2Rlc2M+Cgk8ZGVmcz4KCQk8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50X2xpbmVhcl82NF8yNDNfMCIgeDE9IjI5LjAwMDAwMCIgeTE9IjAuMDAwMDAwIiB4Mj0iMjkuMDAwMDAwIiB5Mj0iNjcuMDAwMDAwIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CgkJCTxzdG9wIHN0b3AtY29sb3I9IiNFOEQ1NDQiLz4KCQkJPHN0b3Agb2Zmc2V0PSIxLjAwMDAwMCIgc3RvcC1jb2xvcj0iI0ZGRUY3OSIgc3RvcC1vcGFjaXR5PSIwLjI3MDU4OCIvPgoJCTwvbGluZWFyR3JhZGllbnQ+CgkJPGxpbmVhckdyYWRpZW50IGlkPSJwYWludF9saW5lYXJfNjRfMjQ0XzAiIHgxPSIyOS4wMDQ1NzIiIHkxPSI3LjUwMDAwMCIgeDI9IjI5LjAwNDU3MiIgeTI9IjYwLjM5NzQzNCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgoJCQk8c3RvcCBzdG9wLWNvbG9yPSIjRkZFRjc5IiBzdG9wLW9wYWNpdHk9IjAuMTA5ODA0Ii8+CgkJCTxzdG9wIG9mZnNldD0iMS4wMDAwMDAiIHN0b3AtY29sb3I9IiNFOEQ1NDQiLz4KCQk8L2xpbmVhckdyYWRpZW50PgoJPC9kZWZzPgoJPHBhdGggaWQ9InBhdGgiIGQ9Ik0yOS4xOTcgMEMyMi4zNjc3IDUuMzcyNDQgMTIuNTkyNyAxMC42MzQ5IDAgMTAuNjM0OUwwIDM1Ljg5ODFDMCA0Ny4xNDU4IDE2LjYwNDQgNjcgMjkuMjA0MyA2N0M0MS44MDQ0IDY3IDU4IDQ3LjEzODMgNTggMzUuODk4MUw1OCAxMC42MzQ5QzQ1LjM4NTMgMTAuNjM0OSAzNi4wMjY0IDUuMzcyNDQgMjkuMTk3IDBaTTUyLjAyOTQgMzUuNjQ3NUM1Mi4wMjk0IDQ1LjI4OTQgMzkuNjI1NCA2MC4yOTIyIDI4LjgyNjMgNjAuMjkyMkMxOC4wMiA2MC4yOTIyIDYgNDUuNjQyIDYgMzZMNiAxNS41QzE2Ljc5OSAxNS41IDIzLjM0NTUgMTIuMzUyMiAyOS4yMDQzIDcuNzM3NTVDMzUuMDQ4NiAxMi4zMzcyIDQxLjIzMDUgMTUuNDYxNSA1Mi4wMjk0IDE1LjQ2MTVMNTIuMDI5NCAzNS42NDc1WiIgZmlsbC1ydWxlPSJub256ZXJvIiBmaWxsPSJ1cmwoI3BhaW50X2xpbmVhcl82NF8yNDNfMCkiIGZpbGwtb3BhY2l0eT0iMC4zNTAwMDAiLz4KCTxwYXRoIGlkPSJwYXRoIiBkPSJNMjkuMTU1NSA3LjVDMjMuNDc2OSAxMi42NTM4IDE1LjY4NCAxNS41IDYgMTUuNUw2IDM2Ljc2OTNDNi40MjY1MSA0NC4wNzA2IDE2LjEwNTMgNjAuMzk3NSAyOC44NjQ5IDYwLjM5NzVDMzguODI5OCA2MC4zOTc1IDUyLjQ3NjggNDYuNjUzOCA1MS45OTY4IDM1LjI1OTRMNTEuOTk2OCAxNS41QzQwLjEwOTMgMTUuNSAzNC40MDc1IDExLjQ2NTEgMjkuMTU1NSA3LjVaTTQ2Ljc5MzYgMzUuMjU5M0M0Ni43OTM2IDQyLjM3NTUgMzcuMTY5NCA1My4zNTc0IDI4Ljg2NDkgNTMuMzU3NEMyMC41NTQ3IDUzLjM1NzQgMTEuNTA2MiA0Mi4zNzU1IDExLjUwNjIgMzUuMjU5M0wxMS41MDYyIDIwLjM0MDJDMTkuODEwOCAyMC4zNDAyIDI0LjY0OTkgMTcuOTc1NSAyOS4xNTU1IDE0LjU2OTdDMzMuNjQ5OSAxNy45NjQ0IDM4LjQ5NDYgMjAuMzQwMiA0Ni43OTkzIDIwLjM0MDJMNDYuNzkzNiAzNS4yNTkzWiIgZmlsbC1ydWxlPSJub256ZXJvIiBmaWxsPSJ1cmwoI3BhaW50X2xpbmVhcl82NF8yNDRfMCkiIGZpbGwtb3BhY2l0eT0iMC4zNDAwMDAiLz4KPC9zdmc+Cg==)}.scan-icon-img-bg[data-v-13e5c800]{position:absolute;left:0;right:0;top:0;bottom:0;z-index:50;margin:auto;display:inline-block;width:100px;height:100px;border-radius:100%;background:radial-gradient(50% 50% at 50% 50%,rgba(255,255,255,.2) 54.962%,rgba(122,227,142,.2))}.animate-box[data-v-13e5c800]{position:relative;width:100px;height:100px;animation:rotate-13e5c800 3s linear infinite}.animate-box-left[data-v-13e5c800]{z-index:55;width:50px;height:100px;border-radius:50px 0 0 50px}.animate-box-right[data-v-13e5c800]{position:absolute;left:50%;z-index:55;height:100px;--un-bg-opacity:1;background-color:rgb(255 255 255 / var(--un-bg-opacity));border-radius:0 50px 50px 0}.animate-box-bottom[data-v-13e5c800]{position:absolute;top:.4rem;left:.4rem;z-index:2;width:92px;height:92px;border-radius:50%;background:radial-gradient(50% 50% at 50% 50%,rgba(255,255,255,.2) 54.962%,rgba(122,227,142,.2))}.circle-inner[data-v-13e5c800]{position:absolute;left:0;top:0;bottom:0;right:0;z-index:55;margin:auto;display:inline-block;width:96px;height:96px;border-radius:100%;--un-bg-opacity:1;background-color:rgb(255 255 255 / var(--un-bg-opacity))}.circle-outer[data-v-13e5c800]{position:absolute;left:0;top:0;bottom:0;right:0;z-index:55;margin:auto;width:100px;height:100px;border-radius:100%}.linear-safe[data-v-13e5c800]{background:linear-gradient(#20a53a,#fff)}.linear-danger[data-v-13e5c800]{background:linear-gradient(#ef0808,#fff)}.linear-warn[data-v-13e5c800]{background:linear-gradient(#f0ad4e,#fff)}.linear-risk[data-v-13e5c800]{background:linear-gradient(#e8d544,#fff)}.safe[data-v-13e5c800]{background:radial-gradient(50% 50% at 50% 50%,rgba(255,255,255,.2) 54.962%,rgba(122,227,142,.2))}.danger[data-v-13e5c800]{background:radial-gradient(50% 50% at 50% 50%,rgba(255,255,255,.2) 54.962%,rgba(255,0,0,.2))}.risk[data-v-13e5c800]{background:radial-gradient(50% 50% at 50% 50%,rgba(240,173,78,0) 58.015%,rgba(232,213,68,.2))}.warn[data-v-13e5c800]{background:radial-gradient(50% 50% at 50% 50%,rgba(240,173,78,0) 58.015%,rgba(240,173,78,.2))}.box-text[data-v-13e5c800]{position:absolute;left:0;right:0;top:0;bottom:0;z-index:99;margin:auto;width:78px;height:50px;display:flex;align-items:center;justify-content:center;font-size:3.2rem;font-weight:700;line-height:4.5rem}.box-text span[data-v-13e5c800]{margin-top:16px;font-size:1.8rem}.module-list[data-v-72d45b6c]::-webkit-scrollbar{width:10px;height:5px}.module-list[data-v-72d45b6c]::-webkit-scrollbar-thumb{box-shadow:inset 0 0 .5rem rgba(0,0,0,.2);background-color:#999}.module-item[data-v-72d45b6c]{font-size:1.25rem}.module-head[data-v-72d45b6c]{border-bottom:1px solid #ececec;color:#555;transition:background .3s}.module-head[data-v-72d45b6c]:nth-child(1){border-top:1px solid #ececec}.module-head[data-v-72d45b6c]:hover{background-color:#f5f7fa}.module-body[data-v-72d45b6c]{border-bottom-width:1px;--un-border-opacity:1;border-color:rgb(236 236 236 / var(--un-border-opacity));padding:1rem 1.5rem 1rem 2.5rem;--un-text-opacity:1;color:rgb(102 102 102 / var(--un-text-opacity))}.collapse-item[data-v-72d45b6c]{width:48rem;border-radius:2px;font-size:1.2rem;--un-text-opacity:1;color:rgb(102 102 102 / var(--un-text-opacity));margin-left:1rem;border-width:1px;--un-border-opacity:1;border-color:rgb(235 238 245 / var(--un-border-opacity));--un-bg-opacity:1;background-color:rgb(255 255 255 / var(--un-bg-opacity));padding:.6rem 1.6rem;display:flex;align-items:center;line-height:1.8rem}.n-progress.n-progress--circle[data-v-0a5f55f9],.n-progress.n-progress--dashboard[data-v-0a5f55f9]{width:100px!important}.progress-header[data-v-0a5f55f9]{display:flex;align-items:center;height:140px;padding:20px;text-align:center}.progresscircle[data-v-0a5f55f9]{position:absolute;top:8px;left:25px}.progresscircle p[data-v-0a5f55f9]{padding:5px 0;font-size:13px;font-weight:700}.progresscirclebar[data-v-0a5f55f9]{position:relative;width:100px;height:100px;line-height:100px;font-size:18px}.progresscirclebar span[data-v-0a5f55f9]:nth-child(1){font-size:24px}.progresscirclebar.active svg[data-v-0a5f55f9]{-webkit-animation:load8 1.1s infinite linear;animation:load8 1.1s infinite linear}.progress-header-cot[data-v-0a5f55f9]:nth-child(1),.progress-header-cot[data-v-0a5f55f9]:nth-child(3){min-width:100px;position:relative}.progress-header-cot[data-v-0a5f55f9]:nth-child(3){display:flex}.progress-header-cot[data-v-0a5f55f9]:nth-child(2){width:100%;padding:0 40px}.progress-header-cot button.cancel_detect[data-v-0a5f55f9]{border-color:#999;color:#666;background-color:#fff;font-size:15px}.progress-header-cot button.cancel_detect[data-v-0a5f55f9]:hover{color:#fc6d26;background:rgba(252,109,38,.1);border-color:rgba(252,109,38,.2)}.scanning-progress-title[data-v-0a5f55f9]{text-align:left;font-weight:700;margin:15px 0;font-size:20px}.scanning-progress-title img[data-v-0a5f55f9]{margin-right:10px;vertical-align:sub;width:24px}.scanning-progress-title span[data-v-0a5f55f9]{color:#fc6d26}.scanning-progress-cont[data-v-0a5f55f9]{text-align:left;margin:15px 0;font-size:14px}.progress_item[data-v-9d0196ea]{margin:0 20px 6px;padding:0 20px;background-color:#f7f7f7;border-radius:4px;border:1px solid transparent}.progress_item_header[data-v-9d0196ea]{height:30px;line-height:30px;display:flex;justify-content:space-between;border-radius:4px;cursor:pointer;font-size:12px;color:#555}.progress_item_header .progress_type[data-v-9d0196ea]{display:flex;align-items:center;width:59.5%;font-weight:700;line-height:22px}.progress_item_header .progress_type .title-icon[data-v-9d0196ea]{width:14px;margin-right:6px}.progress_item_header .progress_status[data-v-9d0196ea]{flex:1}.progress-cont-list[data-v-9d0196ea]{overflow:auto;max-height:390px}.progress_item_body[data-v-9d0196ea]{line-height:30px;display:none;font-size:12px}.progress_item.active .progress_item_body[data-v-9d0196ea]{display:block}.progress_item_info[data-v-9d0196ea]{margin-bottom:6px}.progress_item_info .info_cont[data-v-9d0196ea]{display:flex;color:#666;padding:0 30px}.progress_item_info .info_cont div[data-v-9d0196ea]:nth-child(1){width:60%}.progress_item_info .info_cont div[data-v-9d0196ea]:nth-child(2){width:40%}.progress_item_info .info_cont div:nth-child(2) span[data-v-9d0196ea]{font-weight:600}.progress_item_info.active[data-v-9d0196ea]{background-color:rgba(252,109,38,.1);padding:0}.progress_item_info.active .info_cont[data-v-9d0196ea]{margin:0 20px;padding:0 10px;border-bottom:1px dashed #d9d9d9}.progress_item_info.active .info_cont_desc[data-v-9d0196ea]{color:#888;border-radius:4px;padding:0 30px}.progress_item_info.active[data-v-9d0196ea]:hover{background-color:rgba(252,109,38,.2)}.progress_item_info[data-v-9d0196ea]:hover{background-color:#efefef}.btn_red[data-v-9d0196ea]{font-weight:700;margin-left:5px;padding:1px 5px;text-align:center;border-radius:3px;color:#fff;background:red}[data-v-9d0196ea] .n-progress__text{font-size:16px!important;font-weight:700}.scrollable[data-v-9d0196ea]::-webkit-scrollbar{width:10px}.scrollable[data-v-9d0196ea]::-webkit-scrollbar-track{background:#efefef}.scrollable[data-v-9d0196ea]::-webkit-scrollbar-thumb{background:#bfbfbf;border-radius:10px}.scrollable[data-v-9d0196ea]::-webkit-scrollbar-thumb:hover{background:#555}\n',document.head.appendChild(rt);const nt=e("a",M("home-security",(()=>{const e=h("overview"),t=h({score:85,scoreLevel:"Good",riskNum:3,subtitle:"The overall security status of the system is good. It is recommended to check the security configuration regularly."}),a=h({day:1,time:"--",virus:"--"}),l=h({risk_scan:{status:!1,icon:"home-risk",name:"Risk Scan"},safe_detect:{status:!1,icon:"home-safeDetect",name:"Safety Testing"},file_detection:{status:!1,icon:"home-ware",name:"Malicious file detection"},vul_scan:{status:!1,icon:"home-web",name:"Vulnerability Scanning"},tamper:{status:!1,icon:"home-tamper",name:"Tamper-proof"}}),s=h([{title:"Bug",type:"loophole",tips:"Timely discovery of vulnerabilities in the website and timely upgrade of the version can prevent hackers from taking advantage of the situation.",value:0},{title:"Malicious files",type:"file",tips:"Detection of malicious files (such as viruses, Trojans) that may steal information or damage the system",value:0},{title:"Risk",type:"risk",tips:"Conduct comprehensive inspections on websites/panel/systems to eliminate hidden risks",value:0},{title:"Baseline issues",type:"server",tips:"Check whether the server configuration meets security standards",value:0},{title:"Tamper-proof",type:"tamper",tips:"Tamper-proof for Enterprise：Real-time protection to see if web page content is illegally modified",value:0}]);return{menu:e,scoreData:t,safe:a,capabilitySwitch:l,risk_details:s,getSafeOverviewData:async()=>{const{message:e}=await X();if(i(e)){const{security_status:i,risk_details:r}=e;t.value.score=e.score,t.value.scoreLevel=e.level,t.value.riskNum=e.risk_count,t.value.subtitle=e.level_description,a.value.day=e.protect_days,a.value.time=e.risk_scan_time.slice(0,10)||"-",a.value.virus=e.virus_update_time.slice(0,10)||"-",l.value.risk_scan.status=i.risk_scan,l.value.safe_detect.status=i.safe_detect,l.value.file_detection.status=i.file_detection,l.value.vul_scan.status=i.vul_scan,l.value.tamper.status=i.tamper,s.value[0].value=r.vul_scan.total||0,s.value[1].value=r.file_detection.total||0,s.value[2].value=r.homepage_risk.total||0,s.value[3].value=r.safe_detect.total||0,s.value[4].value=r.tamper.total||0}}}}))),ot=nt(),{risk_details:ct}=b(ot),ut=w({props:{value:{type:Number,required:!0},iconName:{type:String,required:!0}},setup:e=>()=>k(_,null,[k(l,{size:32,name:e.iconName},null),e.value>0?k("div",{class:"absolute top-15px right-20px bg-red-500 text-white rounded-full px-2 py-1 text-xs"},[e.value]):""])}),dt=e=>ct.value.find((t=>t.type===e))?.value||0,mt=e("r",(e=>{switch(e){case 1:return{text:"Medium",style:"color: #FF9900"};case 2:return{text:"High",style:"color: #FF0000"};case 3:return{text:"Urgent",style:"color: #ba281e"};default:return{text:"--",style:"color: #000000"}}})),pt=M("home-security-file",(()=>{const e=h({status:!1,isHasMounts:!1}),t=h(!1),a=h(!1),l=h("--"),s=h([{title:"Total Scanned",value:0,style:"color: #333"},{title:"High risk",value:0,style:"color: #F50606;",id:2},{title:"Moderate",value:0,style:"color: #FF9900",id:1},{title:"Low risk",value:0,style:"color: #DDC400",id:0}]),r=h([]),n=h([]);return{lastScanTime:l,riskLevelsOverview:s,dynamicKill:t,autoIntercept:a,ossConfig:e,monitorPath:r,excludePath:n,getConfig:async()=>{const{message:l}=await K();if(i(l)){const i=l.data;a.value=i.quarantine,t.value=i.dynamic_detection,e.value={status:i.scan_oss,isHasMounts:i.has_oss_mounts},r.value=i.monitor_dirs.map((e=>({path:e}))),n.value=i.exclude_dirs.map((e=>({path:e})))}}}})),gt={class:"text-right text-[#666] mb-2"},vt={class:"infoList"},yt={class:"text-[1.2rem] text-[#666] mb-[1.6rem]"},xt=w({__name:"file-info",setup(e){const t=pt(),{lastScanTime:a,riskLevelsOverview:i}=b(t);return(e,t)=>(I(),N("div",null,[D("div",gt,j(e.$t("Home.Security.index_9"))+"："+j(S(a)),1),D("div",vt,[(I(!0),N(_,null,A(S(i),(e=>(I(),N("div",{class:"flex-1 text-center item-list",key:e.title},[D("div",yt,j(e.title),1),D("div",{class:"text-[2.4rem]",style:z(e.style)},j(e.value),5)])))),128))])]))}}),ft=s(xt,[["__scopeId","data-v-ab2cfe5b"]]),Mt={class:"p-20px h-full"},ht={class:"relative"},bt={class:"flex items-center absolute right-0 top-0"},wt={class:"mr-[.8rem]"},kt={key:0},_t={key:1},It=w({__name:"file-advanced",setup(e){const{t:t}=T(),a=pt(),{autoIntercept:i,dynamicKill:l,monitorPath:s,excludePath:n}=b(a),o=h("monitor"),c=[{key:"monitor",label:"Monitor Directory"},{key:"exclude",label:"Exclude Directory"},{key:"ignore",label:"Ignore File"}],u=h(""),{keys:d,table:m,columns:p}=_e([{title:t("Site.DelSite.index_2"),key:"path",width:200},Ie({width:100,options:e=>[{label:t("Public.Btn.Del"),onClick:async()=>{if("ignore"===o.value)return await q({md5:e.md5}),void w();Ne({title:"ignore"===o.value?t("Public.Btn.Cancel"):t("Public.Btn.Del"),content:`Are you sure you want to delete this path? [${e.path}]`,onConfirm:async()=>{const t="monitor"===o.value;await ee({[t?"delete_monitor_path":"delete_exclude_path"]:e.path}),await a.getConfig(),m.data=t?s.value:n.value}})}}]})]),g=C((()=>{const e=p.value;if("ignore"===o.value){const[a,...i]=e;return[a,{title:"MD5",key:"md5"},{title:t("Config.Safe.index_152"),key:"time",width:150},...i]}return e})),v=async e=>{const a=e?"Whether to enable automatic isolation (not recommended), this feature will have a probability of isolating normal files.":"Whether dynamic detection is turned off, this feature will make it possible to isolate normal files.";Ne({title:t("Home.Security.index_25"),content:a,onConfirm:async()=>{await ee({quarantine:e,dynamic_detection:l.value}),i.value=e}})},y=async()=>{const e="monitor"===o.value;await ee({[e?"add_monitor_path":"add_exclude_path"]:u.value}),await a.getConfig(),u.value="",m.data=e?s.value:n.value},x=async e=>{o.value=e,"monitor"===e?m.data=s.value:"exclude"===e?m.data=n.value:await w()},{loading:f,setLoading:M}=De(),w=async()=>{try{M(!0);const{message:e}=await te();r(e)&&(m.data=e.map((e=>({path:e.filepath,md5:e.md5_to_add,time:e.timestamp}))))}finally{M(!1)}};return(async()=>{m.data=s.value})(),(e,t)=>{const a=Pe,l=We,s=Ye,r=Ee,n=je,p=Qe,M=Se;return I(),N("div",Mt,[D("div",ht,[k(a,{value:S(o),"onUpdate:value":[t[0]||(t[0]=e=>L(o)?o.value=e:null),x],options:c},null,8,["value"]),D("div",bt,[D("span",wt,j(e.$t("Home.Security.index_25")),1),k(l,{value:S(i),size:"small","onUpdate:value":v},null,8,["value"])])]),k(p,null,O({table:Q((()=>[k(n,{keys:S(d),"onUpdate:keys":t[2]||(t[2]=e=>L(d)?d.value=e:null),"row-key":"path",data:S(m).data,columns:S(g),"max-height":300,loading:S(f)},null,8,["keys","data","columns","loading"])])),_:2},["ignore"!==S(o)?{name:"toolsLeft",fn:Q((()=>[k(s,{class:"w-[350px]",value:S(u),"onUpdate:value":t[1]||(t[1]=e=>L(u)?u.value=e:null),placeholder:e.$t("Site.Placeholder.Index_5")},null,8,["value","placeholder"]),k(r,{type:"primary",onClick:y},{default:Q((()=>[U(j(e.$t("Public.Btn.Add")),1)])),_:1})])),key:"0"}:void 0]),1024),k(M,{class:"mt-16px"},{default:Q((()=>["ignore"!==S(o)?(I(),N("li",kt,"Avoid adding full disk path monitoring, such as /")):H("",!0),"ignore"===S(o)?(I(),N("li",_t,"Ignore items will be matched based on the md5 value of the file, and identical files will be ignored")):H("",!0)])),_:1})])}}}),Nt={class:"flex items-center"},Dt={class:"flex items-center"},jt={class:"mr-[.8rem]"},St=w({__name:"file-switch",setup(e){const{t:t}=T(),a=pt(),{dynamicKill:i,autoIntercept:l,ossConfig:s}=b(a),r=Ae(t("Config.Alarm.index_21")),n=async e=>{const a=t(e?"Home.Security.index_28":"Home.Security.index_29"),s=t(e?"Home.Security.index_30":"Home.Security.index_31");Ne({title:a,content:s,onConfirm:async()=>{await ee({quarantine:l.value,dynamic_detection:e}),i.value=e}})};return(async()=>{await a.getConfig()})(),(e,t)=>{const a=We,l=Ee,s=ke;return I(),N("div",Nt,[H("",!0),H("",!0),k(l,{size:"small",onClick:t[0]||(t[0]=e=>S(r).show=!0)},{default:Q((()=>t[3]||(t[3]=[U("Advanced Settings")]))),_:1,__:[3]}),t[4]||(t[4]=D("span",{class:"text-[#999] mx-[1.2rem]"},"|",-1)),D("div",Dt,[D("span",jt,j(e.$t("Home.Security.index_26")),1),k(a,{value:S(i),size:"small","onUpdate:value":n},null,8,["value"])]),k(s,{show:S(r).show,"onUpdate:show":t[1]||(t[1]=e=>S(r).show=e),title:S(r).title,data:S(r).data,width:800,"min-height":500,footer:!1,component:It},null,8,["show","title","data"])])}}}),At={class:"p-16px"},zt=w({__name:"file-ignore-result",props:{data:{}},setup(e){const{t:t}=T(),a=e,{table:i,columns:l}=_e([{key:"filepath",title:t("Site.TableRow.index_2"),width:"70%"},{key:"success",title:t("Public.Table.Status"),render:e=>k("span",{class:e.success?"text-primary":"text-error"},[U(" "),e.success?t("Site.PHP.index_35"):t("Mail.Mass.index_7"),U(" ")])}]);return Y((()=>{i.data=a.data.message})),(e,t)=>{const a=je;return I(),N("div",At,[k(a,{data:S(i).data,columns:S(l),"max-height":200},null,8,["data","columns"])])}}}),Tt=w({__name:"file-list",setup(e){const a=W((()=>c((()=>t.import("./file-detail-legacy.js?v=1753954525509")),void 0))),{t:l}=T(),s=pt(),u=n(),d=nt(),{risk_details:m}=b(d),{riskLevelsOverview:p,lastScanTime:g}=b(s),v=Ae(),y=P({p:1,limit:30,day:""}),x=[{label:l("Home.Security.index_12"),value:""},{label:l("Home.Security.index_13"),value:1},{label:l("Home.Security.index_14"),value:7},{label:l("Home.Security.index_15"),value:30}],{keys:f,table:M,columns:h}=_e([{type:"selection"},{title:l("Component.SelectPath.index_3"),key:"filename",ellipsis:{tooltip:{width:"trigger"}}},{title:l("Home.Security.index_1"),key:"threat_type",width:86,render:e=>k(Re,{type:"info"},{default:()=>[e.threat_type]})},{title:"MD5",key:"md5",ellipsis:{tooltip:{width:"trigger"}}},{title:l("Account.Logs.logsState-131428-1"),key:"risk_level_desc",width:80,render:e=>{let t=p.value.find((t=>t.id===e.risk_level))?.style;return k("span",{style:t},[U(" "),e.risk_level_desc,U(" ")])}},{title:l("Home.Security.index_16"),key:"time",width:140},Ie({width:160,options:e=>[{label:l("Ftp.Table.index_8"),onClick:()=>{Ne({title:"Ignore malicious file",content:`Are you sure you want to ignore this malicious file? [${e.filename}]`,onConfirm:async()=>{const{filepath:t,md5:a}=e,{message:i}=await ae({files:JSON.stringify([{filepath:t,md5:a}])});r(i)&&(i[0].success?o.success(l("Home.Security.index_20")):o.error(i[0].message)),A()}})}},{label:l("Home.Security.index_17"),onClick:()=>{u.isFree?ze({source:399}):Ne({title:l("Home.Security.index_18"),content:l("Home.Security.index_19"),onConfirm:async()=>{await ie({file_list:JSON.stringify([{filepath:e.filepath,md5:e.md5}]),action_type:"delete"},!1),o.success(l("Home.Security.index_20")),A()}})}},{label:l("Security.Anti.Index_21"),onClick:()=>{v.data=e,v.title=`[${e.filename}] ${l("Home.Security.index_21")}`,v.show=!0}}]})]),w=[{key:"delete",type:"confirm",label:l("Home.Security.index_17"),confirm:{title:l("Crontab.Planned.index_16",[l("Home.Security.index_22")]),desc:l("Crontab.Planned.index_17",[l("Home.Security.index_22")]),columns:[h.value[1]],api:e=>ie({file_list:JSON.stringify([{filepath:e.filepath,md5:e.md5}]),action_type:"delete"},!1),done:async()=>{await A(),f.value=[]}}},{key:"ignore",label:l("Ftp.Table.index_8"),onBatch:e=>{Ne({title:l("Ftp.Table.index_8"),content:"Are you sure you want to ignore these malicious files?",onConfirm:async()=>{const{message:t}=await ae({files:JSON.stringify(e.map((e=>({filepath:e.filepath,md5:e.md5}))))});r(t)&&Te({title:l("Public.Table.Result"),width:480,data:{message:t},component:zt}),f.value=[],A()}})}}],_=e=>{y.day=e,M.data=[],A()},A=async()=>{try{M.loading=!0;const{message:e}=await le({day:y.day?y.day:null,p:y.p,limit:y.limit});if(i(e)){M.data=e.detected.map(((e,t)=>({...e,keyid:t}))),m.value[1].value=e.total_detected,g.value=e.last_scan_time;const{total_scanned_files:t,risk_stats:a}=e;p.value[0].value=t,p.value[1].value=a[2],p.value[2].value=a[1],p.value[3].value=a[0],M.total=e.total_detected}}finally{M.loading=!1}};return A(),(e,t)=>{const i=Ze,l=je,s=He,r=Ue,n=Qe,o=Se,c=ke;return I(),N("div",null,[k(n,null,{toolsLeft:Q((()=>[k(i,{value:S(y).day,"onUpdate:value":[t[0]||(t[0]=e=>S(y).day=e),_],options:x,class:"mr-[1rem] !w-[12rem]"},null,8,["value"])])),toolsRight:Q((()=>[k(St)])),table:Q((()=>[k(l,{"loading-num":3,"checked-row-keys":S(f),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>L(f)?f.value=e:null),"row-key":"keyid",loading:S(M).loading,data:S(M).data,columns:S(h),"max-height":"220px"},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:Q((()=>[k(s,{"checked-row-keys":S(f),"onUpdate:checkedRowKeys":t[2]||(t[2]=e=>L(f)?f.value=e:null),"row-key":"keyid",data:S(M).data,options:w},null,8,["checked-row-keys","data"])])),pageRight:Q((()=>[k(r,{"show-size-picker":!1,"show-quick-jumper":!1,page:S(y).p,"onUpdate:page":t[3]||(t[3]=e=>S(y).p=e),"page-size":S(y).limit,"onUpdate:pageSize":t[4]||(t[4]=e=>S(y).limit=e),"item-count":S(M).total,onRefresh:A},null,8,["page","page-size","item-count"])])),_:1}),k(o,{class:"mt-16px"},{default:Q((()=>[D("li",null,j(e.$t("Home.Security.index_10")),1),H("",!0)])),_:1}),k(c,{show:S(v).show,"onUpdate:show":t[5]||(t[5]=e=>S(v).show=e),title:S(v).title,data:S(v).data,width:500,"min-height":400,footer:!1,component:S(a)},null,8,["show","title","data","component"])])}}}),Ct={class:"text-20px"},Lt=w({__name:"index",setup:e=>(e,t)=>(I(),N(_,null,[D("div",Ct,j(e.$t("Home.Security.index_32")),1),k(ft),k(Tt)],64))}),Ot={class:"text-20px"},Qt={class:"w-250px"},Ut=w({__name:"index",setup(e){const{t:t}=T(),a=h(null),l=P({status:!0,type:[],method:[]}),s={type:{trigger:"change",type:"array",required:!0,message:t("Home.Security.index_36")},method:{trigger:"change",type:"array",required:!0,message:t("Config.Safe.index_7")}},r=()=>({status:l.status,safe_type:l.type.join(","),sender:l.method.join(",")}),n=async()=>{await(a.value?.validate()),await se(r()),r()},{loading:o,setLoading:c}=De();return(async()=>{try{c(!0);const{message:e}=await K();if(i(e)){const t=e.data;l.status=t.alertable.status,l.method=t.alertable.sender,l.type=t.alertable.safe_type}}finally{c(!1)}})(),(e,t)=>{const i=We,r=Be,c=Ge,d=Je,m=at,p=Ee,g=tt,v=u;return I(),E(v,{show:S(o)},{default:Q((()=>[D("div",Ot,j(e.$t("Home.Security.index_33")),1),k(g,{class:"p-16px",ref_key:"formRef",ref:a,model:S(l),rules:s},{default:Q((()=>[k(r,{label:e.$t("Home.Security.index_34")},{default:Q((()=>[k(i,{value:S(l).status,"onUpdate:value":t[0]||(t[0]=e=>S(l).status=e)},null,8,["value"])])),_:1},8,["label"]),k(r,{label:e.$t("Docker.App.Backup.index_5"),path:"type"},{default:Q((()=>[k(d,{value:S(l).type,"onUpdate:value":t[1]||(t[1]=e=>S(l).type=e)},{default:Q((()=>[k(c,{value:"webshell",label:e.$t("Home.Security.index_35")},null,8,["label"])])),_:1},8,["value"])])),_:1},8,["label"]),k(r,{label:e.$t("Config.Safe.index_6"),path:"method"},{default:Q((()=>[D("div",Qt,[k(m,{value:S(l).method,"onUpdate:value":t[2]||(t[2]=e=>S(l).method=e)},null,8,["value"])])])),_:1},8,["label"]),k(r,{label:" "},{default:Q((()=>[k(p,{type:"primary",onClick:n},{default:Q((()=>[U(j(e.$t("Public.Btn.Save")),1)])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["show"])}}}),Ht=n(),Yt=M("home-security-loophole",(()=>({scanRes:h([]),scanResShow:h(!1),scanContentShow:h(!0),onVulScanSwitch:()=>{Ht.isFree?ze({source:399}):Te({title:"Setting up automatic scanning",width:"550px",height:"200px",footer:!0,component:W((()=>c((()=>t.import("./risk-info-form-legacy.js?v=1753954525509")),void 0)))})}}))),Pt={class:"p-16px"},Wt={class:"mb-[2rem]"},Et={class:"flex flex-nowrap items-center justify-between"},Rt={key:0,class:"relative"},Zt={key:0,class:"loading-icon"},Bt={class:"pr-[2rem]"},Gt=["innerHTML"],Jt={class:"text-[1.6rem] mt-[1.2rem]"},Vt={class:"relative"},Ft={class:"text-[1.5rem]"},$t=w({__name:"loophole-scan",setup(e){const{t:t}=T(),a=Yt(),s=nt(),r=n(),{scanResShow:o,scanContentShow:c,scanRes:u}=b(a),p=h("success"),g=h(!1),v=h({scanTitle:t("Home.Security.index_39"),scanTime:t("Home.Security.index_40"),scanCheckButton:t("Home.Security.index_41")}),y=async()=>{if(r.isFree)ze({source:399});else{p.value="loading",v.value.scanTitle=t("Home.Security.index_42")+"...";try{g.value=!0;const{message:e}=await re();i(e)&&(v.value.scanTitle=t("Home.Security.index_43"),v.value.scanTime=`${t("Logs.Panel.index_13")}：${d(e.time)}`,v.value.scanCheckButton=t("Home.Security.index_41"),c.value=!1,e.info.length?(o.value=!1,u.value=e.info,p.value="danger",v.value.scanCheckButton=t("Home.Security.index_41"),v.value.scanTitle=`${t("Security.Anti.Index_7")} [<span class='text-primary px-2px'>${e.site_num}</span>] ${t("Home.Security.index_45")} <span class='text-error'>${e.loophole_num}</span>`):(o.value=!0,v.value.scanTitle=t("Home.Security.index_44")),s.risk_details[0].value=e.loophole_num)}catch(e){console.log(e),p.value="success"}finally{g.value=!1}}};return(async()=>{const{message:e}=await ne();if(i(e)){const{loophole_num:a,site_num:i,time:l}=e.data;a>0?(v.value.scanTitle=`<span class='text-error'>${a}</span> ${t("Home.Security.index_46")} <span class='text-primary'>${i}</span>`,v.value.scanTime=`${t("Home.Security.index_9")}:${l}`,p.value="danger",v.value.scanCheckButton=t("Home.Security.index_41")):(v.value.scanTitle=`${t("Home.Security.index_47")} ${i}`,v.value.scanTime=`${t("Home.Security.index_9")}:${l}`,v.value.scanCheckButton=t("Home.Security.index_41"),p.value="success")}})(),(e,t)=>{const i=l,s=Ve,r=Ee,n=m;return I(),N("div",Pt,[D("div",Wt,[D("div",Et,[k(s,{class:"flex-nowrap!"},{default:Q((()=>["loading"==S(p)?(I(),N("div",Rt,[S(g)?(I(),N("div",Zt)):H("",!0),k(i,{name:"home-scanning-scan",size:80,color:"#20a53a"})])):H("",!0),D("div",null,["success"==S(p)?(I(),E(i,{key:0,name:"home-scanning-success",size:80,color:"#20a53a"})):H("",!0),"danger"==S(p)?(I(),E(i,{key:1,name:"home-scanning-danger",size:80,color:"#ef0808"})):H("",!0)]),D("div",Bt,[D("div",{class:"text-[2rem] font-bold",innerHTML:S(v).scanTitle},null,8,Gt),D("div",Jt,j(S(v).scanTime),1)])])),_:1}),D("div",Vt,[k(r,{type:"primary",text:"",class:"absolute top-[5rem] right-1rem",onClick:S(a).onVulScanSwitch},{default:Q((()=>[U(j(e.$t("Home.Security.index_38"))+">> ",1)])),_:1},8,["onClick"]),k(r,{class:"h-[4rem] w-[10rem]",type:"loading"==S(p)?"default":"primary",size:"large",onClick:y},{default:Q((()=>[D("span",Ft,j(S(v).scanCheckButton),1)])),_:1},8,["type"])])])]),k(n)])}}}),Xt=s($t,[["__scopeId","data-v-a91fb030"]]),Kt={class:"px-16px"},qt={key:0,class:"info"},ea={class:"webedit-con flex items-center justify-center"},ta={class:"thumbnail-introduce mt-[0rem]"},aa={class:"text-[1.8rem] font-bold"},ia={key:1,class:"scan"},la={key:0,class:"scan-success border-[0.1rem] p-[2rem] h-[38rem] border-[#e8e8e8] flex items-center justify-center"},sa={class:"flex flex-column items-center"},ra={class:"absolute mt-[10.5rem] text-[2rem] leading-[0.14rem]"},na={key:1},oa={class:"flex items-center mb-[2rem] text-[#333]"},ca={class:"w-[26rem]"},ua={class:"overflow-auto h-[34rem] scrollable"},da={class:"w-[25rem] flex-shrink-0"},ma={class:"ml-[1.2rem]"},pa={class:"whitespace-nowrap"},ga={class:"text-[#666] text-[1.2rem] w-auto"},va={class:"flex items-center justify-between w-full"},ya={class:"flex items-center ml-[1.2rem]"},xa={class:"text-[#999] ml-[1.2rem]"},fa={class:"bg-[#f6f6f6] text-[#999] p-[2rem] ml-[1.2rem]"},Ma={class:"flex items-center"},ha=w({__name:"loophole-view",setup(e){const t=Yt(),{scanResShow:a,scanContentShow:i,scanRes:l}=b(t),s=h(["1"]),r={4:["error","Critical"],3:["warning","High"],2:["info","Medium"],1:["success","Low"]},n=e=>r[e]||["default","Unknown"];return(e,t)=>{const r=Fe,o=Se,c=Re,u=Ve,d=p,m=g,y=v;return I(),N("div",Kt,[S(i)?(I(),N("div",qt,[D("div",ea,[k(r,{class:"max-w-[90rem] mr-[4rem] w-[36rem]",width:"100%",src:S("/static/vite/images/toolview.png")},null,8,["src"]),D("div",ta,[D("span",aa,j(e.$t("Home.Security.index_49"))+"：",1),k(o,null,{default:Q((()=>[D("li",null,[U(j(e.$t("Home.Security.index_50"))+": ",1),t[1]||(t[1]=D("br",null,null,-1)),t[2]||(t[2]=U(" XunRui CMS、pbootcms、Apple CMS、eyoucms、Ocean CMS、 ")),t[3]||(t[3]=D("br",null,null,-1)),t[4]||(t[4]=U(" ThinkCMF、zfaka、dedecms、MetInfo、emlog、 ")),t[5]||(t[5]=D("br",null,null,-1)),t[6]||(t[6]=U("Empire CMS、discuz、Thinkphp、Wordpress、Z-Blog、 ")),t[7]||(t[7]=D("br",null,null,-1)),t[8]||(t[8]=U("Ultimate CMS、ShopXO、HYBBS、ECShop、SchoolCMS、 ")),t[9]||(t[9]=D("br",null,null,-1)),t[10]||(t[10]=U("phpcms、likeshop、iCMS、WellCMS、chanzhiEPS、 ")),t[11]||(t[11]=D("br",null,null,-1)),t[12]||(t[12]=U("PHPOK、LaySNS、Knight CMS、openSNS、QiBo CMS、 ")),t[13]||(t[13]=D("br",null,null,-1)),t[14]||(t[14]=U("ZZZCMS、prestashop、ThinkphpSHOP、DouPHP、 ")),t[15]||(t[15]=D("br",null,null,-1)),t[16]||(t[16]=U("cmseasy、piwigo、phpwind、XingYunHai CMS "))]),D("li",null,j(e.$t("Home.Security.index_51")),1),D("li",null,j(e.$t("Home.Security.index_52")),1)])),_:1})])])])):(I(),N("div",ia,[S(a)?(I(),N("div",la,[D("div",sa,[k(r,{class:"w-[34.0rem] h-[30.1rem]",width:"100%",src:S("/static/vite/images/secure.png"),"preview-disabled":""},null,8,["src"]),D("span",ra,j(e.$t("Home.Security.index_53")),1)])])):(I(),N("div",na,[D("div",oa,[D("span",ca,j(e.$t("Layout.Sider.site_1")),1),D("span",null,j(e.$t("Mail.MailBox.index_4")),1)]),D("div",ua,[k(y,{modelValue:S(s),"onUpdate:modelValue":t[0]||(t[0]=e=>L(s)?s.value=e:null),accordion:"","arrow-placement":"right"},{default:Q((()=>[(I(!0),N(_,null,A(S(l),((t,a)=>(I(),E(m,{key:a},{header:Q((()=>[k(u,{class:"items-center flex-nowrap! w-full"},{default:Q((()=>[D("div",da,[k(c,{size:"small",color:t.cms.length>0?{color:"#f2711c",borderColor:"#f2711c",textColor:"white"}:{color:"#67c23a",borderColor:"#67c23a",textColor:"white"}},{default:Q((()=>[U(j(t.cms.length)+" items ",1)])),_:2},1032,["color"]),D("span",ma,j(t.name),1)]),D("span",pa,j(t.cms_name+"--"+t.version_info),1),D("div",ga,j(e.$t("Home.Security.index_54")),1)])),_:2},1024)])),default:Q((()=>[k(y,{accordion:"","arrow-placement":"right"},{default:Q((()=>[(I(!0),N(_,null,A(t.cms,((t,a)=>(I(),E(m,{key:a},{header:Q((()=>[D("div",va,[D("div",ya,[k(c,{type:n(t.dangerous)[0],size:"small"},{default:Q((()=>[U(j(n(t.dangerous)[1]),1)])),_:2},1032,["type"]),D("span",xa,j(t.ps),1)]),k(d,{class:"mb-[.2rem] mr-[1.6rem]"},{default:Q((()=>[U(j(e.$t("Public.Btn.Details")),1)])),_:1})])])),default:Q((()=>[D("div",fa,j(e.$t("Home.Security.index_55"))+": "+j(t.repair),1)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["modelValue"])])]))])),D("div",null,[D("div",Ma,[U(j(e.$t("Home.Security.index_56"))+"： ",1),k(d,{target:"_blank",href:"https://www.aapanel.com/forum/t/support"},{default:Q((()=>t[17]||(t[17]=[U(" https://www.aapanel.com/forum/t/support ")]))),_:1,__:[17]})])])])}}}),ba=s(ha,[["__scopeId","data-v-216c3aa4"]]),wa={class:"text-20px"},ka=w({__name:"index",setup:e=>(e,t)=>(I(),N(_,null,[D("div",wa,j(e.$t("Home.Security.index_37")),1),k(Xt),k(ba)],64))}),_a={class:"risk-chart"},Ia={class:"circle-box"},Na={class:"circle-box-inner"},Da={class:"circle-box-value"},ja={class:"circle-box-desc"},Sa={class:"flex-1 m-[1rem]"},Aa={key:0,class:"mb-[1rem]"},za={class:"text-error"},Ta={class:"mb-[1rem]"},Ca={class:"mt-[1rem]"},La={class:"flex h-[3.2rem]"},Oa={class:"text-[30px] mr-[2rem]"},Qa={class:"bg-[#ef0808] px-2"},Ua={class:"bg-[#f0ad4e] px-2"},Ha={class:"bg-[#a1a1a1] px-2"},Ya=w({__name:"risk-score",setup(e){const{t:t}=T(),a=nt(),{scoreData:l}=b(a),s=[{color:"#ef0808",percentage:60,type:"danger"},{color:"#f0ad4e",percentage:80,type:"warn"},{color:"#e8d544",percentage:90,type:"alert"},{color:"#20a53a",percentage:100,type:"safe"}],r=C((()=>s.find((e=>l.value.score<=e.percentage)))),n=P({total:0,high_risk:0,medium_risk:0,low_risk:0}),o=(e=[])=>[{type:"category",show:!1,boundaryGap:!1,data:e}],c=(e=[])=>[{name:t("Home.Security.index_71"),type:"line",data:e,itemStyle:{color:"#ec958d"},smooth:!0,showSymbol:!1,sampling:"average",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"#fcdcd5"},{offset:1,color:"#fcdcd5"}]}}}],u=R({tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{width:1,type:"solid"}}},grid:{top:"30%",left:"0",right:"0",bottom:"0%",containLabel:!1},yAxis:{show:!1},xAxis:o(),series:c()});return(async()=>{const{message:e}=await oe();if(i(e)){n.total=e.total,n.high_risk=e.high_risk,n.medium_risk=e.medium_risk,n.low_risk=e.low_risk;const t=e.trend_list.map((e=>d(e.timestamp))),a=e.trend_list.map((e=>e.count));u.xAxis=o(t),u.series=c(a)}})(),(e,t)=>{const a=Ve;return I(),N("div",null,[D("div",{class:Z(["flex items-center mt-[2rem]",`circle-${S(r)?.type}`])},[D("div",_a,[D("div",Ia,[t[1]||(t[1]=D("div",{class:"circle-box-bg"},null,-1)),D("div",Na,[D("div",Da,[U(j(S(l).score)+" ",1),t[0]||(t[0]=D("div",{class:"unit"},null,-1))]),D("div",ja,j(S(l).scoreLevel),1)])])]),D("div",Sa,[S(l).riskNum>0?(I(),N("div",Aa,[D("span",za,j(S(l).riskNum),1),U(" "+j(e.$t("Home.Security.index_68")),1)])):H("",!0),D("template",null,[D("div",Ta,j(e.$t("Home.Security.index_69")),1)]),D("p",null,j(S(l).subtitle),1)])],2),D("div",Ca,[D("div",null,j(e.$t("Home.Security.index_70")),1),D("div",La,[D("span",Oa,j(S(n).total),1),k(a,{class:"items-end color-white"},{default:Q((()=>[D("span",Qa,j(S(n).high_risk),1),D("span",Ua,j(S(n).medium_risk),1),D("span",Ha,j(S(n).low_risk),1)])),_:1})]),k(it,{height:60,option:S(u)},null,8,["option"])])])}}}),Pa=s(Ya,[["__scopeId","data-v-cd7f811e"]]),Wa={class:"flex items-center justify-between flex-nowrap text-[11px]"},Ea={class:"text-[30px] mx-[0.4rem] text-primary"},Ra={class:"leading-[2rem]"},Za={class:"flex items-center"},Ba={class:"flex ml-[0.6rem]"},Ga=["title"],Ja={class:"flex flex-wrap mt-15 justify-center!"},Va=["onClick"],Fa=w({__name:"risk-info",setup(e){const{t:t}=T(),a=nt(),{safe:i,capabilitySwitch:s,risk_details:r,menu:o}=b(a),c=n(),u=Yt(),d=async e=>{const a=t(e?"Home.Security.index_64":"Home.Security.index_65"),i=t(e?"Home.Security.index_66":"Home.Security.index_67");await Ne({title:a,content:i,onConfirm:async()=>{await ce({dynamic_detection:e}),s.value.file_detection.status=e}})};return(e,t)=>{const a=l,n=m,p=We,g=Ve,v=$e;return I(),N("div",null,[D("div",Wa,[D("div",null,[U(j(e.$t("Security.Anti.Index_35")),1),D("strong",Ea,j(S(i).day),1),U(j(e.$t("Crontab.arrange.index_41")),1)]),D("div",Ra,[D("div",Za,[t[0]||(t[0]=D("span",null,"Protection",-1)),D("ul",Ba,[(I(!0),N(_,null,A(S(s),((e,t)=>(I(),N("li",{class:"mr-[0.1rem]",key:t,title:e.name},[k(a,{name:e.icon+(e.status?"-active":""),size:14},null,8,["name"])],8,Ga)))),128))])]),D("div",null,"Last Scan："+j(S(i).time),1),D("div",null,"Last Virus DB Update："+j(S(i).virus),1)])]),k(n,{class:"!mb-[1.8rem] !mt-0"}),k(g,{class:"text-[14px] text-bold"},{default:Q((()=>[k(g,{size:4,class:"items-center! mr-[1rem]"},{default:Q((()=>[t[1]||(t[1]=D("span",null,"Malware Scan",-1)),k(p,{size:"small",value:S(s).file_detection.status,onUpdateValue:d},null,8,["value"])])),_:1,__:[1]}),k(g,{size:4,class:"items-center!"},{default:Q((()=>[D("span",null,j(e.$t("Home.Security.index_63")),1),k(p,{size:"small",value:S(s).vul_scan.status,"onUpdate:value":S(u).onVulScanSwitch},null,8,["value","onUpdate:value"])])),_:1})])),_:1}),k(n,{class:"my-[1rem]!"}),D("div",Ja,[(I(!0),N(_,null,A(S(r),((e,a)=>(I(),N("div",{key:a,class:"flex flex-col items-center w-[12rem] mb-[1rem] w-1/3"},[D("div",null,[D("span",null,j(e.title),1),k(v,{trigger:"hover"},{trigger:Q((()=>t[2]||(t[2]=[D("span",{class:"ml-4px bt-ico-ask"},"?",-1)]))),default:Q((()=>[D("span",null,j(e.tips),1)])),_:2},1024)]),D("div",{class:Z(["text-[22px] cursor-pointer",e.value>0?"text-[#ef0808]":"text-[#20a53a]"]),onClick:t=>(async e=>{if("tamper"===e){if(c.isFree)return void ze({source:399});await Ce("tamper_core"),await lt({name:"tamper_core",title:"Tamper-proof for Enterprise\t",admin:!0})}else o.value=e})(e.type)},j(e.value),11,Va)])))),128)),t[3]||(t[3]=D("div",{class:"w-1/3"},null,-1))])])}}}),$a=w({__name:"security-trend",setup(e){const{loading:t,setLoading:a}=De(),l=h(!0),s=h(null);let r=null;return B((()=>{(async()=>{if(s.value){r=st(s.value);try{a(!0);const{message:e}=await ue();if(i(e)){l.value=e.trend_list.length>0;const t=e.trend_list.map((e=>d(e.timestamp,"MM-dd"))),a=e.trend_list.map((e=>e.handled_risks)),i=e.trend_list.map((e=>e.unhandled_risks)),s=e.trend_list.map((e=>e.risk_scan)),n={tooltip:{trigger:"axis",axisPointer:{type:"shadow",label:{show:!0}}},grid:{top:"10%",right:"5%",bottom:"15%",left:"5%",containLabel:!0},legend:{bottom:0,itemWidth:12,itemHeight:10,itemGap:10,textStyle:{fontSize:10,color:"#666666"},data:["Unaddressed","Processed","Home","Bug","Baseline"]},xAxis:{type:"category",data:t},yAxis:{type:"value",min:0},series:[{name:"Unaddressed",type:"line",smooth:!0,showSymbol:!1,sampling:"average",data:i},{name:"Processed",type:"line",smooth:!0,showSymbol:!1,sampling:"#20a53a",data:a},{name:"Home",type:"bar",barWidth:"8px",itemStyle:{normal:{color:"rgb(29, 159, 234, 1)"}},data:s},{name:"Bug",type:"bar",barWidth:"8px",itemStyle:{normal:{color:"rgb(30,67,180,1)"}},data:e.trend_list.map((e=>e.vul_scan))},{name:"Baseline",type:"bar",barWidth:"8px",itemStyle:{normal:{color:"rgb(70,44,104,1)"}},data:e.trend_list.map((e=>e.server_risks))}]};r.setOption(n)}}finally{a(!1)}}})()})),G((()=>{r?.dispose()})),(e,a)=>{const i=Xe,r=u;return I(),E(r,{show:S(t)},{default:Q((()=>[D("span",null,j(e.$t("Home.Security.index_79")),1),S(l)?(I(),N("div",{key:0,ref_key:"chartContainer",ref:s,style:{height:"230px"}},null,512)):(I(),E(i,{key:1,description:"No data available"}))])),_:1},8,["show"])}}}),Xa=w({__name:"security-news",setup(e){const a=W((()=>c((()=>t.import("./security-news-detail-legacy.js?v=1753954525509")),void 0))),{t:l}=T(),s=Ae(),{table:r,columns:n}=_e([{key:"description",title:l("Home.Security.index_72"),ellipsis:{tooltip:{width:"trigger"}}},{key:"title",title:l("Home.Security.index_73"),align:"center",width:80,render:e=>{const{text:t,style:a}=mt(e.level);return k("span",{style:a},[U("["),t,U("]")])}},{key:"title",title:"Time",width:60,render:e=>d(e.time,"MM-dd")},Ie({width:80,options:e=>[{label:l("Security.Anti.Index_21"),onClick:()=>{s.title=`[${e.file_path}] ${l("Security.Anti.Index_21")}`,s.data.row=e,s.show=!0}}]})]),{loading:o,setLoading:u}=De();return(async()=>{try{u(!0);const{message:e}=await de();i(e)&&(r.data=e.events)}finally{u(!1)}})(),(e,t)=>{const i=je,l=Ke,c=qe,u=ke;return I(),N("div",null,[k(c,{"default-value":"security"},{default:Q((()=>[k(l,{name:"security",tab:"Security News"},{default:Q((()=>[k(i,{loading:S(o),data:S(r).data,columns:S(n),"loading-num":4,"max-height":"160"},null,8,["loading","data","columns"])])),_:1})])),_:1}),k(u,{show:S(s).show,"onUpdate:show":t[0]||(t[0]=e=>S(s).show=e),title:S(s).title,data:S(s).data,width:500,footer:!1,"min-height":380,component:S(a)},null,8,["show","title","data","component"])])}}}),Ka={class:"text-20px"},qa={class:"flex"},ei={class:"flex"},ti=w({__name:"index",setup:e=>(nt().getSafeOverviewData(),(e,t)=>{const a=m;return I(),N(_,null,[D("div",Ka,j(e.$t("Home.Security.index_57")),1),D("div",qa,[k(Pa,{class:"w-50%"}),k(Fa,{class:"w-50%"})]),k(a,{class:"my-6!"}),D("div",ei,[k($a,{class:"w-50%"}),k(Xa,{class:"w-50%"})])],64)})}),ai=nt(),ii=n(),{risk_details:li}=b(ai),si=e("H",M("HOME-SECURITY-RISKS-STORE",(()=>{const e=h(""),t=h(""),a=h("Scanning, please wait patiently..."),l=h(!1),s=h(!1),r=h(""),n=h(!1),c=h(!1),u=h(!0),d=h(!1),m=h(),p=h(!0),g=h(!1),v=h("primary"),y=h(100),x=h("!text-[#20a53A]"),f=h("safe"),M=h(),b=h("The current server has not been scanned for security and may be at risk"),w=h(""),_=h([]),I=h(),N=h([]),D=h(!0),j=h([]),S=h([]),A=h(!0),z=h(!1),T=h(!1),C=P({progress:1,repairProgress:!1,repairText:"Repairing.."}),L=P({processPercentage:0,processColor:"#20a53a"}),O={risk:{type:"danger",label:"Risk Items",list:[]},security:{type:"primary",label:"Risk-free item",list:[]},ignore:{type:"warning",label:"Ignored items",list:[]}},Q=P({cannot_automatically:0,failed:0,success:0}),H=h(0),{table:Y,columns:W}=_e([{title:"Risk Items",key:"m_name",width:150,ellipsis:{tooltip:{width:"trigger"}}},{title:"Fixes",key:"msg",ellipsis:{tooltip:{width:"trigger"}}},{title:"Information",key:"type",width:100,align:"center",render:e=>Array.isArray(e.type)&&e.type.length>0?k("span",{class:"h-[3.2rem] inline-block whitespace-pre-wrap"},[U(" "),e.type.join("，"),U(" ")]):"None"},{title:"Operation Results",key:"status",width:120,align:"right",render:e=>e.status?k("span",{class:"text-[#20a53a]"},[U(" Repair Success ")]):k("span",{class:"text-[red]"},[U(" Repair failed ")])}]),E=P({1:{text:"Low",bg:"rgba(232, 213, 68, 0.1)",color:"#D4BB00"},2:{text:"Medium",bg:"rgba(240, 173, 78, 0.14)",color:"#f0ad4e"},3:{text:"High",bg:"rgba(239, 8, 8, 0.1)",color:"#EF0808"}}),R=h("overview"),Z=P({risk:0,malware:0,web:0,baseline:0}),B=()=>{100==y.value?(x.value="!text-[#20a53A]",f.value="safe",L.processColor="#20a53A"):y.value>=80&&y.value<=99?(x.value="!text-[#E8D544]",f.value="risk",L.processColor="#E8D544"):y.value>=60&&y.value<=79?(x.value="!text-[#F0AD4E]",L.processColor="#F0AD4E",f.value="warn"):y.value<60&&(x.value="!text-[#EF0808]",L.processColor="#EF0808",f.value="danger")},G=e=>{N.value=e.is_autofix,localStorage.setItem("isAutoFix",JSON.stringify(N.value));for(const t in O){const a=e[t];if(Array.isArray(a)){for(let e=0;e<a.length;e++){const i=O[t].list.find((t=>t.m_name==a[e].m_name));a[e].show=i?.show||!1,a[e].selection=i?.selection||!1}Object.keys(O).includes(t)&&"risk"==t&&I.value&&a&&(I.value=[...I.value,...a]),O[t].list=a}}r.value=e.check_time,v.value="primary",n.value=!0,g.value=!0,J(),m.value=" !animate-none",localStorage.setItem("scanData",JSON.stringify(I.value)),localStorage.setItem("lastScanTime",JSON.stringify(r.value))},J=()=>{I.value?.forEach((e=>{N.value.includes(e.m_name)?(e.selection=!0,j.value.push(e)):e.selection=!1})),j.value.length>0?(D.value=!1,s.value=!0):D.value=!0},V=async(e=!1)=>{l.value=!0,a.value="Scanning, please wait...";try{const t={};let a;e&&(t.force=1),a=e?(await Me(t)).message:(await he()).message,i(a)&&(a.interrupt||(I.value=[],G(a),y.value=a.score??0,H.value=I.value.length,li.value[2].value=H.value,b.value="Security scan completed.",S.value=a.ignore??[]))}catch(t){console.log(t)}l.value=!1},F=async e=>{Y.data=[],c.value=!0,Q.cannot_automatically=e.cannot_automatically.length,Q.failed=e.failed.length,Q.success=e.success.length,_.value=[];for(const t in e)for(const a of e[t])_.value.push({m_name:a.m_name,type:a.result.type,msg:a.result.msg,status:a.result.status,name:t});Y.data=_.value,l.value=!1,I.value=I.value?.filter((t=>!e.success.some((e=>e.m_name===t.m_name)))),H.value=I.value?.length||0,li.value[2].value=H.value,localStorage.setItem("scanData",JSON.stringify(I.value))};return{showAnimation:d,scanScore:y,scanTextClass:x,scanOuterClass:f,animateFlag:m,scanPreText:b,riskNum:H,scanButtonType:v,repairAutoRiskButton:n,cookieRepair:p,scanItemText:w,processData:L,lastScanTime:r,scanSelectShow:g,allSelect:s,allSelectionDis:D,isIgnoreAll:z,ignoreData:S,emptyDetail:u,loading:l,loadingText:a,isShow:A,activeMent:e,activeMentIgnore:t,is_autofix:N,levelData:E,allData:I,repairData:C,resultConfirm:c,resultItemLength:Q,resultTable:Y,resultColumn:W,reportPopup:T,onIgnore:async e=>{try{l.value=!0,a.value="Ignoring risk items, please wait patiently...",await be({m_name:e.m_name}),V(!1)}finally{l.value=!1}},onScan:async()=>{if(A.value=!1,u.value=!1,y.value=100,f.value="safe",x.value="!text-[#20a53A]","info"==v.value){clearInterval(M.value),await ge();const{message:e}=await ve();i(e)&&(G(e),y.value="?",x.value="!text-[#EF0808]",f.value="danger",l.value=!1,H.value=e.risk.length,li.value[2].value=H.value,b.value="Scan interruption ")}else{L.processPercentage=0,d.value=!0,b.value="Security scan in progress...",H.value=0,w.value="Testing...",m.value="",v.value="info",p.value=!0,n.value=!1,V(!0);try{clearInterval(M.value),M.value=setInterval((async function(){const{message:e}=await ye();i(e)&&(L.processPercentage=e.percentage,H.value=e.count,li.value[2].value=H.value,w.value=e.status,y.value=e.score,e.count&&100!=e.percentage&&(x.value="!text-[#EF0808]",f.value="danger",b.value="A security scan is in progress. "),100==e.percentage&&clearInterval(M.value),B())}),1e3)}catch(e){console.log(e)}}},onRepairAll:async()=>{if(ii.isFree)ze({source:399});else try{const e=I.value?.filter((e=>1==e.selection)).map((e=>e.m_name));if(0==e?.length)return l.value=!1,void o.error("There are currently no risk items that can be automatically repaired!");l.value=!0,a.value="It is being repaired. It may take a long time. Please wait patiently...",C.progress=0;const{message:t}=await xe(JSON.stringify({m_name:e}));if(i(t)){C.repairProgress=!0;const e=setInterval((async()=>{const{message:a}=await fe();if(i(a)&&(C.progress=a.percentage,C.repairText=a.status,100===a.percentage)){C.repairText="Repair Completed",C.repairProgress=!1,C.progress=100,clearInterval(e);const a=await t;F(a),V(!0)}}),800)}}catch(e){console.log(e)}finally{l.value=!1}},onRepair:async(e,t)=>{if(ii.isFree)return void ze({source:399});const s=I.value?.filter((e=>1==e.selection)).map((e=>e.m_name));try{if(!e&&0==s?.length)return void o.error("Please select the risk items that need to be repaired!");l.value=!0,a.value="It is being repaired. It may take a long time. Please wait patiently...";const{message:r}=await xe(JSON.stringify({m_name:e?[t?.m_name]:s}));i(r)&&(e&&r.success.length>0?(o.success("Repair Success"),H.value--,li.value[2].value=H.value,I.value=I.value?.filter((e=>e.m_name!==t?.m_name)),F(r)):F(r))}catch(r){console.log(r)}finally{l.value=!1}},vulnerabilityInvolvesSoftware:e=>{const t=Object.keys(e.soft_name);let a="";return t.forEach(((i,l)=>{l===t.length-1?a+=`${t}:${e.soft_name[i]}`:a+=`${t}:${e.soft_name[i]}\n`})),a},onToggle:(e,t)=>{e.show||t.forEach((e=>e.show=!1)),e.show=!e.show},repairTypeActive:R,tootipTotal:Z,getScanTotal:async()=>{const{message:e}=await me();if(i(e)){const{vulnerability:t,malware:a,security:l,baseline:s}=e.data;if(Z.malware=a,Z.risk=l,Z.web=t,Z.baseline=s,Z.risk){b.value=`<span class='text-error'>${Z.risk}</span> risks have been detected, please fix them in time`;const{message:e}=await pe();i(e)&&(N.value=e.is_autofix,I.value=e.risk,r.value=e.check_time,g.value=!0,n.value=!0,A.value=!1,u.value=!1,d.value=!0,y.value=e.score,B(),J())}}}}}))),ri={class:"flex items-center p-[2rem]"},ni={class:"flex items-center w-full"},oi={key:0,class:"w-[10rem] h-[10rem] relative flex-shrink-0"},ci={key:1,class:"w-[10rem] h-[10rem] relative flex-shrink-0"},ui={class:"w-full text-[#333] text-[2rem] flex flex-col ml-[3rem]"},di={class:"flex items-center w-full justify-between"},mi={class:"w-420px"},pi=["innerHTML"],gi={key:1},vi={class:"mx-[4px] text-[2.4rem] mx-[4px] text-error"},yi={class:"flex items-center"},xi={key:0,class:"text-[1.4rem] text-[#666] mt-[1rem]"},fi={key:1,class:"text-[1.4rem] text-[#666] mt-[1rem]"},Mi={key:3,class:"text-[1.4rem] mt-[12px] text-[#666] flex items-center"},hi={key:4,class:"text-[1.4rem] mt-[12px] text-[#F0AD4E] flex items-center"},bi=w({__name:"risk-scan",setup(e){const t=si(),{showAnimation:a,scanScore:i,scanTextClass:l,scanOuterClass:s,animateFlag:r,scanPreText:n,riskNum:o,scanButtonType:c,repairAutoRiskButton:u,cookieRepair:d,scanItemText:m,processData:p,lastScanTime:g}=b(t);return(e,v)=>{const y=Ee,x=et;return I(),N("div",ri,[D("div",ni,[S(a)?H("",!0):(I(),N("div",oi,v[1]||(v[1]=[D("span",{class:"inline-block scan-icon-img icon-img-safe"},null,-1),D("span",{class:"scan-icon-img-bg"},null,-1),D("span",{class:"text-[3.2rem] h-[4.4rem] w-[0.7rem] text-[#20a53a] font-bold absolute-center"},"i",-1)]))),S(a)?(I(),N("div",ci,[D("p",{class:Z("box-text w-[5.8rem] "+S(l))},j(S(i)),3),D("span",{class:Z("scan-icon-img icon-img-"+S(s))},null,2),v[4]||(v[4]=D("span",{class:"circle-inner"},null,-1)),D("span",{class:Z("circle-outer "+S(s))},null,2),D("div",{class:Z("animate-box"+S(r))},[D("div",{class:Z("animate-box-left linear-"+S(s))},null,2),v[2]||(v[2]=D("div",{class:"animate-box-right"},null,-1)),v[3]||(v[3]=D("div",{class:"animate-box-bottom"},null,-1))],2)])):H("",!0),D("div",ui,[D("div",di,[D("span",mi,[S(o)?(I(),N("span",gi,[D("span",vi,j(S(o)),1),U(" "+j(e.$t("Home.Security.index_89")),1)])):(I(),N("span",{key:0,innerHTML:S(n)},null,8,pi))]),D("div",yi,[S(u)&&S(d)?H("",!0):(I(),E(y,{key:0,class:Z("w-[9rem] "+("info"==S(c)?"bg-[#CBCBCB]":"")),type:S(c),round:"",onClick:S(t).onScan},{default:Q((()=>[U(j("info"==S(c)?e.$t("Home.Security.index_90"):e.$t("Home.Security.index_41")),1)])),_:1},8,["class","type","onClick"])),S(u)&&S(d)?(I(),N("span",{key:1,round:"",onClick:v[0]||(v[0]=(...e)=>S(t).onScan&&S(t).onScan(...e)),class:"!p-[0] bt-link text-[1.2rem] mr-4px whitespace-nowrap"},j(e.$t("Ftp.Log.Index_12")),1)):H("",!0),S(u)&&S(d)?(I(),E(y,{key:2,round:"",type:S(c),onClick:S(t).onRepairAll},{default:Q((()=>[U(j(e.$t("Home.Security.index_91")),1)])),_:1},8,["type","onClick"])):H("",!0)])]),"info"===S(c)||S(u)?H("",!0):(I(),N("span",xi,j(e.$t("Home.Security.index_92")),1)),"info"==S(c)?(I(),N("span",fi,j(S(m)),1)):H("",!0),"info"==S(c)?(I(),E(x,{key:2,class:"mt-[1.6rem] h-[1rem]","process-color":S(p).processColor,percentage:S(p).processPercentage,"stroke-width":10,"show-text":!1},null,8,["process-color","percentage"])):H("",!0),S(u)?(I(),N("span",Mi,j(e.$t("Home.Security.index_9"))+"："+j(S(g)),1)):H("",!0),S(u)&&S(d)?(I(),N("span",hi,j(e.$t("Home.Security.index_93")),1)):H("",!0)])])])}}}),wi=s(bi,[["__scopeId","data-v-13e5c800"]]),ki={key:0,class:"text-[1.4rem] w-full flex items-center justify-between px-[0.8rem]"},_i={class:"items-center flex"},Ii={class:"flex items-center"},Ni=w({__name:"risk-select",setup(e){const t=si(),{scanSelectShow:a,allSelect:i,allSelectionDis:s,allData:r,isIgnoreAll:n,is_autofix:o,reportPopup:c}=b(t),u=C((()=>r.value?.filter((e=>1==e.selection)).map((e=>e.m_name)).length));return J(i,(e=>{e?r.value?.forEach((e=>{o.value.includes(e.m_name)&&(e.selection=!0)})):r.value?.forEach((e=>{e.selection=!1}))})),(e,r)=>{const o=Ge,d=p,m=l,g=Ee;return S(a)?(I(),N("div",ki,[D("div",_i,[k(o,{checked:S(i),"onUpdate:checked":r[0]||(r[0]=e=>L(i)?i.value=e:null),disabled:S(s)},{default:Q((()=>[U(j(e.$t("Public.SelectAll")),1)])),_:1},8,["checked","disabled"]),k(d,{onClick:r[1]||(r[1]=e=>S(t).onRepair(!1)),class:Z(S(u)?"ml-[20px] text-[1.4rem]":"ml-[20px] text-[1.4rem] text-[#999] cursor-not-allowed ")},{default:Q((()=>[U(j(e.$t("Home.Security.index_94")),1)])),_:1},8,["class"])]),D("div",Ii,[k(d,{onClick:r[2]||(r[2]=e=>n.value=!0)},{default:Q((()=>[U(j(e.$t("Home.Security.index_95")),1)])),_:1}),r[5]||(r[5]=D("span",{class:"text-[#999] mx-[1.2rem]"},"|",-1)),k(g,{type:"primary",text:"",onClick:r[3]||(r[3]=e=>c.value=!0)},{default:Q((()=>[k(m,{name:"home-safe-report",class:"mr-4px"}),r[4]||(r[4]=U(" View Report "))])),_:1,__:[4]})])])):H("",!0)}}}),Di=["onClick"],ji={class:"module-head flex items-center h-[5.4rem] justify-between border-b-1 px-[0.8rem] w-full"},Si={class:"w-full flex items-center"},Ai=["title"],zi={class:"px-[3rem] py-[3.2rem] bg-[#F8F8F8]"},Ti={class:"flex items-center"},Ci={class:"text-[#333] w-100px text-right"},Li=["innerHTML"],Oi={class:"flex mt-[16px] items-center"},Qi={key:0,class:"collapse-item flex-col !items-start"},Ui={key:1,class:"collapse-item"},Hi={class:"flex mt-[16px] items-center"},Yi={class:"w-100px text-right"},Pi={class:"collapse-item"},Wi=w({__name:"risk-list",setup(e){const{t:t}=T(),a=si(),{emptyDetail:i,allData:l,loading:s,loadingText:r,activeMent:n,isShow:o,is_autofix:c,levelData:d}=b(a),m=e=>[{label:"Fix it now",show:!!c.value.includes(e.m_name),onClick:()=>{a.onRepair(!0,e)}},{label:t("Ftp.Table.index_8"),class:"text-[#999]",onClick:()=>{a.onIgnore(e)}},{label:e.show?t("Home.Security.index_83"):t("Security.Anti.Index_21"),onClick:t=>{t.stopPropagation(),a.onToggle(e,l.value)}}];return(e,t)=>{const g=Ge,x=Ve,f=p,M=Le,h=y,b=v,w=u;return I(),N(_,null,[S(i)?H("",!0):(I(),E(w,{key:0,show:S(s),class:Z([S(o)?"h-[24rem]":"h-[34rem]","scan-body mt-16px"]),description:S(r)},{default:Q((()=>[k(b,{"expanded-names":S(n),"onUpdate:expandedNames":t[0]||(t[0]=e=>L(n)?n.value=e:null),accordion:"","arrow-placement":"right"},{default:Q((()=>[D("div",{class:Z(["module-list overflow-auto",S(o)?"h-[24rem]":"h-[34rem]"])},[(I(!0),N(_,null,A(S(l),((i,s)=>(I(),N("div",{class:"module-item text-[1.2rem] cursor-pointer",key:`${s}`,onClick:e=>S(a).onToggle(i,S(l))},[D("div",ji,[D("div",Si,[k(g,{checked:i.selection,"onUpdate:checked":e=>i.selection=e,disabled:!S(c).includes(i.m_name)},null,8,["checked","onUpdate:checked","disabled"]),k(x,{class:Z(["flex-nowrap!",S(c).includes(i.m_name)?"w-[50rem]!":"w-[30rem]!"])},{default:Q((()=>[D("span",{class:"text-[1.2rem] h-[2.2rem] px-[8px] rounded-[0.2rem] mx-[8px] whitespace-nowrap flex items-center",style:z({color:S(d)[i.level].color,backgroundColor:S(d)[i.level].bg})},j(S(d)[i.level].text),5),D("div",{class:"truncate",style:z({color:S(d)[i.level].color}),title:i.ps?i.ps:i.vuln_name},j(i.ps?i.ps:i.vuln_name),13,Ai)])),_:2},1032,["class"]),S(c).includes(i.m_name)?H("",!0):(I(),E(x,{key:0,size:0,class:"text-[#666] ml-10px items-center!"},{default:Q((()=>[t[2]||(t[2]=D("span",null,"Contact Now",-1)),k(f,{href:"mailto:support@aapanel.com",target:"_blank",class:"ml-2px"},{default:Q((()=>t[1]||(t[1]=[U("support@aapanel.com")]))),_:1,__:[1]})])),_:1,__:[2]}))]),k(M,{class:"w-200px",options:m(i)},null,8,["options"])]),k(h,null,{default:Q((()=>[V(D("div",zi,[D("div",Ti,[D("div",Ci,j(i.ps?"Risk Description":"Involved software "),1),V(D("div",{class:"collapse-item",innerHTML:i.msg},null,8,Li),[[F,i.msg]]),V(D("div",{class:"collapse-item"},j(i.soft_name?S(a).vulnerabilityInvolvesSoftware(i):""),513),[[F,i.soft_name]])]),D("div",Oi,[t[3]||(t[3]=D("div",{class:"w-100px text-right"},"Solution",-1)),i.tips?(I(),N("div",Qi,[(I(!0),N(_,null,A(i.tips,((e,t)=>(I(),N("p",{key:t,class:Z(0==t?"":"mt-[4px]")},j(t+1)+"、"+j(e),3)))),128))])):H("",!0),i.vuln_solution?(I(),N("div",Ui,j(i.vuln_solution),1)):H("",!0)]),V(D("div",Hi,[D("div",Yi,j(e.$t("Home.Security.index_81")),1),D("div",Pi,j(i.remind),1)],512),[[F,i.remind]])],512),[[F,i.show]])])),_:2},1024)],8,Di)))),128))],2)])),_:1},8,["expanded-names"])])),_:1},8,["show","class","description"])),S(i)?(I(),N("div",{key:1,class:Z([S(o)?"h-[32rem]":"h-[40rem]","scan-body flex justify-center flex-col my-[3rem] relative"])},[t[4]||(t[4]=D("span",{class:"bg-[#f2f2f2] h-[3rem] w-[33%] mb-[12px]"},null,-1)),(I(),N(_,null,A(4,((e,t)=>D("span",{class:"bg-[#f2f2f2] h-[3rem] w-full mb-[12px]",key:t}))),64)),t[5]||(t[5]=D("span",{class:"bg-[#f2f2f2] h-[3rem] w-[60%] mb-[12px]"},null,-1)),(I(),N(_,null,A(3,((e,t)=>D("span",{class:"bg-[#f2f2f2] h-[3rem] w-full mb-[12px]",key:t}))),64)),t[6]||(t[6]=D("span",{class:"bg-[#f2f2f2] h-[3rem] w-[40%] mb-[12px]"},null,-1))],2)):H("",!0)],64)}}}),Ei=s(Wi,[["__scopeId","data-v-72d45b6c"]]),Ri={class:"text-20px"},Zi=w({__name:"index",setup(e){const a=W((()=>c((()=>t.import("./risk-repair-legacy.js?v=1753954525509")),void 0))),i=W((()=>c((()=>t.import("./risk-ignore-list-legacy.js?v=1753954525509")),void 0))),l=W((()=>c((()=>t.import("./risk-report-legacy.js?v=1753954525509")),void 0))),s=si(),{resultConfirm:r,isIgnoreAll:n,reportPopup:o}=b(s);return s.getScanTotal(),(e,t)=>{const s=ke;return I(),N(_,null,[D("div",Ri,j(e.$t("Home.Security.index_80")),1),k(wi),k(Ni),k(Ei),k(s,{show:S(r),"onUpdate:show":t[0]||(t[0]=e=>L(r)?r.value=e:null),title:"Result Confirmation",width:500,component:S(a)},null,8,["show","component"]),k(s,{show:S(n),"onUpdate:show":t[1]||(t[1]=e=>L(n)?n.value=e:null),title:"Ignore risk items",width:700,"min-height":400,component:S(i)},null,8,["show","component"]),k(s,{show:S(o),"onUpdate:show":t[2]||(t[2]=e=>L(o)?o.value=e:null),title:"Security Scan Report",width:1e3,"min-height":800,component:S(l),footer:!0,"confirm-text":e.$t("Public.Btn.Export"),"hide-close":!0},null,8,["show","component","confirm-text"])],64)}}}),Bi=M("home-security-server",(()=>{const e=h(!1),t=h("");return{serverScanParams:h({scanStatus:!1,isEnd:!1,error:0,warn:0,time:0,progress:0,progressColor:"#20a53a",progressConfig:{system_account:[],sshd_service:[],file_mode:[],software:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},statusTotal:{},allArr:[],result:{},progressStatus:{},active:{}}),checkTopic:t,isScan:e}})),Gi={class:"progress-header"},Ji={class:"progress-header-cot"},Vi={key:0,class:"relative"},Fi={class:"absolute top-[1.6rem] left-[2.6rem] flex flex-col"},$i={class:"text-[1.2rem] font-bold leading-none"},Xi={class:"progress-header-cot"},Ki={class:"scanning-progress-title"},qi={class:"color-#fc6d26"},el={class:"scanning-progress-cont"},tl=w({__name:"server-scan",setup(e){const t=Bi(),a=n(),{serverScanParams:s,checkTopic:r,isScan:o}=b(t),c=P({status:!0,time:0,security_count:0,risk_count:{warning:0,danger:7}}),u=h(""),m=C((()=>s.value.scanStatus&&!s.value.isEnd?"Scanning":c.status?"Last detection time "+x(c.time):"Currently not undergoing security testing")),p=C((()=>s.value.scanStatus&&!s.value.isEnd?`Scanning-${u.value}`:s.value.isEnd?"Detection time："+d(s.value.time/1e3,"yyyy-MM-dd"):c.status?"The server may have security risks. It is recommended to check it immediately":"The current security risk is unknown, please check immediately")),{open:g,send:v,close:y}=Oe("/ws_project",{immediate:!1,onMessage:(e,t)=>{const a=JSON.parse(t.data.replace(/'/g,'"'));a&&"object"==typeof a&&"callback"in a?(y(),s.value.scanStatus=!1,s.value.isEnd=!0,s.value.time=(new Date).getTime(),A()):(u.value=a.name,r.value=a.topic,s.value.progress=parseInt(a.progress),s.value.progressConfig[a.topic]?.push(a),s.value.statusTotal[a.topic]=f(s.value.progressConfig[a.topic]),s.value.allArr.push(a),3===a.status&&s.value.error++,2!==a.status&&3!==a.status||s.value.warn++,1!==a.status&&(s.value.progressColor="#fc6d26"))}}),f=e=>{const t={};return e.length&&e.forEach((e=>{t[e.status]?t[e.status]++:t[e.status]=1})),t},M=()=>{if(a.isFree)ze({source:399});else{if(s.value.scanStatus&&!s.value.isEnd)return y(),void w();s.value.isEnd&&w(),s.value.scanStatus=!0,g(),v({mod_name:"safe_detect",def_name:"get_safe_scan",ws_callback:""}),o.value=!0}},w=()=>{s.value.scanStatus=!1,s.value.isEnd=!1,s.value.error=0,s.value.warn=0,s.value.time=0,s.value.progress=0,s.value.progressColor="#20a53a",s.value.progressConfig={system_account:[],sshd_service:[],file_mode:[],software:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},s.value.statusTotal={},s.value.allArr=[],s.value.result={},s.value.progressStatus={},s.value.active={system_account:!1,sshd_service:!1,file_mode:!1,software:!1,other:!1,backdoor:!1,proc:!1,history:!1,log:!1,rootkit:!1}},A=()=>{const e=e=>e.sort(((e,t)=>t.status-e.status));for(const i in s.value.progressConfig){const t=s.value.progressConfig[i];Array.isArray(t)&&t.length&&e(t)}const t=s.value.allArr;Array.isArray(t)&&t.length&&e(t);const a=s.value.result;if(a&&Object.keys(a).length){const t={};Object.keys(a).forEach((t=>{const i=a[t];Array.isArray(i)&&e(i)})),Object.keys(a).sort(((e,t)=>{const i=a[e].some((e=>e.status>1));return i===a[t].some((e=>e.status>1))?0:i?-1:1})).forEach((e=>{t[e]=a[e]})),s.value.result=t}};return(async()=>{try{const{message:e}=await we();if(i(e)){if(Object.prototype.hasOwnProperty.call(e,"msg"))return void(c.status=!1);c.time=e.time,c.security_count=e.security_count,c.risk_count=e.risk_count}}catch{c.status=!1}})(),$((()=>{y()})),(e,t)=>{const a=l,i=et,r=Ee;return I(),N("div",Gi,[D("div",Ji,[D("div",{class:Z("progresscirclebar "+(S(c).status?"security ":"")+"text-["+(100===S(c).security_count?" #20a53a ":" #fc6d26 ")+"]")},[S(c).status?(I(),N(_,{key:1},[S(s).scanStatus&&!S(s).isEnd?(I(),N("div",Vi,[k(i,{class:"animate-spin",type:"circle",percentage:70,"stroke-width":4,color:S(s).warn||S(s).error?"#fc6d26":"#20a53a"},{default:Q((()=>[U(j(),1)])),_:1},8,["color"]),D("div",Fi,[k(a,{name:"firewall-icon-safe-detect"+(S(s).warn||S(s).error?"-org":""),size:50},null,8,["name"]),D("span",$i,j(e.$t("Home.Security.index_41")),1)])])):(I(),E(i,{key:1,type:"circle",percentage:S(c).security_count,color:100===S(c).security_count?"#20a53a":"#fc6d26"},{default:Q((()=>[U(j(S(c).security_count),1)])),_:1},8,["percentage","color"]))],64)):(I(),E(a,{key:0,size:100,name:"firewall-icon-safe-detect"}))],2)]),D("div",Xi,[D("div",Ki,[S(s).isEnd?(I(),N(_,{key:1},[t[2]||(t[2]=U(" Testing completed ")),S(s).error>0||S(s).warn>0?(I(),N(_,{key:0},[t[1]||(t[1]=U(" ，Found ")),S(s).warn>0?(I(),N(_,{key:0},[D("span",qi,j(S(s).warn),1),t[0]||(t[0]=U(" risk items "))],64)):H("",!0)],64)):H("",!0)],64)):(I(),N(_,{key:0},[U(j(S(m)),1)],64))]),S(s).scanStatus?(I(),E(i,{key:0,percentage:S(s).progress,color:S(s).warn||S(s).error?"#fc6d26":"#20a53a","stroke-width":10},null,8,["percentage","color"])):H("",!0),D("div",el,j(S(p)),1)]),D("div",null,[k(r,{size:"large",type:S(s).scanStatus&&!S(s).isEnd?"warning":"primary",onClick:M,plain:!(!S(s).scanStatus||S(s).isEnd)},{default:Q((()=>[U(j(S(s).scanStatus&&!S(s).isEnd?"Cancel Scan":(S(s).isEnd,e.$t("Home.Security.index_41"))),1)])),_:1},8,["type","plain"])])])}}}),al=s(tl,[["__scopeId","data-v-0a5f55f9"]]),il={class:"progress-cont-list scrollable"},ll=["onClick"],sl={class:"progress_type"},rl={class:"progress_status"},nl={key:0,class:"text-error"},ol={key:1,class:"text-warning"},cl={key:1},ul={key:2,class:"text-[#666]"},dl={key:0},ml={key:0,class:"progress_fold"},pl={class:"progress_item_body"},gl={class:"info_cont"},vl={class:"info_cont_desc"},yl=w({__name:"server-list",setup(e){const t=Bi(),{serverScanParams:a,checkTopic:i,isScan:s}=b(t),r=[{color:"#888",text:"Not Installed"},{color:"#666",text:"Good"},{color:"#e6a23c",text:"Warn"},{color:"red",text:"Danger"}],n={system_account:"System Account",sshd_service:"SSHD Remote Service",file_mode:"Important file permissions and attributes",software:"Key software detection",other:"Other project testing",backdoor:"Backdoor Detection",proc:"Malicious processes",history:"History Commands",log:"Log troubleshooting",rootkit:"Rootkit detection"};return(e,t)=>{const o=l;return I(),N("div",il,[(I(),N(_,null,A(n,((t,l)=>D("div",{key:l,class:Z([l+"_item "+(S(a).active[l]?"active":""),"progress_item"])},[D("div",{class:"progress_item_header",onClick:e=>(e=>{a.value.active[e]=!a.value.active[e]})(l)},[D("div",sl,[k(o,{class:"title-icon",name:"firewall-icon-"+l},null,8,["name"]),D("span",null,j(t),1)]),D("div",rl,[S(a).statusTotal[l]?(I(),N(_,{key:0},[S(a).statusTotal[l][3]||S(a).statusTotal[l][2]?(I(),N(_,{key:0},[S(a).statusTotal[l][3]?(I(),N("span",nl,j(S(a).statusTotal[l][3])+" "+j(e.$t("Home.Security.index_89")),1)):H("",!0),S(a).statusTotal[l][2]?(I(),N("span",ol,j((S(a).statusTotal[l][3]?"":"Found ")+S(a).statusTotal[l][2])+" "+j(e.$t("Database.tools.index_20")),1)):H("",!0)],64)):S(a).scanStatus&&S(i)==l?(I(),N("span",cl,j(e.$t("Home.Security.index_97"))+"... ",1)):(I(),N("span",ul,j(e.$t("Home.Security.index_98")),1))],64)):(I(),N(_,{key:1},[S(a).scanStatus&&!S(a).statusTotal[l]?(I(),N("span",dl,j(e.$t("Home.Security.index_99")),1)):H("",!0)],64))]),S(s)?(I(),N("div",ml,[k(o,{name:"base-arrow-bottom"})])):H("",!0)],8,ll),D("div",pl,[S(a).progressConfig[l]&&S(a).progressConfig[l].length?(I(!0),N(_,{key:0},A(S(a).progressConfig[l],((e,t)=>(I(),N("div",{key:t,class:Z([e.info?"active":"","progress_item_info"])},[D("div",gl,[D("div",null,j(e.name),1),D("div",{class:Z("text-["+r[e.status<0?0:e.status].color+"]")},j(r[e.status<0?0:e.status].text),3)]),D("div",vl,j(e.info||""),1)],2)))),128)):H("",!0)])],2))),64))])}}}),xl=s(yl,[["__scopeId","data-v-9d0196ea"]]),fl={class:"text-20px"},Ml=w({__name:"index",setup:e=>(e,t)=>(I(),N(_,null,[D("div",fl,j(e.$t("Home.Security.index_96")),1),k(al),k(xl)],64))}),hl={class:"h-600px"};e("_",w({__name:"index",setup(e){const t=nt(),{menu:i}=b(t),s=[{key:"overview",label:()=>{const e="overview"===i.value;return k(l,{size:32,name:e?"home-aapanel-active":"home-aapanel"},null)},component:ti},{key:"risk",label:()=>{const e="risk"===i.value?"home-risk-active":"home-risk";return k(ut,{value:dt("risk"),iconName:e},null)},component:Zi},{key:"file",label:()=>{const e="file"===i.value?"home-ware-active":"home-ware";return k(ut,{value:dt("file"),iconName:e},null)},component:Lt},{key:"loophole",label:()=>{const e="loophole"===i.value?"home-web-active":"home-web";return k(ut,{value:dt("loophole"),iconName:e},null)},component:ka},{key:"server",label:()=>{const e="server"===i.value?"home-safeDetect-active":"home-safeDetect";return k(ut,{value:dt("server"),iconName:e},null)},component:Ml},{key:"global",label:()=>{const e="global"===i.value;return k(l,{size:32,name:e?"home-alarm-active":"home-alarm"},null)},component:Ut}];return i.value="overview",(e,t)=>{const l=f,r=p,n=a,o=Ve;return I(),N("div",hl,[k(l,{"is-icon":"",value:S(i),"onUpdate:value":t[0]||(t[0]=e=>L(i)?i.value=e:null),data:s,class:"relative"},null,8,["value"]),k(o,{size:3,class:"absolute right-[2rem] top-[1rem] items-center!"},{default:Q((()=>[k(n,{"icon-name":"demand"},{default:Q((()=>[k(r,{href:"mailto:support@aapanel.com",target:"_blank"},{default:Q((()=>t[1]||(t[1]=[U("support@aapanel.com")]))),_:1,__:[1]})])),_:1})])),_:1})])}}}))}}}));
