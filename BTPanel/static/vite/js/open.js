import{s as a,_ as e,f as l}from"./index98.js?v=1741416570306";import{_ as s}from"./index99.js?v=1741416570306";import{m as n,F as t,as as i,aw as o,_ as r,b as f,k as c}from"./page_layout.js?v=1741416570306";import{d as p,M as u,r as v,a1 as d,P as m,Q as x,R as _,N as g,a0 as w,$ as b,S as C,ae as S,k as y,v as h,c as $}from"./vue.js?v=1741416570306";import{w as k,O as j,P,x as U}from"./global.js?v=1741416570306";import{ch as K,_ as N}from"./naive.js?v=1741416570306";const O={class:"px-40px py-24px"},R={class:"flex-center mb-20px"},z={class:"min-w-32px"},E={class:"ml-4px text-21px"},F={class:"text-error"},I={class:"bt-link",href:"https://www.aapanel.com/forum/d/167-common-problems-after-opening-the-panel-certificate",target:"_blank"},L={class:"flex"},M={class:"form-label"},Q={class:"w-280px"},T={class:"flex mt-16px"},q={class:"form-label"},A={class:"w-280px"},B={class:"flex mt-16px"},D={class:"form-label"},G={class:"w-280px"},H={class:"flex mt-16px"},J={class:"form-label"},V={class:"w-280px"},W={class:"flex justify-between mt-24px"},X={class:"bt-link",href:"https://www.aapanel.com/forum/d/167-common-problems-after-opening-the-panel-certificate",target:"_blank"},Y=c(p({__name:"open",setup(c,{expose:p}){const{t:Y}=u(),Z=v(),aa=v(1),ea=v(""),la=v(""),sa=v(""),na=[{label:Y("Config.Safe.index_30"),value:1},{label:"Let's Encrypt",value:2},{label:Y("Config.Safe.index_31"),value:3}],ta=async()=>{const{message:a}=await P();f(a)&&(aa.value=a.cert_type?Number(a.cert_type):1,ea.value=a.email||"")},ia=async()=>{const{message:a}=await U();f(a)&&(la.value=a.privateKey||"",sa.value=a.certPem||"")};return(async()=>{const a=n.loading(Y("Config.Safe.index_32"));try{await Promise.all([ta(),ia()])}finally{a.close()}})(),p({onConfirm:async()=>{if(await Z.value.validate(),2===aa.value&&""===ea.value.trim())return n.error(Y("Config.Safe.index_33")),!1;if(2===aa.value&&!t(ea.value))return n.error(Y("Config.Safe.index_34")),!1;if(3===aa.value&&(""===la.value.trim()||""===sa.value.trim()))return n.error(Y("Config.Safe.index_35")),!1;const e=n.loading(Y("Config.Safe.index_36"));try{3===aa.value&&await k({privateKey:la.value,certPem:sa.value}),await j((()=>{const a=2===aa.value?{email:ea.value}:{};return{cert_type:aa.value,...a}})(),!1),await i(),setTimeout((()=>{if(o){const e="http:"===location.protocol?"https":"http";window.location.href="".concat(e,"://").concat(window.location.host).concat(a.value.adminPath)}}),1500)}finally{e.close()}return!1}}),(a,n)=>{const t=r,i=d("i18n-t"),o=e,f=K,c=N,p=s,u=l;return m(),x("div",O,[_("div",R,[_("div",z,[g(t,{name:"scan-success",size:"32"})]),_("span",E,w(a.$t("Config.Safe.index_18")),1)]),g(o,{class:"mb-20px"},{default:b((()=>[_("li",F,w(a.$t("Config.Safe.index_19")),1),_("li",null,w(a.$t("Config.Safe.index_20")),1),g(i,{tag:"li",scope:"global",keypath:"Config.Safe.index_21"},{link_:b((()=>[_("a",I,w(a.$t("Config.Safe.index_22")),1)])),_:1})])),_:1}),_("div",L,[_("span",M,w(a.$t("Config.Safe.index_24")),1),_("div",Q,[g(f,{value:C(aa),"onUpdate:value":n[0]||(n[0]=a=>S(aa)?aa.value=a:null),options:na},null,8,["value"])])]),y(_("div",T,[_("span",q,w(a.$t("Config.Safe.index_25")),1),_("div",A,[g(c,{value:C(ea),"onUpdate:value":n[1]||(n[1]=a=>S(ea)?ea.value=a:null),placeholder:a.$t("Config.Safe.index_26")},null,8,["value","placeholder"])])],512),[[h,2===C(aa)]]),y(_("div",B,[_("span",D,w(a.$t("Config.Safe.index_27")),1),_("div",G,[g(p,{value:C(la),"onUpdate:value":n[2]||(n[2]=a=>S(la)?la.value=a:null),rows:4,placeholder:""},null,8,["value"])])],512),[[h,3===C(aa)]]),y(_("div",H,[_("span",J,w(a.$t("Config.Safe.index_28")),1),_("div",V,[g(p,{value:C(sa),"onUpdate:value":n[3]||(n[3]=a=>S(sa)?sa.value=a:null),rows:4,placeholder:""},null,8,["value"])])],512),[[h,3===C(aa)]]),_("div",W,[g(u,{ref_key:"riskRef",ref:Z},{default:b((()=>[$(w(a.$t("Config.Safe.index_29")),1)])),_:1},512),_("a",X,w(a.$t("Config.Safe.index_167")),1)])])}}}),[["__scopeId","data-v-02bc9a9f"]]);export{Y as O};
