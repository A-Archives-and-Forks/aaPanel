import{_ as e}from"./index226.js?v=1742891699271";import{_ as a}from"./index95.js?v=1742891699271";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1742891699271";import{_ as s}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1742891699271";import{_ as i}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1742891699271";import{b as l,I as n,b7 as o,m as p}from"./page_layout.js?v=1742891699271";import{b as u,f as r}from"./public.js?v=1742891699271";import{s as m,a as c,b as _,d,c as g,e as v}from"./index56.js?v=1742891699271";import{d as y,O as x,r as f,j as S,R as j,S as b,P as h,a1 as w,F as k,N as B,V as L,U as z,a2 as A,M as H,af as U,c as N}from"./vue.js?v=1742891699271";import{b$ as $,bU as P,_ as R,T as C}from"./naive.js?v=1742891699271";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1742891699271";import"./common.js?v=1742891699271";import"./__commonjsHelpers__.js?v=1742891699271";import"./index104.js?v=1742891699271";import"./index.js?v=1742891699271";import"./index.vue_vue_type_script_setup_true_lang.js?v=1742891699271";import"./index.vue_vue_type_script_setup_true_lang2.js?v=1742891699271";import"./index96.js?v=1742891699271";import"./config3.js?v=1742891699271";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1742891699271";const O={class:"mr-12px"},q=y({__name:"logs",props:{config:{}},emits:["setName"],setup(e,{expose:p,emit:r}){const d=e,g=r,{t:v}=x(),y=f(""),U=f([]),{table:N,columns:R,setLoading:C}=u([{key:"log",title:v("Security.SSH.Basic.LoginAlarm.logs_1")},{key:"addtime",title:v("Security.SSH.Basic.LoginAlarm.logs_2"),width:160}]),q=S({p:1,p_size:10}),D=async()=>{try{C(!0);const{message:e}=await c(H(q));l(e)&&(N.data=n(e.data)?e.data:[],N.total=o(e.page))}finally{C(!1)}},F=async()=>{const{message:e}=await _();l(e)&&(y.value=e.result)};return D(),F(),(async()=>{const{config:e}=d;l(e)&&(U.value=Object.entries(e).map((([,e])=>({name:e.name,title:e.title}))))})(),p({init:()=>{D(),F()}}),(e,l)=>{const n=$,o=P,p=i,u=s,r=t,c=a;return j(),b("div",null,[h(o,{class:"mb-20px",size:20},{default:w((()=>[(j(!0),b(k,null,B(L(U),(e=>(j(),b("div",{key:e.name,class:"flex items-center"},[z("span",O,A(e.title),1),h(n,{value:L(y)===e.name,size:"small","onUpdate:value":a=>(async e=>{const a=y.value!==e;await m(a,{type:e}),await F(),g("setName",y.value)})(e.name)},null,8,["value","onUpdate:value"])])))),128))])),_:1}),h(r,null,{table:w((()=>[h(p,{"max-height":450,loading:L(N).loading,data:L(N).data,columns:L(R)},null,8,["loading","data","columns"])])),pageRight:w((()=>[h(u,{page:L(q).p,"onUpdate:page":l[0]||(l[0]=e=>L(q).p=e),"page-size":L(q).p_size,"onUpdate:pageSize":l[1]||(l[1]=e=>L(q).p_size=e),"item-count":L(N).total,"show-size-picker":!1,"show-quick-jumper":!1,onRefresh:D},null,8,["page","page-size","item-count"])])),_:1}),h(c,{class:"mt-16px"},{default:w((()=>[z("li",null,A(e.$t("Security.SSH.Basic.LoginAlarm.logs_3")),1)])),_:1})])}}}),D={class:"flex"},F={class:"w-200px mr-10px mb-12px"},I=y({__name:"whitelist",setup(e,{expose:a}){const{t:t}=x(),s=f(""),l=async()=>{""!==s.value.trim()?(await v({ip:s.value}),s.value=""):p.error(t("Security.SSH.Basic.LoginAlarm.whitelist_1"))},{table:o,columns:m,setLoading:c}=u([{key:"ip",title:t("Security.SSH.Basic.LoginAlarm.whitelist_2")},r({width:100,options:e=>[{label:t("Public.Btn.Del"),onClick:async()=>{await d({ip:e.ip}),_()}}]})]),_=async()=>{try{c(!0);const{message:e}=await g();n(e)&&(o.data=e.map((e=>({ip:e}))))}finally{c(!1)}};return _(),a({init:_}),(e,a)=>{const t=R,n=C,p=i;return j(),b("div",null,[z("div",D,[z("div",F,[h(t,{value:L(s),"onUpdate:value":a[0]||(a[0]=e=>U(s)?s.value=e:null),placeholder:e.$t("Security.SSH.Basic.LoginAlarm.whitelist_1")},null,8,["value","placeholder"])]),h(n,{type:"primary",onClick:l},{default:w((()=>[N(A(e.$t("Public.Btn.Add")),1)])),_:1})]),h(p,{loading:L(o).loading,"max-height":500,data:L(o).data,columns:L(m)},null,8,["loading","data","columns"])])}}}),M={class:"h-full"},T=y({__name:"index",props:{config:{}},emits:["setName"],setup(a,{emit:t}){const s=a,i=t,{t:l}=x(),n=f("login"),o=[{key:"login",label:l("Security.SSH.Basic.LoginAlarm.index_1"),data:{config:s.config,onSetName:e=>{i("setName",e)}},component:q},{key:"whitelist",label:l("Security.SSH.Basic.LoginAlarm.index_2"),component:I}];return(a,t)=>{const s=e;return j(),b("div",M,[h(s,{value:L(n),"onUpdate:value":t[0]||(t[0]=e=>U(n)?n.value=e:null),data:o},null,8,["value"])])}}});export{T as default};
