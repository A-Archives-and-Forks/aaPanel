System.register(["./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1742891699271","./index.vue_vue_type_script_setup_true_lang-legacy20.js?v=1742891699271","./index.vue_vue_type_script_setup_true_lang-legacy11.js?v=1742891699271","./page_layout-legacy.js?v=1742891699271","./alarm-legacy.js?v=1742891699271","./vue-legacy.js?v=1742891699271","./naive-legacy.js?v=1742891699271","./index-legacy95.js?v=1742891699271","./index-legacy195.js?v=1742891699271","./public-legacy.js?v=1742891699271","./common-legacy.js?v=1742891699271","./__commonjsHelpers__-legacy.js?v=1742891699271"],(function(e,l){"use strict";var a,t,u,n,i,r,s,d,o,v,p,m,_,c,f,g,y,h,b,x,w,k,j,U,$,C,A,E,M,D,P,R,B,O,S,H,T,F,I,Y,G,J,L,N,V,q,z,K,Q;return{setters:[e=>{a=e._},e=>{t=e._},e=>{u=e._},e=>{n=e.bf,i=e.J,r=e.u,s=e.b,d=e.I,o=e.cD},e=>{v=e.n,p=e.a,m=e.g},e=>{_=e.d,c=e.R,f=e.S,g=e.ar,y=e.as,h=e.t,b=e.e,x=e.U,w=e.P,k=e.V,j=e.H,U=e.a2,$=e.ap,C=e.F,A=e.a1,E=e.a0,M=e.c,D=e.N,P=e.a5,R=e.O,B=e._,O=e.r,S=e.j,H=e.x,T=e.af,F=e.n},e=>{I=e.cn,Y=e.bY,G=e.cr,J=e.y,L=e.cm,N=e.cl,V=e.ch},e=>{q=e._},e=>{z=e._},e=>{K=e.c,Q=e.e},null,null],execute:function(){const l=_({__name:"form-template-field-none",props:{field:{}},setup:e=>(e,l)=>(c(),f("div"))}),W={key:0,class:"ml-10px whitespace-pre"},X=_({__name:"form-template-field-select",props:g({field:{}},{value:{default:null},valueModifiers:{}}),emits:["update:value"],setup(e){const l=e,a=y(e,"value"),t=h(l,"field"),u=b((()=>t.value.items.map((e=>({label:`${e.title}${t.value.unit||""}`,value:e.value})))));return(e,l)=>{const n=I;return c(),f(C,null,[x("div",{style:j({width:k(t).width?"160px":"260px"})},[w(n,{value:a.value,"onUpdate:value":l[0]||(l[0]=e=>a.value=e),disabled:k(t).disabled,options:k(u)},null,8,["value","disabled","options"])],4),k(t).suffix?(c(),f("div",W,U(k(t).suffix),1)):$("",!0)],64)}}}),Z={key:0,class:"ml-10px whitespace-pre"},ee=_({__name:"form-template-field-number",props:g({field:{}},{value:{},valueModifiers:{}}),emits:["update:value"],setup(e){const l=h(e,"field"),a=y(e,"value"),t=()=>{a.value||(a.value=l.value.default)};return(e,u)=>{const n=Y,i=G,r=J;return c(),f(C,null,[x("div",null,[w(r,null,{default:A((()=>[w(n,{value:a.value,"onUpdate:value":u[0]||(u[0]=e=>a.value=e),class:"w-100px",min:1,"show-button":!1,placeholder:"",onBlur:t},null,8,["value"]),k(l).unit?(c(),E(i,{key:0,class:"min-w-52px text-center"},{default:A((()=>[M(U(k(l).unit),1)])),_:1})):$("",!0)])),_:1})]),k(l).suffix?(c(),f("span",Z,U(k(l).suffix),1)):$("",!0)],64)}}}),le=_({__name:"form-template-field-radio",props:g({field:{}},{value:{},valueModifiers:{}}),emits:["update:value"],setup(e){const l=e,a=y(e,"value"),t=h(l,"field");return(e,l)=>{const u=L,n=N;return c(),E(n,{value:a.value,"onUpdate:value":l[0]||(l[0]=e=>a.value=e)},{default:A((()=>[(c(!0),f(C,null,D(k(t).items,(e=>(c(),E(u,{key:e.value,value:e.value},{default:A((()=>[M(U(e.title),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])}}}),ae=_({__name:"form-template-field-help",props:{field:{}},setup:e=>(e,l)=>{const a=q;return c(),E(a,null,{default:A((()=>[(c(!0),f(C,null,D(e.field.list,(e=>(c(),f("li",{key:e},U(e),1)))),128))])),_:1})}}),te=_({__name:"form-template-field",props:g({field:{}},{value:{},valueModifiers:{}}),emits:g(["change"],["update:value"]),setup(e,{emit:a}){const t=e,u=a,n=y(e,"value"),i=h(t,"field"),r=(()=>{switch(i.value.type){case"select":return X;case"number":return ee;case"radio":return le;case"help":return ae;default:return l}})(),s=e=>{u("change",e,i.value.attr)};return(e,l)=>(c(),E(P(k(r)),{value:n.value,"onUpdate:value":[l[0]||(l[0]=e=>n.value=e),s],field:k(i)},null,40,["value","field"]))}}),ue=_({__name:"form-template",props:g({type:{default:"none"},template:{default:()=>({field:[],sorted:[]})}},{value:{default:()=>({})},valueModifiers:{}}),emits:["update:value"],setup(e,{expose:l}){const a=e,{t:t}=R(),u=h(a,"type"),r=h(a,"template"),s=y(e,"value"),d=b((()=>{const{field:e,sorted:l}=r.value,a=[];return l.forEach((l=>{const t=[];l.forEach((l=>{const a=e.find((e=>e.attr===l));a&&t.push(a)})),a.push(t)})),a})),o=(e,l)=>{"system_disk"===u.value&&"cycle"===l&&v(),"project_status"===u.value&&"cycle"===l&&p()},v=()=>{const{cycle:e}=s.value;switch(e){case 1:r.value.field[2].unit="GB",r.value.field[2].name=t("Config.Alarm.index_26");break;case 2:r.value.field[2].unit="%",r.value.field[2].name=t("Config.Alarm.index_27")}},p=()=>{const{field:e}=r.value,[,l]=e,{all_items:a}=l;if(a&&n(s.value.cycle)){const e=a[i(s.value.cycle)-1];e.length>0?(l.items=e,s.value.project=e[0].value):(l.items=[],s.value.project=null)}},m=()=>{switch(u.value){case"system_disk":v();break;case"project_status":p()}};return m(),l({render:m}),(e,l)=>{const a=V;return c(!0),f(C,null,D(k(d),((e,l)=>(c(),f(C,null,[1===e.length?(c(!0),f(C,{key:0},D(e,(e=>(c(),E(a,{key:`${k(u)}-${e.attr}`,label:e.name},{default:A((()=>[w(te,{value:s.value[e.attr],"onUpdate:value":l=>s.value[e.attr]=l,field:e,onChange:o},null,8,["value","onUpdate:value","field"])])),_:2},1032,["label"])))),128)):$("",!0),e.length>1?(c(),f("div",{key:`${k(u)}-${l+1}`,class:"flex"},[(c(!0),f(C,null,D(e,((e,l)=>(c(),E(a,{key:`${k(u)}-${e.attr}`,label:e.name,"label-width":0!==l?"auto":void 0},{default:A((()=>[w(te,{value:s.value[e.attr],"onUpdate:value":l=>s.value[e.attr]=l,field:e,onChange:o},null,8,["value","onUpdate:value","field"])])),_:2},1032,["label","label-width"])))),128))])):$("",!0)],64)))),256)}}}),ne=_({__name:"form-advanced",props:g({config:{default:()=>({})},inverse:{type:Boolean,default:!1},timeRangeShow:{type:Boolean,default:!1}},{value:{default:()=>({day_num:0,total:0,send_interval:0,time_range:[]})},valueModifiers:{}}),emits:["update:value"],setup(e){const l=e,a=h(l,"config"),t=y(e,"value"),u=e=>l.inverse?!a.value[e]:a.value[e];return(e,l)=>{const a=Y,n=G,i=J,r=V,s=z;return c(),f(C,null,[u("day_num")?(c(),E(r,{key:0,label:e.$t("Config.Alarm.index_28"),path:"day_num"},{default:A((()=>[w(i,null,{default:A((()=>[w(a,{value:t.value.day_num,"onUpdate:value":l[0]||(l[0]=e=>t.value.day_num=e),class:"w-100px",min:0,"show-button":!1,placeholder:""},null,8,["value"]),w(n,{class:"min-w-52px text-center"},{default:A((()=>[M(U(e.$t("Public.Unit.Times")),1)])),_:1})])),_:1})])),_:1},8,["label"])):$("",!0),u("total")?(c(),E(r,{key:1,label:e.$t("Config.Alarm.index_30"),path:"total"},{default:A((()=>[w(i,null,{default:A((()=>[w(a,{value:t.value.total,"onUpdate:value":l[1]||(l[1]=e=>t.value.total=e),class:"w-100px",min:0,"show-button":!1,placeholder:""},null,8,["value"]),w(n,{class:"min-w-52px text-center"},{default:A((()=>[M(U(e.$t("Public.Unit.Times")),1)])),_:1})])),_:1})])),_:1},8,["label"])):$("",!0),u("send_interval")?(c(),E(r,{key:2,label:e.$t("Config.Alarm.index_31"),path:"send_interval"},{default:A((()=>[w(i,null,{default:A((()=>[w(a,{value:t.value.send_interval,"onUpdate:value":l[2]||(l[2]=e=>t.value.send_interval=e),class:"w-100px",min:0,"show-button":!1,placeholder:""},null,8,["value"]),w(n,{class:"min-w-52px text-center"},{default:A((()=>[M(U(e.$t("Public.Unit.Seconds")),1)])),_:1})])),_:1})])),_:1},8,["label"])):$("",!0),e.timeRangeShow?(c(),E(r,{key:3,label:e.$t("Config.Alarm.index_33"),path:"time_range","show-feedback":!1},{default:A((()=>[w(s,{value:t.value.time_range,"onUpdate:value":l[3]||(l[3]=e=>t.value.time_range=e)},null,8,["value"])])),_:1},8,["label"])):$("",!0)],64)}}}),ie={class:"px-20px py-24px"},re={class:"w-260px"},se={class:"w-260px"};e("default",_({__name:"form",props:{isEdit:{type:Boolean},row:{}},emits:["refresh"],setup(e,{expose:l,emit:i}){const _=e,g=r(),{isPro:y}=B(g),j=i,{t:U}=R(),$=h(_,"isEdit"),C=O(null),E=O(),D=O(!1),P=S({type:null,method:[],day_num:0,total:0,send_interval:0,time_range:[(new Date).setHours(0,0,0,0),(new Date).setHours(23,59,59,0)],template:{}}),Y=S({day_num:{trigger:["input","blur"],validator:()=>!(!P.day_num&&0!==P.day_num)||(z.value.day_num||(D.value=!0),new Error(U("Config.Alarm.index_22")))},total:{trigger:["input","blur"],validator:()=>!(!P.total&&0!==P.total)||(z.value.total||(D.value=!0),new Error(U("Config.Alarm.index_23")))},send_interval:{trigger:["input","blur"],validator:()=>!(!P.send_interval&&0!==P.send_interval)||(z.value.send_interval||(D.value=!0),new Error(U("Config.Alarm.index_24")))},method:{trigger:["change"],validator:()=>0!==P.method.length||new Error(U("Config.Alarm.index_25"))}}),G=H([]),J=b((()=>G.value.map(((e,l)=>({label:e.title,value:l,disabled:"80"===e.id&&!y.value,data:e}))))),L=b((()=>{let e="none";const l=G.value[P.type||0];return l&&(e=l.source),e})),N=e=>w("div",null,[w("span",null,[e.label,M(" ")]),14===e.value?w("span",{class:"float-right cursor-pointer color-#ffb800",onClick:()=>{Q({source:323})}},[M("PRO")]):""]),q=O({field:[],sorted:[]}),z=O({}),W=()=>G.value[P.type||0],X=()=>{const e=W();q.value=e.template,q.value.field.forEach((l=>{l.default?P.template[l.attr]=l.default:P.template[l.attr]=e.default[l.attr]})),P.day_num=0,P.total=0,P.send_interval=0;const l={},{advanced_default:a}=e;s(a)&&Object.entries(a).forEach((([e,a])=>{s(a)?Object.entries(a).forEach((([e,a])=>{l[e]=!0,ee(e,a)})):n(a)&&(l[e]=!0,ee(e,a))})),z.value=l},Z=["day_num","total","send_interval"],ee=(e,l)=>{Z.includes(e)&&(P[e]=l)},le=()=>{X(),F((()=>{E.value.render()}))},{loading:ae,setLoading:te}=K(),de=e=>{const l=new Date,a=l.getFullYear(),t=l.getMonth(),u=l.getDate();return new Date(a,t,u).getTime()+1e3*e};return(async()=>{await(async()=>{try{te(!0);const{message:e}=await m();d(e)&&(G.value=e,P.type=0,$.value||X())}finally{te(!1)}})();const{row:e}=_;$.value&&e&&(P.type=G.value.findIndex((l=>l.id===e.template_id)),X(),P.method=e.sender,e.number_rule&&(P.day_num=e.number_rule.day_num,P.total=e.number_rule.total),e.time_rule&&(P.send_interval=e.time_rule.send_interval,e.time_rule.time_range&&e.time_rule.time_range.length>0&&(P.time_range=[de(e.time_rule.time_range[0]),de(e.time_rule.time_range[1])])),Object.keys(P.template).forEach((l=>{e.task_data&&(P.template[l]=e.task_data[l])})),await F(),E.value.render())})(),l({onConfirm:async()=>{await(C.value?.validate());const{row:e}=_,l=(()=>{const e=W();return{template_id:e.id,task_data:{task_data:{tid:e.id,type:e.source,title:e.title,status:!0,count:0,interval:600,project:"",...P.template},sender:P.method,number_rule:{day_num:P.day_num,total:P.total},time_rule:{send_interval:P.send_interval,time_range:[o(P.time_range[0]),o(P.time_range[1])]}}}})();$.value&&e?await v({...l,task_id:e.id}):await p(l),j("refresh")}}),(e,l)=>{const n=I,i=V,r=u,s=t,d=a;return c(),f("div",ie,[w(d,{ref_key:"formRef",ref:C,model:k(P),rules:k(Y),"label-width":"140"},{default:A((()=>[w(i,{label:e.$t("Config.Alarm.index_19")},{default:A((()=>[x("div",re,[w(n,{value:k(P).type,"onUpdate:value":[l[0]||(l[0]=e=>k(P).type=e),le],options:k(J),loading:k(ae),"render-label":N},null,8,["value","options","loading"])])])),_:1},8,["label"]),w(ue,{ref_key:"templateRef",ref:E,value:k(P).template,"onUpdate:value":l[1]||(l[1]=e=>k(P).template=e),type:k(L),template:k(q)},null,8,["value","type","template"]),w(ne,{value:k(P),"onUpdate:value":l[2]||(l[2]=e=>T(P)?P.value=e:null),config:k(z)},null,8,["value","config"]),w(i,{label:e.$t("Config.Alarm.index_20"),path:"method"},{default:A((()=>[x("div",se,[w(r,{value:k(P).method,"onUpdate:value":l[3]||(l[3]=e=>k(P).method=e)},null,8,["value"])])])),_:1},8,["label"]),w(s,{show:k(D),"onUpdate:show":l[5]||(l[5]=e=>T(D)?D.value=e:null),title:e.$t("Config.Alarm.index_21")},{default:A((()=>[w(ne,{value:k(P),"onUpdate:value":l[4]||(l[4]=e=>T(P)?P.value=e:null),config:k(z),inverse:!0,"time-range-show":!0},null,8,["value","config"])])),_:1},8,["show","title"])])),_:1},8,["model","rules"])])}}}))}}}));
