const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/FileTask.js?v=1756367574781","js/page_layout.js?v=1756367574781","js/vue.js?v=1756367574781","js/__commonjsHelpers__.js?v=1756367574781","js/naive.js?v=1756367574781","js/common.js?v=1756367574781","js/public.js?v=1756367574781","css/public.css?v=1756367574781","css/page_layout.css?v=1756367574781","js/index.js?v=1756367574781","css/index107.css?v=1756367574781","js/soft2.js?v=1756367574781","js/soft.js?v=1756367574781","js/file2.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang7.js?v=1756367574781","css/FileTask.css?v=1756367574781","js/PasteConfirm.js?v=1756367574781","js/CalcVerify.js?v=1756367574781","css/CalcVerify.css?v=1756367574781","css/PasteConfirm.css?v=1756367574781","js/UploadFile.js?v=1756367574781","css/UploadFile.css?v=1756367574781","js/RemoteDownload.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang.js?v=1756367574781","js/SearchFileContent.js?v=1756367574781","js/ResourceManagerWindow.js?v=1756367574781","css/ResourceManagerWindow.css?v=1756367574781","css/SearchFileContent.css?v=1756367574781","js/FavoriteList.js?v=1756367574781","js/ShareList.js?v=1756367574781","js/ShareDetail.vue_vue_type_script_setup_true_lang.js?v=1756367574781","js/Backup.js?v=1756367574781","js/Recycle.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang12.js?v=1756367574781","js/index244.js?v=1756367574781","css/index59.css?v=1756367574781","css/Recycle.css?v=1756367574781","js/Terminal.js?v=1756367574781","js/terminal2.js?v=1756367574781","js/xterm.js?v=1756367574781","js/xterm-addon-canvas.js?v=1756367574781","css/xterm-addon-canvas.css?v=1756367574781","css/terminal.css?v=1756367574781","js/SoftLink.js?v=1756367574781","js/Share.js?v=1756367574781","js/index199.js?v=1756367574781","js/Permission.js?v=1756367574781","css/Permission.css?v=1756367574781","js/Properties.js?v=1756367574781","js/index108.js?v=1756367574781","css/index21.css?v=1756367574781","css/Properties.css?v=1756367574781","js/Del.js?v=1756367574781","css/Del.css?v=1756367574781","js/Compression.js?v=1756367574781","js/Decompress.js?v=1756367574781","js/index183.js?v=1756367574781","js/index101.js?v=1756367574781","css/index81.css?v=1756367574781"])))=>i.map(i=>d[i]);
import{v as t,r as e,t as a,x as n,i,w as l,a as s,m as o,d as r,be as c,p as u,cm as p,_ as d,h as f,n as m,a7 as v,R as h,q as y,u as g,cn as _,co as w,cp as b}from"./page_layout.js?v=1756367574781";import{r as k,ak as x,aC as C,aD as S,_ as P,n as R,ap as z,W as O,F,k as D,c as L,R as T,V as j,H as M,U as E,i as I,a2 as N,a3 as V,S as q,I as U,O as A,j as K,a4 as G,x as B,P as W,f as H,ad as J,ae as Y,o as X,an as Z,aw as Q,G as tt,l as et,v as at,aj as nt,av as it,w as lt,u as st,b as ot,$ as rt,h as ct,a7 as ut,p as pt,a0 as dt,a6 as ft}from"./vue.js?v=1756367574781";import{b as mt,u as vt,a as ht,q as yt}from"./public.js?v=1756367574781";import{_ as gt}from"./index.js?v=1756367574781";import{a0 as _t}from"./common.js?v=1756367574781";import{c as wt}from"./soft2.js?v=1756367574781";import{_ as bt,dc as kt,dl as xt,aC as Ct,di as St,aX as Pt,au as Rt,av as zt,dg as Ot,dh as Ft,dS as Dt}from"./naive.js?v=1756367574781";import{a as Lt}from"./soft.js?v=1756367574781";import{i as Tt}from"./file2.js?v=1756367574781";import{_ as jt}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1756367574781";function Mt(t,a,n){e("FileEditorPath",n),openEditorView(t,a)}async function Et(){await async function(){await t("/static/vite/oldjs/jquery-2.2.4.min.js?v=1756367574781"),await t("/static/layer/layer.js?v=1756367574781"),await t("/static/vite/oldjs/jsencrypt.min.js?v=1756367574781"),await t("/static/language/English/lan.js?v=1756367574781"),await t("/static/ace/ace.js?v=1756367574781"),await t("/static/ace/ext-language_tools.js?v=1756367574781"),await t("/static/vite/oldjs/polyfill.min.js?v=1756367574781"),await t("/static/vite/oldjs/public.js?v=1756367574781"),await t("/static/vite/oldjs/public_backup.js?v=1756367574781")}(),window.usePay=mt,$("#file-main").append('\n\t\t<script type="text/template" id="aceTmplate">\n\t\t\t\t<div id="ace_conter">\n\t\t\t\t\t\t<div class="ace_header" style="top: 0">\n\t\t\t\t\t\t\t\t<span class="saveFile"><i class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></i><span>Save</span></span>\n\t\t\t\t\t\t\t\t<span class="saveFileAll"><i class="glyphicon glyphicon-duplicate" aria-hidden="true"></i><span>Save All</span></span>\n\t\t\t\t\t\t\t\t<span class="refreshs"><i class="glyphicon glyphicon-refresh" aria-hidden="true"></i><span>Refresh</span></span>\n\t\t\t\t\t\t\t\t<span class="searchs"><i class="glyphicon glyphicon-search" aria-hidden="true"></i><span>Search</span></span>\n\t\t\t\t\t\t\t\t<span class="replaces"><i class="glyphicon glyphicon-retweet" aria-hidden="true"></i><span>Replace</span></span>\n\t\t\t\t\t\t\t\t<span class="jumpLine"><i class="glyphicon glyphicon-pushpin" aria-hidden="true"></i><span>JumpLine</span></span>\n\t\t\t\t\t\t\t\t<span class="fontSize"><i class="glyphicon glyphicon-text-width" aria-hidden="true"></i><span>Font</span></span>\n\t\t\t\t\t\t\t\t<span class="themes"><i class="glyphicon glyphicon-magnet" aria-hidden="true"></i><span>Theme</span></span>\n\t\t\t\t\t\t\t\t<span class="setUp"><i class="glyphicon glyphicon-cog" aria-hidden="true"></i><span>Set</span></span>\n\t\t\t\t\t\t\t\t<span class="helps"><i class="glyphicon glyphicon-question-sign" aria-hidden="true"></i><span>Help</span></span>\n\t\t\t\t\t\t\t\t<div class="pull-down" title="Hide toolbar" style="top: 0"><i class="glyphicon glyphicon-menu-down" aria-hidden="true"></i></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ace_overall" style="top: 35px;">\n\t\t\t\t\t\t\t\t\x3c!-- 编辑器目录 --\x3e\n\t\t\t\t\t\t\t\t<div class="ace_catalogue" style="left:0px">\n\t\t\t\t\t\t\t\t\t\t<div class="ace_catalogue_title">Directory<div class="dir-menu-right"><span class="glyphicon glyphicon-minus" aria-hidden="true"></span></div></div>\n\t\t\t\t\t\t\t\t\t<div class="ace_dir_tools">\n\t\t\t\t\t\t\t\t\t\t<div class="upper_level"  title="Return to parent directory">\n\t\t\t\t\t\t\t\t\t\t\t<i class="glyphicon glyphicon-share-alt" aria-hidden="true"></i>\n\t\t\t\t\t\t\t\t\t\t\t<span>Back</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="search_file" title="Search File">\n\t\t\t\t\t\t\t\t\t\t\t<i class="glyphicon glyphicon-search" aria-hidden="true"></i>\n\t\t\t\t\t\t\t\t\t\t\t<span>Search</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="new_folder" title="File/Folder">\n\t\t\t\t\t\t\t\t\t\t\t<i class="glyphicon glyphicon-plus"  aria-hidden="true"></i>\n\t\t\t\t\t\t\t\t\t\t\t<span>New</span>\n\t\t\t\t\t\t\t\t\t\t\t<ul class="folder_down_up">\n\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="2"><i class="folder-icon"></i>Folder</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="3"><i class="text-icon"></i>File</li>\n\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="refresh_dir" title="Refresh list">\n\t\t\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>\n\t\t\t\t\t\t\t\t\t\t\t<span>Refresh</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<span class="ace_editor_main_storey"></span>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t<div class="ace_catalogue_list">\n\t\t\t\t\t\t\t\t\t\t\t\t<ul class="cd-accordion-menu"></ul>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul class="ace_catalogue_menu">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="0"><i class="glyphicon glyphicon-refresh" aria-hidden="true"></i><span>Refresh</span></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="1"><i class="glyphicon glyphicon-folder-open" aria-hidden="true"></i><span>Subdirectory</span></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="2"><i class="folder-icon"></i><span>New Folder</span></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="3"><i class="text-icon"></i><span>New File</span></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="4"><i class="rename-icon img-icon"></i><span>Rename</span></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="5"><i class="down-icon img-icon"></i><span>Download</span></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="6"><i class="del-icon img-icon"></i><span>Delete</span></li>\n\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="ace_catalogue_drag_icon">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="drag_icon_conter"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="fold_icon_conter" title="Hide file directory"></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\x3c!-- 编辑内容 --\x3e\n\t\t\t\t\t\t\t\t<div class="ace_editor_main">\n\t\t\t\t\t\t\t\t\t\t<ul class="ace_conter_menu"></ul>\n\t\t\t\t\t\t\t\t\t\t<div class="ace_conter_tips"><div class="tips"></div></div>\n\t\t\t\t\t\t\t\t\t\t<div class="ace_editor_main_storey"></div>\n\t\t\t\t\t\t\t\t\t\t<div class="ace_conter_editor"></div>\n\t\t\t\t\t\t\t\t\t\t<div class="ace_conter_toolbar">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="pull-left size_ellipsis">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span data-type="path" class="size_ellipsis"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="pull-right">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span data-type="cursor"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span data-type="history"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span data-type="tab"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span data-type="encoding"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span data-type="lang"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="ace_toolbar_menu" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-tabs" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">Set tabs</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul class="tabsType">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="nbsp">Indent using spaces</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="tabs">Indent using "Tab"</li>\n\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title" style="margin-top:15px">Set the tab length</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul class="tabsSize">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="1">1</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="2">2</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="3">3</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="4">4</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="5">5</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="6">6</li>\n\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-encoding" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">Set file save encoding format</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul></ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-files" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-conter">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="text" class="menu-input" placeholder="Input language mode">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-close" aria-hidden="true"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">Set file language association</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul></ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-fontSize" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">Set editor font size</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-conter">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="set_font_size">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="number" min="12" max="45"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="tips error">Font setting range 12-45</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class="btn-save">Save</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-jumpLine" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">Jump to specified line</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-conter">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="set_jump_line">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="number" min="0"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class="btn-save">Jump</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-themes" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">Set editor theme</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul></ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-history" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">History version</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul></ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-setUp"  style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">Editor setting [ Some settings need to be restart editor ]</div>\n\t\t\t\t\t\t\t\t\t\t\t<ul class="editor_menu">\n\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="wrap">Auto wrap</li>\n\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="enableLiveAutocompletion">Code autocomplete</li>\n\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="enableSnippets">Enable snippets</li>\n\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="showInvisibles">Show hidden characters</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="showLineNumbers">Show line numbers</li>\n\n\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t<\/script>\n\t')}function It(t,e,a){const n=k(!0),i=k(0),l=k(0),s=k(0),o=k(0),r=k(0),c=k(0),u=k(0),p=k(0);let d;x(t)?d=t.value:"string"==typeof t?d=document.querySelector(t):t instanceof Element&&(d=t);const f=function(){let t=null;return!!e&&(()=>{t||(t=setTimeout(()=>{e({m_flag:n,m_left:i,m_right:l,m_bottom:o,m_top:s,m_x:u,m_y:p,m_height:r,m_width:c}),clearTimeout(t),t=null},10))})}();function m(t){const{left:e,right:a,top:n,bottom:d,height:f,width:m,x:v,y:h}=t.getBoundingClientRect();i.value=e,l.value=a,s.value=n,o.value=d,r.value=f,c.value=m,u.value=v,p.value=h}const v=t=>{if(a&&a(t,{m_flag:n,m_left:i,m_right:l,m_bottom:o,m_top:s,m_x:u,m_y:p,m_height:r,m_width:c}),!n.value)return;const{left:e,right:v,top:h,bottom:y}=d.getBoundingClientRect(),g=document.createElement("div"),_=t.clientX,w=t.clientY;g.style.position="absolute",g.style.left=_-e+"px",g.style.top=w-h+"px",g.style.width="0px",g.style.height="0px",g.style.backgroundColor="rgba(135, 182, 130, 0.1)",g.classList.add("district-wrapper"),d.appendChild(g),t.preventDefault();const{pause:b,resume:k,isActive:x}=C(()=>{z.scrollTop>=z.scrollHeight-z.clientHeight?b():(g.style.height=g.offsetHeight+10+"px",g.style.marginTop=parseInt(getComputedStyle(g).marginTop)-10+"px",z.scrollTop+=10,O=z.scrollTop,m(g),f&&f())},{immediate:!1}),{pause:S,resume:P,isActive:R}=C(()=>{z.scrollTop<=0?S():(g.style.height=g.offsetHeight+10+"px",z.scrollTop-=10,F+=10,m(g),f&&f())},{immediate:!1}),z=d.querySelector(".n-scrollbar-container");let O=0,F=0;document.onmousemove=t=>{t.preventDefault(),x.value||R.value||(_<=t.clientX?g.style.width=t.clientX-_+"px":(g.style.width=_-t.clientX+"px",g.style.marginLeft=-(_-t.clientX)+"px"),w<=t.clientY?(g.style.height=t.clientY-w+O+"px",g.style.marginTop=-O+"px"):(g.style.height=w-t.clientY+F+"px",g.style.marginTop=-(w-t.clientY)+"px"),t.clientX<e&&(g.style.width=_-e+"px",g.style.marginLeft=-(_-e)+"px"),t.clientX>v&&(g.style.width=v-_+"px")),t.clientY>y&&k(),t.clientY<h&&P(),m(g),f&&f()},document.onmouseup=()=>{document.onmousemove=null,d.contains(g)&&d.removeChild(g)}};return d&&(d.onmousedown=v),{m_flag:n,m_x:u,m_y:p,m_left:i,m_right:l,m_top:s,m_bottom:o,m_height:r,m_width:c}}function Nt(t,e){const a=S(t.m_left),n=S(t.m_right),i=S(t.m_top),l=S(t.m_bottom),s=S(e.left),o=S(e.right),r=S(e.top),c=S(e.bottom);return!(o<a||s>n||c<i||r>l)}function Vt(t){t.card_hover=!0}function qt(t){t.card_hover=!1}const{t:Ut}=i.global;async function At(t){const{shareList:e,shareListPage:i,shareListTotal:l}=t;try{const t=await a.post("/files?action=get_download_url_list",{p:i.value,row:12});return e.value=t.message.data,l.value=n(t.message.page),e.value}catch(s){return console.warn(s),[]}}async function Kt(t,e){try{await a.post("/files?action=remove_download_url",{id:e},{requestOptions:{loading:Ut("file.shareListModal.deletingShare"),successMessage:!0}}),$t(t)}catch(n){console.warn(n)}}const Gt=z(t=>le(t),100),{t:Bt}=i.global;async function $t(t,e){var a;const{tableLoading:i,currentPath:l,favoriteList:s,fileRecycle:o,fileList:r,filesView:c,dirNums:u,fileNums:p,total:d,page:f,size:m,sort:v,reverse:h,diskMountPoint:y,currentFile:g,currentDirSize:_,uploadFileList:w,dragUploadRef:b}=t;i.value=!0;try{const i=await ea(l.value,t=>{s.value=t.store,o.value=t.file_recycle,u.value=t.dir.length,p.value=t.files.length,d.value=n(t.page),y.value=t.disk,l.value=t.path},{p:f.value,showRow:m.value,...v.value?{sort:v.value,reverse:h.value}:{},disk:!0,...e});g.value=null,_.value=-1,f.value=1;const k=await Ht(t);let x=[];k.length&&(x=k.map(t=>t.label));const C=await At(t);let S=[];C.length&&(S=C.map(t=>t.filename)),r.value=i.map(t=>(t.remarks_hover=!1,t.isEditRemarks=!1,t.isCreate=!1,t.card_hover=!1,t.card_choosed=!1,t.isRenameForCard=!1,t.operation_show=!1,x.includes(t.nm)&&(t.isFavorite=!0),S.includes(t.path)&&(t.isShare=!0),t)),w.value=[],null==(a=b.value)||a.listenDragEvent(),R(()=>{"list"==c.value&&(Wt(t),function(t){const{tableRef:e,choosePathRef:a}=t;let n=0;const i=setInterval(()=>{if(n<10?n++:clearInterval(i),e.value){const n=e.value;n.querySelector(".n-data-table-base-table-body")&&Wt(t),n.oncontextmenu=e=>{e.preventDefault(),Jt(e,t)},n.onclick=e=>{"INPUT"!=e.target.nodeName&&(Gt(t),a.value.handleEnterDown())},clearInterval(i)}},1e3)}(t))}),function(t){const{choosedKeys:e,waitForPaste:a}=t;e.value=[]}(t)}catch(k){console.warn(k)}finally{i.value=!1}}function Wt(t){const{tableRef:e}=t;e.value&&It(e.value.querySelector(".n-data-table-base-table-body"),e=>function(t,e){const{trRectArr:a,choosedKeys:n}=t,i=[];for(let l=0;l<a.value.length;l++){const[[t,n]]=Object.entries(a.value[l]);Nt(e,n.getClientRects()[0])&&i.push(t)}n.value=[...new Set(i)]}(t,e),(e,a)=>function(t,e,a){const{choosedKeys:n,isMiniScreen:i}=a;if(t.target.closest(".n-checkbox-box"))return;if(t.target.classList.contains("file-checkbox")){const e=t.target.closest("tr").dataset.key;return void(n.value.includes(e)?n.value=n.value.filter(t=>t!==e):n.value.push(e))}if(function(t){const{normalTrList:e,trRectArr:a}=t;e.value=document.querySelectorAll('[class*="normal-tr"]');const n=[];for(let i=0;i<e.value.length;i++){const t=e.value[i].dataset.key;n.push({[t]:e.value[i]})}a.value=n}(a),t.target.closest("tr")){const e=t.target.closest("tr").dataset.key;if(0==t.button&&(n.value=[e]),2==t.button){if(n.value.includes(e))return;n.value=[e]}}"INPUT"==t.target.nodeName?e.m_flag.value=!1:e.m_flag.value=!0}(e,a,t))}async function Ht(t){const{resetFavoriteOptions:e,favoriteOptions:n}=t;try{const t=(await a.post("/files?action=get_files_store",{},{requestOptions:{isOriginalResult:!0}})).message.map(t=>({icon:t.type,label:t.name,key:t.path}));return e(),n.value=[...t,...n.value],n.value}catch(i){return console.warn(i),[]}}function Jt(t,e){const{choosedKeys:a,contextRef:n}=e;console.log();let i="empty";t.target.closest("tr")&&(i=a.value.length>1?"multiple":1==a.value.length?"single":"empty"),n.value.filesOperation(t,i)}function Yt(){var t;const e=null==(t=document.querySelector("#createInput"))?void 0:t.querySelector("input");null==e||e.focus(),null==e||e.select()}async function Xt(t,e){const{close:n}=o.loading("Processing, please wait...");try{await wt("tamper_core",71);const{message:n}=await a.post("/tamper_core/get_effective_path.json",{path:e.path},{requestOptions:{isOriginalResult:!0}});if(r(n)&&n.status){const{data:a}=n;"dir"===e.type?function(t,e,a){const{pid:n,lock:i,action:l}=a,s=(i?"Turning off protection ":"Turning on protection ")+"[".concat(e.path,"]"),o=Bt(i?"file.tableController.afterTurningOffProtectionDir":"file.tableController.afterTurningOnProtectionDir");ht({width:480,title:s,content:o,onConfirm:async()=>{if("create"===l[0]&&0===n)return await Zt(e.path,[]),void $t(t);const a=[];i?a.push({key:-1!=e.path.indexOf("/www/server/panel/class")?"add_wd":l[0],values:[e.path]}):a.push({key:l[0],values:[e.path]}),await Qt(n,a),$t(t)}})}(t,e,a):function(t,e,a){const{pid:n,lock:i,action:l}=a,s=Bt(i?"file.tableController.turningOffProtection":"file.tableController.turningOnProtection",{path:e.path}),o=Bt(i?"file.tableController.afterTurningOffProtectionFile":"file.tableController.afterTurningOnProtectionFile"),r=k(!1),c=k(!0);ht({title:s,width:480,content:()=>O(F,null,[O("div",null,[o]),O("div",{class:"mt-8px"},[O(bt,{checked:c.value,"onUpdate:checked":t=>c.value=t},{default:()=>[O("span",null,[Bt(i?"file.tableController.turningOffProtectionFile":"file.tableController.turningOnProtectionFile",{path:e.nm})])]})]),O("div",{class:"mt-8px"},[O(bt,{checked:r.value,"onUpdate:checked":t=>r.value=t},{default:()=>[O("span",null,[Bt(i?"file.tableController.turningOffProtectionSuffix":"file.tableController.turningOnProtectionSuffix",{suffix:e.ext})])]})])]),onConfirm:async()=>{if("create"===l[0]&&0===n){const a=e.path.substring(0,e.path.lastIndexOf("/")),n=[];if(c.value){const t=e.path.split("/"),a=t.length>=2?t[t.length-2]:"";n.push("".concat(a,"/").concat(e.nm))}return r.value&&n.push("."+e.ext),await Zt(a,n),void $t(t)}const a=[];i?(c.value&&(a.push({key:"remove_bf",values:[e.path]}),a.push({key:"add_wf",values:[e.path]})),r.value&&a.push({key:"remove_bf",values:["."+e.ext]})):(c.value&&(a.push({key:"add_bf",values:[e.path]}),a.push({key:"remove_wf",values:[e.path]})),r.value&&a.push({key:"add_bf",values:["."+e.ext]})),await Qt(n,a),$t(t)}})}(t,e,a)}}finally{n()}}async function Zt(t,e){const{message:n}=await a.post("/tamper_core/create_path.json",{path:t,exts:JSON.stringify(e)},{requestOptions:{loading:Bt("file.tableController.creatingDirectoryProtection"),isOriginalResult:!0}});if(r(n)){if(!n.status)return o.error(n.msg),Promise.reject();o.success(n.msg)}}async function Qt(t,e){const{message:n}=await a.post("/tamper_core/batch_setting.json",{pid:t,settings:JSON.stringify(e)},{requestOptions:{loading:Bt("file.tableController.executing"),isOriginalResult:!0}});if(r(n)){if(!n.status)return o.error(n.msg),Promise.reject();o.success(n.msg)}}function te(t,e){const{currentPreviewImg:a,previewShow:n}=t;a.value=e,n.value=!0}function ee(t,e){const{currentPreviewVideo:a,previewVideoShow:n}=t;a.value={path:e.path,name:e.nm},n.value=!0}async function ae(t){const{currentFile:e,currentPath:a}=t;if(e.value&&(e.value.isCreate&&e.value.isRename||e.value.isRenameForCard)&&(e.value.editName||(e.value.isCreate=!1),e.value.editName==e.value.nm&&(e.value.isCreate=!1),e.value.isCreate&&e.value.isRename||e.value.isRenameForCard)){if(e.value.editName!==e.value.nm){try{await(n=e.value.path,i=a.value+"/"+e.value.editName,Ee(n,i,{rename:!0})),$t(t)}catch(l){console.log(l)}finally{e.value.isCreate=!1,e.value.isRenameForCard=!1,e.value.isRename=!1}return!0}e.value.isCreate=!1,e.value.isRenameForCard=!1,e.value.isRename=!1}var n,i}async function ne(t){const{currentFile:e,currentPath:n,fileList:i}=t;if(e.value&&e.value.isCreate&&!e.value.isRename)if(""==e.value.editName)i.value.shift();else try{return"dir"==e.value.type?await ue(n.value+"/"+e.value.editName):await async function(t){try{await a.post("/files?action=CreateFile",{path:t},{requestOptions:{loading:ce("file.buttonGroup.loading.creatingFile"),successMessage:!0}})}catch(e){console.warn(e)}}(n.value+"/"+e.value.editName),await $t(t),!0}catch(l){i.value.shift()}}async function ie(t){const{currentFile:e}=t;if(e.value&&e.value.isEditRemarks)return e.value.editRemarks!=e.value.rmk?(await async function(t){await a.post("/files?action=set_file_ps",t,{requestOptions:{successMessage:!0}})}({filename:e.value.path,ps_type:0,ps_body:e.value.editRemarks}),await $t(t),!0):(e.value.isEditRemarks=!1,e.value.remarks_hover=!1,!1)}async function le(t){if(await ie(t))return;if(await ae(t))return;await ne(t)}async function se(){return a.post("/task?action=get_task_lists",{status:-3})}async function oe(t){if(document.querySelector(".file-task-modal"))return;const{message:e}=await se();l(e)&&e.length>0&&vt({title:Bt("file.tableController.realtimeTaskQueue"),width:510,class:"file-task-modal",unstableShowMask:!1,data:{store:t,taskList:e},component:P(()=>s(()=>import("./FileTask.js?v=1756367574781"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])))})}async function re(t){return a.post("/task?action=remove_task",{id:t},{requestOptions:{loading:Bt("file.tableController.deletingTask"),successMessage:!0}})}const{t:ce}=i.global;async function ue(t){try{await a.post("/files?action=CreateDir",{path:t},{requestOptions:{loading:ce("file.buttonGroup.loading.creatingDirectory"),successMessage:!0}})}catch(e){console.warn(e)}}async function pe(t,e){try{await a.post("/files?action=CreateLink",{sfile:t,dfile:e},{requestOptions:{loading:ce("file.buttonGroup.loading.creatingSoftlink"),successMessage:!0}})}catch(n){console.warn(n)}}function de(t){la(t,"UploadFile",t=>{t.value.open()})}function fe(t){la(t,"RemoteDownload",t=>{t.value.open()})}function me(t){la(t,"SearchFileContent",t=>{t.value.open()})}const ve=t=>{la(t,"FavoriteList",t=>{t.value.open()})};function he(t,e){const{currentPath:a}=t;"management"==e?ve(t):(a.value=e,$t(t))}function ye(t){la(t,"ShareList",t=>{t.value.open()})}function ge(t){const{currentPath:e}=t;e.value="/",$t(t)}function _e(t){la(t,"Backup",t=>{t.value.open()})}function we(t){la(t,"Recycle",t=>{t.value.open()})}function be(t){la(t,"Terminal",t=>{t.value.open()})}function ke(t,e,a,n){const{fileList:i,currentFile:l}=t,s={nm:e,isCreate:!0,type:a,ext:n,path:"",editName:e};l.value=s,l.value.editName=l.value.nm,i.value.unshift(l.value),R(Yt)}function xe(t,e){switch(e){case"dir":ke(t,ce("file.buttonGroup.defaultNames.untitledDirectory"),"dir","folder");break;case"file":ke(t,ce("file.buttonGroup.defaultNames.untitledFile"),"file","unknown");break;case"softlink":la(t,"Softlink",t=>{t.value.open()})}}function Ce(t){const{optionToolsRef:e,isMiniScreen:a}=t;e.value.offsetWidth<1560?a.value=!0:a.value=!1}async function Se(t,e){try{await a.post("/files?action=del_files_store",{path:e},{requestOptions:{loading:ce("file.buttonGroup.loading.deletingFavorite"),successMessage:!0}}),$t(t)}catch(n){console.warn(n)}}const{t:Pe}=i.global,Re=t=>{const{fileRecycle:e}=t;e.value?ze(t):Oe(t)},ze=t=>{const{currentPath:e,choosedKeys:a,fileList:n}=t,i=n.value.filter(t=>a.value.includes(t.nm));ht({title:1===i.length?Pe("file.deleteController.deleteSingleFileTitle",{name:i[0].nm}):Pe("file.deleteController.batchDeleteTitle"),content:Pe("file.deleteController.recycleBinMessage"),width:400,onConfirm:async()=>{1===i.length?await Fe(i[0].path,i[0].type):await De(i.map(t=>t.nm),e.value),$t(t)}})},Oe=t=>{const{currentPath:e,choosedKeys:a,fileList:n}=t,i=n.value.filter(t=>a.value.includes(t.nm));yt({title:1===i.length?Pe("file.deleteController.deleteSingleFileTitle",{name:i[0].nm}):Pe("file.deleteController.batchDeleteTitle"),content:()=>O("span",{class:"text-error"},[Pe("file.deleteController.permanentDeleteMessage")]),width:400,onConfirm:async()=>{1===i.length?await Fe(i[0].path,i[0].type):await De(i.map(t=>t.nm),e.value),$t(t)}})};async function Fe(t,e){await a.post("/files?action=".concat("dir"===e?"DeleteDir":"DeleteFile"),{path:t},{requestOptions:{loading:Pe("file.deleteController.deletingSingle"),successMessage:!0}})}async function De(t,e){await a.post("/files?action=SetBatchData",{data:JSON.stringify(t),type:4,path:e},{requestOptions:{loading:Pe("file.deleteController.deletingBatch"),successMessage:!0}})}const{t:Le}=i.global;async function Te(t,e){return(await a.post("/files?action=CheckExistsFiles",{dfile:t,filename:e},{requestOptions:{isOriginalResult:!0}})).message.length>0}async function je(t,e){return await a.post("/files?action=CopyFile",{sfile:t,dfile:e},{requestOptions:{loading:Le("file.contextMenu.loading.copying"),successMessage:!0}})}async function Me(t,e){return await a.post("/files?action=BatchPaste",{type:t,path:e},{requestOptions:{loading:Le("file.contextMenu.loading.pasting"),successMessage:!0}})}async function Ee(t,e,n){return await a.post("/files?action=MvFile",{sfile:t,dfile:e,...n},{requestOptions:{loading:Le("file.contextMenu.loading.moving"),successMessage:!0}})}async function Ie(t,e,n,i){try{await a.post("/files?action=Zip",{sfile:t,dfile:e,z_type:n,path:i},{requestOptions:{loading:Le("file.contextMenu.loading.compressing"),successMessage:!0}})}catch(l){console.warn(l)}}async function Ne(t){await a.post("/files?action=UnZip",t,{requestOptions:{loading:Le("file.contextMenu.loading.decompressing"),successMessage:!0}})}function Ve(t,e){return e.map(e=>t[e])}function qe(t){const{choosedKeys:e,currentPath:a,fileList:n}=t,i=n.value.find(t=>t.nm==e.value[0]);i&&Mt(0,i.path,a.value)}function Ue(t){const{choosedKeys:e,currentPath:a,fileList:n}=t,i=n.value.find(t=>t.nm==e.value[0]);a.value=i.path,$t(t)}async function Ae(t,e,n){const{choosedKeys:i,fileList:l,fileCopyCache:s,waitForPaste:r,copiedFile:c,currentPath:u}=t;if(1==i.value.length)o.success(e),s.value=JSON.parse(JSON.stringify(i.value)),c.value=ia(l.value,s.value)[0],r.value=!0;else try{const t=await async function(t,e,n){return await a.post("/files?action=SetBatchData",{data:JSON.stringify(t),type:e,path:n},{requestOptions:{loading:Le("file.contextMenu.loading.batchSetting"),successMessage:!0}})}(i.value,n,u.value);0==t.status&&(s.value=JSON.parse(JSON.stringify(i.value)),r.value=!0)}catch(p){console.warn(p)}}async function Ke(t){const{fileOperationFlag:e,waitForPaste:a}=t;e.value=1,await Ae(t,Le("file.contextMenu.messages.copySuccess"),1),a.value=!0}async function Ge(t){const{fileOperationFlag:e,waitForPaste:a}=t;e.value=2,await Ae(t,Le("file.contextMenu.messages.cutSuccess"),2),a.value=!0}async function Be(t){const{fileCopyCache:e,currentPath:a,waitForPaste:n}=t;if(!n.value)return;let i=!1;1==e.value.length?i=await Te(a.value,e.value[0]):e.value.length>1&&(i=await Te(a.value)),i?la(t,"PasteConfirm",t=>t.value.open()):async function(t){const{fileCopyCache:e,fileOperationFlag:a,currentPath:n,copiedFile:i,waitForPaste:l}=t;e.value.length>1?await Me(a.value,n.value):1==e.value.length&&(1==a.value?await je(i.value.path,n.value+"/"+i.value.nm):2==a.value&&await Ee(i.value.path,n.value+"/"+i.value.nm)),$t(t),l.value=!1}(t)}function $e(t){la(t,"Compression",t=>t.value.open())}function We(t,e){const{menuShow:n}=e;switch(t){case"edit":qe(e);break;case"copy":Ke(e);break;case"cut":Ge(e);break;case"paste":Be(e);break;case"permission":la(e,"Permission",t=>t.value.open());break;case"compression":$e(e);break;case"decompress":la(e,"Decompress",t=>t.value.open());break;case"conversion":console.log("conversion");break;case"del":Re(e);break;case"refresh":$t(e);break;case"upload":la(e,"UploadFile",t=>t.value.open());break;case"createFile":ke(e,Le("file.contextMenu.defaultNames.untitledFile"),"file","file");break;case"createDir":ke(e,Le("file.contextMenu.defaultNames.untitledDirectory"),"dir","folder");break;case"download":!async function(t){const{currentPath:e,choosedKeys:a}=t;c("".concat("/"===e.value?"":e.value,"/").concat(a.value[0]))}(e);break;case"terminal":la(e,"Terminal",t=>t.value.open());break;case"open":Ue(e);break;case"share":la(e,"Share",t=>t.value.open());break;case"unShare":!function(t){const{choosedKeys:e,fileList:a,shareList:n}=t,i=ia(a.value,e.value)[0],l=n.value.find(t=>t.filename.includes(i.nm));Kt(t,null==l?void 0:l.id)}(e);break;case"favorite":!async function(t){const{choosedKeys:e,fileList:n}=t,i=n.value.find(t=>t.nm==e.value[0]);try{await a.post("/files?action=add_files_store",{path:i.path},{requestOptions:{loading:Le("file.contextMenu.loading.addingToFavorites"),successMessage:!0}}),Ht(t),$t(t)}catch(l){console.warn(l)}}(e);break;case"unfavorite":!async function(t){const{choosedKeys:e,fileList:a}=t;Se(t,ia(a.value,e.value)[0].path)}(e);break;case"rename":!async function(t){const{choosedKeys:e,fileList:a,currentFile:n,filesView:i}=t,l=ia(a.value,e.value)[0];n.value=l,"card"===i.value?(n.value.isRenameForCard=!0,n.value.editName=n.value.nm):(l.isCreate=!0,l.isRename=!0,l.editName=l.nm,R(Yt))}(e);break;case"attrs":la(e,"Properties",t=>t.value.open());break;case"preview":!function(t){const{choosedKeys:e,fileList:a}=t;te(t,ia(a.value,e.value)[0].path)}(e);break;case"playVideo":!function(t){const{choosedKeys:e,fileList:a}=t;ee(t,ia(a.value,e.value)[0])}(e)}n.value=!1}function He(t){const{type:e,list:a,path:n}=t,i=[];for(const l of a)i.push(Je({type:e,item:l,path:n}));return i}function Je(t){const{type:e,item:a,path:n}=t,{nm:i,sz:l,is_link:s,lnk:o,mt:r,ctime:c,atime:u,gid:p,uid:d,group:f,user:m,acc:v,rmk:h,durl:y,cmp:g,fav:_,top:w,sn:b}=a,k=function(t,e){if("dir"===e)return"folder";const a=["tar.gz"],n=t.toLowerCase();for(const l of a)if(n.endsWith(l))return l;const i=n.lastIndexOf(".");if(-1!==i)return n.substring(i+1);return"file"}(a.nm,e);return{ext:k,nm:i,sz:l,mt:r,acc:v,user:m,is_link:s?o:"",lnk:o,durl:y,cmp:g,fav:_,rmk:h,top:w,sn:b,path:Ye(n,i),ctime:c,atime:u,gid:p,uid:d,group:f,type:e}}function Ye(t,e){return function(t){return t.replace(/\/\//g,"/")}("".concat(t,"/").concat(e))}function Xe(t){return["folder"].includes(t)?"file-dir":["txt","rtf","md","log","conf"].includes(t)?"file-txt":["json"].includes(t)?"file-json":["htm","html","xhtml"].includes(t)?"file-html":["css","less","scss"].includes(t)?"file-css":["js","ts"].includes(t)?"file-js":["php"].includes(t)?"file-php":["doc","docx","docm","dot","dotx","dotm"].includes(t)?"file-doc":["pdf","pdfa","pdfx","pdfu"].includes(t)?"file-pdf":["xlsx","xlsm","xltx","xltm"].includes(t)?"file-excel":["jpg","jpeg","png","gif","bmp","webp","tiff","tif","psd","ai","eps","cr2","cr3","nef","nrw","dng","svg","cdr","wmf","emf","apng","heic","ico","xbm","xpm","xcf","iff","pnm"].includes(t)?"file-img":["py","java","js","ts","c","cpp","cs","php","rb","go","swift","kt","html","css","jsx","vue","scss","less","tsx","json","xml","yaml","yml","ini","properties","env","sql","pl","sh","bat","ps1","m","swift","kt","gradle","makefile","cmake","jar","war","exe","md","gitignore","dockerfile","yml","ipynb","asm","lua","rs","hs"].includes(t)?"file-sh":["zip","rar","7z","tar","tar.gz","gz","tgz","tar.bz2","tar.xz","cab","iso","msi","rpm","deb","xz","zipx","lz4","zst","rar5","part1.rar","rar.part1","z01","z02"].includes(t)?"file-compression":"file-unknown-file"}function Ze(t){return["mp4","avi","mov","mkv","wmv","flv","3gp","3g2","vob","webm","ogv"].includes(t)}function Qe(t){return"file-img"===Xe(t.ext)}function ta(t){return"file-compression"===Xe(t)}async function ea(t,e,n){try{const{message:i}=await a.post("/files?action=GetDirNew",{path:t,is_operating:!0,...n});e&&e(i);let l=He({type:"dir",list:i.dir,path:t}),s=He({type:"file",list:i.files,path:t});return l=l.map((t,e)=>({...t,protected:i.tamper_data.dirs&&i.tamper_data.dirs[e]?Number(i.tamper_data.dirs[e].split(";")[0]):0,protected_rule:i.tamper_data.dirs&&i.tamper_data.dirs[e]?Number(i.tamper_data.dirs[e].split(";")[1]):0})),s=s.map((t,e)=>({...t,protected:i.tamper_data.files&&i.tamper_data.files[e]?Number(i.tamper_data.files[e].split(";")[0]):0,protected_rule:i.tamper_data.files&&i.tamper_data.files[e]?Number(i.tamper_data.files[e].split(";")[1]):0})),[...l,...s]}catch(i){return console.warn(i),[]}}async function aa(t,e,n){try{const i={path:t,p:1,showRow:5e3,sort:"name",reverse:!1,search:e};n&&(i.all=!0);const{message:l}=await a.post("/files?action=GetDirNew&tojs=GetFiles",i);let s=He({type:"dir",list:l.dir,path:t}),o=He({type:"file",list:l.files,path:t});return s=s.map((t,e)=>({...t,protected:l.tamper_data.dirs&&l.tamper_data.dirs[e]?Number(l.tamper_data.dirs[e].split(";")[0]):0,protected_rule:l.tamper_data.dirs&&l.tamper_data.dirs[e]?Number(l.tamper_data.dirs[e].split(";")[1]):0})),o=o.map((t,e)=>({...t,protected:l.tamper_data.files&&l.tamper_data.files[e]?Number(l.tamper_data.files[e].split(";")[0]):0,protected_rule:l.tamper_data.files&&l.tamper_data.files[e]?Number(l.tamper_data.files[e].split(";")[1]):0})),[...s,...o]}catch(i){return console.warn(i),[]}}async function na(t,e,n,i,l,s,o=!1,r){const c=[],u=Math.ceil(t.size/n);console.log("总切片数：",u);for(let a=0;a<u;a++){const e=a*n,l=Math.min(e+n,t.size),s=t.slice(e,l),o=new FormData;o.append("f_path",i),o.append("f_name",t.name),o.append("f_size","".concat(t.size)),o.append("f_start","".concat(e)),o.append("blob",s),c.push(o)}try{for(let t=0;t<c.length;t++){const n=await a.post(e,c[t],{headers:{"Content-Type":"multipart/form-data"},requestOptions:{isOriginalResult:!0}});"number"==typeof n.message&&s&&s(n);l(Math.round(t/c.length*100),n)}l(100,null)}catch(p){return Promise.reject({msg:p.message})}}function ia(t,e){return t.filter(t=>e.includes(t.nm))}async function la(t,e,a){const{dynamicCmptObj:n,dynamicCmpt:i,dynamicCmptRef:l}=t,s=n[e]();await s.__asyncLoader(),i.value=s,R(()=>{a&&a(l)})}_t.create({baseURL:"/v2"});const sa=u(D({__name:"FileIcon",props:{ext:{type:String,default:""},size:{type:String,default:"medium"}},setup(t){const e=L(()=>ta(t.ext)?"compress":"Dir"===t.ext?"folder":t.ext);return(a,n)=>(j(),T("div",{class:M(["files-icon",["".concat(E(e),"-icon"),"".concat(t.size,"-icon")]])},null,2))}}),[["__scopeId","data-v-0a2d98fb"]]),oa={class:"video-container"},ra=["src"],ca={class:"video-list"},ua=["onClick"],pa=u(D({__name:"VideoPlayer",setup(t){const e=I("fileStore"),{videoWaitPreview:a,previewVideoShow:n,currentPreviewVideo:i}=e,l=k(),s=k(0),o=L(()=>"/download?filename=".concat(i.value.path));function r(){s.value=l.value.offsetHeight}return(t,e)=>{const c=p,u=gt;return j(),N(u,{show:E(n),"onUpdate:show":e[0]||(e[0]=t=>x(n)?n.value=t:null),width:"70%",title:t.$t("file.videoPlayerModal.title"),onAfterEnter:r},{default:V(()=>[q("div",oa,[q("video",{src:E(o),controls:"true",preload:"auto",width:"100%",ref_key:"videoRef",ref:l},null,8,ra),q("div",ca,[O(c,{style:U({height:E(s)+"px"})},{default:V(()=>[(j(!0),T(F,null,A(E(a),t=>(j(),T("div",{class:M(["video-item",{active:t.path==E(i).path}]),key:t.path,onClick:e=>i.value=t},[O(sa,{ext:"mp4"}),O(E(kt),null,{default:V(()=>[K(G(t.name),1)]),_:2},1024)],10,ua))),128))]),_:1},8,["style"])])])]),_:1},8,["show","title"])}}}),[["__scopeId","data-v-6be9ab69"]]),da=k([]),fa=k(!1),ma=k(null),va=k(1),{t:ha}=i.global;const ya={class:"drag-upload"},ga={class:"upload-area"},_a={class:"tip"},wa=u(D({__name:"DragUpload",setup(t,{expose:e}){const{t:a}=W(),n=I("fileStore"),{uploadFileList:i,uploadShow:l,uploadComplete:s,startUpload:r}=n,c=k(!1),u=k(0);function p(t){const e=t.dataTransfer;return!!e&&e.types.some(t=>"Files"===t||"application/x-moz-file"===t)}function d(t){t.preventDefault(),p(t)&&(u.value++,c.value=!0)}function f(t){t.preventDefault(),p(t)&&(u.value--,u.value<=0&&(c.value=!1,u.value=0))}function m(t){t.preventDefault(),p(t)&&(t.dataTransfer.dropEffect="copy")}async function v(t){const e=[];for(let a=0;a<t.length;a++){const n=t[a].webkitGetAsEntry();n&&e.push(n)}await h(e)&&o.error(a("file.uploadModal.fileAlreadyExists"),{close:!0})}async function h(t,e=""){s.value&&(i.value=[],r.value=!1,s.value=!1);let a=!1;for(const n of t)if(n.isDirectory){const t=n.createReader(),i=await new Promise(e=>{t.readEntries(e)});await h(i,e?"".concat(e,"/").concat(n.name):n.name)&&(a=!0)}else if(n.isFile){if(-1!=i.value.findIndex(t=>t.file.name==n.name)){a=!0;continue}const t=await new Promise(t=>{n.file(t)});i.value.push({file:t,status:0,progress:0,relativePath:e?"".concat(e):""})}return a}async function y(t){var e;t.preventDefault(),p(t)&&(u.value=0,c.value=!1,(null==(e=t.dataTransfer)?void 0:e.items)&&(await v(t.dataTransfer.items),la(n,"UploadFile"),l.value=!0))}function g(){document.ondragenter=d,document.ondragleave=f,document.ondragover=m,document.ondrop=y}return la(n,"UploadFile"),e({listenDragEvent:g}),H(()=>{g()}),(t,e)=>{const a=xt;return j(),T("div",ya,[O(a,{show:E(c),"onUpdate:show":e[0]||(e[0]=t=>x(c)?c.value=t:null)},{default:V(()=>[q("div",ga,[q("span",_a,G(t.$t("file.uploadModal.dragFilesHere")),1)])]),_:1},8,["show"])])}}}),[["__scopeId","data-v-35fe8a60"]]),ba={class:"img-wrapper"},ka=["src"],xa=u(D({__name:"ImagePreview",setup(t){const e=I("fileStore"),{imgWaitPreview:a,currentPreviewImg:n,previewShow:i}=e,l=k(.5),s=L(()=>"/download?filename=".concat(a.value[o.value])),o=k(0);function r(){o.value=a.value.findIndex(t=>t===n.value)}function c(){o.value>0&&o.value--}function u(){o.value<a.value.length-1&&o.value++}function p(){l.value>2||(l.value+=.1)}function d(){l.value<.2||(l.value-=.1)}function f(){i.value=!1}function m(t){l.value-t.deltaY/1e3<.2||l.value-t.deltaY/1e3>2||(l.value-=t.deltaY/1e3)}return(t,e)=>{const a=xt;return j(),N(a,{show:E(i),"onUpdate:show":e[0]||(e[0]=t=>x(i)?i.value=t:null),"close-on-esc":!1,"mask-closable":!1,"on-after-enter":r},{default:V(()=>[q("div",ba,[q("img",{src:E(s),style:U({transform:"translate(-50%, -50%) scale(".concat(E(l),")")}),onWheel:m},null,44,ka),q("div",{class:"tools"},[q("i",{class:"i-ic:outline-arrow-circle-left text-16 text-[#fff] cursor-pointer",onClick:c}),q("i",{class:"i-ic:baseline-zoom-in text-16 text-[#fff] cursor-pointer",onClick:p}),q("i",{class:"i-ic:baseline-zoom-out text-16 text-[#fff] cursor-pointer",onClick:d}),q("i",{class:"i-ic:outline-arrow-circle-right text-16 text-[#fff] cursor-pointer",onClick:u})]),q("i",{class:"i-iconoir:xmark-circle text-16 text-[#fff] cursor-pointer close-icon",onClick:f})])]),_:1},8,["show"])}}}),[["__scopeId","data-v-7045f818"]]),Ca={key:0,class:"group-left"},Sa={key:1,class:"group-left"},Pa={class:"group-right"},Ra={class:"view-change"},za=u(D({__name:"ButtonGroup",props:{filesView:{type:String,default:"list"},filesViewModifiers:{}},emits:J(["viewChange"],["update:filesView"]),setup(t,{emit:e}){const a=e,{t:n}=W(),i=I("fileStore"),{favoriteOptions:l,choosedKeys:s,waitForPaste:o,optionToolsRef:c,isMiniScreen:u}=i,p=Y(t,"filesView"),f=L(()=>[{label:n("file.buttonGroup.createOptions.newDirectory"),key:"dir",icon:()=>O(d,{name:"file-dir",size:"16"},null)},{label:n("file.buttonGroup.createOptions.newFile"),key:"file",icon:()=>O(d,{name:"base-file",size:"16"},null)},{label:n("file.buttonGroup.createOptions.softLink"),key:"softlink",icon:()=>O(d,{name:"file-soft-link",size:"15"},null)}]),m=L(()=>[{label:n("file.buttonGroup.miniScreenOptions.upload"),key:"Upload",icon:()=>O(d,{name:"file-upload",size:"14"},null)},{label:n("file.buttonGroup.miniScreenOptions.remoteDownload"),key:"Remote Download",icon:()=>O(d,{name:"file-download",size:"16"},null)},{label:n("file.buttonGroup.miniScreenOptions.new"),key:"create",icon:()=>O(d,{name:"base-dir",size:"14",class:"mr-5px"},null),children:[{label:n("file.buttonGroup.createOptions.newDirectory"),key:"dir",icon:()=>O(d,{name:"file-dir",size:"16"},null)},{label:n("file.buttonGroup.createOptions.newFile"),key:"file",icon:()=>O(d,{name:"base-file",size:"16"},null)},{label:n("file.buttonGroup.createOptions.softLink"),key:"softlink",icon:()=>O(d,{name:"file-soft-link",size:"15"},null)}]},{label:n("file.buttonGroup.miniScreenOptions.searchFileContent"),key:"Search File Content",icon:()=>O(d,{name:"search",size:"14"},null)},{label:n("file.buttonGroup.miniScreenOptions.favorite"),key:"Favorite",icon:()=>O(d,{name:"file-favorite",size:"14",class:"mr-5px"},null),children:h.value},{label:n("file.buttonGroup.miniScreenOptions.shareList"),key:"Share List",icon:()=>O(d,{name:"file-share",size:"14"},null)},{label:n("file.buttonGroup.miniScreenOptions.terminal"),key:"Terminal",icon:()=>O(d,{name:"file-terminal",size:"14"},null)},{label:n("file.buttonGroup.miniScreenOptions.rootDirectory"),key:"Root Directory",icon:()=>O(d,{name:"file-disk",size:"14"},null)},{label:n("file.buttonGroup.miniScreenOptions.fileProtection"),key:"File/Dir protection",icon:()=>O(d,{name:"file-protect",size:"14"},null)}]);function v(t,e){switch(t){case"Upload":de(i);break;case"Remote Download":fe(i);break;case"dir":xe(i,"dir");break;case"file":xe(i,"file");break;case"softlink":xe(i,"softlink");break;case"Search File Content":me(i);break;case"Share List":ye(i);break;case"Terminal":be(i);break;case"Root Directory":ge(i);break;case"File/Dir protection":y();break;default:!function(t){he(i,t)}(t)}}const h=L(()=>l.value.map(t=>({key:t.key,icon:()=>{return O(d,{name:(e=t.icon,"dir"==e?"file-dir":"settings"==e?"flow-action":"file-record"),size:"16"},null);var e},label:()=>O("div",{class:"flex"},[O("div",{class:"max-w-300px"},[O(kt,null,{default:()=>[t.label]})])]),meta:{type:"favorite"}}))),y=async()=>{const t=await wt("tamper_core",75);r(t)&&Lt(t)};function g(){la(i,"Permission",t=>t.value.open())}function _(){Re(i)}function w(t){!function(t,e){const{filesView:a}=t;a.value=e}(i,t),a("viewChange",t)}return X(()=>{Ce(i),window.addEventListener("resize",()=>Ce(i))}),(t,e)=>{const a=d,n=Ct,l=St,r=Pt;return j(),T("div",{class:"button-group",ref_key:"optionToolsRef",ref:c},[!E(u)&&E(s).length<=1?(j(),T("div",Ca,[O(n,{onClick:e[0]||(e[0]=t=>E(de)(E(i)))},{icon:V(()=>[O(a,{name:"file-upload",size:"14"})]),default:V(()=>[K(" "+G(t.$t("file.upload")),1)]),_:1}),O(n,{onClick:e[1]||(e[1]=t=>E(fe)(E(i)))},{icon:V(()=>[O(a,{name:"file-download",size:"16"})]),default:V(()=>[K(" "+G(t.$t("file.remoteDownload")),1)]),_:1}),O(l,{trigger:"hover",options:E(f),placement:"bottom-start","on-select":t=>E(xe)(E(i),t)},{default:V(()=>[O(n,{"icon-placement":"right",class:"btn-behavior"},{default:V(()=>[O(a,{name:"base-dir",size:"14",class:"mr-5px"}),K(" "+G(t.$t("file.create"))+" ",1),O(a,{name:"base-arrow-right",size:"14"})]),_:1})]),_:1},8,["options","on-select"]),O(n,{onClick:e[2]||(e[2]=t=>E(me)(E(i)))},{icon:V(()=>[O(a,{name:"search",size:"14"})]),default:V(()=>[K(" "+G(t.$t("file.searchContent")),1)]),_:1}),O(l,{placement:"bottom-start",scrollable:!0,style:{maxHeight:"480px"},options:E(h),onSelect:e[4]||(e[4]=t=>E(he)(E(i),t))},{default:V(()=>[O(n,{"icon-placement":"right",class:"btn-behavior",onClick:e[3]||(e[3]=t=>E(ve)(E(i)))},{default:V(()=>[O(a,{name:"file-favorite",size:"14",class:"mr-5px"}),K(" "+G(t.$t("file.favorite"))+" ",1),O(a,{name:"base-arrow-right",size:"14"})]),_:1})]),_:1},8,["options"]),O(n,{onClick:e[5]||(e[5]=t=>E(ye)(E(i)))},{icon:V(()=>[O(a,{name:"file-share",size:"14"})]),default:V(()=>[K(" "+G(t.$t("file.shareList")),1)]),_:1}),O(n,{onClick:e[6]||(e[6]=t=>E(be)(E(i)))},{icon:V(()=>[O(a,{name:"file-terminal",size:"14"})]),default:V(()=>[K(" "+G(t.$t("file.terminal")),1)]),_:1}),e[16]||(e[16]=q("div",{class:"divider"},null,-1)),O(n,{onClick:e[7]||(e[7]=t=>E(ge)(E(i)))},{icon:V(()=>[O(a,{name:"file-disk",size:"14"})]),default:V(()=>[K(" "+G(t.$t("file.rootDirectory")),1)]),_:1}),e[17]||(e[17]=q("div",{class:"divider"},null,-1)),O(n,{onClick:y},{icon:V(()=>[O(a,{name:"file-protect",size:"14"})]),default:V(()=>[K(" "+G(t.$t("file.protection")),1)]),_:1})])):E(u)||E(s).length>1?(j(),T("div",Sa,[O(l,{placement:"bottom-start",scrollable:!0,"menu-props":()=>({style:"max-height: 480px"}),options:E(m),"on-select":v},{default:V(()=>[O(n,{"icon-placement":"right",class:"btn-behavior"},{default:V(()=>[O(a,{name:"base-dir",size:"14",class:"mr-5px"}),K(" "+G(t.$t("file.buttonGroup.fileOperations"))+" ",1),O(a,{name:"base-arrow-right",size:"14"})]),_:1})]),_:1},8,["options"])])):Z("",!0),q("div",Pa,[E(s).length>1?(j(),N(r,{key:0},{default:V(()=>[O(n,{onClick:e[8]||(e[8]=t=>E(Ke)(E(i)))},{icon:V(()=>[O(a,{name:"common-copy",size:"16"})]),default:V(()=>[K(" "+G(t.$t("file.copy")),1)]),_:1}),O(n,{onClick:e[9]||(e[9]=t=>E(Ge)(E(i)))},{icon:V(()=>[O(a,{name:"file-cut",size:"16"})]),default:V(()=>[K(" "+G(t.$t("file.cut")),1)]),_:1}),O(n,{onClick:e[10]||(e[10]=t=>E($e)(E(i)))},{icon:V(()=>[O(a,{name:"file-compression",size:"16"})]),default:V(()=>[K(" "+G(t.$t("file.compress")),1)]),_:1}),O(n,{onClick:g},{icon:V(()=>[O(a,{name:"file-dir-permission",size:"16"})]),default:V(()=>[K(" "+G(t.$t("file.buttonGroup.permissions")),1)]),_:1}),O(n,{onClick:_},{icon:V(()=>[O(a,{name:"file-recycling-bin",size:"16"})]),default:V(()=>[K(" "+G(t.$t("file.delete")),1)]),_:1})]),_:1})):Z("",!0),E(o)?(j(),N(n,{key:1,onClick:e[11]||(e[11]=()=>E(Be)(E(i)))},{icon:V(()=>[O(a,{name:"file-paste",size:"20"})]),default:V(()=>[K(" "+G(t.$t("file.paste")),1)]),_:1})):Z("",!0),O(n,{onClick:e[12]||(e[12]=t=>E(_e)(E(i)))},{default:V(()=>[K(G(t.$t("file.backup")),1)]),_:1}),O(n,{onClick:e[13]||(e[13]=t=>E(we)(E(i)))},{icon:V(()=>[O(a,{name:"file-recycling-bin",size:"14"})]),default:V(()=>[K(" "+G(t.$t("file.recycleBin")),1)]),_:1}),q("div",Ra,[q("div",{class:M(["card",{active:"card"==p.value}]),onClick:e[14]||(e[14]=t=>w("card"))},[O(a,{name:"file-card-view",size:"14"})],2),q("div",{class:M(["list",{active:"list"==p.value}]),onClick:e[15]||(e[15]=t=>w("list"))},[O(a,{name:"file-list-view",size:"16"})],2)])])],512)}}}),[["__scopeId","data-v-062d5ea2"]]),Oa={class:"path-dir"},Fa={class:"path-arrow reversal"},Da={class:"path-dir"},La={class:"path-arrow"},Ta=["onClick"],ja={class:"path-dir"},Ma={class:"path-arrow"},Ea=u(D({__name:"ChoosePath",props:{currentPath:{type:String,default:"/"}},emits:["pathChange"],setup(t,{expose:e,emit:n}){const i=t,l=n,{t:s}=W(),o=I("fileStore"),c=k(""),u=Q("pathListRef"),p=k(0),f=L(()=>i.currentPath.split("/").filter(t=>""!==t).map((t,e)=>({name:t,originalIndex:e}))),m=L(()=>{if(!p.value||0===f.value.length)return f.value;let t=p.value-80;const e=[...f.value].reverse(),a=[];for(const n of e){const e=Math.min(8*n.name.length,150)+20+12;if(!(t>=e))break;a.unshift(n),t-=e}return a}),v=L(()=>m.value.length<f.value.length),h=L(()=>{const t=f.value.length-m.value.length;return f.value.slice(0,t)}),y=L(()=>{const t=h.value.map(t=>({key:t.originalIndex,label:t.name,icon:()=>O(d,{name:"file-dir",size:"16"},null)}));return t.unshift({key:"/",label:s("file.rootDirectory"),icon:()=>O(d,{name:"file-dir",size:"16"},null)}),t}),g=t=>{z(t)},_=k(!0),w=Q("inputRef");let b=null;function C(){u.value&&(p.value=u.value.offsetWidth)}function S(t){_.value=t,_.value?(c.value="",R(()=>{C()})):c.value=i.currentPath}X(()=>{u.value&&(C(),b=new ResizeObserver(()=>{C()}),b.observe(u.value))}),tt(()=>{b&&b.disconnect()});const P=()=>{S(!1),R(()=>{var t;null==(t=w.value)||t.focus()})};function z(t,e){const a=i.currentPath.split("/").filter(t=>""!==t);let n="";"number"==typeof t&&(a.splice(t+1),n="/"+a.join("/")),"/"==t&&(n="/"),l("pathChange",n),null==e||e.stopPropagation()}async function D(){var t;if(c.value==i.currentPath||""==c.value)null==(t=w.value)||t.blur(),S(!0);else if(Tt(c.value))try{const{message:t}=await a.post("/files?action=test_path",{path:c.value});if(r(t)&&t.exists)l("pathChange",c.value),S(!0);else{let t=c.value;ht({title:s("file.pathNotExists"),content:s("file.pathNotExistsConfirm",{path:t}),onPublicClose:()=>S(!1),onConfirm:async()=>{await ue(t),l("pathChange",t)},onCancel(){var t;null==(t=w.value)||t.blur(),S(!0)}})}}catch(e){console.warn(e)}else S(!1)}function M(){const t=i.currentPath.split("/").filter(t=>""!==t);if(0!=t.length){t.pop();let e="/"+t.join("/");l("pathChange",e)}}function U(){$t(o)}return e({handleEnterDown:D}),(t,e)=>{const a=Ct,n=St,i=kt,l=Rt,s=zt;return j(),N(s,null,{default:V(()=>[O(a,{onClick:M},{default:V(()=>[O(d,{name:"file-back",size:"16"})]),_:1}),E(_)?(j(),T("div",{key:0,ref_key:"pathListRef",ref:u,class:"path-list",onClick:P},[O(n,{trigger:"click",placement:"bottom-start",options:E(y),onSelect:g},{default:V(()=>[et(q("div",{class:"path-item",onClick:e[0]||(e[0]=t=>t.stopPropagation())},[q("div",Oa,[O(d,{name:"file-dir",size:"16"})]),q("div",Fa,[O(d,{name:"base-arrow-right"})])],512),[[at,E(v)]])]),_:1},8,["options"]),et(q("div",{class:"path-item",onClick:e[1]||(e[1]=t=>z("/",t))},[q("div",Da,G(t.$t("file.rootDirectory")),1),q("div",La,[O(d,{name:"base-arrow-right"})])],512),[[at,!E(v)]]),(j(!0),T(F,null,A(E(m),(t,e)=>(j(),T("div",{class:"path-item",key:"".concat(t,"_").concat(e),onClick:e=>z(t.originalIndex,e)},[q("div",ja,[O(i,{class:"max-w-150px!"},{default:V(()=>[K(G(t.name),1)]),_:2},1024)]),q("div",Ma,[O(d,{name:"base-arrow-right"})])],8,Ta))),128))],512)):(j(),N(l,{key:1,ref_key:"inputRef",ref:w,value:E(c),"onUpdate:value":e[2]||(e[2]=t=>x(c)?c.value=t:null),class:"flex-1",placeholder:" ",onFocus:e[3]||(e[3]=t=>S(!1)),onBlur:e[4]||(e[4]=t=>S(!0)),onKeydown:[nt(D,["enter"]),it(()=>!1,["stop"])]},null,8,["value"])),O(a,{onClick:U},{default:V(()=>[O(d,{name:"base-refresh",size:"16"})]),_:1})]),_:1})}}}),[["__scopeId","data-v-13ecd16b"]]),Ia={class:"filter-tools"},Na=u(D({__name:"SearchTools",setup(t){const e=I("fileStore"),{currentPath:a}=e,n=k(""),i=k(void 0),{choosePathRef:l}=e;async function s(){const t={search:n.value};i.value&&(t.all="True"),$t(e,t)}function o(t){a.value=t,$t(e)}return(t,e)=>{const r=bt,c=Rt,u=d,p=Ct,f=zt;return j(),T("div",Ia,[O(Ea,{class:"w-50%","current-path":E(a),onPathChange:o,ref_key:"choosePathRef",ref:l},null,8,["current-path"]),O(f,{class:"dir-search"},{default:V(()=>[O(c,{placeholder:t.$t("file.search"),status:"success",value:E(n),"onUpdate:value":e[1]||(e[1]=t=>x(n)?n.value=t:null),onKeyup:nt(s,["enter"])},{suffix:V(()=>[O(r,{checked:E(i),"onUpdate:checked":e[0]||(e[0]=t=>x(i)?i.value=t:null)},{default:V(()=>[K(G(t.$t("file.includeSubdir")),1)]),_:1},8,["checked"])]),_:1},8,["placeholder","value"]),O(p,{type:"primary",onClick:s},{icon:V(()=>[O(u,{name:"search",size:"16"})]),_:1})]),_:1})])}}}),[["__scopeId","data-v-70ba294c"]]),Va={key:0,class:"operation-wrapper"},qa={class:"mr-4px"},Ua=u(D({__name:"FileOperation",props:{file:{}},setup(t){const e=t,a=I("fileStore"),{isMiniScreen:n}=a,{t:i}=W(),l=k([{label:i("Public.Btn.Copy"),value:"copy",handle:()=>We("copy",a)},{label:i("file.fileOperation.cut"),value:"cut",handle:()=>We("cut",a)},{label:i("file.fileOperation.rename"),value:"rename",handle:()=>We("rename",a)},{label:i("file.fileOperation.PMSN"),value:"permission",handle:()=>We("permission",a)},{label:i("file.fileOperation.compress"),value:"compress",handle:()=>We("compression",a)},{label:i("Public.Btn.Delete"),value:"delete",handle:()=>We("del",a)}]),s=L(()=>l.value.map(t=>({label:t.label,key:t.value,handle:t.handle}))),o=L(()=>{if(Qe(e.file))return[{label:i("Public.Btn.Preview"),value:"preview",handle:()=>te(a,e.file.path)},...l.value];if("dir"===e.file.type)return[{label:i("file.fileOperation.open"),value:"open",handle:()=>We("open",a)},...l.value];if(t=e.file,["file-txt","file-json","file-html","file-css","file-js","file-php","file-doc","file-sh"].includes(Xe(t.ext)))return[{label:i("Public.Btn.Edit"),value:"edit",handle:()=>We("edit",a)},...l.value];var t;if(ta(e.file.ext)){const t=[...l.value];return t.splice(-2,0,{label:i("file.fileOperation.decompress"),value:"decompress",handle:()=>We("decompress",a)}),t}return l.value});function r(t){const e=l.value.find(e=>e.value===t);e&&e.handle()}return(t,e)=>{const a=Ct,i=d,l=St;return E(n)?(j(),N(l,{key:1,trigger:"click",options:E(s),onSelect:r},{default:V(()=>[O(a,{text:"","icon-placement":"right"},{default:V(()=>[q("span",qa,G(t.$t("Public.Table.Action")),1),O(i,{name:"down",size:"14"})]),_:1})]),_:1},8,["options"])):(j(),T("div",Va,[(j(!0),T(F,null,A(E(o),t=>(j(),N(a,{key:t.value,text:"",type:"primary",onClick:it(t.handle,["stop"])},{default:V(()=>[K(G(t.label),1)]),_:2},1032,["onClick"]))),128))]))}}}),[["__scopeId","data-v-e47d1079"]]),Aa=D({__name:"ContextMenu",setup(t,{expose:e}){const{t:a}=W(),n=I("fileStore"),{waitForPaste:i,menuShow:l}=n,s=k("empty"),o=k(0),r=k(1),c=L(()=>{switch(s.value){case"single":return function(t,e){const{fileList:a,choosedKeys:n}=t,i=ia(a.value,n.value)[0];let l=["share","favorite","permission","copy","cut","rename","del","compression","attrs"];if(!i)return Ve(e.value,["refresh","upload","create","terminal"]);if("dir"==i.type?l.unshift("open"):l.unshift("edit","download"),Qe(i)&&(l.unshift("preview"),l=l.filter(t=>"edit"!==t)),Ze(i.ext)&&(l.unshift("playVideo"),l=l.filter(t=>"edit"!==t)),i.isFavorite){const t=l.findIndex(t=>"favorite"==t);l[t]="unfavorite"}if(i.isShare){const t=l.findIndex(t=>"share"==t);l[t]="unShare"}return ta(i.ext)&&(l.unshift("decompress"),l=l.filter(t=>"edit"!==t)),Ve(e.value,l)}(n,u);case"multiple":return Ve(u.value,["copy","cut","permission","compression","del"]);default:return i.value?Ve(u.value,["refresh","upload","create","terminal","paste"]):Ve(u.value,["refresh","upload","create","terminal"])}}),u=k({edit:{label:a("Public.Btn.Edit"),key:"edit",icon:()=>O(d,{name:"common-copy",size:"14"},null)},copy:{label:a("Public.Btn.Copy"),key:"copy",icon:()=>O(d,{name:"common-copy",size:"14"},null)},cut:{label:a("file.fileOperation.cut"),key:"cut",icon:()=>O(d,{name:"file-cut",size:"16"},null)},permission:{label:a("file.fileOperation.permission"),key:"permission",icon:()=>O(d,{name:"file-dir-permission",size:"14"},null)},compression:{label:a("file.contextMenu.createCompression"),key:"compression",icon:()=>O(d,{name:"file-compression",size:"16"},null)},decompress:{label:a("file.fileOperation.decompress"),key:"decompress",icon:()=>O(d,{name:"file-compression",size:"16"},null)},conversion:{label:a("file.contextMenu.formatConversion"),key:"conversion",icon:()=>O(d,{name:"file-conversion",size:"16"},null)},del:{label:a("Public.Btn.Delete"),key:"del",icon:()=>O(d,{name:"file-recycling-bin",size:"16"},null)},refresh:{label:a("Public.Btn.Refresh"),key:"refresh",icon:()=>O(d,{name:"base-refresh",size:"14"},null)},upload:{label:a("Public.Btn.Upload"),key:"upload",icon:()=>O(d,{name:"file-upload",size:"16"},null)},create:{label:a("file.contextMenu.newFolderFile"),key:"create",icon:()=>O(d,{name:"base-dir",size:"14"},null),children:[{label:a("file.contextMenu.newFolder"),key:"createDir",icon:()=>O(d,{name:"base-dir",size:"14"},null)},{label:a("file.contextMenu.newFile"),key:"createFile",icon:()=>O(d,{name:"base-file",size:"14"},null)}]},download:{label:a("Public.Btn.Download"),key:"download",icon:()=>O(d,{name:"file-download",size:"16"},null)},terminal:{label:a("file.contextMenu.terminal"),key:"terminal",icon:()=>O(d,{name:"file-terminal",size:"16"},null)},paste:{label:a("file.contextMenu.paste"),key:"paste",icon:()=>O(d,{name:"file-paste",size:"16"},null)},open:{label:a("file.fileOperation.open"),key:"open",icon:()=>O(d,{name:"file-open",size:"16"},null)},share:{label:a("file.contextMenu.externalShare"),key:"share",icon:()=>O(d,{name:"file-share",size:"16"},null)},unShare:{label:a("file.contextMenu.cancelShare"),key:"unShare",icon:()=>O(d,{name:"file-share",size:"16"},null)},favorite:{label:a("file.contextMenu.addToFavorites"),key:"favorite",icon:()=>O(d,{name:"file-favorite",size:"14"},null)},unfavorite:{label:a("file.contextMenu.removeFromFavorites"),key:"unfavorite",icon:()=>O(d,{name:"file-favorite",size:"14"},null)},rename:{label:a("file.fileOperation.rename"),key:"rename",icon:()=>O(d,{name:"file-rename",size:"16"},null)},attrs:{label:a("file.contextMenu.properties"),key:"attrs",icon:()=>O(d,{name:"file-attrs",size:"16"},null)},"new-window":{label:a("file.contextMenu.openInNewWindow"),key:"new-window",icon:()=>O(d,{name:"file-new-window",size:"14"},null)},top:{label:a("file.contextMenu.pinToTop"),key:"top",icon:()=>O(d,{name:"file-top",size:"18"},null)},"file-sync":{label:a("file.contextMenu.fileSync"),key:"file-sync",icon:()=>O(d,{name:"common-copy",size:"16"},null)},scan:{label:a("file.contextMenu.malwareScan"),key:"scan",icon:()=>O(d,{name:"file-scan",size:"16"},null)},duplicate:{label:a("file.contextMenu.createCopy"),key:"duplicate",icon:()=>O(d,{name:"common-copy",size:"16"},null)},preview:{label:a("Public.Btn.Preview"),key:"preview",icon:()=>O(d,{name:"drag-preview",size:"14"},null)},playVideo:{label:"播放",key:"playVideo",icon:()=>O(d,{name:"file-play-video",size:"16"},null)}});function p(){l.value=!1}return e({filesOperation:function(t,e){t.preventDefault(),l.value=!1,s.value=e,R().then(()=>{l.value=!0,o.value=t.clientX,r.value=t.clientY})}}),(t,e)=>{const a=St;return j(),N(a,{placement:"bottom-start",trigger:"manual",x:E(o),y:E(r),options:E(c),show:E(l),"on-clickoutside":p,onSelect:e[0]||(e[0]=t=>E(We)(t,E(n)))},null,8,["x","y","options","show"])}}}),Ka={key:1,class:"i-svg-spinners:90-ring-with-bg text-[#36ad6a] text-7"},Ga=D({__name:"CalcSize",props:{path:{}},setup(t){const{t:e}=W(),n=t,i=k(-1),l=k(!1);async function s(){-1==i.value&&(l.value=!0,i.value=await async function(t){try{return(await a.post("/files?action=GetDirSize",{path:t},{requestOptions:{isOriginalResult:!0}})).message}catch(e){return console.warn(e),"计算失败"}}(n.path),l.value=!1)}return(t,a)=>{const n=Ct;return E(l)?(j(),T("i",Ka)):(j(),N(n,{key:0,text:"",type:"primary",onClick:s},{default:V(()=>[K(G(-1!==E(i)?E(i):E(e)("file.tableFooter.calculate")),1)]),_:1}))}}});const Ba=u(D({__name:"FileTable",setup(t){function e(t){}const a=I("fileStore"),{sort:n,reverse:i,tableRef:l,fileList:s,choosedKeys:o,tableLoading:r,contextRef:c,currentFile:u,dataTableRef:p}=a,h=k({}),y=t=>t.nm,g=t=>({"data-key":t.nm,onContextmenu(t){t.preventDefault(),Jt(t,a)},onDblclick(){!function(t,e){const{currentPath:a}=t;"dir"==e.type?(a.value="/"==a.value?"/".concat(e.nm):a.value+"/"+e.nm,$t(t)):Qe(e)?te(t,e.path):ta(e.ext)?la(t,"Decompress",t=>t.value.open()):Ze(e.ext)?ee(t,e):Mt(0,e.path,a.value)}(a,t)},onMouseenter(){t.operation_show=!0},onMouseleave(){t.operation_show=!1}}),_=(t,e)=>o.value.includes(t.nm)?"active-row normal-tr-".concat(t.nm):"normal-tr-".concat(t.nm),{t:w}=W(),b=k([{type:"selection",width:40,className:"file-checkbox",cellProps:()=>({style:{cursor:"pointer"}})},{title:()=>w("file.fileName"),key:"name",width:"22%",minWidth:164,sorter:!0,sortOrder:!1,render:t=>t.isCreate?O("div",{class:"flex justify-between items-center gap-2.5 w-100%"},[O("div",{class:"flex justify-start items-center"},[O(sa,{ext:t.ext},null),O(Rt,{"input-props":{autocomplete:"on",name:"filename"},value:t.editName,"onUpdate:value":e=>t.editName=e,autofocus:!0,id:"createInput",onKeydown:t=>{"Enter"===t.key&&(t.preventDefault(),le(a))},onBlur:()=>{le(a)}},null)])]):O("div",{class:"flex cursor-pointer",onClick:()=>function(t,e){const{choosedKeys:a}=t;"dir"==e.type&&(a.value=[e.nm],Ue(t))}(a,t)},[O("div",{class:"flex-1 flex items-center w-0 gap-4px"},[O("div",{class:"flex-1 w-0 flex items-center"},[O("div",{class:"flex items-center"},[O(sa,{ext:t.ext},null)]),O("div",{class:"min-w-0"},[O(kt,null,{default:()=>[O("span",{class:"hover:text-primary cursor-pointer"},[t.lnk?t.nm+t.lnk:t.nm])]})])]),O("div",{class:"flex items-center gap-4px"},[t.isShare?O(d,{name:"file-share",size:"16"},null):null,t.isFavorite?O(d,{name:"file-favorite",size:"16"},null):null])])])},{title:()=>w("file.protected"),key:"protection",width:"8%",minWidth:114,render:t=>O("div",{class:"flex justify-start gap-4px items-center cursor-pointer",onClick:()=>Xt(a,t)},[O("span",{class:1===t.protected?"text-primary":""},[1==t.protected?w("file.protectedStatus"):w("file.unprotectedStatus")]),O(d,{size:"14",name:1==t.protected?"file-lock":"file-unlock",class:1===t.protected?"text-primary":"text-weak"},null)])},{title:"PMSN/Owner",key:"accept",width:"8%",minWidth:108,sorter:!0,sortOrder:!1,render:t=>"".concat(t.acc," / ").concat(t.user)},{title:()=>w("file.size"),key:"size",width:"7%",minWidth:90,sorter:!0,sortOrder:!1,render(t){if("dir"===t.type)return O(Ga,{path:t.path},null);{let a;return O(Ct,{type:"primary",text:!0},"function"==typeof(e=a=m(t.sz))||"[object Object]"===Object.prototype.toString.call(e)&&!st(e)?a:{default:()=>[a]})}var e}},{title:()=>w("file.modifyTime"),key:"mtime",width:"10%",minWidth:140,sorter:!0,sortOrder:!1,render:t=>v(t.mt)},{title:()=>w("file.remarks"),key:"rmk",minWidth:164,render:t=>O("div",{class:"min-w-134px min-h-26px",onMouseenter:()=>{return(e=t).remarks_hover=!0,void(e.editRemarks=e.rmk);var e},onMouseleave:()=>{var e;(e=t).isEditRemarks||(e.remarks_hover=!1)}},[t.remarks_hover?O(Rt,{value:t.editRemarks,"onUpdate:value":e=>t.editRemarks=e,size:"small",onClick:e=>{e.preventDefault(),t.isEditRemarks=!0,h.value=t,u.value=t,u.value.editRemarks=t.rmk,u.value.isEditRemarks=!0},onBlur:()=>{le(a)},onKeydown:t=>{"Enter"===t.key&&(t.preventDefault(),le(a))}},null):O("span",{title:t.rmk},[t.rmk])])},{title:()=>w("file.operation"),key:"operation",width:"22%",maxWidth:340,align:"right",render(t){if(t.operation_show||o.value.includes(t.nm))return O(Ua,{file:t},null)}}]),x=t=>{b.value.forEach(e=>{const a=e;a.key===t.columnKey?a.sortOrder=t.order:a.sortOrder=!1}),f(t.order)?(i.value="ascend"===t.order?"False":"True",n.value="".concat(t.columnKey)):(n.value="",i.value="False"),$t(a)};function C(t,e){o.value=t}return lt(o,()=>Ce(a)),X(()=>{Wt(a),l.value.oncontextmenu=t=>{t.preventDefault(),t.target.closest("tr")||(o.value.length,c.value.filesOperation(t))}}),(t,a)=>{const n=Ot;return j(),T(F,null,[q("div",{ref_key:"tableRef",ref:l,class:"h-full relative"},[O(n,{class:"h-full",ref_key:"dataTableRef",ref:p,"flex-height":"",columns:E(b),"row-key":y,data:E(s),"row-class-name":_,"on-update:checked-row-keys":C,"row-props":g,"checked-row-keys":E(o),loading:E(r),"scrollbar-props":{trigger:"none"},"onUpdate:sorter":x,"on-scroll":e},null,8,["columns","data","checked-row-keys","loading"])],512),O(Aa,{ref_key:"contextRef",ref:c},null,512)],64)}}}),[["__scopeId","data-v-2f7fd2d3"]]),$a={class:"h-full overflow-auto"},Wa=["onMouseenter","onMouseleave","onClick","data-key","onContextmenu","onDblclick"],Ha={class:"single-line-ellipsis"},Ja=["onMouseenter","onMouseleave","onClick","data-key","onContextmenu"],Ya=u(D({__name:"CardList",setup(t){const e=I("fileStore"),{normalCardList:a,cardRectArr:n,fileList:i,choosedKeys:l,tableLoading:s,currentFile:o}=e,r=k(),c=k(),u=k();lt(o,t=>{(null==t?void 0:t.isCreate)&&R(()=>{const t=c.value.querySelector("input");t&&(t.focus(),t.select())})});const p=L(()=>i.value.map(t=>(l.value.includes(t.nm)?t.card_choosed=!0:t.card_choosed=!1,t)));async function d(t){t.isRenameForCard||(l.value=[t.nm],"dir"===t.type&&await Ue(e))}function f(t){const e=[];for(let a=0;a<n.value.length;a++){const[[i,l]]=Object.entries(n.value[a]);Nt(t,l.getClientRects()[0])&&e.push(i)}l.value=e}function m(t,i){!function(){a.value=document.querySelectorAll(".file-item");const t=[];for(let e=0;e<a.value.length;e++){const n=a.value[e].dataset.key;t.push({[n]:a.value[e]})}n.value=t}(),"INPUT"==t.target.nodeName?i.m_flag.value=!1:(i.m_flag.value=!0,le(e))}function v(t){if(t.target.closest("div.file-item")){const e=t.target.closest("div.file-item").dataset.key;if(l.value.includes(e))return;l.value=[e]}else l.value=[]}function y(t,e){l.value.length>1?r.value.filesOperation(t,"multiple"):(1==l.value.length||(l.value=[e.nm]),r.value.filesOperation(t,"single"))}return X(()=>{u.value=It(c,f,m),c.value.oncontextmenu=t=>{t.preventDefault(),t.target.closest("div.file-item")||(l.value.length,r.value.filesOperation(t))}}),ot(()=>{c.value.oncontextmenu=null}),(t,a)=>{const n=Ft,i=Rt,o=h;return j(),T("div",$a,[O(o,{show:E(s),class:"h-full"},{default:V(()=>[q("div",{class:"card-list",ref_key:"cardListRef",ref:c,onContextmenu:v},[(j(!0),T(F,null,A(E(p),t=>(j(),T(F,{key:t.nm},[t.isRenameForCard||t.isCreate?t.isRenameForCard||t.isCreate?(j(),T("div",{key:1,class:M(["file-item",{active:t.card_hover||t.card_choosed}]),onMouseenter:e=>E(Vt)(t),onMouseleave:e=>E(qt)(t),onClick:e=>d(t),"data-key":t.nm,onContextmenu:e=>y(e,t)},[O(sa,{ext:t.ext,size:"large"},null,8,["ext"]),O(i,{value:t.editName,"onUpdate:value":e=>t.editName=e,size:"small",autofocus:"",autoselect:"",onClick:it(()=>!1,["stop"]),onKeydown:a[0]||(a[0]=nt(()=>E(le)(E(e)),["enter"]))},null,8,["value","onUpdate:value"])],42,Ja)):Z("",!0):(j(),N(n,{key:0,trigger:"hover",placement:"bottom"},{trigger:V(()=>[q("div",{class:M(["file-item",{active:t.card_hover||t.card_choosed}]),onMouseenter:e=>E(Vt)(t),onMouseleave:e=>E(qt)(t),onClick:e=>d(t),"data-key":t.nm,onContextmenu:e=>y(e,t),onDblclick:a=>function(t){t.isRenameForCard||"dir"!==t.type&&(l.value=[t.nm],qe(e))}(t)},[O(sa,{ext:t.ext,size:"large"},null,8,["ext"]),q("span",Ha,G(t.nm),1)],42,Wa)]),default:V(()=>[K(" "+G(t.nm),1)]),_:2},1024))],64))),128))],544)]),_:1},8,["show"]),O(Aa,{ref_key:"contextRef",ref:r},null,512)])}}}),[["__scopeId","data-v-ae5d241c"]]),Xa={class:"flex items-center justify-between"},Za={class:"flex justify-start items-center whitespace-pre"},Qa={key:1,class:"i-svg-spinners:90-ring-with-bg text-7 text-primary"},tn=D({__name:"FileTableFooter",setup(t){const{t:e}=W(),n=I("fileStore"),{dirNums:i,fileNums:l,page:s,size:o,total:r,currentPath:c,currentDirSize:u}=n,p=k(!1),d=[100,500,1e3,1500,2e3];async function f(){try{p.value=!0;const t=await a.post("/files?action=GetDirSize",{path:c.value},{requestOptions:{isOriginalResult:!0}});u.value=t.message}catch(t){console.warn(t)}finally{p.value=!1}}return(t,a)=>{const c=Ct,m=jt;return j(),T("div",Xa,[q("div",Za,[K(G(E(e)("file.tableFooter.summary",{dirNum:E(i),fileNum:E(l)}))+" ",1),E(p)?(j(),T("i",Qa)):(j(),T(F,{key:0},[-1===E(u)?(j(),N(c,{key:0,type:"primary",text:"",onClick:f},{default:V(()=>[K(G(E(e)("file.tableFooter.calculate")),1)]),_:1})):(j(),N(c,{key:1,text:"",type:"primary"},{default:V(()=>[K(G(E(u)),1)]),_:1}))],64))]),O(m,{page:E(s),"onUpdate:page":a[0]||(a[0]=t=>x(s)?s.value=t:null),"page-size":E(o),"onUpdate:pageSize":a[1]||(a[1]=t=>x(o)?o.value=t:null),"item-count":E(r),"page-sizes":d,onRefresh:a[2]||(a[2]=()=>E($t)(E(n)))},null,8,["page","page-size","item-count"])])}}}),en={class:"flex flex-col gap-16px h-full p-16px overflow-hidden"},an=D({__name:"main",props:{path:{default:"/"},view:{default:"list"}},emits:["currentPathChange","viewChange","rendered"],setup(t,{emit:e}){const a=t,n=k(),i=function(){const t=k(),e=k("list"),a=k("/www"),n=k([]),i=k(!1),l=k([]),o=k([]),r=k([]),c=k(),u=k(),p=k(),d=k([]),f=k([]),m=k({url:"http://",path:a.value,filename:""}),v=k({reference:"",per:0,speed:"0",used:"0",except:"--",total:0}),h=k(!1),y=k([]),g=k({text:"",exts:"html,php",path:a.value,is_subdir:0,mode:0,isword:0,iscase:1,noword:0}),_=k({}),w=k({files:0,times:0}),b=k([]),x=k([{label:ha("file.favoriteListModal.management"),key:"management",icon:"settings"}]),C=k([]),S=k([]),R=k({back_sub_dir:1,path:"",remark:""}),z=va,O=da,F=fa,D=ma,T={PasteConfirm:()=>P(()=>s(()=>import("./PasteConfirm.js?v=1756367574781"),__vite__mapDeps([16,9,2,3,5,6,1,4,8,7,10,17,18,11,12,13,14,19]))),UploadFile:()=>P(()=>s(()=>import("./UploadFile.js?v=1756367574781"),__vite__mapDeps([20,9,2,3,5,6,1,4,8,7,10,11,12,13,14,21]))),RemoteDownload:()=>P(()=>s(()=>import("./RemoteDownload.js?v=1756367574781"),__vite__mapDeps([22,9,2,3,5,6,1,4,8,7,10,23,11,12,13,14]))),SearchFileContent:()=>P(()=>s(()=>import("./SearchFileContent.js?v=1756367574781"),__vite__mapDeps([24,9,2,3,5,6,1,4,8,7,10,25,26,11,12,13,14,27]))),FavoriteList:()=>P(()=>s(()=>import("./FavoriteList.js?v=1756367574781"),__vite__mapDeps([28,9,2,3,5,6,1,4,8,7,10,11,12,13,14]))),ShareList:()=>P(()=>s(()=>import("./ShareList.js?v=1756367574781"),__vite__mapDeps([29,9,2,3,5,6,1,4,8,7,10,30,23,11,12,13,14]))),Backup:()=>P(()=>s(()=>import("./Backup.js?v=1756367574781"),__vite__mapDeps([31,9,2,3,5,6,1,4,8,7,10,25,26,11,12,13,14]))),Recycle:()=>P(()=>s(()=>import("./Recycle.js?v=1756367574781"),__vite__mapDeps([32,9,2,3,5,6,1,4,8,7,10,33,34,35,11,12,13,14,36]))),Terminal:()=>P(()=>s(()=>import("./Terminal.js?v=1756367574781"),__vite__mapDeps([37,9,2,3,5,6,1,4,8,7,10,38,39,40,41,42]))),Softlink:()=>P(()=>s(()=>import("./SoftLink.js?v=1756367574781"),__vite__mapDeps([43,9,2,3,5,6,1,4,8,7,10,23,25,26,11,12,13,14]))),Share:()=>P(()=>s(()=>import("./Share.js?v=1756367574781"),__vite__mapDeps([44,9,2,3,5,6,1,4,8,7,10,23,45,30,11,12,13,14]))),Permission:()=>P(()=>s(()=>import("./Permission.js?v=1756367574781"),__vite__mapDeps([46,9,2,3,5,6,1,4,8,7,10,11,12,13,14,47]))),Properties:()=>P(()=>s(()=>import("./Properties.js?v=1756367574781"),__vite__mapDeps([48,9,2,3,5,6,1,4,8,7,10,49,50,11,12,13,14,51]))),Del:()=>P(()=>s(()=>import("./Del.js?v=1756367574781"),__vite__mapDeps([52,17,1,2,3,4,5,6,7,8,18,9,10,11,12,13,14,53]))),Compression:()=>P(()=>s(()=>import("./Compression.js?v=1756367574781"),__vite__mapDeps([54,9,2,3,5,6,1,4,8,7,10,23,25,26,11,12,13,14]))),Decompress:()=>P(()=>s(()=>import("./Decompress.js?v=1756367574781"),__vite__mapDeps([55,9,2,3,5,6,1,4,8,7,10,23,11,12,13,14]))),AceEditor:()=>P(()=>s(()=>import("./index183.js?v=1756367574781"),__vite__mapDeps([56,1,2,3,4,5,6,7,8,57,9,10,11,12,13,14,58])))},j=B(null),M=k(),E=k(!1),I=k(!1),N=k([]),V=k(!1),q=k(!1),U=k(!1),A=k(!1),K=k(),G=k(!1),$=L(()=>n.value.filter(t=>Qe(t)).map(t=>t.path)),W=L(()=>n.value.filter(t=>Ze(t.ext)).map(t=>({path:t.path,name:t.nm}))),H=k(""),J=k({path:"",name:""}),Y=k(!1),X=k(!1),Z=k(1),Q=k(0),tt=k(0),et=k(1),at=k(100),nt=k(""),it=k("False"),lt=k(0),st=k(null),ot=k(),rt=k([]),ct=k(1),ut=k(0),pt=k(-1),dt=k();return{mainRef:t,filesView:e,currentPath:a,fileList:n,tableLoading:i,normalTrList:l,trRectArr:o,choosedKeys:r,tableRef:c,dataTableRef:u,contextRef:p,normalCardList:d,cardRectArr:f,downloadFileFormData:m,downloadProgressData:v,downloadProgressShow:h,resourceManagerWindow:y,searchFileContentFormData:g,resetSearchFileContentFormData:function(){g.value={text:"",exts:"html,php",path:a.value,is_subdir:0,mode:0,isword:0,iscase:1,noword:0}},searchRes:_,searchStatistics:w,favoriteList:b,favoriteOptions:x,resetFavoriteOptions:function(){x.value=[{label:ha("file.favoriteListModal.management"),key:"management",icon:"settings"}]},shareList:C,backupList:S,backupForm:R,fileOperationFlag:z,fileCopyCache:O,waitForPaste:F,copiedFile:D,dynamicCmptObj:T,dynamicCmpt:j,dynamicCmptRef:M,fileRecycle:E,menuShow:I,uploadFileList:N,uploadShow:V,uploadComplete:q,startUpload:U,fileConflictShow:A,optionToolsRef:K,isMiniScreen:G,imgWaitPreview:$,videoWaitPreview:W,currentPreviewImg:H,currentPreviewVideo:J,previewShow:Y,previewVideoShow:X,operationType:Z,dirNums:Q,fileNums:tt,page:et,size:at,sort:nt,reverse:it,total:lt,currentFile:st,choosePathRef:ot,diskMountPoint:rt,shareListPage:ct,shareListTotal:ut,currentDirSize:pt,dragUploadRef:dt}}(),l=rt();pt("fileStore",i);const{dynamicCmpt:o,dynamicCmptRef:r,currentPath:c,filesView:u,choosedKeys:p,mainRef:d,copiedFile:f,currentFile:m,dragUploadRef:v}=i;c.value=a.path,u.value=a.view;const h=e;function g(t){h("viewChange",{view:t,currentPath:c.value})}return lt(c,t=>{sessionStorage.setItem("currentPath",t),h("currentPathChange",t)}),H(()=>{$t(i),document.onkeydown=async t=>{var e,a,n;if("/files"!=l.path)return;if((null==(e=m.value)?void 0:e.isCreate)||(null==(a=m.value)?void 0:a.isEditRemarks)||(null==(n=m.value)?void 0:n.isRename))return;if(!document.querySelector(".aceEditors")){if(t.ctrlKey&&"c"===t.key){if(0==p.value.length)return;await Ke(i)}if(t.ctrlKey&&"v"===t.key&&Be(i),t.ctrlKey&&"x"===t.key){if(0==p.value.length)return;Ge(i)}}}}),ct(()=>{$t(i)}),oe(i),X(()=>h("rendered",c.value)),(t,e)=>{const a=y;return j(),T("div",{ref_key:"mainRef",ref:d,class:"flex-1 overflow-hidden"},[q("div",en,[q("div",null,[O(Na)]),O(a),q("div",null,[O(za,{"files-view":E(u),"onUpdate:filesView":e[0]||(e[0]=t=>x(u)?u.value=t:null),onViewChange:g},null,8,["files-view"])]),q("div",{ref_key:"listRef",ref:n,class:"flex-1 overflow-hidden",tabindex:"0"},["list"==E(u)?(j(),N(Ba,{key:0})):"card"==E(u)?(j(),N(Ya,{key:1})):Z("",!0)],512),O(tn)]),(j(),N(ut(E(o)),{ref_key:"dynamicCmptRef",ref:r},null,512)),O(wa,{ref_key:"dragUploadRef",ref:v},null,512),O(xa),O(pa)],512)}}}),nn={class:"tabs"},ln=["onClick"],sn={class:"flex justify-start gap-5"},on={class:"tab-tit"},rn={class:"tab-tit"},cn=u(D({__name:"index",setup(t){const e=k(null),{mainHeight:a}=dt(g()),n=L(()=>a.value-16-16),i=sessionStorage.getItem("tabs"),l=k(),s=k(),r=k(),c=k(!1);let u=[];u=i?JSON.parse(i):[{id:"tab-0",title:"/www/wwwroot",path:"/www/wwwroot",view:"list"}];const p=k(u),f=k("tab-0"),m=k("list");f.value=sessionStorage.getItem("activeTab")?sessionStorage.getItem("activeTab"):"tab-0",lt(f,t=>{const e=p.value.find(e=>e.id==t);e&&(m.value=e.view)},{immediate:!0});const v=L(()=>{const t=p.value.find(t=>t.id==f.value);return t?t.path:"tab-0"});function h(){if(p.value.length>=14)return void o.warning("最多只能打开14个标签");const t="tab-".concat((new Date).getTime());p.value.push({id:t,title:"/www/wwwroot",path:"/www/wwwroot",view:"list"}),f.value=t}function y(t){const e=t.split("/").slice(-1)[0];p.value.forEach(a=>{a.id==f.value&&(a.path=t,a.title=""==e?"/":e)})}function x({view:t,path:e}){m.value=t,p.value.forEach(a=>{a.id==f.value&&(a.path=e,a.view=t)})}function C(t){"left"==t?r.value.scrollLeft-=100:"right"==t&&(r.value.scrollLeft+=100)}function S(){s.value&&(c.value=s.value.offsetWidth>l.value.offsetWidth)}return lt(p,t=>{sessionStorage.setItem("tabs",JSON.stringify(t)),setTimeout(()=>S(),50)},{deep:!0}),lt(f,t=>{sessionStorage.setItem("activeTab",t),S()}),X(()=>{r.value.addEventListener("mousewheel",t=>{t.preventDefault(),r.value.scrollLeft+=t.deltaY})}),function(){const t=w("Path");if(t){const e="tab-".concat((new Date).getTime());p.value.push({id:e,title:t,path:t,view:"list"});const a=p.value.find(e=>e.path==t);a&&(f.value=a.id)}b("Path")}(),X(async()=>{await _("/static/ace/styles/icons.css?v=1756367574781",e.value),Et()}),(t,a)=>{const i=d,o=Ft,u=Dt;return j(),T("div",{ref_key:"fileRef",ref:e,id:"file-main",class:"p-16px"},[O(u,{style:U({height:E(n)+"px"}),"content-style":{display:"flex",flexDirection:"column",overflow:"hidden"}},{default:V(()=>[q("div",nn,[q("div",{class:M(["tabs-scroll",{"has-scroll":E(c)}]),ref_key:"tabScrollRef",ref:l},[E(c)?(j(),T("div",{key:0,class:"left",onClick:a[0]||(a[0]=t=>C("left"))},a[2]||(a[2]=[q("i",{class:"i-tdesign:caret-left text-7"},null,-1)]))):Z("",!0),E(c)?(j(),T("div",{key:1,class:"right",onClick:a[1]||(a[1]=t=>C("right"))},a[3]||(a[3]=[q("i",{class:"i-tdesign:caret-right text-7"},null,-1)]))):Z("",!0),q("div",{class:"scroll-container",ref_key:"tabScrollContainerRef",ref:r},[q("div",{class:"tabs-wrapper",ref_key:"tabWrapperRef",ref:s},[(j(!0),T(F,null,A(E(p),t=>(j(),N(o,{placement:"bottom",key:t.id},{trigger:V(()=>[q("div",{class:M(["tab-item",{active:t.id==E(f)}]),onClick:e=>{return a=t.id,void(f.value=a);var a}},[q("div",sn,[O(i,{name:"file-dir",size:"18"}),q("span",on,G(t.title),1)]),t.id==E(f)&&E(p).length>1?(j(),N(i,{key:0,name:"base-error",size:"18",color:"#bbb",onClick:e=>function(t){if(1==p.value.length)return void(f.value=p.value[0].id);const e=p.value.findIndex(e=>e.id==t);p.value.splice(e,1),setTimeout(()=>f.value=p.value[p.value.length-1].id,50)}(t.id)},null,8,["onClick"])):Z("",!0)],10,ln)]),default:V(()=>[q("span",rn,G(t.title),1)]),_:2},1024))),128)),q("div",{class:"tab-item add",onClick:h},[O(i,{name:"base-add",size:"18",color:"#ccc"})])],512)],512)],2)]),(j(),N(ft,null,[(j(),N(ut(an),{key:E(f),onCurrentPathChange:y,path:E(v),view:E(m),onViewChange:x},null,40,["path","view"]))],1024))]),_:1},8,["style"])],512)}}}),[["__scopeId","data-v-7a85dcb9"]]),un=Object.freeze(Object.defineProperty({__proto__:null,default:cn},Symbol.toStringTag,{value:"Module"}));export{Me as B,Ea as C,sa as F,oe as a,Xe as b,je as c,la as d,Se as e,ia as f,$t as g,Kt as h,At as i,pe as j,Ie as k,Ne as l,se as m,re as n,Mt as o,un as p,ea as r,aa as s,na as u};
