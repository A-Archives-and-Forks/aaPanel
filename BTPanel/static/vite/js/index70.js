import{_ as t}from"./index.vue_vue_type_script_setup_true_lang.js?v=1721298337096";import{u as e,_ as i}from"./useTableData.js?v=1721298337096";import{u as a,M as s,L as o,dA as r,dH as l,h as n,dI as m,dJ as d,k as p,n as u,dK as c,B as h}from"./index.js?v=1721298337096";import{b as f}from"./useTableColumns.js?v=1721298337096";import{u as w}from"./useLoading.js?v=1721298337096";import{l as k,S as g,Z as j,P as y,V as b,q as _,W as x}from"./vue.js?v=1721298337096";import"./Skeleton.js?v=1721298337096";import"./DataTable.js?v=1721298337096";import"./Checkbox.js?v=1721298337096";import"./Ellipsis.js?v=1721298337096";import"./Select.js?v=1721298337096";import"./Tag.js?v=1721298337096";import"./Empty.js?v=1721298337096";import"./omit.js?v=1721298337096";import"./pinia.js?v=1721298337096";import"./Progress.js?v=1721298337096";const L={class:"p-20px"},v=k({__name:"index",props:{data:{}},setup(k){const v=k,{sid:C}=v.data,D=a(),B=async()=>{if(null===C)throw u.error("Please select remote database!"),new Error("sid is null");await c({sid:C}),P()},{table:E,columns:T}=e([{key:"name",title:"File name",width:180,ellipsis:{tooltip:{width:"trigger"}}},{key:"filepath",title:"File path",ellipsis:{tooltip:{width:"trigger"}}},{key:"mtime",title:"Backup time",width:150,render:t=>s(t.mtime)},{key:"size",title:"File size",width:80,render:t=>o(t.size)},{key:"sid",title:"Backup location",width:120,render:t=>{let e="--";for(let i=0;i<D.remoteList.length;i++)if("".concat(D.remoteList[i].id)===t.sid){e=D.remoteList[i].ps||D.remoteList[i].db_host;break}return e}},f({width:100,options:t=>[{label:"Repair",onClick:()=>{r({text:"Overwrite the data",title:"Overwrite the data",content:"Data will be overwritten using [".concat(t.name,"], Do you want to continue?"),onConfirm:async({hide:e})=>{if(null===C)throw new Error("sid is null");await l({file:t.filepath,sid:C}),D.setRefresh(!0),e()}})}},{label:"Del",onClick:()=>{n({title:"Delete backup",content:"Whether to delete the [".concat(t.name,"] backup"),onConfirm:async({hide:e})=>{await m({file:t.filepath}),P(),e()}})}}]})]),{loading:z,setLoading:F}=w(),P=async()=>{try{F(!0);const{message:t}=await d();E.data=p(t)?t:[]}finally{F(!1)}};return P(),(e,a)=>{const s=h,o=i,r=t;return g(),j("div",L,[y(r,null,{toolsLeft:b((()=>[y(s,{type:"primary",onClick:B},{default:b((()=>[_("Backup")])),_:1})])),table:b((()=>[y(o,{"max-height":400,loading:x(z),columns:x(T),data:x(E).data},null,8,["loading","columns","data"])])),_:1})])}}});export{v as default};
