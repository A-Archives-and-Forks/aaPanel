const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index233.js?v=1756367574781","js/index108.js?v=1756367574781","js/vue.js?v=1756367574781","js/__commonjsHelpers__.js?v=1756367574781","js/naive.js?v=1756367574781","js/common.js?v=1756367574781","js/page_layout.js?v=1756367574781","js/public.js?v=1756367574781","css/public.css?v=1756367574781","css/page_layout.css?v=1756367574781","css/index21.css?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang10.js?v=1756367574781","js/index98.js?v=1756367574781","css/index13.css?v=1756367574781","js/index99.js?v=1756367574781","css/index14.css?v=1756367574781","js/site.js?v=1756367574781","js/domain-input.js?v=1756367574781","css/domain-input.css?v=1756367574781","js/index133.js?v=1756367574781","css/index23.css?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang5.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang6.js?v=1756367574781","css/index15.css?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang7.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang12.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang8.js?v=1756367574781","js/index131.js?v=1756367574781","js/php.js?v=1756367574781","js/soft.js?v=1756367574781","css/index22.css?v=1756367574781","js/soft2.js?v=1756367574781","js/useOperate.js?v=1756367574781","js/useModal2.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang15.js?v=1756367574781","js/index.js?v=1756367574781","css/index107.css?v=1756367574781","css/index95.css?v=1756367574781","js/index234.js?v=1756367574781","js/index105.js?v=1756367574781","css/index19.css?v=1756367574781","js/index235.js?v=1756367574781","js/index244.js?v=1756367574781","css/index59.css?v=1756367574781","js/index100.js?v=1756367574781","js/index101.js?v=1756367574781","js/file.js?v=1756367574781","js/theme-monokai.js?v=1756367574781","css/index16.css?v=1756367574781","js/refersh.js?v=1756367574781","js/form.vue_vue_type_script_setup_true_lang2.js?v=1756367574781","js/logs.vue_vue_type_script_setup_true_lang.js?v=1756367574781","js/ssl.js?v=1756367574781","js/cert.js?v=1756367574781","js/utils3.js?v=1756367574781","js/index217.js?v=1756367574781","js/paypal-js.js?v=1756367574781","css/index48.css?v=1756367574781","js/ssl-lets-progress.js?v=1756367574781","css/ssl-lets-progress.css?v=1756367574781","js/upload.js?v=1756367574781","css/index96.css?v=1756367574781","js/index236.js?v=1756367574781","js/index.vue_vue_type_script_setup_true_lang14.js?v=1756367574781","css/index97.css?v=1756367574781","js/index237.js?v=1756367574781","js/ssl-log.js?v=1756367574781","js/expired.js?v=1756367574781","js/php2.js?v=1756367574781","js/category.js?v=1756367574781"])))=>i.map(i=>d[i]);
import{j as e,s as t,bd as a,aq as l,di as n,d as i,a as s,z as o,p as r,q as u,r as d,a4 as c,_ as p,u as m,w as _,a7 as f,m as v,o as y}from"./page_layout.js?v=1756367574781";import{_ as h}from"./index133.js?v=1756367574781";import{_ as g}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1756367574781";import{_ as x}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1756367574781";import{_ as w}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1756367574781";import{de as k,di as S,aC as b,_ as P,d5 as C,dc as H,dd as j,d8 as B,dh as T,aX as L,da as V,bH as D,dj as A,dm as R,au as U,dg as O,dR as M,dV as W,dS as N}from"./naive.js?v=1756367574781";import{k as E,i as I,r as $,o as q,w as K,a2 as F,V as z,U as Q,a3 as G,W as X,S as Y,F as Z,Z as J,c as ee,P as te,_ as ae,a0 as le,R as ne,H as ie,a4 as se,l as oe,v as re,j as ue,am as de,aw as ce,ak as pe,O as me,x as _e,s as fe,e as ve,N as ye,ah as he,an as ge,p as xe}from"./vue.js?v=1756367574781";import{_ as we}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1756367574781";import{_ as ke}from"./index131.js?v=1756367574781";import{u as Se,a9 as be,v as Pe,h as Ce,aa as He,G as je,e as Be,c as Te,f as Le,a as Ve,d as De,ab as Ae,m as Re}from"./public.js?v=1756367574781";import{s as Ue,c as Oe,d as Me,e as We,f as Ne,h as Ee,i as Ie,j as $e,k as qe}from"./site.js?v=1756367574781";import{u as Ke}from"./soft2.js?v=1756367574781";import{a as Fe,b as ze,c as Qe}from"./php.js?v=1756367574781";import{u as Ge}from"./useOperate.js?v=1756367574781";import{a5 as Xe,a6 as Ye,a7 as Ze,m as Je,h as et}from"./common.js?v=1756367574781";import{_ as tt}from"./index.vue_vue_type_script_setup_true_lang15.js?v=1756367574781";import{_ as at}from"./index.js?v=1756367574781";import{_ as lt}from"./index.vue_vue_type_script_setup_true_lang.js?v=1756367574781";const nt=E({__name:"index",props:{disabledKeys:{type:Array,default:()=>[]},hideKeys:{type:Array,default:()=>[]},storeKey:{type:String,default:""},loading:{type:Boolean,default:!1}},setup(l){const n=I("tableRef"),i=$(!1),s=$([]),o=$([]),r=$([]),u=()=>{i.value=!0},d=()=>{i.value=!1},c=()=>{if(!n)return;const e=k(o.value.filter(e=>s.value.includes(String(e.key)))),t=e.length;if(t>0){const l=Math.floor(100/t),n=100-l*t;e.forEach((e,t)=>{if(a(e.width)||!e.width)return;let i=l;t<n&&(i+=1),e.width="".concat(i,"%")})}"selection"===o.value[0].type&&e.unshift(o.value[0]),n.value.setColumns(e)},p=e=>{if(s.value.includes(e)?s.value=s.value.filter(t=>t!==e):s.value.push(e),l.storeKey&&t(l.storeKey,s.value.join(",")),l.loading){const e=K(()=>l.loading,t=>{t||c(),e()})}else c()};return q(()=>{if(n){const t=n.value.getColumns();0===o.value.length&&(o.value=k(t)),(()=>{if(l.storeKey){const t=e(l.storeKey);t&&(s.value=t.split(","))}})(),(()=>{const e=o.value.filter(e=>"selection"!==e.type);0===s.value.length&&(s.value=e.filter(e=>!l.hideKeys.includes(String(e.key))).map(e=>String(e.key))),r.value=e.map(e=>({key:String(e.key),disabled:"operate"===e.key||l.disabledKeys.includes(String(e.key)),label:()=>X(Z,null,[X(P,{checked:s.value.includes(String(e.key))},null),X("span",{class:"ml-8px"},[String(e.title)])])}))})();const a=K(()=>l.loading,e=>{e||c(),a()})}}),(e,t)=>{const a=b,l=S;return z(),F(l,{placement:"bottom-end",show:Q(i),"show-arrow":!0,"arrow-point-to-center":!0,options:Q(r),onSelect:p,onClickoutside:d},{default:G(()=>[X(a,{onClick:u},{default:G(()=>t[0]||(t[0]=[Y("i",{class:"i-famicons:settings-outline text-16px"},null,-1)])),_:1,__:[0]})]),_:1},8,["show","options"])}}}),it=J("SitePhpStore",()=>{const e=$(!1),t=$("--"),a=$(""),s=$("/www/wwwroot"),o=$(!0),r=$({setup:!0,type:"",version:"",status:!1}),u=$({setup:!1,version:"",status:!1}),d=$({setup:!1,version:"",status:!1}),c=$({is_install:0,status:!1,version:""}),p=ee(()=>1===c.value.is_install&&l(c.value.version,"4.1.2")),m=$({is_install:0,status:!1,version:""}),_=ee(()=>1===m.value.is_install&&l(m.value.version,"9.6.8")),f=$({setup:!1});return{web:r,ftp:u,siteName:t,mysql:d,php:f,sitePath:s,webserver:a,recycleBin:o,isRefresh:e,monitor:c,waf:m,isMonitorInstall:p,isWafInstall:_,getConfig:async()=>{const{message:e}=await n();i(e)&&(a.value=C(e,"webserver",""),s.value=C(e,"sites_path",""),o.value=C(e,"recycle_bin",!1),f.value.setup=!!e.php.length,i(e.web)&&(r.value=e.web),i(e["pure-ftpd"])&&(u.value=e["pure-ftpd"]),i(e.mysql)&&(d.value=e.mysql),i(e.monitor)&&(c.value=e.monitor),i(e.waf)&&(m.value=e.waf))},setRefresh:t=>{e.value=t}}}),st=()=>{const{t:e}=te();return{openAddSiteModal:()=>{Se({title:e("Site.PHP.index_9"),width:700,height:540,footer:!0,component:ae(()=>s(()=>import("./index233.js?v=1756367574781"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38])))})},openBackupModal:t=>{Se({title:e("Site.PHP.index_33",[t.name]),width:720,minHeight:200,data:{row:t},component:ae(()=>s(()=>import("./index234.js?v=1756367574781"),__vite__mapDeps([39,36,2,3,5,7,6,4,9,8,37,40,41,22,23,24,25,26,17])))})},openSiteConfig:(t,a={})=>{Se({title:e("Site.PHP.index_13",[t.name,t.addtime]),width:860,height:700,data:{siteInfo:t,config:Object.assign({menu:"",subMenu:""},a)},component:ae(()=>s(()=>import("./index235.js?v=1756367574781").then(e=>e.i),__vite__mapDeps([42,6,2,3,4,5,7,8,9,43,44,22,23,24,26,15,16,17,36,37,11,12,13,14,1,10,45,46,47,48,49,29,20,21,50,51,40,41,52,53,54,55,56,57,58,59,60,61,62])))})},openDeleteSiteConfig:t=>{Se({title:1===t.length?"".concat(e("Site.Cert.index_56")," [").concat(t[0].name,"]"):"".concat(e("Site.Cert.index_57")),width:480,minHeight:248,footer:!0,data:{rows:t},component:ae(()=>s(()=>import("./index236.js?v=1756367574781"),__vite__mapDeps([63,6,2,3,4,5,7,8,9,17,64,47,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,11,65])))})},openSiteAdvancedModal:t=>{Se({title:e("Database.Mysql.index_3"),width:950,height:620,data:{menu:t},component:ae(()=>s(()=>import("./index237.js?v=1756367574781"),__vite__mapDeps([66,43,2,3,4,5,6,7,8,9,44,1,10,45,46,47,48,49,11,17,29,20,21,22,23,24,25,26,27,28,30,31,32,33,34,35,36,37])))})},openSslLogsModal:t=>{Se({title:e("SSL.Domain.index_5"),width:700,height:450,data:{path:t},component:ae(()=>s(()=>import("./ssl-log.js?v=1756367574781"),__vite__mapDeps([67,40,6,2,3,4,5,7,8,9,41])))})}}},ot={class:"website-name"},rt={key:1,class:"flex-center w-24px h-24px rounded-50%"},ut=["src"],dt={class:"flex flex-col flex-1 w-0 overflow-hidden"},ct={class:"flex items-center gap-8px"},pt={class:"min-w-0"},mt={class:"website-description"},_t=r(E({__name:"Name",props:{ico:{type:String,default:""},name:{type:String,default:"--"},description:{type:String,default:"--"}},emits:["clickName","blur"],setup(e,{emit:t}){const a=o(),{theme:l}=le(a),n=t,i=()=>{n("clickName")},s=()=>{window.open("http://".concat(e.name))},r=e=>{n("blur",e)};return(t,a)=>{const n=H,o=b,u=be;return z(),ne("div",ot,[Y("div",{class:"website-icon",onClick:i},[e.ico?(z(),ne("div",rt,[Y("img",{src:e.ico,class:"w-full h-full"},null,8,ut)])):(z(),ne("div",{key:0,class:ie(["flex-center w-24px h-24px rounded-50%","dark"!==Q(l)&&"bg-#F1F9F3"])},[Y("i",{class:ie(["i-mdi:earth text-18px","dark"!==Q(l)&&"text-primary"])},null,2)],2))]),Y("div",dt,[Y("div",ct,[Y("div",pt,[X(n,{class:"max-w-full",tooltip:{contentStyle:{maxWidth:"200px"}}},{default:G(()=>[Y("span",{class:ie(["cursor-pointer","dark"!==Q(l)&&"text-primary"]),onClick:i},se(e.name),3)]),_:1})]),X(o,{type:"primary",text:"",onClick:s},{default:G(()=>a[0]||(a[0]=[Y("i",{class:"i-fa-solid:external-link-alt"},null,-1)])),_:1,__:[0]})]),Y("div",mt,[X(u,{value:e.description,onBlur:r},null,8,["value"])])])])}}}),[["__scopeId","data-v-ac550e57"]]),ft={class:"i-famicons:play-circle-outline"},vt={class:"i-famicons:pause-circle-outline text-warning"},yt=r(E({__name:"Status",props:{status:{type:String,default:"0"},checkedValue:{type:String,default:"1"},unCheckedValue:{type:String,default:"0"},onUpdateValue:{type:Function}},setup(e){const t=()=>{var t;null==(t=e.onUpdateValue)||t.call(e,e.status===e.checkedValue?e.unCheckedValue:e.checkedValue)};return(a,l)=>(z(),ne("div",{class:"website-status",onClick:t},[oe(Y("i",ft,null,512),[[re,e.status===e.checkedValue]]),oe(Y("i",vt,null,512),[[re,e.status===e.unCheckedValue]])]))}}),[["__scopeId","data-v-a66f2bce"]]),ht=E({__name:"Backup",props:{count:{type:Number,default:0},lastTime:{type:String,default:""}},emits:["showBackup"],setup(e,{emit:t}){const a=t,l=()=>{a("showBackup")},n=t=>Xe(new Date,e.lastTime||new Date)>=t,i=ee(()=>{if(0===e.count)return"Backup now";const t=Xe(new Date,e.lastTime||new Date);return 0===t?"Today":1===t?"Yesterday":"".concat(t," days ago")}),s=ee(()=>n(30)||e.count<=0?"error":n(7)?"warning":"primary");return(t,a)=>{const n=j,o=B;return z(),ne("div",{class:"flex items-center gap-8px cursor-pointer",onClick:l},[X(n,{type:Q(s),size:"small",bordered:!1},{default:G(()=>[ue(se(e.count),1)]),_:1},8,["type"]),X(o,{disabled:0===e.count},{trigger:G(()=>[Y("div",{class:ie({"text-error":"error"===Q(s),"text-warning":"warning"===Q(s)})},se(Q(i)),3)]),default:G(()=>[ue(" "+se(e.lastTime),1)]),_:1},8,["disabled"])])}}}),gt={class:"inline-flex items-center w-full"},xt={class:"flex-1 text-right"},wt={class:"flex-1 text-left"},kt=E({__name:"Quick",props:{path:{type:String,default:""},phpVersion:{type:String,default:""}},emits:["showPhp"],setup(e,{emit:t}){const a=t,l=de(),n=()=>{d("Path",e.path),l.push("/files")},i=()=>{a("showPhp")};return(t,a)=>{const l=b,s=B,o=u;return z(),ne("div",gt,[Y("div",xt,[X(s,{trigger:"hover"},{trigger:G(()=>[X(l,{text:"",onClick:n},{default:G(()=>a[0]||(a[0]=[Y("i",{class:"i-fa:folder-open-o text-13px"},null,-1)])),_:1,__:[0]})]),default:G(()=>[ue(" "+se(e.path),1)]),_:1})]),X(o,{vertical:""}),Y("div",wt,[X(l,{text:"",onClick:i},{default:G(()=>[ue(se(e.phpVersion),1)]),_:1})])])}}}),St={class:"flex justify-end"},bt=r(E({__name:"ExpiredDate",props:{value:{type:String,default:"0000-00-00"},onUpdateValue:{type:Function}},setup(e){const{t:t}=te(),a=ce("popoverRef"),l=$(null),n=ee(()=>{const t=new Date(e.value);return"0000-00-00"!==e.value&&Ye(t,Ze())}),i=ee(()=>"0000-00-00"===e.value?t("Site.PHP.index_34"):n.value?t("Site.PHP.index_28"):e.value),s=e=>Ye(e,Je(Ze(),1)),o=ee(()=>{const t=new Date(e.value);return"0000-00-00"!==e.value&&Ye(t,Je(Ze(),7))}),r=async()=>{var t,l;await(null==(t=e.onUpdateValue)?void 0:t.call(e,"0000-00-00")),null==(l=a.value)||l.setShow(!1)},u=async()=>{var t,n;if(null===l.value)return;const i=et(l.value,"yyyy-MM-dd");await(null==(t=e.onUpdateValue)?void 0:t.call(e,i)),null==(n=a.value)||n.setShow(!1)},d=()=>{l.value="0000-00-00"===e.value?null:new Date(e.value).getTime()};return(e,t)=>{const p=b,m=L,_=c,f=T;return z(),F(f,{ref_key:"popoverRef",ref:a,placement:"bottom",trigger:"click"},{trigger:G(()=>[X(p,{type:Q(n)?"error":Q(o)?"warning":"default",text:!0,onClick:d},{default:G(()=>[ue(se(Q(i)),1)]),_:1},8,["type"])]),default:G(()=>[X(_,{value:Q(l),"onUpdate:value":t[0]||(t[0]=e=>pe(l)?l.value=e:null),type:"date",panel:!0,actions:null,"is-date-disabled":s},{footer:G(()=>[Y("div",St,[X(m,{size:"small"},{default:G(()=>[X(p,{onClick:r},{default:G(()=>[ue(se(e.$t("Site.PHP.index_34")),1)]),_:1}),X(p,{disabled:null===Q(l),onClick:u},{default:G(()=>[ue(se(e.$t("Public.Btn.Confirm")),1)]),_:1},8,["disabled"])]),_:1})])]),_:1},8,["value"])]),_:1},512)}}}),[["__scopeId","data-v-4583ec55"]]),Pt=["onClick"],Ct={class:"whitespace-nowrap mr-10px"},Ht={class:"w-120px"},jt=E({__name:"Ssl",props:{config:{type:[Number,Object],default:-1},sslApplyList:{type:Array,default:()=>[]}},emits:["click"],setup(e,{emit:t}){const a=t,{openSslLogsModal:l}=st(),n=()=>{a("click")};return(t,a)=>{const s=b,o=D,r=p,u=V;return Q(i)(e.config)?(z(),F(s,{key:0,type:e.config.endtime<0?"error":"primary",text:"",onClick:n},{default:G(()=>[ue(se(e.config.endtime<0?t.$t("Site.PHP.index_28"):t.$t("Site.PHP.index_29",[e.config.endtime])),1)]),_:1},8,["type"])):e.sslApplyList.length>0?(z(!0),ne(Z,{key:1},me(e.sslApplyList,e=>(z(),ne("div",{class:"flex flex-nowrap! p-10px cursor-pointer justify-between items-center",key:e.task_name,onClick:t=>{return a=t,n=e.task_log,a.stopPropagation(),void l(n);var a,n}},[Y("span",Ct,se(e.task_name),1),X(u,{class:"items-center flex-nowrap!"},{default:G(()=>[Y("div",Ht,[X(o,{class:"w-full",type:"line",status:"success","indicator-placement":"inside",percentage:e.task_status,processing:100!==e.task_status},null,8,["percentage","processing"])]),X(r,{name:"base-left-logs",size:"18",color:"#666666"})]),_:2},1024)],8,Pt))),128)):(z(),F(s,{key:2,type:"warning",text:"",onClick:n},{default:G(()=>[ue(se(t.$t("Site.PHP.index_30")),1)]),_:1}))}}}),Bt={class:"text-left"},Tt={class:"cursor-pointer"},Lt=E({__name:"Requests",props:{name:{type:String,default:""},total:{type:[Number,String],default:0},value:{type:Array,default:()=>[]}},setup(e){const{openMonitor:t}=Ge(),a=ee(()=>e.total.toLocaleString("en-US")),l=ee(()=>({xAxis:{type:"category",data:e.value.map(e=>e.date)},yAxis:{type:"value",show:!1},series:[{name:"页面浏览量",data:e.value.map(e=>e.value),type:"line",lineStyle:{color:"#20a53a",width:2},areaStyle:{color:"rgba(32, 165, 58, 0.1)"},symbol:"none"}],grid:{left:0,right:0,top:0,bottom:0}}));return(n,i)=>(z(),ne("div",{class:"flex flex-col gap-3px cursor-pointer",onClick:i[0]||(i[0]=a=>Q(t)(e.name))},[Y("div",Bt,se(Q(a)),1),Y("div",Tt,[X(tt,{type:"line",option:Q(l),height:"15px"},null,8,["option"])])]))}}),Vt={class:"flex w-full items-center"},Dt={class:"flex-1 flex items-center justify-end"},At={class:"flex-1 flex justify-start"},Rt=E({__name:"Waf",props:{siteName:{type:String,default:""},total:{type:Number,default:0},status:{type:Boolean,default:!1},onUpdateStatus:{type:Function}},setup(e){const{openSiteWaf:t}=Ge();return(a,l)=>{const n=b,i=u,s=A;return z(),ne("div",Vt,[Y("div",Dt,[X(n,{text:"",onClick:l[0]||(l[0]=a=>Q(t)(e.siteName))},{default:G(()=>[ue(se(e.total),1)]),_:1})]),X(i,{vertical:""}),Y("div",At,[X(s,{value:e.status,size:"small","onUpdate:value":e.onUpdateStatus},null,8,["value","onUpdate:value"])])])}}}),Ut={class:"inline-flex items-center"},Ot=E({__name:"OperateMenu",emits:["clickConfig","clickLog","clickOperate"],setup(e,{emit:t}){const a=t,l=[{key:"scan",label:"Security Scan",icon:()=>X("i",{class:"i-ant-design:security-scan-outlined text-18px"},null)},{key:"delete",label:"Delete WebSite",icon:()=>X("i",{class:"i-weui:delete-outlined text-18px"},null)}],n=e=>{a("clickOperate",e)};return(e,t)=>{const i=b,s=u,o=S;return z(),ne("div",Ut,[X(i,{type:"primary",text:"",onClick:t[0]||(t[0]=e=>a("clickConfig"))},{default:G(()=>t[2]||(t[2]=[ue("Conf",-1)])),_:1,__:[2]}),X(s,{vertical:""}),X(i,{class:"mr-8px",type:"primary",text:"",onClick:t[1]||(t[1]=e=>a("clickLog"))},{default:G(()=>t[3]||(t[3]=[ue("Log",-1)])),_:1,__:[3]}),X(o,{trigger:"click",options:l,onSelect:n},{default:G(()=>t[4]||(t[4]=[Y("i",{class:"i-famicons:ellipsis-vertical text-18px cursor-pointer"},null,-1)])),_:1,__:[4]})])}}}),Mt=E({__name:"index",emits:["fetchTable","update:sorter"],setup(t,{expose:a,emit:l}){const n=l,s=it(),o=m(),{isFree:r}=le(o),{webserver:u,monitor:d,waf:c,isMonitorInstall:p,isWafInstall:v}=le(s),{t:y}=te(),{openBackupModal:h,openSiteConfig:g,openDeleteSiteConfig:x}=st(),{setSiteStatus:w}=Ge(),k=$([{type:"selection",width:40,minWidth:40,maxWidth:40},{key:"name",title:y("Site.PHP.index_17"),minWidth:160,sorter:!0,sortOrder:!1,render:e=>X(_t,{ico:e.ico,name:e.name,description:e.ps,onClickName:()=>{g(e)},onBlur:async t=>{await Ue({id:e.id,ps:t}),e.ps=t}},null)},{key:"status",title:y("Public.Table.Status"),align:"center",className:"sort-center",width:90,minWidth:90,maxWidth:90,sorter:!0,sortOrder:!1,render:e=>X(yt,{status:e.status,onUpdateValue:t=>{w(t,e)}},null)},{key:"backup_count",title:y("Site.PHP.index_19"),width:"10%",minWidth:110,render:e=>X(ht,{count:e.backup_count,lastTime:e.last_backup_time,onShowBackup:()=>{h(e)}},null)},{key:"path",title:"Quick action",align:"center",width:"8%",minWidth:100,render:e=>X(kt,{path:e.path,phpVersion:e.php_version,onShowPhp:()=>{g(e,{menu:"php"})}},null)},Pe({type:"site",minWidth:70,callback:()=>{n("fetchTable")}}),{key:"edate",title:"Expiration",align:"center",width:"8%",minWidth:80,render:e=>X(bt,{value:e.edate,onUpdateValue:async t=>{await Oe({id:e.id,edate:t}),e.edate=t}},null)},{key:"site_ssl",title:y("Site.PHP.index_27"),align:"center",width:100,minWidth:100,maxWidth:100,sorter:!0,sortOrder:!1,className:"sort-center",render:e=>{const t=A.value.filter(t=>t.target_id===e.id);return X(jt,{config:e.ssl,sslApplyList:t,onClick:()=>{g(e,{menu:"ssl"})}},null)}},{key:"requests",title:"Requests",align:"center",width:"12%",minWidth:120,render:e=>{if("nginx"!==u.value&&"apache"!==u.value)return"--";if(r.value)return X(b,{type:"primary",text:!0,onClick:()=>{je({source:142})}},{default:()=>[ue("Active")]});if(!p.value)return X(b,{type:"primary",text:!0,onClick:()=>{Ke("monitor",async()=>{await s.getConfig(),n("fetchTable"),j()})}},{default:()=>[1===d.value.is_install?y("Public.Btn.Update"):y("Public.Btn.Install")]});const t=P.value[e.name];if(!R(t)){const a=C(t),l=H(t);return X(Lt,{name:e.name,total:a,value:l},null)}return"--"}},{key:"waf",title:"WAF",align:"center",width:"10%",minWidth:100,render:e=>{if("nginx"!==u.value)return"--";if(r.value)return X(b,{type:"primary",text:!0,onClick:()=>{je({source:216})}},{default:()=>[ue("Active")]});if(!v.value)return X(b,{type:"primary",text:!0,onClick:()=>{Ke("btwaf",async()=>{await s.getConfig(),n("fetchTable"),L()})}},{default:()=>[1===c.value.is_install?y("Public.Btn.Update"):y("Public.Btn.Install")]});const t=B.value.find(t=>t.siteName===e.name);if(i(t)){const a=T(t);return X(Rt,{siteName:e.name,total:a,status:t.open,onUpdateStatus:async a=>{await Qe({siteName:e.name,obj:"open"}),t.open=a}},null)}return"--"}},{key:"operate",title:y("Public.Table.Operation"),align:"right",width:110,minWidth:110,maxWidth:110,render:e=>X(Ot,{onClickConfig:()=>{g(e)},onClickLog:()=>{g(e,{menu:"logs"})},onClickOperate:t=>{switch(t){case"scan":g(e,{menu:"logs",subMenu:"security"});break;case"delete":x([e])}}},null)}]),S=e=>{k.value.forEach(t=>{const a=t;a.key===e.columnKey?a.sortOrder=e.order:a.sortOrder=!1});const t=e.order?"".concat(e.columnKey," ").concat("descend"===e.order?"desc":"asc"):"";n("update:sorter",t)},P=_e({}),C=e=>e.total?e.total.request:0,H=e=>e.list.map(e=>({date:e.date,value:e.request})),j=async()=>{if(r.value)return;if(!p.value)return;const{message:e}=await Fe((()=>{const e=new Date,t=Je(e,-30);return{start_date:f(t,"yyyy-MM-dd"),end_date:f(e,"yyyy-MM-dd")}})());i(e)&&(P.value=e)},B=$([]),T=e=>e.total.reduce((e,t)=>e+t.value,0),L=async()=>{if(r.value)return;if(!v.value)return;const{message:e}=await ze({p:1,limit:1e3,search:""});i(e)&&(B.value=_(e.data)?e.data.map(e=>({open:e.open,total:e.total,siteName:e.siteName})):[])};let V=null;const D=$(!1),A=$([]),U=async()=>{V&&clearTimeout(V);const{message:e}=await He();_(e)&&(A.value=e,e.length>0?(D.value=!0,V=window.setTimeout(()=>{U()},3e3)):(D.value&&n("fetchTable"),V&&clearTimeout(V)))};return(()=>{const t=e("site-php-order","");if(t){const[e,a]=t.split(" "),l=k.value.find(t=>t.key===e);l&&(l.sortOrder="asc"===a?"ascend":"descend")}})(),a({getMonitorData:j,getNginxWafConfig:L,getSSLApplyList:U,getColumns:()=>k.value,setColumns:e=>{k.value=e}}),(e,t)=>{const a=Ce;return z(),F(a,fe(e.$attrs,{columns:Q(k),"onUpdate:sorter":S}),null,16,["columns"])}}}),Wt={class:"p-20px"},Nt={class:"flex-1"},Et={class:"mt-12px"},It={class:"px-20px pt-24px pb-8px"},$t={class:"w-150px"},qt=E({__name:"set",props:{data:{}},setup(e){const{t:t}=te(),a=e,{setOptions:l}=a.data,n=$(""),i=async()=>{const e=n.value.trim();""!==e?(await Ne({name:e}),n.value="",await m(),null==l||l(c.data)):v.error(t("Site.PHP.index_46"))},s=Be(),o=$(null),r=ve({id:-1,name:""}),u={name:{required:!0,message:t("Site.PHP.index_46"),trigger:["blur","change"]}},d=async({hide:e})=>{var t;await(null==(t=o.value)?void 0:t.validate()),await Ee(ye(r)),await m(),null==l||l(c.data),e()},{table:c,columns:p}=Te([{key:"name",title:"Name"},Le({width:120,options:e=>[{label:t("Public.Btn.Edit"),disabled:0===e.id,onClick:()=>{(e=>{r.id=e.id,r.name=e.name,s.title="".concat(t("Site.PHP.index_48")," [").concat(e.name,"]"),s.show=!0})(e)}},{label:t("Public.Btn.Delete"),disabled:0===e.id,onClick:()=>{Ve({title:"".concat(t("Site.PHP.index_49")," [").concat(e.name,"]"),content:t("Site.PHP.index_50"),onConfirm:async({hide:t})=>{await Me({id:e.id}),await m(),null==l||l(c.data,e.id),t()}})}}]})]),m=async()=>{const{message:e}=await We();c.data=_(e)?e:[]};return m(),(e,t)=>{const a=U,l=b,m=V,_=O,f=M,v=lt,y=at;return z(),ne("div",Wt,[X(m,null,{default:G(()=>[Y("div",Nt,[X(a,{value:Q(n),"onUpdate:value":t[0]||(t[0]=e=>pe(n)?n.value=e:null),placeholder:e.$t("Site.PHP.index_46")},null,8,["value","placeholder"])]),Y("div",null,[X(l,{type:"primary",onClick:i},{default:G(()=>[ue(se(e.$t("Site.Cert.index_62")),1)]),_:1})])]),_:1}),Y("div",Et,[X(_,{"max-height":300,data:Q(c).data,columns:Q(p)},null,8,["data","columns"])]),X(y,{show:Q(s).show,"onUpdate:show":t[2]||(t[2]=e=>Q(s).show=e),title:Q(s).title,width:350,footer:!0,onConfirm:d},{default:G(()=>[Y("div",It,[X(v,{ref_key:"formRef",ref:o,model:Q(r),rules:u},{default:G(()=>[X(f,{label:e.$t("Site.PHP.index_47"),path:"name"},{default:G(()=>[Y("div",$t,[X(a,{value:Q(r).name,"onUpdate:value":t[1]||(t[1]=e=>Q(r).name=e),placeholder:""},null,8,["value"])])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["show","title"])])}}}),Kt={class:"w-160px"},Ft=E({__name:"index",props:{value:{default:null}},emits:["change","update:value"],setup(e,{emit:t}){const a=t,l=he(e,"value"),{t:n}=te(),{loading:i,setLoading:s}=De(),o=$([]),r=async e=>{a("change"),a("update:value",e),sessionStorage.setItem("typeValue",e)},u=Be(n("Site.PHP.index_44"),{setOptions:(e,t)=>{t===l.value&&(l.value=-1),o.value=e.map(e=>({label:e.name,value:e.id})),c()}}),d=()=>{u.show=!0},c=()=>{o.value.unshift({label:n("Site.PHP.index_45"),value:-1})};return c(),q(()=>{(async()=>{try{s(!0);const{message:e}=await We();_(e)?o.value=e.map(e=>({label:e.name,value:e.id})):o.value=[],c()}finally{s(!1);const e=sessionStorage.getItem("typeValue");l.value=e?Number(e):-1}})()}),(e,t)=>{const a=b,n=W,s=at;return z(),ne("div",Kt,[X(n,{value:Q(l),"onUpdate:value":t[0]||(t[0]=e=>pe(l)?l.value=e:null),loading:Q(i),options:Q(o),onUpdateValue:r},{action:G(()=>[X(a,{block:"",onClick:d},{default:G(()=>[ue(se(e.$t("Site.PHP.index_43")),1)]),_:1})]),_:1},8,["value","loading","options"]),X(s,{show:Q(u).show,"onUpdate:show":t[1]||(t[1]=e=>Q(u).show=e),width:350,title:Q(u).title,data:Q(u).data,component:qt},null,8,["show","title","data"])])}}}),zt=E({__name:"index",setup(a){const l=it(),n=m(),{web:i,webserver:o}=le(l),{t:r}=te(),{openAddSiteModal:u,openSiteAdvancedModal:d,openDeleteSiteConfig:c}=st(),{tableConfig:p,tableData:_,pageConfig:f,tableParams:v,fetchTable:k,resetTable:P,setLoading:C}=Ae({params:{p:1,limit:10,table:"sites",search:"",order:e("site-php-order",""),type:-1},immediate:!1,fetchFn:qe}),H=ce("siteTableRef");xe("tableRef",H);const j=$(!1),B=$([]),T=[{label:r("Site.PHP.index_5"),key:"default-page"},{label:r("Site.PHP.index_6"),key:"default-site"},{label:r("Site.PHP.index_7"),key:"php-version"},{label:r("Site.PHP.index_86"),key:"https"}],V=[{key:"enable",type:"confirm",label:r("Site.Batch.index_1"),confirm:{title:r("Site.Batch.index_2"),desc:r("Site.Batch.index_3"),columns:[{key:"name",title:r("Site.PHP.index_17")}],api:e=>Ie(!0,{id:e.id,name:e.name},!1),done:()=>{k(!1)}}},{key:"disable",type:"confirm",label:r("Site.Batch.index_4"),confirm:{title:r("Site.Batch.index_5"),desc:r("Site.Batch.index_6"),columns:[{key:"name",title:r("Site.PHP.index_17")}],api:e=>Ie(!1,{id:e.id,name:e.name},!1),done:()=>{k(!1)}}},{key:"backup",type:"confirm",label:r("Site.Batch.index_7"),confirm:{title:r("Site.Batch.index_8"),desc:r("Site.Batch.index_9"),columns:[{key:"name",title:r("Site.PHP.index_17")}],api:e=>$e({id:e.id},!1),done:()=>{k(!1)}}},{key:"expired",label:r("Site.PHP.index_70"),onBatch:e=>{Se({title:r("Site.PHP.index_71"),width:380,minHeight:72,footer:!0,data:{rows:e},component:ae(()=>s(()=>import("./expired.js?v=1756367574781"),__vite__mapDeps([68,11,2,3,4,5,7,6,9,8,17,64,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37])))})}},{key:"php",label:r("Site.PHP.index_66"),onBatch:e=>{Se({title:r("Site.PHP.index_65"),width:500,minHeight:198,footer:!0,data:{rows:e},component:ae(()=>s(()=>import("./php2.js?v=1756367574781"),__vite__mapDeps([69,7,6,2,3,4,5,9,8,11,17,64,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37])))})}},{key:"category",label:r("Crontab.Planned.index_19"),onBatch:e=>{Se({title:r("Site.Batch.index_22"),width:350,minHeight:72,footer:!0,data:{rows:e},component:ae(()=>s(()=>import("./category.js?v=1756367574781"),__vite__mapDeps([70,11,2,3,4,5,6,7,8,9,17,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37])))})}},{key:"delete",label:r("Site.Batch.index_10"),onBatch:e=>{c(e)}}],D=()=>{u()},A=e=>{v.value.order=e,t("site-php-order",e),k()},R=e=>{d(e)},U=async()=>{var e,t,a;await P(),null==(e=H.value)||e.getNginxWafConfig(),null==(t=H.value)||t.getMonitorData(),null==(a=H.value)||a.getSSLApplyList(),B.value=[]},O=async(e=!1)=>{var t,a,l;await k(e,!0),null==(t=H.value)||t.getSSLApplyList(),null==(a=H.value)||a.getNginxWafConfig(),null==(l=H.value)||l.getMonitorData(),B.value=[]},M=async()=>{try{C(!0),await l.getConfig(),j.value=i.value.setup,i.value.setup&&await O()}finally{C(!1)}};return K(()=>l.isRefresh,e=>{e&&(l.setRefresh(!1),O())}),K(()=>n.taskCount,()=>{M()}),C(!0),q(async()=>{M()}),(e,t)=>{const a=y,l=b,n=S,s=L,r=ke,u=we,c=nt,m=w,P=x,C=g,M=h,W=N;return z(),F(W,null,{default:G(()=>[X(M,{install:Q(i).setup},{desc:G(()=>[Y("span",null,se(e.$t("Site.PHP.index_1")),1),X(a,{class:"ml-4px",onClick:t[0]||(t[0]=e=>Q(Re)("nginx"))},{default:G(()=>[ue(se(e.$t("Site.PHP.index_2")),1)]),_:1}),t[7]||(t[7]=Y("span",{class:"mx-4px"},"|",-1)),X(a,{onClick:t[1]||(t[1]=e=>Q(Re)("apache"))},{default:G(()=>[ue(se(e.$t("Site.PHP.index_3")),1)]),_:1})]),default:G(()=>[X(C,{class:"p-16px",feedback:!0},{toolsLeft:G(()=>[X(l,{type:"primary",class:"add-site-btn",onClick:D},{default:G(()=>[ue(se(e.$t("Site.PHP.index_4")),1)]),_:1}),X(s,null,{default:G(()=>[X(l,{onClick:t[2]||(t[2]=e=>Q(d)())},{default:G(()=>[ue(se(e.$t("Database.Mysql.index_3")),1)]),_:1}),X(n,{trigger:"hover",options:T,onSelect:R},{default:G(()=>[X(l,null,{default:G(()=>t[8]||(t[8]=[Y("i",{class:"i-fa:angle-down"},null,-1)])),_:1,__:[8]})]),_:1})]),_:1}),Q(j)?(z(),F(r,{key:0,"soft-name":Q(o)},null,8,["soft-name"])):ge("",!0)]),toolsRight:G(()=>[X(Ft,{value:Q(v).type,"onUpdate:value":t[3]||(t[3]=e=>Q(v).type=e),onChange:U},null,8,["value"]),X(u,{value:Q(v).search,"onUpdate:value":t[4]||(t[4]=e=>Q(v).search=e),placeholder:e.$t("Site.PHP.index_8"),onSearch:U},null,8,["value","placeholder"]),X(c,{"store-key":"site-php-columns",loading:Q(p).loading,"hide-keys":["quota"],"disabled-keys":["name"]},null,8,["loading"])]),table:G(()=>[X(Mt,fe({ref_key:"siteTableRef",ref:H,"checked-row-keys":Q(B),"onUpdate:checkedRowKeys":t[5]||(t[5]=e=>pe(B)?B.value=e:null)},Q(p),{onFetchTable:Q(k),"onUpdate:sorter":A}),null,16,["checked-row-keys","onFetchTable"])]),pageLeft:G(()=>[X(m,{"checked-row-keys":Q(B),"onUpdate:checkedRowKeys":t[6]||(t[6]=e=>pe(B)?B.value=e:null),data:Q(_),options:V},null,8,["checked-row-keys","data"])]),pageRight:G(()=>[X(P,fe(Q(f),{"store-key":"site-php-page",onRefresh:O}),null,16)]),_:1})]),_:1},8,["install"])]),_:1})}}}),Qt=Object.freeze(Object.defineProperty({__proto__:null,default:zt},Symbol.toStringTag,{value:"Module"}));export{Qt as i,it as u};
