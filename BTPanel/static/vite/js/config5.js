import{_ as e}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1744703330658";import{d as t,J as a}from"./page_layout.js?v=1744703330658";import{b as l,f as i,u as n}from"./public.js?v=1744703330658";import{k as s,l as r,n as c,g as o}from"./setting.js?v=1744703330658";import{_ as u}from"./index95.js?v=1744703330658";import{_ as f}from"./index.vue_vue_type_script_setup_true_lang.js?v=1744703330658";import{d as p,O as d,r as m,j as _,R as y,S as g,P as v,a0 as b,U as x,V as w,a1 as h,M as S,c as j}from"./vue.js?v=1744703330658";import{_ as q,ch as W,bY as E,T as k}from"./naive.js?v=1744703330658";import"./common.js?v=1744703330658";import"./__commonjsHelpers__.js?v=1744703330658";const U={class:"p-20px"},$={class:"w-220px"},P={class:"ml-8px text-desc"},R={class:"w-220px mr-8px"},B={class:"text-desc"},C={class:"w-220px mr-8px"},L={class:"text-desc"},O=p({__name:"form",props:{isEdit:{type:Boolean,default:!1},row:{}},emits:["refresh"],setup(e,{expose:t,emit:a}){const l=e,i=a,{t:n}=d(),c=m(null),o=_({url:"",frequency:30,cycle:60}),p={url:{trigger:["blur","input"],validator:()=>""!==o.url.trim()||new Error(n("Waf.Setting.config_55"))},frequency:{trigger:["blur","input"],validator:()=>!!o.frequency||new Error(n("Waf.Setting.config_56"))},cycle:{trigger:["blur","input"],validator:()=>!!o.cycle||new Error(n("Waf.Setting.config_57"))}};return(()=>{const{row:e,isEdit:t}=l;t&&e&&(o.url=e.url,o.frequency=e.frequency,o.cycle=e.cycle)})(),t({onConfirm:async()=>{var e;await(null==(e=c.value)?void 0:e.validate()),l.isEdit?await s(S(o)):await r(S(o)),i("refresh")}}),(e,t)=>{const a=q,l=W,i=E,n=f,s=u;return y(),g("div",U,[v(n,{ref_key:"formRef",ref:c,model:w(o),rules:p},{default:b((()=>[v(l,{label:"URL",path:"url"},{default:b((()=>[x("div",$,[v(a,{value:w(o).url,"onUpdate:value":t[0]||(t[0]=e=>w(o).url=e),placeholder:"/index.php"},null,8,["value"])]),x("span",P,h(e.$t("Waf.Setting.config_51")),1)])),_:1}),v(l,{label:e.$t("Waf.Setting.config_48"),path:"frequency"},{default:b((()=>[x("div",R,[v(i,{value:w(o).frequency,"onUpdate:value":t[1]||(t[1]=e=>w(o).frequency=e),min:1,"show-button":!1},null,8,["value"])]),x("span",B,h(e.$t("Public.Unit.Time",w(o).frequency)),1)])),_:1},8,["label"]),v(l,{label:e.$t("Waf.Setting.config_49"),path:"cycle"},{default:b((()=>[x("div",C,[v(i,{value:w(o).cycle,"onUpdate:value":t[2]||(t[2]=e=>w(o).cycle=e),min:1,"show-button":!1},null,8,["value"])]),x("span",L,h(e.$t("Public.Unit.Second",w(o).cycle)),1)])),_:1},8,["label"])])),_:1},8,["model"]),v(s,{class:"mt-12px"},{default:b((()=>[x("li",null,h(e.$t("Waf.Setting.config_54")),1)])),_:1})])}}}),T={class:"p-20px"},A={class:"flex mb-16px"},D=p({__name:"config",setup(s){const{t:r}=d(),u=e=>{n({title:e.title,width:570,footer:!0,data:{...e.data,onRefresh:()=>{S()}},component:O})},f=async()=>{u({title:r("Waf.Setting.config_46"),data:{isEdit:!1}})},{table:p,columns:m,setLoading:_}=l([{key:"url",title:"URL",ellipsis:{tooltip:!0}},{key:"frequency",title:r("Waf.Setting.config_48"),width:100,ellipsis:{tooltip:!0}},{key:"cycle",title:r("Waf.Setting.config_49"),width:120,ellipsis:{tooltip:!0},render:e=>r("Waf.Setting.config_50",[e.cycle])},i({width:100,options:e=>[{label:r("Public.Btn.Edit"),onClick:async()=>{(async e=>{u({title:r("Waf.Setting.config_47"),data:{row:e,isEdit:!0}})})(e)}},{label:r("Public.Btn.Del"),onClick:async()=>{await c({url:e.url}),S()}}]})]),S=async()=>{try{_(!0);const{message:e}=await o();t(e)&&(p.data=Object.entries(e.cc_uri_frequency).map((([e,t])=>({url:e,frequency:a(t.frequency),cycle:a(t.cycle)}))))}finally{_(!1)}};return S(),(t,a)=>{const l=k,i=e;return y(),g("div",T,[x("div",A,[v(l,{type:"primary",onClick:f},{default:b((()=>[j(h(t.$t("Public.Btn.Add")),1)])),_:1})]),v(i,{"max-height":368,loading:w(p).loading,data:w(p).data,columns:w(m)},null,8,["loading","data","columns"])])}}});export{D as default};
