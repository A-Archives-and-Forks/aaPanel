System.register(["./page_layout-legacy.js?v=1753954525509","./public-legacy.js?v=1753954525509","./vue-legacy.js?v=1753954525509","./naive-legacy.js?v=1753954525509","./index.vue_vue_type_script_setup_true_lang-legacy15.js?v=1753954525509","./index-legacy.js?v=1753954525509","./echartsGl-legacy.js?v=1753954525509","./common-legacy.js?v=1753954525509","./interface-legacy.js?v=1753954525509","./echarts-legacy.js?v=1753954525509","./tools-legacy2.js?v=1753954525509","./__commonjsHelpers__-legacy.js?v=1753954525509","./rules-legacy.js?v=1753954525509"],(function(e,t){"use strict";var a,l,i,o,s,n,r,c,d,u,p,f,v,m,x,h,y,g,b,_,w,k,S,O,W,$,C,j,L,D,z,E,T,q,A,M,I,R,U,N,G,P,H,B,F,V,X,Q,J,Y,Z,K,ee,te,ae,le,ie,oe,se,ne,re,ce,de,ue,pe,fe,ve,me,xe,he;return{setters:[e=>{a=e.e,l=e.cT,i=e.p,o=e.aZ,s=e.X,n=e.T,r=e.cU,c=e.w,d=e.O,u=e.k,p=e.a,f=e.cV,v=e.o,m=e.cW,x=e.c,h=e.j,y=e.cX,g=e.s,b=e.c8},e=>{_=e.l,w=e.e,k=e.b,S=e.f,O=e.d},e=>{W=e.U,$=e.a1,C=e.a2,j=e.q,L=e.k,D=e.aj,z=e.e,E=e.W,T=e.a3,q=e.X,A=e.Q,M=e.r,I=e.P,R=e.ac,U=e.y,N=e.V,G=e.F,P=e.O,H=e.j,B=e.ah,F=e.$,V=e.aD,X=e.al,Q=e.H,J=e._,Y=e.w,Z=e.n,K=e.av,ee=e.o,te=e.b},e=>{ae=e.cD,le=e.bA,ie=e.c3,oe=e.cJ,se=e.cE,ne=e.D,re=e.c5,ce=e.cP},e=>{de=e._},e=>{ue=e._},e=>{pe=e.i,fe=e.a,ve=e.b},e=>{me=e.a0},null,e=>{xe=e.a4},e=>{he=e.a},null,null],execute:function(){var ye=document.createElement("style");ye.textContent='.wap-card[data-v-2f1d0213]{--n-border-radius: 6px;--n-title-font-size: 14px;border:1px #f7f7f7 solid;box-shadow:0 1px 3px 1px rgba(0,0,0,.05)}.wap-card[data-v-2f1d0213] .n-card-header{height:50px;padding:0 16px}.refresh-progress[data-v-8898e53f]{width:28px;cursor:pointer}.bt-radio[data-v-f8a2b372] .n-radio-button:last-child{border-right:none;border-top-right-radius:0;border-bottom-right-radius:0}.bt-date-picker[data-v-f8a2b372] .n-input{border-top-left-radius:0;border-bottom-left-radius:0}.count-item[data-v-c6ff642a]{color:#888}.count-item+.count-item[data-v-c6ff642a]{padding-top:20px;margin-top:20px;border-top:1px solid #dcdcdc}.count-item .count-tit[data-v-c6ff642a]{margin-bottom:12px;font-size:14px}.count-item .count-val[data-v-c6ff642a]{display:flex;align-items:baseline;padding-left:12px}.count-item .count-num[data-v-c6ff642a]{font-size:22px;font-weight:700;cursor:pointer}.district-legend[data-v-9406e065]{position:absolute;left:4%;bottom:4%;display:flex;align-items:center;color:#7b7d98}.district-legend .item[data-v-9406e065]{width:15px;height:4px}.district-legend .item+.item[data-v-9406e065]{margin-left:6px}.district-legend .item[data-v-9406e065]:nth-of-type(1){background-color:rgba(62,183,82,.125)}.district-legend .item[data-v-9406e065]:nth-of-type(2){background-color:rgba(62,183,82,.5)}.district-legend .item[data-v-9406e065]:nth-of-type(3){background-color:#3eb752}.attack-map{width:100%;height:100%}.attack-map>div:first-child:before{content:"";background:radial-gradient(closest-side,#fff,#f7f8fa);border-radius:100%;width:464px;height:464px;display:inline-block;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2;border:26px solid #fff}.attack-map>div:first-child:after{content:"";background:radial-gradient(closest-side,#fff,#fff);border-radius:100%;display:inline-block;width:524px;height:524px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1;border:10px solid rgb(247 248 250)}.attack-map canvas{z-index:4}\n',document.head.appendChild(ye);const ge=a({},[["render",function(e,t){const a=ae;return W(),$(a,{class:"wap-card"},{header:C((()=>[j(e.$slots,"header",{},void 0,!0)])),default:C((()=>[j(e.$slots,"default",{},void 0,!0)])),_:3})}],["__scopeId","data-v-2f1d0213"]]),be={class:"flex items-center h-184px text-#888"},_e={class:"flex-1 flex-center flex-col"},we={class:"flex items-center mb-16px"},ke={class:"ml-8px text-14px"},Se={class:"text-22px font-bold"},Oe={class:"flex-1 flex-center flex-col"},We={class:"flex items-center mb-16px"},$e={class:"ml-8px text-14px"},Ce=L({__name:"index",setup(e){const t=l(),a=D(),o=z({request:0,malicious:0}),s=()=>{a.push("/waf/block")};return t.onReady("total",(e=>{o.request=e.count.today_request,o.malicious=e.count.malicious_request})),(e,t)=>{const a=i;return W(),$(ge,null,{default:C((()=>[E("div",be,[E("div",_e,[E("div",we,[t[0]||(t[0]=E("img",{class:"icon",src:"/static/vite/images/today.svg"},null,-1)),E("span",ke,T(e.$t("Waf.Overview.index_1")),1)]),E("div",Se,T(q(o).request),1)]),A(a,{class:"text-106px",vertical:""}),E("div",Oe,[E("div",We,[t[1]||(t[1]=E("img",{class:"icon",src:"/static/vite/images/malicious.svg"},null,-1)),E("span",$e,T(e.$t("Waf.Overview.index_2")),1)]),E("div",{class:"text-22px font-bold cursor-pointer",onClick:s},T(q(o).malicious),1)])])])),_:1})}}}),je={class:"text-desc text-12px leading-1"},Le=L({__name:"auto-refresh",props:{open:{type:Boolean,default:!0},seconds:{default:3},refresh:{}},setup(e){const t=e,a=t.seconds,l=M(0),i=M(a),o=M(!1),{loop:s}=_((async()=>{if(0===i.value)try{o.value=!0,await(t.refresh?.())}finally{l.value=0,i.value=a,o.value=!1}else i.value-=1,l.value=(a-i.value)/a*100}),1);return s(),(e,t)=>{const s=le,n=ie;return W(),$(n,{placement:"bottom"},{trigger:C((()=>[A(s,{class:"refresh-progress",type:"circle",status:"success",processing:q(o),"rail-color":"#e8e8e8","stroke-width":12,"offset-degree":180,percentage:q(l)},{default:C((()=>[E("span",je,T(q(i)),1)])),_:1},8,["processing","percentage"])])),default:C((()=>[E("span",null,T(e.$t("Waf.Overview.index_8",[q(a)])),1)])),_:1})}}}),De=a(Le,[["__scopeId","data-v-8898e53f"]]),ze={class:"flex"},Ee=a(L({__name:"query-date",props:{value:{default:"today"},valueModifiers:{}},emits:["update:value"],setup(e){const{t:t}=I(),a=M("today"),l=M(null),i=R(e,"value"),r=[{label:t("Public.Search.Yesterday"),value:"yesterday"},{label:t("Public.Search.Today"),value:"today"}],c=e=>{l.value=null,i.value=e},d=e=>{a.value=e?"":"today",i.value=o(e)?s(e,"yyyy-MM-dd"):"today"};return U((()=>{r.map((e=>e.value)).includes(i.value)?(a.value=i.value,l.value=null):(a.value="",l.value=new Date(i.value).getTime())})),(e,t)=>{const i=oe,o=se,s=n;return W(),N("div",ze,[A(o,{value:q(a),"onUpdate:value":[t[0]||(t[0]=e=>B(a)?a.value=e:null),c],size:"small",class:"bt-radio"},{default:C((()=>[(W(),N(G,null,P(r,(e=>A(i,{key:e.value,value:e.value},{default:C((()=>[H(T(e.label),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"]),A(s,{value:q(l),"onUpdate:value":[t[1]||(t[1]=e=>B(l)?l.value=e:null),d],type:"date",size:"small",class:"bt-date-picker",clearable:!0},null,8,["value"])])}}}),[["__scopeId","data-v-f8a2b372"]]),Te={class:"flex justify-between flex-1"},qe={class:"flex items-center"},Ae={class:"mr-10px"},Me={class:"flex-center h-134px p-10px"},Ie=L({__name:"index",setup(e){const{t:t}=I(),a=l(),{loading:i,startTime:o}=F(a),n=M(!0),u=()=>{a.getInfo()},p=async()=>{await a.getNewInfo()},f=(e=[])=>({type:"category",boundaryGap:!1,data:e,axisLabel:{color:"#666"},nameTextStyle:{color:"#666"},axisLine:{show:!0,lineStyle:{color:"#666"}},axisTick:{show:!0,lineStyle:{color:"#666"}}}),v=(e=[],a=[])=>[{name:t("Waf.Overview.index_4"),type:"line",data:e,symbol:"none",sampling:"average",smooth:!0,showSymbol:!1,itemStyle:{color:"#A0BFE0"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(242, 242, 242, 0.6)"},{offset:.8,color:"rgba(242, 242, 242, 0)"}]}}},{name:t("Waf.Overview.index_5"),type:"line",data:a,sampling:"average",smooth:!0,symbol:"none",showSymbol:!1,itemStyle:{color:"#20a53a"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(32, 164, 58, 0.6)"},{offset:1,color:"rgba(32, 164, 58, 0)"}]}}}],m=V({grid:{left:"5%",right:"4%",bottom:"3%",top:"20%",containLabel:!0},legend:{icon:"circle",data:[t("Waf.Overview.index_5"),t("Waf.Overview.index_4")],top:"-2%",itemWidth:10,itemHeight:10,itemGap:16,textStyle:{lineHeight:12,padding:[0,0,-2,0],rich:{a:{verticalAlign:"middle"}}}},tooltip:{trigger:"axis",formatter(e){let a="";const l=Object.entries(e);return l.forEach((([,e],i)=>{0===i&&(a+=`${t("Waf.Overview.index_6",[s(r(o.value),"yyyy-MM-dd"),e.name])}<br />`),a+=`<span style="display: inline-block; width: 10px; height: 10px; margin-right:10px; border-radius: 50%;background: ${e.color};"></span>${e.seriesName}: ${e.value}<br />`,i===l.length-1&&(a+=`<div style="padding-left: 20px;">${t("Waf.Overview.index_7_1",[e.data.err_499])}<br />${t("Waf.Overview.index_7_2",[e.data.err_502])}</div>`)})),a}},xAxis:f(),yAxis:{type:"value",nameGap:8,splitNumber:4,splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:"#ebeef5"}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#666"},nameTextStyle:{color:"#666"}},series:v()});return a.onReady("flow",(e=>{c(e.traffic_filter)&&e.traffic_filter.length>0?(n.value=!1,(e=>{const t=[],a=[],l=[];e.forEach((e=>{const i=e.hour<10?"0"+e.hour:e.hour,o=e.minute<10?"0"+e.minute:e.minute;t.push(`${i}:${o}`),a.push(e.proxy_count),l.push({value:e.request,err_499:e.err_499,err_502:e.err_502})})),m.xAxis=f(t),m.series=v(a,l)})(e.traffic_filter)):n.value=!0})),(e,t)=>{const a=ne,l=d;return W(),$(ge,null,{header:C((()=>[E("div",Te,[E("div",qe,[E("div",Ae,T(e.$t("Waf.Overview.index_3")),1),A(Ee,{value:q(o),"onUpdate:value":[t[0]||(t[0]=e=>B(o)?o.value=e:null),u]},null,8,["value"])]),A(De,{refresh:p})])])),default:C((()=>[A(l,{show:q(i)},{default:C((()=>[E("div",Me,[q(n)?(W(),$(a,{key:0})):(W(),$(de,{key:1,type:"line",height:"100%",option:q(m)},null,8,["option"]))])])),_:1},8,["show"])])),_:1})}}}),Re={class:"h-134px p-10px"},Ue=L({__name:"index",setup(e){const{t:t}=I(),a=l(),i=M(0),o=(e=[])=>({type:"category",boundaryGap:!1,data:e,axisLabel:{color:"#666",formatter:e=>s(u(e),"hh:mm:ss")},nameTextStyle:{color:"#666"},axisLine:{show:!0,lineStyle:{color:"#666"}},axisTick:{show:!0,lineStyle:{color:"#666"}}}),n=(e=[])=>[{name:"QPS",type:"line",stack:"Total",data:e,itemStyle:{color:"#20a53a"},smooth:!0,showSymbol:!1,sampling:"average",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(32, 164, 58, 0.4)"},{offset:.7,color:"rgba(32, 164, 58, 0)"}]}}}],r=V({grid:{left:"5%",right:"10%",bottom:"3%",top:"20%",containLabel:!0},tooltip:{trigger:"axis",formatter(e){let a="";return Object.entries(e).forEach((([,e],l)=>{0===l&&(a+=`${t("Waf.Overview.index_22",[s(e.axisValue)])}<br>`),a+=`<span style="display: inline-block; width: 10px; height: 10px; margin-right:10px; border-radius: 50%;background: ${e.color};"></span>${e.seriesName}: ${e.value}`})),a}},xAxis:o(),yAxis:{type:"value",nameGap:8,splitNumber:4,splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:"#ebeef5"}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#666"},nameTextStyle:{color:"#666"}},series:n()}),c=[],d=[],p=()=>{var e;c.length>0&&(e=c[0],(new Date).getTime()-e>6e4)&&(c.shift(),d.shift()),r.xAxis=o(c),r.series=n(d)};return a.onReady("qps",(e=>{i.value=e.qps,c.push(Date.now()),d.push(e.qps),p()})),(e,t)=>(W(),$(ge,null,{header:C((()=>[E("span",null,T(e.$t("Waf.Overview.index_21",[q(i)])),1)])),default:C((()=>[E("div",Re,[A(de,{type:"line",height:"100%",option:q(r)},null,8,["option"])])])),_:1}))}}),Ne={class:"flex-center h-292px p-10px"},Ge=L({__name:"index",setup(e){const{t:t}=I(),a=l(),i=M(!1),o=V({backgroundColor:"#fff",title:s(),tooltip:{trigger:"item",confine:!0,formatter(e){const t=e;return`${t.marker} ${t.name}: ${t.value} (${t.percent}%)`}},series:r()});function s(e=0){return{text:t("Waf.Overview.index_32"),textStyle:{color:"#484848",fontSize:17},subtext:`${e}`,subtextStyle:{color:"#717171",fontSize:15},itemGap:20,left:"center",top:"42%"}}const n=["#6ec71e","#4885FF","#fc8b40","#818af8","#31c9d7","#f35e7a","#ab7aee","#14d68b","#cde5ff"];function r(e=[]){return[{type:"pie",data:e,radius:["45%","55%"],center:["50%","50%"],clockwise:!0,avoidLabelOverlap:!0,label:{show:!0,position:"outside",color:"#999",lineHeight:18,formatter:e=>""!==e.name?0===e.percent?"":t("Waf.Overview.index_33",[e.name,e.value,e.percent]):""},labelLine:{length:30,length2:30,lineStyle:{width:1,color:"#CDCDCD"}},itemStyle:{labelLine:{length:30,length2:30,lineStyle:{width:1,color:"#CDCDCD"}},color:e=>n[e.dataIndex]},emphasis:{scaleSize:15}}]}return a.onReady("block",(e=>{i.value=0===e.type.length,(e=>{let t=0;const a=[];e.forEach((e=>{t+=e[1],a.push({name:e[0],value:e[1]})})),o.title=s(t),o.series=r(a)})(e.type)})),(e,t)=>{const a=ne;return W(),$(ge,{class:"mb-16px"},{header:C((()=>[E("span",null,T(e.$t("Waf.Overview.index_31")),1)])),default:C((()=>[E("div",Ne,[q(i)?(W(),$(a,{key:0})):(W(),$(de,{key:1,type:"pie",height:"100%",option:q(o)},null,8,["option"]))])])),_:1})}}}),Pe={class:"flex flex-col justify-center h-306px p-20px"},He={class:"count-item"},Be={class:"count-tit"},Fe={class:"count-val"},Ve={class:"count-item"},Xe={class:"count-tit"},Qe={class:"count-val"},Je={class:"count-item"},Ye={class:"count-tit"},Ze={class:"count-val"},Ke=a(L({__name:"index",setup(e){const a=J((()=>p((()=>t.import("./shell-legacy.js?v=1753954525509")),void 0))),i=J((()=>p((()=>t.import("./site-legacy2.js?v=1753954525509")),void 0))),o=J((()=>p((()=>t.import("./cc-legacy.js?v=1753954525509")),void 0))),{t:s}=I(),n=l(),r=z({webshell:0,site:0,siteList:[],cc:0,ccList:[]}),c=w(s("Waf.Overview.index_14")),d=()=>{},u=w(s("Waf.Overview.index_15")),m=async()=>{await f(),n.getNewInfo()},x=()=>{u.data.list=r.siteList,u.show=!0},h=w(s("Waf.Overview.index_16")),y=()=>{h.data.list=r.ccList,h.show=!0};return n.onReady("count",(e=>{r.webshell=e.count.webshell,r.site=e.count.unprotected_site,r.siteList=e.count.unprotected_site_list,r.cc=e.count.maybe_err_cc,r.ccList=e.count.maybe_err_cc_list})),(e,t)=>{const l=v,s=ue;return W(),$(ge,null,{default:C((()=>[E("div",Pe,[E("div",He,[E("div",Be,T(e.$t("Waf.Overview.index_9")),1),E("div",Fe,[E("div",{class:"count-num",onClick:d},T(q(r).webshell),1)])]),E("div",Ve,[E("div",Xe,T(e.$t("Waf.Overview.index_10")),1),E("div",Qe,[E("div",{class:"count-num",onClick:x},T(q(r).site),1),q(r).site>0?(W(),N(G,{key:0},[A(l,{class:"ml-20px",onClick:m},{default:C((()=>[H(T(e.$t("Waf.Overview.index_11")),1)])),_:1}),A(l,{class:"ml-20px",onClick:x},{default:C((()=>[H(T(e.$t("Waf.Overview.index_12")),1)])),_:1})],64)):X("",!0)])]),E("div",Je,[E("div",Ye,T(e.$t("Waf.Overview.index_13")),1),E("div",Ze,[E("div",{class:Q(["count-num",{"text-error":q(r).cc>0}]),onClick:y},T(q(r).cc),3),q(r).cc>0?(W(),$(l,{key:0,class:"ml-20px",onClick:y},{default:C((()=>[H(T(e.$t("Waf.Overview.index_12")),1)])),_:1})):X("",!0)])])]),A(s,{show:q(c).show,"onUpdate:show":t[0]||(t[0]=e=>q(c).show=e),title:q(c).title,width:800,"min-height":236,component:q(a)},null,8,["show","title","component"]),A(s,{show:q(u).show,"onUpdate:show":t[1]||(t[1]=e=>q(u).show=e),title:q(u).title,data:q(u).data,width:440,"min-height":236,component:q(i)},null,8,["show","title","data","component"]),A(s,{show:q(h).show,"onUpdate:show":t[2]||(t[2]=e=>q(h).show=e),title:q(h).title,data:q(h).data,width:800,"min-height":236,component:q(o)},null,8,["show","title","data","component"])])),_:1})}}}),[["__scopeId","data-v-c6ff642a"]]),et={class:"w-full h-full"},tt={class:"district-legend"},at={class:"mr-2"},lt={class:"ml-2"},it=a(L({__name:"Map2d",props:{data:{type:Array,default:()=>[]}},setup(e){const{t:t}=I(),a=V({title:{left:"center",top:"top"},grid:{top:70,bottom:40,left:0,right:0},tooltip:{padding:4,borderColor:"rgba(50, 50, 50, 0)",backgroundColor:"rgba(50, 50, 50, 0.7)",textStyle:{color:"#fff"},formatter:e=>{const a=e;let l="";const i=`${a.value}`.split(".");return l="NaN"===i[0]?a.name:`${a.name}<br />${t("Waf.Overview.index_26",[i[0]])}`,l}},visualMap:{min:0,max:100,left:-200,range:null,inRange:{color:["rgba(62, 183, 82, 0.13)","rgba(62, 183, 82, 0.5)","#3eb752"]}},series:l()});function l(e=[]){return[{name:"World Population (2010)",type:"map",map:"world",zoom:1.2,itemStyle:{borderColor:"#ffffff",areaColor:"#E6E6E6"},label:{show:!1},emphasis:{itemStyle:{borderColor:"#ffffff",areaColor:"#20a53a"}},data:e}]}return Y((()=>e.data),(e=>{Z((()=>{var t;t=e,a.series=l(t)}))}),{immediate:!0}),(e,t)=>(W(),N("div",et,[E("div",tt,[E("span",at,T(e.$t("Waf.Overview.index_24")),1),t[0]||(t[0]=E("div",{class:"item"},null,-1)),t[1]||(t[1]=E("div",{class:"item"},null,-1)),t[2]||(t[2]=E("div",{class:"item"},null,-1)),E("span",lt,T(e.$t("Waf.Overview.index_25")),1)]),A(de,{type:"map",height:"100%",option:q(a)},null,8,["option"])]))}}),[["__scopeId","data-v-9406e065"]]),ot=L({__name:"Map3d",setup(e){const t=K("mapRef");let a=null;const l=M(0),i=M(0),o=M([]),s=()=>{const e=document.createElement("canvas"),t=xe.init(e,null,{width:4096,height:2048});return t.setOption({backgroundColor:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"#9ed6ff"},{offset:.7,color:"#fafcfa"},{offset:1,color:"#9ed6ff"}]},series:[{type:"map",map:"world",left:0,top:0,right:0,bottom:0,boundingCoords:[[-180,90],[180,-90]],label:{show:!1,color:"#fff",fontSize:20},itemStyle:{areaColor:"#44b359",borderColor:"#fff",borderWidth:1}}]}),t},n=async()=>{if(!t.value)return;const{message:e}=await m();x(e)&&(l.value=e.load_ip.latitude,i.value=e.load_ip.longitude,o.value=e.attack_ip.map((t=>({coords:[[t.ip_longitude,t.ip_latitude],[e.load_ip.longitude,e.load_ip.latitude]],value:1})))),a=xe.init(t.value);const n={tooltip:{show:!0},globe:{silent:!0,shading:"color",baseTexture:s(),viewControl:{distance:240,targetCoord:[i.value,l.value],maxDistance:240,minDistance:240,rotateSensitivity:2,autoRotateSpeed:10}},series:[{type:"bar3D",coordinateSystem:"globe",shading:"lambert",opacity:1,bevelSize:.2,itemStyle:{color:"#EBE806"},label:{show:!1,formatter:"{b}"},data:[]},{name:"lines3D",type:"lines3D",coordinateSystem:"globe",effect:{show:!0,period:2,trailWidth:4,trailLength:.5,trailOpacity:1,trailColor:"red"},blendMode:"lighter",lineStyle:{width:1,color:"red",opacity:0},data:o.value,silent:!1},{type:"lines3D",coordinateSystem:"globe",effect:{show:!0,trailWidth:5,trailOpacity:1,trailLength:.2,constantSpeed:5},blendMode:"lighter",lineStyle:{color:"#EBE806",width:1,opacity:1},data:[]}]};a.setOption(n)},r=()=>{a?.resize()};return xe.use([pe,fe,ve]),ee((async()=>{await(async()=>{const{data:e}=await me.get("/static/vite/data/world.json");xe.registerMap("world",e)})(),n(),window.addEventListener("resize",r)})),te((()=>{a?.dispose(),a=null,window.removeEventListener("resize",r)})),(e,a)=>(W(),N("div",{ref_key:"mapRef",ref:t,class:"attack-map"},null,512))}}),st=L({__name:"Table",props:{data:{type:Array,default:()=>[]}},setup(e){const{t:t}=I(),{columns:a}=k([{key:"ip",width:120,title:t("Waf.Overview.index_27"),ellipsis:{tooltip:!0},render:e=>A("a",{class:"bt-link",href:"javascript:;",onClick:()=>{he({ip:e.ip})}},[e.ip])},{key:"count",width:90,title:t("Waf.Overview.index_28")},{key:"address",title:t("Waf.Overview.index_29"),ellipsis:{tooltip:!0}}]);return(t,l)=>{const i=S;return W(),$(i,{"max-height":520,bordered:!1,data:e.data,columns:q(a)},null,8,["data","columns"])}}}),nt={class:"flex items-center justify-between flex-1"},rt={class:"flex items-center"},ct={class:"mr-8px text-12px"},dt={class:"bt-link text-12px",href:"/btwaf/content_report.html",target:"_blank"},ut={class:"flex gap-12px h-616px p-16px"},pt={class:"relative flex-1"},ft={class:"w-320px min-w-320px"},vt=L({__name:"index",setup(e){const{t:t}=I(),a=l(),o=M(u(h("waf-map-type","0"))),s=M(!0),n=M([]),r=M([]),c=e=>{O({title:t(e?"Waf.Overview.index_35":"Waf.Overview.index_36"),content:t(e?"Waf.Overview.index_37":"Waf.Overview.index_38"),onConfirm:async()=>{await y(),s.value=e,o.value=e?3:2,g("waf-map-type",o.value)}})},d=e=>{g("waf-map-type",e)};return a.onReady("map",(e=>{n.value=e.map,r.value=e.attack_details,s.value=e["3D"],0===o.value&&(o.value=e["3D"]?3:2)})),(e,t)=>{const a=re,l=i,u=oe,p=se;return W(),$(ge,null,{header:C((()=>[E("div",nt,[E("div",null,T(e.$t("Waf.Overview.index_23")),1),E("div",rt,[E("span",ct,T(e.$t("Waf.Overview.index_34")),1),A(a,{value:q(s),size:"small","onUpdate:value":c},null,8,["value"]),A(l,{vertical:""}),E("a",dt,T(e.$t("Waf.Overview.index_30")),1)])])])),default:C((()=>[E("div",ut,[E("div",pt,[q(s)?(W(),$(p,{key:0,value:q(o),"onUpdate:value":[t[0]||(t[0]=e=>B(o)?o.value=e:null),d],class:"absolute top-0 left-0 z-1000",size:"small"},{default:C((()=>[A(u,{value:3},{default:C((()=>t[1]||(t[1]=[H("3D")]))),_:1,__:[1]}),A(u,{value:2},{default:C((()=>t[2]||(t[2]=[H("2D")]))),_:1,__:[2]})])),_:1},8,["value"])):X("",!0),3===q(o)?(W(),$(ot,{key:1})):X("",!0),2===q(o)?(W(),$(it,{key:2,data:q(n)},null,8,["data"])):X("",!0)]),E("div",ft,[A(st,{data:q(r)},null,8,["data"])])])])),_:1})}}});e("default",L({__name:"index",setup:e=>(l().getInfo(),(e,t)=>{const a=ce,l=b;return W(),N("div",null,[A(l,{"x-gap":"16","y-gap":"16"},{default:C((()=>[A(a,{span:"6 992:24"},{default:C((()=>[A(Ce)])),_:1}),A(a,{span:"12 992:24"},{default:C((()=>[A(Ie)])),_:1}),A(a,{span:"6 992:24"},{default:C((()=>[A(Ue)])),_:1}),A(a,{span:"6 992:24"},{default:C((()=>[A(Ge),A(Ke)])),_:1}),A(a,{span:"18 992:24"},{default:C((()=>[A(vt)])),_:1})])),_:1})])})}))}}}));
