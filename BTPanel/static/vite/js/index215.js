import{c as a,f as l,a as e,h as s,_ as t}from"./public.js?v=1747989938512";import{N as i,m as n}from"./page_layout.js?v=1747989938512";import{f as u,m as r,h as o,i as c,j as p}from"./setting.js?v=1747989938512";import{_ as d,c0 as m,T as f}from"./naive.js?v=1747989938512";import{d as g,t as v,O as V,j as _,r as x,P as y,F as h,n as S,R as b,S as w,U as W,V as j,a1 as k,c as E,a2 as C,M as P}from"./vue.js?v=1747989938512";import"./common.js?v=1747989938512";import"./__commonjsHelpers__.js?v=1747989938512";const B={class:"p-20px"},N={class:"flex mb-12px"},U={class:"flex-1 mr-12px"},$={class:"w-150px mr-12px"},z={class:"text-error"},D=g({__name:"index",props:{type:{}},setup(g,{expose:D}){const R=v(g,"type"),{t:A}=V(),F=_({ruleValue:"",ps:""}),H=async()=>{""!==F.ruleValue.trim()?(await p({...P(F),ruleName:R.value}),Q(),F.ruleValue="",F.ps=""):n.error(A("Waf.Setting.config_194"))},L=x(null),M=x(null),{table:O,columns:T,setLoading:q}=a([{key:"rule",title:A("Waf.Setting.config_82"),render:a=>y(h,null,[a.isEdit?y(d,{ref:L,value:a.ruleVal,size:"small",type:"textarea",autosize:{minRows:2,maxRows:2},placeholder:"",onUpdateValue:l=>{a.ruleVal=l}},null):a.rule])},{key:"ps",title:A("Waf.Setting.config_190"),width:150,render:a=>y(h,null,[a.isEdit?y(d,{ref:M,value:a.psVal,size:"small",placeholder:"",onUpdateValue:l=>{a.psVal=l}},null):a.ps])},{key:"status",title:A("Waf.Setting.config_82"),width:60,render:(a,l)=>y(m,{value:a.status,size:"small",checkedValue:1,uncheckedValue:0,onUpdateValue:async e=>{await u({index:l,ruleName:R.value}),a.status=e}},null)},l({width:100,options:(a,l)=>a.isEdit?[{label:A("Public.Btn.Save"),onClick:()=>{I(a,l)}},{label:A("Public.Btn.Cancel"),onClick:()=>{J(a)}}]:[{label:A("Public.Btn.Edit"),onClick:()=>{G(a)}},{label:A("Public.Btn.Del"),show:a.isDel,onClick:()=>{K(a,l)}}]})]),G=a=>{a.isEdit=!0,S((()=>{var a;null==(a=L.value)||a.focus()}))},I=async(a,l)=>{a.isEdit=!1,await r({index:l,ruleBody:a.ruleVal,rulePs:a.psVal,ruleName:R.value}),a.rule=a.ruleVal,a.ps=a.psVal},J=a=>{a.isEdit=!1,a.ruleVal=a.rule,a.psVal=a.ps},K=async(a,l)=>{e({title:A("Waf.Setting.config_195",[a.rule]),content:A("Waf.Setting.config_196"),onConfirm:async()=>{await o({index:l,ruleName:R.value}),Q()}})},Q=async()=>{try{q(!0);const{message:a}=await c({ruleName:R.value});i(a)&&(O.data=a.map((a=>({rule:a[1],ruleVal:a[1],ps:a[2],psVal:a[2],status:a[0],isEdit:!1,isDel:1===a[3]}))))}finally{q(!1)}};return Q(),D({init:Q}),(a,l)=>{const e=f,i=s,n=t;return b(),w("div",B,[W("div",N,[W("div",U,[y(j(d),{value:j(F).ruleValue,"onUpdate:value":l[0]||(l[0]=a=>j(F).ruleValue=a),placeholder:a.$t("Waf.Setting.config_189")},null,8,["value","placeholder"])]),W("div",$,[y(j(d),{value:j(F).ps,"onUpdate:value":l[1]||(l[1]=a=>j(F).ps=a),placeholder:a.$t("Waf.Setting.config_190")},null,8,["value","placeholder"])]),y(e,{type:"primary",onClick:H},{default:k((()=>[E(C(a.$t("Public.Btn.Add")),1)])),_:1})]),y(i,{"max-height":340,loading:j(O).loading,data:j(O).data,columns:j(T)},null,8,["loading","data","columns"]),y(n,{class:"mt-16px"},{default:k((()=>[W("li",z,C(a.$t("Waf.Setting.config_191")),1),W("li",null,C(a.$t("Waf.Setting.config_192")),1),W("li",null,C(a.$t("Waf.Setting.config_193")),1)])),_:1})])}}});export{D as default};
