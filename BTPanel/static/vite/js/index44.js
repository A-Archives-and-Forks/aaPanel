import{ca as e,c as t,h as a,e as s,x as n,b0 as i,o as l,m as o}from"./page_layout.js?v=1753954525509";import{c as r,b as c,f as u,u as d,d as p,_}from"./public.js?v=1753954525509";import{_ as m}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1753954525509";import{c as g,e as y,f,h as x,s as b,i as v}from"./logs2.js?v=1753954525509";import{k,r as w,e as h,U as C,V as N,Q as S,X as L,W as j,a1 as P,al as $,F as R,O as U,H as W,a3 as T,N as q,P as I,w as B,a2 as z,j as A,ah as F,c as H}from"./vue.js?v=1753954525509";import{_ as D}from"./index102.js?v=1753954525509";import{_ as K}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1753954525509";import{_ as O}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1753954525509";import{ay as Q,bY as V,bA as X,cD as Y}from"./naive.js?v=1753954525509";import{_ as E}from"./index101.js?v=1753954525509";import{_ as G}from"./index.js?v=1753954525509";import{g as J}from"./site.js?v=1753954525509";import{_ as M}from"./logs.vue_vue_type_script_setup_true_lang.js?v=1753954525509";import"./common.js?v=1753954525509";import"./__commonjsHelpers__.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1753954525509";const Z={class:"w-240px"},ee={class:"item mt-10px"},te=["onClick"],ae=s(k({__name:"index",setup(s){const n=e(),i=w(),l=h({p:1,limit:999,search:"",type:-1}),o=w([]),{loading:c,setLoading:u}=r(),d=async()=>{try{u(!0);const{message:e}=await g(q(l));t(e)&&(n.setWebsite(e.data[0].name),i.value=e.data[0].name,o.value=e.data)}finally{u(!1)}};return d(),(e,t)=>{const s=m,r=a;return C(),N("div",Z,[S(s,{value:L(l).search,"onUpdate:value":t[0]||(t[0]=e=>L(l).search=e),placeholder:e.$t("Logs.Panel.index_4"),onSearch:d},null,8,["value","placeholder"]),j("div",ee,[L(c)?(C(),P(r,{key:0,height:"36px",text:"",repeat:6})):$("",!0),(C(!0),N(R,null,U(L(o),(e=>(C(),N("div",{class:W(["list",{"list-active":L(i)==e.name}]),key:e.id,onClick:t=>{return a=e.name,n.setWebsite(a),void(i.value=a);var a}},T(e.name),11,te)))),128))])])}}}),[["__scopeId","data-v-87bf7484"]]),se=k({__name:"index",setup(a,{expose:s}){const i=e(),{t:l}=I(),{keys:o,table:d,columns:p}=c([{key:"username",title:l("Ftp.Analysis.Index_27")},{key:"type",title:l("Logs.Panel.index_6")},{key:"log",title:l("Public.Btn.Details")},{key:"addtime",align:"right",title:l("Logs.Panel.index_7")}]),_=h({search:i.websiteName,p:1,limit:10,stype:"Site manager"}),{loading:m,setLoading:g}=r(),f=async()=>{try{g(!0);const{message:e}=await y(_);t(e)&&(d.data=e.data,d.total=n(e.page))}finally{o.value=[],g(!1)}};B((()=>i.websiteName),(e=>{e&&(_.p=1,_.search=e,f())}));const x=()=>{i.websiteName&&f()};return x(),s({getList:x}),(e,t)=>{const a=Q,s=u,n=O,i=K;return C(),P(i,{feedback:!1},{toolsLeft:z((()=>[S(a,{type:"primary",onClick:x},{default:z((()=>[A(T(e.$t("Public.Btn.Refresh")),1)])),_:1})])),table:z((()=>[S(s,{"checked-row-keys":L(o),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>F(o)?o.value=e:null),"row-key":"name",loading:L(m),data:L(d).data,columns:L(p)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:z((()=>[S(n,{page:L(_).p,"onUpdate:page":t[1]||(t[1]=e=>L(_).p=e),"page-size":L(_).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>L(_).limit=e),"item-count":L(d).total,onRefresh:x},null,8,["page","page-size","item-count"])])),_:1})}}}),ne=k({__name:"index",setup(a,{expose:s}){const n=e(),{loading:i,setLoading:l}=r(),o=w("None"),c=async()=>{l(!0);try{const{message:e}=await f({siteName:n.websiteName});t(e)&&(o.value=e.result?e.result:"None")}finally{l(!1)}};B((()=>n.websiteName),(e=>{e&&c()}));const u=()=>{n.websiteName&&c()};return u(),s({getList:u}),(e,t)=>{const a=Q,s=E,n=V;return C(),P(n,{vertical:"",class:"h-full"},{default:z((()=>[S(a,{class:"self-start",type:"primary",onClick:u},{default:z((()=>[A(T(e.$t("Public.Btn.Refresh")),1)])),_:1}),S(s,{loading:L(i),log:L(o)},null,8,["loading","log"])])),_:1})}}}),ie=k({__name:"index",setup(a,{expose:s}){const n=e(),{loading:i,setLoading:l}=r(),o=w("None"),c=async()=>{l(!0);try{const{message:e}=await x({siteName:n.websiteName});t(e)&&(o.value=e.result?e.result:"None")}finally{l(!1)}};B((()=>n.websiteName),(e=>{e&&c()}));const u=()=>{n.websiteName&&c()};return u(),s({getList:u}),(e,t)=>{const a=Q,s=E,n=V;return C(),P(n,{vertical:"",class:"h-full"},{default:z((()=>[S(a,{class:"self-start",type:"primary",onClick:u},{default:z((()=>[A(T(e.$t("Public.Btn.Refresh")),1)])),_:1}),S(s,{loading:L(i),log:L(o)},null,8,["loading","log"])])),_:1})}}}),le={class:"text-error"},oe={class:"w-400px p-20px"},re={class:"mb-16px"},ce=s(k({__name:"index",setup(a,{expose:s}){const n=e(),m=i(),{t:g}=I(),y=w(!1),f=w(0),{keys:x,table:k,columns:h}=c([{key:"start_time",title:g("Logs.Panel.index_13")},{key:"time",title:g("Public.Unit.Time"),render:e=>Number(e.time).toFixed(2)+" Sec"},{key:"xss",title:g("Site.TableRow.index_4"),render:e=>e.xss>0?S(l,{onClick:()=>{U("xss")}},{default:()=>[e.xss]}):e.xss},{key:"sql",title:g("Site.TableRow.index_5"),render:e=>e.sql>0?S(l,{onClick:()=>{U("sql")}},{default:()=>[e.sql]}):e.sql},{key:"san",title:g("Site.TableRow.index_6"),render:e=>e.san>0?S(l,{class:"button-color",onClick:()=>{U("san")}},{default:()=>[e.san]}):e.san},{key:"php",title:g("Logs.Panel.index_14"),render:e=>e.php>0?S(l,{onClick:()=>{U("php")}},{default:()=>[e.php]}):e.php},{key:"ip",title:g("Logs.Website.index_5"),render:e=>e.ip>0?S(l,{onClick:()=>{U("ip")}},{default:()=>[e.ip]}):e.ip},{key:"url",title:g("Logs.Website.index_1"),render:e=>e.url>0?S(l,{onClick:()=>{U("url")}},{default:()=>[e.url]}):e.url},{key:"log",title:g("Security.Anti.Index_7"),render:e=>e.xss+e.sql+e.san+e.php+e.ip+e.url}]),P=()=>{p({title:g("Site.Config.index_104"),content:g("Logs.Website.index_3",[n.websiteName]),onConfirm:async({hide:e})=>{try{await b({siteName:W.value}),y.value=!0,$()}finally{e()}}})},$=(e=0)=>{let a=setTimeout((async()=>{const{message:e}=await J({path:W.value});t(e)&&(f.value=e.result,f.value>=100?(o.success(g("Site.Config.index_107")),y.value=!1,f.value=0,O(),clearTimeout(a)):$(1e3))}),e)},U=e=>{d({title:"[".concat(e,"] ").concat(g("Site.Config.index_103")),data:{type:e,path:W.value},component:M})},W=H((()=>{let e="";switch(m.webserver){case"nginx":e=".log";break;case"apache":e="-access_log";break;default:e="_ols.access_log"}return"/www/wwwlogs/".concat(n.websiteName).concat(e)})),{loading:q,setLoading:D}=r(),O=async()=>{try{D(!0);const{message:e}=await v({siteName:W.value});t(e)&&(k.data=e.is_status?[e]:[])}finally{x.value=[],D(!1)}};return B((()=>n.websiteName),(e=>{e&&O()})),O(),s({init:O}),(e,t)=>{const a=Q,s=u,n=K,i=_,o=X,r=G;return C(),N(R,null,[S(n,{feedback:!1},{toolsLeft:z((()=>[S(a,{type:"primary",onClick:P},{default:z((()=>[A(T(e.$t("Site.Config.index_104")),1)])),_:1})])),table:z((()=>[S(s,{"checked-row-keys":L(x),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>F(x)?x.value=e:null),"row-key":"name","max-height":1e3,loading:L(q),data:L(k).data,columns:L(h)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),S(i,{class:"mt-16px"},{default:z((()=>[j("li",null,[A(T(e.$t("Site.Config.index_108"))+" ",1),j("span",le,T(e.$t("Site.Config.index_109")),1)]),j("li",null,T(e.$t("Site.Config.index_110")),1),j("li",null,T(e.$t("Site.Config.index_111")),1),j("li",null,T(e.$t("Site.Config.index_112")),1),j("li",null,[S(l,{href:"https://www.aapanel.com/forum/d/3351-nginx-waf-instructions",target:"_blank"},{default:z((()=>[A(T(e.$t("Site.Config.index_113")),1)])),_:1}),A(" "+T(e.$t("Site.Config.index_114")),1)])])),_:1}),S(r,{show:L(y),"onUpdate:show":t[1]||(t[1]=e=>F(y)?y.value=e:null)},{default:z((()=>[j("div",oe,[j("div",re,T(e.$t("Site.Config.index_115")),1),S(o,{type:"line",status:"success",height:24,percentage:L(f),"border-radius":4,"indicator-placement":"inside"},null,8,["percentage"])])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-5bc24312"]]),ue=s(k({__name:"index",setup(e){const{t:t}=I(),a=w("operation"),s=[{key:"operation",label:t("Security.Tabs.Index_7"),component:se},{key:"access",label:t("Logs.Website.index_2"),component:ne},{key:"error",label:t("Logs.Website.index_4"),component:ie},{key:"security",label:t("Site.Config.index_102"),component:ce}];return(e,t)=>{const n=D;return C(),P(n,{class:"box",value:L(a),"onUpdate:value":t[0]||(t[0]=e=>F(a)?a.value=e:null),options:s},null,8,["value"])}}}),[["__scopeId","data-v-7029a0a8"]]),de=k({__name:"index",setup(e){const t=i();return(async()=>{await t.getPHPConfig()})(),(e,t)=>{const a=V,s=Y;return C(),P(s,{class:"p-16px"},{default:z((()=>[S(a,{class:"flex-nowrap!"},{default:z((()=>[S(ae),S(ue)])),_:1})])),_:1})}}});export{de as default};
