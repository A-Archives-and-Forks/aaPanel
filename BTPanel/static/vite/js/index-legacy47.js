System.register(["./index-legacy104.js?v=1741416570306","./vue-legacy.js?v=1741416570306","./page_layout-legacy.js?v=1741416570306","./campaign-legacy.js?v=1741416570306","./public-legacy.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy17.js?v=1741416570306","./common-legacy.js?v=1741416570306","./naive-legacy.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy16.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy4.js?v=1741416570306","./mail-legacy.js?v=1741416570306","./index-legacy.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1741416570306","./index-legacy95.js?v=1741416570306","./upload-legacy.js?v=1741416570306","./index-legacy103.js?v=1741416570306","./file-legacy.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy12.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1741416570306","./index-legacy99.js?v=1741416570306"],(function(e,t){"use strict";var a,l,i,n,s,o,r,d,u,c,p,m,v,y,f,_,h,g,b,x,w,k,M,C,U,$,P,R,j,S,E,T,D,B,z,L,A,H,O,G,I,N,W,F,q,K,J,V,Q,Y,X,Z,ee,te,ae,le,ie,ne,se,oe,re,de,ue,ce,pe,me,ve,ye,fe,_e,he,ge,be,xe,we,ke,Me,Ce,Ue,$e,Pe,Re,je,Se,Ee,Te,De,Be,ze,Le,Ae,He,Oe,Ge,Ie,Ne,We,Fe,qe,Ke,Je,Ve,Qe,Ye,Xe,Ze,et,tt,at,lt,it,nt,st,ot,rt,dt,ut,ct,pt,mt,vt,yt,ft,_t,ht,gt,bt,xt,wt,kt,Mt,Ct,Ut,$t,Pt,Rt,jt,St,Et,Tt,Dt,Bt,zt,Lt,At,Ht,Ot,Gt,It,Nt,Wt,Ft;return{setters:[e=>{a=e._},e=>{l=e.av,i=e.r,n=e.aC,s=e.d,o=e.ar,r=e.P,d=e.Q,u=e.N,c=e.$,p=e.R,m=e.F,v=e.Y,y=e.S,f=e.ae,_=e.c,h=e.ao,g=e.j,b=e.a0,x=e._,w=e.M,k=e.ap,M=e.aB,C=e.f,U=e.w,$=e.n,P=e.e,R=e.aq,j=e.af,S=e.m,E=e.t,T=e.G,D=e.H,B=e.k,z=e.v,L=e.W,A=e.a7,H=e.u,O=e.ah,G=e.L},e=>{I=e.bP,N=e.b,W=e.U,F=e.a5,q=e.u,K=e.k,J=e.G,V=e.j,Q=e.I,Y=e.bG,X=e.bQ,Z=e.g,ee=e.a,te=e.m,ae=e.H,le=e.av,ie=e.az,ne=e.d},e=>{se=e.d,oe=e.a,re=e.c,de=e.f,ue=e.h,ce=e.i,pe=e.s,me=e.j,ve=e.k,ye=e.l,fe=e.m,_e=e.n,he=e.o,ge=e.p,be=e.q,xe=e.r,we=e.t,ke=e.u,Me=e.v,Ce=e.w,Ue=e.x,$e=e.y,Pe=e.z,Re=e.A,je=e.B,Se=e.C,Ee=e.D,Te=e.E,De=e.F,Be=e.G,ze=e.H,Le=e.I,Ae=e.J,He=e.K,Oe=e.L,Ge=e.M,Ie=e.N,Ne=e.O,We=e.P,Fe=e.g,qe=e.Q,Ke=e.R},e=>{Je=e.e,Ve=e.b,Qe=e.c,Ye=e.u,Xe=e.a,Ze=e.f,et=e.d,tt=e.E,at=e.h},e=>{lt=e._},e=>{it=e.j,nt=e.R,st=e.S},e=>{ot=e.cm,rt=e.cf,dt=e.T,ut=e.bX,ct=e.cu,pt=e.ch,mt=e._,vt=e.cb,yt=e.cw,ft=e.bR,_t=e.bV,ht=e.cg,gt=e.bS,bt=e.ci,xt=e.bO,wt=e.ce,kt=e.bu},e=>{Mt=e._},e=>{Ct=e._},e=>{Ut=e._},e=>{$t=e.b,Pt=e.c,Rt=e.a,jt=e.i,St=e.d,Et=e.e,Tt=e.s,Dt=e.f,Bt=e.h},e=>{zt=e._},e=>{Lt=e._},e=>{At=e._},e=>{Ht=e._},e=>{Ot=e.o},e=>{Gt=e._},e=>{It=e.g},e=>{Nt=e._},e=>{Wt=e._},e=>{Ft=e._}],execute:function(){var qt=document.createElement("style");qt.textContent=".rate-box[data-v-6ec46142]{margin-top:16px;display:flex;justify-content:space-between;gap:16px}.rate-box .rate-list[data-v-6ec46142]{flex:1 1 0%;--un-bg-opacity:1;background-color:rgb(250 250 250 / var(--un-bg-opacity));padding:16px;text-align:center;border-radius:4px;border:1px solid #f1f1f1}.rate-box .rate-title[data-v-6ec46142]{--un-text-opacity:1;color:rgb(153 153 153 / var(--un-text-opacity))}.rate-box .rate-text[data-v-6ec46142]{margin-top:6px;font-size:24px;--un-text-opacity:1;color:rgb(102 102 102 / var(--un-text-opacity));font-weight:700}.n-data-table[data-v-3bfb2bbb]{--n-merged-th-color: transparent;--n-border-color: #f1f1f1}.n-data-table[data-v-3bfb2bbb] .n-data-table-td.n-data-table-td--last-row{border-bottom-color:transparent}.total-list[data-v-1d6a0b1a]{display:flex;justify-content:center;flex-wrap:wrap;margin-bottom:16px}.total-list .total-item[data-v-1d6a0b1a]{width:26%;text-align:center}.total-list .total-label[data-v-1d6a0b1a]{margin-bottom:4px;font-size:14px;color:#666}.total-list .total-value[data-v-1d6a0b1a]{display:flex;align-items:center;justify-content:center;min-height:28px}.overview-card[data-v-5777b7d2]{padding:14px 16px;border:1px solid #f1f1f1;border-radius:4px}.form-card[data-v-3b3d3467]{border:1px solid #ebebeb;border-radius:4px}[data-v-8e0ce07e] .n-progress-graph-line-indicator{text-align:center!important}.ul-style[data-v-f5816121]{margin:0 auto;display:flex;align-items:center;justify-content:center;gap:48px;font-size:16px}.ul-style li[data-v-f5816121]{display:flex;align-items:center}.n-image[data-v-f5816121] img{width:100%}.template-list[data-v-5af2dd72]{display:flex;gap:16px}.template-list .template-item[data-v-5af2dd72]{width:260px;border:1px solid #cccccc;border-radius:4px;padding:16px;cursor:pointer}.template-list .template-item.active[data-v-5af2dd72]{border:1px solid #20A53A;background-color:#e8f6eb}.template-list .template-item .template-title[data-v-5af2dd72]{font-weight:700;color:#555}.template-list .template-item .template-desc[data-v-5af2dd72]{margin-top:8px;color:#666}\n",document.head.appendChild(qt),e({A:function(e,t){const a=vl.value.findIndex((t=>t==e)),l=vl.value.findIndex((e=>e==t));-1!==a&&-1!==l&&a>l&&(vl.value[a]=t,vl.value[l]=e),Sl.$emit("makeDom")},C:Ql,E:function(e){const t=[];yl.value[e].children.forEach((e=>{t.push(Number(fl.value[e].width.split("%")[0]))}));const a=100/(t.length+1),l=t.reduce(((e,t)=>e+t),0),i=(100-(l+a))/l;t.push(a);for(let n=0;n<t.length-1;n++)t[n]+=t[n]*i;Ql(t,e),Sl.$emit("makeDom")},F:function(e,t){const a=yl.value[t].children.reduce(((t,a)=>{const l=Number(fl.value[e].width.split("%")[0]);return{...t,[a]:l}}),{});delete a[e];let l=Object.values(a);const i=l.reduce(((e,t)=>e+t),0),n=(100-i)/i;l=l.map((e=>parseFloat((e*(1+n)).toFixed(2))));const s=l.reduce(((e,t)=>e+t),0),o=100-s;0!==o&&(l[l.length-1]+=o),Vl(e,t),Ql(l,t),Sl.$emit("makeDom")},H:function(){vl.value=[],yl.value={},fl.value={},_l.value={},hl.value={},gl.value={},bl.value={},xl.value={}},I:function(e){e&&(Yl(e),cl(),Sl.$emit("makeDom"))},K:function(e,t){if("0"==e.key){const e=Zl();!function(e,t){vl.value.splice(t,0,e),Sl.$emit("makeDom")}(e,t),function(e){const t=Zl();yl.value[e]={type:dl.Columns,name:"åˆ—",key:e,children:[t]},Fl(t),function(e){gl.value[e]=ft(Pl)}(e),Sl.$emit("makeDom")}(e),Kl(e,"columns")}Sl.$emit("makeDom")},b:function(e,t,a){const l=fl.value[e].children.findIndex((e=>e==t)),i=fl.value[e].children.findIndex((e=>e==a));-1!==l&&-1!==i&&l>i&&(fl.value[e].children.splice(l,1),fl.value[e].children.splice(i,0,t)),Sl.$emit("makeDom")},f:function(e,t,a){const l=fl.value[e].children.findIndex((e=>e==t)),i=fl.value[e].children.findIndex((e=>e==a));-1!==l&&-1!==i&&l<i&&(fl.value[e].children.splice(i,1),fl.value[e].children.splice(l,0,a)),Sl.$emit("makeDom")},g:Zl,h:ti,i:function(e,t,a){fl.value[e].children.push(t),ql(t,a),Sl.$emit("makeDom")},l:function(e,t){const a=fl.value[t],l=_l.value[e],i=bl.value[e];if(a&&l&&i){const t=ft(i),n=ft(l),s=Zl(),o=a.children.findIndex((t=>t===e));-1!==o&&a.children.splice(o+1,0,s),n.key=s,_l.value[s]=n,bl.value[s]=t}},r:Jl,u:function(e,t,a,l){fl.value[e].children.splice(l,0,t),ql(t,a),Sl.$emit("makeDom")},y:function(e){pl.value="",ml.value="",yl.value[e].children.forEach((t=>{Vl(t,e)})),delete yl.value[e],vl.value=vl.value.filter((t=>t!==e)),Sl.$emit("makeDom")},z:function(e,t){const a=vl.value.findIndex((t=>t==e)),l=vl.value.findIndex((e=>e==t));-1!==a&&-1!==l&&a<l&&(vl.value[a]=t,vl.value[l]=e),Sl.$emit("makeDom")}});const Kt=l("menu-mail-market","overview"),Jt=i(null),Vt=i(!1),Qt=i(-1);class Yt{static instance;constructor(){}static getInstance(){return Yt.instance||(Yt.instance=n()),Yt.instance}}const Xt=i(!1),Zt=i(""),ea=i({type:"today",data:function(){const{start:e,end:t}=I(new Date);return[e.getTime(),t.getTime()]}()});function ta(){const e=Yt.getInstance();function t(){return{...Zt.value?{domain:Zt.value}:{},start_time:Math.floor(ea.value.data[0]/1e3),end_time:Math.floor(ea.value.data[1]/1e3)}}return{getRate:e=>e>=0?`${e}%`:"--",getChartTime:(e,t)=>{let a=new Date;return"hourly"===e?(a.setMinutes(0),a.setSeconds(0),a.setHours(t)):"daily"===e&&(a=new Date(1e3*t)),W(a)},getOverview:async function(){try{Xt.value=!0;const{message:a}=await se(t());N(a)&&e.trigger(a)}finally{Xt.value=!1}},getParams:t,onResult:e.on}}const aa={class:"w-240px ml-8px"},la=s({__name:"date",props:{type:{},typeModifiers:{},value:{default:()=>[]},valueModifiers:{}},emits:["update:type","update:value"],setup(e){const t=o(e,"type"),a=o(e,"value");function l(e=new Date){const t=nt(e),a=st(e);return[t.getTime(),a.getTime()]}const i=e=>{switch(e){case"today":a.value=l();break;case"yesterday":a.value=l(it(new Date,-1));break;case"7day":a.value=(()=>{const e=new Date,t=st(e);return[nt(it(e,-6)).getTime(),t.getTime()]})()}},n=e=>{const t=new Date,a=it(t,-30);return nt(a).getTime()>e||st(t).getTime()<e},s=e=>{t.value="custom",a.value=[nt(e[0]).getTime(),st(e[1]).getTime()]};return(e,l)=>{const o=ot,v=rt,y=F;return r(),d(m,null,[u(v,{value:t.value,"onUpdate:value":[l[0]||(l[0]=e=>t.value=e),i]},{default:c((()=>[u(o,{label:e.$t("Public.Search.Today"),value:"today"},null,8,["label"]),u(o,{label:e.$t("Public.Search.Yesterday"),value:"yesterday"},null,8,["label"]),u(o,{label:e.$t("Public.Search.Last7"),value:"7day"},null,8,["label"])])),_:1},8,["value"]),p("div",aa,[u(y,{value:a.value,type:"daterange","is-date-disabled":n,"onUpdate:value":s},null,8,["value"])])],64)}}}),ia={class:"flex items-center justify-between"},na={class:"flex items-center gap-16px"},sa={class:"w-240px"},oa={key:0},ra={class:"flex items-center"},da=s({__name:"index",setup(e){const t=q(),{getOverview:a}=ta(),{isFree:l}=v(t),i=()=>{Je({source:324})},n=()=>{a()},s=()=>{a()};return(e,t)=>{const a=dt;return r(),d("div",ia,[p("div",na,[p("div",sa,[u(lt,{value:y(Zt),"onUpdate:value":[t[0]||(t[0]=e=>f(Zt)?Zt.value=e:null),n]},null,8,["value"])]),y(l)?(r(),d("div",oa,[t[4]||(t[4]=p("span",{class:"mr-8px"},"Upgrade to Pro Edition to unlock all reports immediately",-1)),u(a,{type:"primary",size:"small",ghost:"",onClick:i},{default:c((()=>t[3]||(t[3]=[_("Upgrade Now")]))),_:1})])):h("",!0)]),p("div",ra,[u(la,{type:y(ea).type,"onUpdate:type":t[1]||(t[1]=e=>y(ea).type=e),value:y(ea).data,"onUpdate:value":[t[2]||(t[2]=e=>y(ea).data=e),s]},null,8,["type","value"])])])}}}),ua={class:"rate-box"},ca={class:"rate-list"},pa={class:"rate-text"},ma={class:"rate-list"},va={class:"rate-text"},ya={class:"rate-list"},fa={class:"rate-text"},_a={class:"rate-list"},ha={class:"rate-text"},ga=K(s({__name:"index",setup(e){const{onResult:t,getRate:a}=ta(),l=g({delivery:0,open:0,click:0,bounce:0});return t((e=>{l.delivery=e.dashboard.delivery_rate,l.open=e.dashboard.open_rate,l.click=e.dashboard.click_rate,l.bounce=e.dashboard.bounce_rate})),(e,t)=>(r(),d("div",ua,[p("div",ca,[t[0]||(t[0]=p("div",{class:"rate-title"},"Delivered",-1)),p("div",pa,b(`${y(l).delivery}%`),1)]),p("div",ma,[t[1]||(t[1]=p("div",{class:"rate-title"},"Open",-1)),p("div",va,b(y(a)(y(l).open)),1)]),p("div",ya,[t[2]||(t[2]=p("div",{class:"rate-title"},"Click",-1)),p("div",fa,b(y(a)(y(l).click)),1)]),p("div",_a,[t[3]||(t[3]=p("div",{class:"rate-title"},"Bounce",-1)),p("div",ha,b(y(a)(y(l).bounce)),1)])]))}}),[["__scopeId","data-v-6ec46142"]]),ba=K(s({__name:"index",setup(e){const{getRate:t,onResult:a}=ta(),{table:l,columns:i}=Ve([{key:"mail_provider",title:"Mail Provider",ellipsis:{tooltip:!0}},{key:"delivery_rate",title:"Delivered",render:e=>t(e.delivery_rate)},{key:"open_rate",title:"Open",render:e=>t(e.open_rate)},{key:"click_rate",title:"Click",render:e=>t(e.click_rate)},{key:"bounce_rate",title:"Bounce",render:e=>t(e.bounce_rate)}]);return a((e=>{l.data=e.mail_providers})),(e,t)=>{const a=Mt;return r(),x(a,{"min-height":268,"max-height":268,bordered:!1,loading:y(Xt),data:y(l).data,columns:y(i)},null,8,["loading","data","columns"])}}}),[["__scopeId","data-v-3bfb2bbb"]]),xa={class:"p-20px"},wa=s({__name:"error",setup(e){const{t:t}=w(),{getParams:a}=ta(),{loading:l,setLoading:i}=Qe(),{table:n,columns:s}=Ve([{key:"recipient",title:t("Mail.Mass.index_50"),width:160,render:e=>u(ut,{class:e.tooltip?"":"break-all!","line-clamp":e.tooltip?999:1,tooltip:!1},{default:()=>[e.recipient]})},{key:"dsn",title:"Dsn",width:60},{key:"delay",title:t("Mail.Mass.index_51"),width:70},{key:"delays",title:t("Mail.Mass.index_52"),width:150},{key:"status",title:t("Public.Table.Status"),width:100,ellipsis:{tooltip:!0},render:e=>e.status},{key:"relay",title:t("Mail.Mass.index_53"),width:200,render:e=>u(ut,{class:e.tooltip?"":"break-all!","line-clamp":e.tooltip?9999:1,tooltip:!1},{default:()=>[e.relay]})},{key:"description",title:t("Public.Btn.Details"),render:e=>u(ut,{class:e.tooltip?"":"break-all!","line-clamp":e.tooltip?9999:1,tooltip:!1},{default:()=>[e.description]})}]),o=e=>({onMousemove:()=>{e.tooltip=!0},onMouseleave:()=>{e.tooltip=!1}});return(async()=>{try{i(!0);const e=a(),{message:t}=await $t({...e.domain?{domain:e.domain}:{},start:e.start_time,end:e.end_time});n.data=J(t)?t.map((e=>({...e,tooltip:!1}))):[]}finally{i(!1)}})(),(e,t)=>{const a=Mt,i=Ut;return r(),d("div",xa,[u(i,null,{table:c((()=>[u(a,{"max-height":600,loading:y(l),data:y(n).data,columns:y(s),"row-props":o},null,8,["loading","data","columns"])])),_:1})])}}}),ka={class:"total-list"},Ma={class:"total-item"},Ca={class:"total-label"},Ua={class:"total-value text-primary text-22px"},$a={class:"total-item"},Pa={class:"total-label"},Ra={class:"total-value text-17px"},ja={class:"total-item"},Sa={class:"total-label"},Ea={class:"total-value text-17px"},Ta=K(s({__name:"index",setup(e){const{t:t}=w(),{onResult:a,getChartTime:l,getOverview:n}=ta(),s=k("chartRef"),o=i({delivered:0,delivery_rate:0,failed:0,failure_rate:0,sends:0}),v=()=>{Ye({title:t("Mail.Overview.today_9"),width:980,component:wa})},f=M({tooltip:{trigger:"axis",order:"seriesDesc",axisPointer:{type:"shadow"}},legend:{top:0,itemGap:16,icon:"circle",itemWidth:10,itemHeight:10,data:[t("Mail.Overview.today_2"),t("Mail.Overview.today_3")],textStyle:{lineHeight:12,padding:[0,0,-2,0],rich:{a:{verticalAlign:"middle"}}}},grid:{top:"16%",left:"2%",right:"2%",bottom:"4%",containLabel:!0},yAxis:{type:"value",boundaryGap:[0,"6%"],splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:"#ebeef5"}}},xAxis:h(),series:[{type:"bar",name:t("Mail.Overview.today_3"),data:[]},{type:"bar",name:t("Mail.Overview.today_2"),data:[]}]});function h(e="HH:mm"){return{type:"category",axisLabel:{formatter:t=>W(t,e)}}}return a((e=>{e.send_mail_chart&&(o.value=e.send_mail_chart.dashboard,(e=>{const a=[],i=[];e.data.forEach((t=>{a.push([l(e.column_type,t.x),t.failed,e.column_type]),i.push([l(e.column_type,t.x),t.delivered,e.column_type])})),f.series=[{type:"bar",name:t("Mail.Overview.today_3"),data:a,stack:"total",itemStyle:{color:"#1A519B"}},{type:"bar",name:t("Mail.Overview.today_2"),data:i,stack:"total",itemStyle:{color:"#91CC75"}}],f.xAxis=h("hourly"===e.column_type?"HH:mm":"yyyy-MM-dd")})(e.send_mail_chart))})),C((()=>{setTimeout((()=>{s.value&&s.value.getChart().on("click",(e=>{if("bar"===e.componentSubType&&J(e.value)&&"daily"===e.value[2]){const t=new Date(e.value[0]);ea.value.type="custom",ea.value.data=[nt(t).getTime(),st(t).getTime()],n()}}))}),1e3)})),(e,t)=>{const a=V,l=Q;return r(),d(m,null,[t[0]||(t[0]=p("div",{class:"mb-16px font-bold text-16px text-default"},"Send today",-1)),p("div",ka,[p("div",Ma,[p("div",Ca,b(e.$t("Mail.Overview.today_1")),1),p("div",Ua,b(y(o).delivery_rate)+"%",1)]),p("div",$a,[p("div",Pa,b(e.$t("Mail.Overview.today_2")),1),p("div",Ra,b(y(o).delivered),1)]),p("div",ja,[p("div",Sa,[_(b(e.$t("Mail.Overview.today_3"))+" ",1),u(a,{class:"ml-4px",onClick:v},{default:c((()=>[_(b(e.$t("Public.Btn.Details")),1)])),_:1})]),p("div",Ea,[u(a,{class:"text-17px!",onClick:v},{default:c((()=>[_(b(y(o).failed),1)])),_:1})])])]),u(l,{class:"w-100% h-200px",show:y(Xt)},{default:c((()=>[u(Ct,{ref_key:"chartRef",ref:s,type:"bar",height:"200",option:y(f)},null,8,["option"])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-1d6a0b1a"]]),Da=s({name:"AuthBox",setup(e,{slots:t}){const a=q(),{isFree:l}=v(a);return()=>u(m,null,[l.value?u("div",{class:"text-14px color-desc"},[_("Pro Edition Exclusive Features")]):t.default?.()])}}),Ba={class:"flex-center h-200px"},za=s({__name:"unique",setup(e){const{onResult:t,getChartTime:a}=ta(),l=M({tooltip:{trigger:"axis",order:"seriesDesc",axisPointer:{type:"shadow"}},grid:{top:"16%",left:"2%",right:"2%",bottom:"2%",containLabel:!0},yAxis:{type:"value",splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:"#ebeef5"}},name:"%",max:({max:e})=>e>100?100:e},xAxis:i(),series:n()});function i(e="HH:mm"){return{type:"category",axisLabel:{formatter:t=>W(t,e)}}}function n(e=[]){return[{name:"Unique Open Rate",type:"line",data:e,itemStyle:{color:"#1a519b"},smooth:!1,showSymbol:!1,sampling:"average"}]}return t((e=>{const{open_rate_chart:t}=e;if(t){const e=t.data.map((e=>[a(t.column_type,e.x),e.open_rate]));l.series=n(e),l.xAxis=i("hourly"===t.column_type?"HH:mm":"yyyy-MM-dd")}})),(e,t)=>{const a=Q;return r(),d(m,null,[t[0]||(t[0]=p("div",{class:"mb-16px font-bold text-16px text-default"},"Unique Open Rate %",-1)),p("div",Ba,[u(y(Da),null,{default:c((()=>[u(a,{class:"w-100%",show:y(Xt)},{default:c((()=>[u(Ct,{height:200,option:y(l)},null,8,["option"])])),_:1},8,["show"])])),_:1})])],64)}}}),La={class:"flex-center h-200px"},Aa=s({__name:"click",setup(e){const{onResult:t,getChartTime:a}=ta(),l=M({tooltip:{trigger:"axis",order:"seriesDesc",axisPointer:{type:"shadow"}},grid:{top:"16%",left:"2%",right:"2%",bottom:"2%",containLabel:!0},yAxis:{name:"%",type:"value",boundaryGap:[0,"6%"],splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:"#ebeef5"}},max:({max:e})=>e>100?100:e},xAxis:i(),series:n()});function i(e="HH:mm"){return{type:"category",axisLabel:{formatter:t=>W(t,e)}}}function n(e=[]){return[{name:"Click Rate",type:"line",data:e,itemStyle:{color:"#1a519b"},smooth:!1,showSymbol:!1,sampling:"average"}]}return t((e=>{const{click_rate_chart:t}=e;if(t){const e=t.data.map((e=>[a(t.column_type,e.x),e.click_rate]));l.series=n(e),l.xAxis=i("hourly"===t.column_type?"HH:mm":"yyyy-MM-dd")}})),(e,t)=>{const a=Q;return r(),d(m,null,[t[0]||(t[0]=p("div",{class:"mb-16px font-bold text-16px text-default"},"Click Rate %",-1)),p("div",La,[u(y(Da),null,{default:c((()=>[u(a,{class:"w-100%",show:y(Xt)},{default:c((()=>[u(Ct,{height:200,option:y(l)},null,8,["option"])])),_:1},8,["show"])])),_:1})])],64)}}}),Ha={class:"flex-center h-200px"},Oa=s({__name:"bounce",setup(e){const{onResult:t,getChartTime:a}=ta(),l=M({tooltip:{trigger:"axis",order:"seriesDesc",axisPointer:{type:"shadow"}},grid:{top:"16%",left:"2%",right:"2%",bottom:"2%",containLabel:!0},yAxis:{name:"%",type:"value",splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:"#ebeef5"}},max:({max:e})=>e>100?100:e},xAxis:i(),series:n()});function i(e="HH:mm"){return{type:"category",axisLabel:{formatter:t=>W(t,e)}}}function n(e=[]){return[{name:"Bounce Rate",type:"line",data:e,itemStyle:{color:"#20a53a"},smooth:!1,showSymbol:!1,sampling:"average"}]}return t((e=>{const{bounce_rate_chart:t}=e;if(t){const e=t.data.map((e=>[a(t.column_type,e.x),e.bounce_rate]));l.series=n(e),l.xAxis=i("hourly"===t.column_type?"HH:mm":"yyyy-MM-dd")}})),(e,t)=>{const a=Q;return r(),d(m,null,[t[0]||(t[0]=p("div",{class:"mb-16px font-bold text-16px text-default"},"Bounce Rate %",-1)),p("div",Ha,[u(y(Da),null,{default:c((()=>[u(a,{class:"w-100%",show:y(Xt)},{default:c((()=>[u(Ct,{height:200,option:y(l)},null,8,["option"])])),_:1},8,["show"])])),_:1})])],64)}}}),Ga={class:"overview-card"},Ia={class:"overview-card"},Na={class:"overview-card"},Wa={class:"overview-card"},Fa={class:"overview-card"},qa=K(s({__name:"index",setup(e){const{getOverview:t}=ta();return t(),(e,t)=>{const a=ct,l=Y;return r(),d("div",null,[u(da),u(ga),u(l,{class:"mt-16px","x-gap":"16","y-gap":"16",cols:2},{default:c((()=>[u(a,null,{default:c((()=>[p("div",Ga,[u(ba)])])),_:1}),u(a,null,{default:c((()=>[p("div",Ia,[u(Ta)])])),_:1}),u(a,null,{default:c((()=>[p("div",Na,[u(za)])])),_:1}),u(a,null,{default:c((()=>[p("div",Wa,[u(Aa)])])),_:1}),u(a,null,{default:c((()=>[p("div",Fa,[u(Oa)])])),_:1})])),_:1})])}}}),[["__scopeId","data-v-5777b7d2"]]),Ka=s({__name:"template",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e,{expose:t}){const a=o(e,"value"),l=i([]),{loading:n,setLoading:s}=Qe(),d=async()=>{try{s(!0);const{message:e}=await oe();J(e)&&e.length>0&&(l.value=e.map((e=>({label:e.name,value:e.id}))),a.value||(a.value=e[0].id))}finally{s(!1)}};return d(),t({getList:d}),(e,t)=>{const i=pt;return r(),x(i,{value:a.value,"onUpdate:value":t[0]||(t[0]=e=>a.value=e),loading:y(n),filterable:!0,options:y(l)},null,8,["value","loading","options"])}}}),Ja={class:"w-170px mr-10px"},Va={class:"w-180px"},Qa=s({__name:"sender",props:{value:{},valueModifiers:{}},emits:R(["change"],["update:value"]),setup(e,{emit:t}){const a=t,l=i(null),n=o(e,"value"),s=i([]),c=P((()=>v.value.filter((e=>e.domain===l.value)).map((e=>({data:e,label:e.username,value:e.username}))))),v=i([]),_=(e,t)=>{const{data:l}=t;N(l)&&a("change",l.full_name)},h=i(!1),g=i(!1),b=async()=>{try{h.value=!0;const{message:e}=await Pt();J(e)&&(s.value=e.map((e=>({label:e,value:e}))),l.value=e[0]||null)}finally{h.value=!1}},x=async()=>{try{g.value=!0;const{message:e}=await Rt();J(e)&&e.length>0&&(v.value=e)}finally{g.value=!1}},w=()=>{if(c.value[0]){const{data:e}=c.value[0];n.value=`${c.value[0].value}`,N(e)&&a("change",e.full_name)}else n.value=null,a("change","")},k=()=>{w()};return(async()=>{if(await Promise.all([b(),x()]),n.value){for(const e of v.value)if(e.username===n.value){l.value=e.domain;break}}else w()})(),(e,t)=>{const a=pt;return r(),d(m,null,[p("div",Ja,[u(a,{value:y(l),"onUpdate:value":[t[0]||(t[0]=e=>f(l)?l.value=e:null),k],loading:y(h),options:y(s)},null,8,["value","loading","options"])]),p("div",Va,[u(a,{value:n.value,"onUpdate:value":[t[1]||(t[1]=e=>n.value=e),_],loading:y(g),options:y(c)},null,8,["value","loading","options"])])],64)}}}),Ya={class:"flex items-center mb-8px"},Xa={class:"ml-40px"},Za=s({__name:"import",props:R({path:{default:""},accept:{default:()=>[]}},{value:{},valueModifiers:{}}),emits:["update:value"],setup(e){const t=e,{path:a,accept:l}=t,i=o(e,"value"),n=()=>{Ot({path:a,size:5,uploadData:{accept:l.map((e=>`.${e}`)).join(","),multiple:!1},onUploadSuccess:e=>{i.value=e[0].name}})};return(e,t)=>{const a=dt;return r(),d("div",null,[p("div",Ya,[u(a,{onClick:n},{default:c((()=>[_(b(e.$t("Public.Btn.Import")),1)])),_:1}),p("div",Xa,[_(b(e.$t("Mail.Mass.index_43"))+" ",1),p("span",{class:j(i.value?"text-primary":"text-error")},b(i.value||e.$t("Mail.Mass.index_44")),3)])]),S(e.$slots,"default")])}}}),el={class:"p-20px"},tl={class:"w-250px"},al=s({__name:"type-create",props:{refresh:{}},setup(e,{expose:t}){const a=e,{refresh:l}=a,n=i(null),s=g({mail_type:"",file:""}),o={mail_type:{required:!0,message:"Please enter group name",trigger:["blur","input"]},file:{required:!0,message:"Please upload file",trigger:["blur","change"]}},m=()=>{X("/www/server/panel/plugin/mail_sys/data/example_recipients.txt")};return t({onConfirm:async()=>{await(n.value?.validate()),await jt({...s}),l?.()}}),(e,t)=>{const a=mt,l=vt,i=At,v=V,f=Ht;return r(),d("div",el,[u(i,{ref_key:"formRef",ref:n,model:y(s),rules:o},{default:c((()=>[u(l,{label:"Group name",path:"mail_type"},{default:c((()=>[p("div",tl,[u(a,{type:"text",value:y(s).mail_type,"onUpdate:value":t[0]||(t[0]=e=>y(s).mail_type=e),placeholder:"Please enter group name"},null,8,["value"])])])),_:1}),u(l,{label:"Emails",path:"file"},{default:c((()=>[u(Za,{value:y(s).file,"onUpdate:value":t[1]||(t[1]=e=>y(s).file=e),path:"/www/server/panel/data/mail/in_bulk/recipient",accept:["txt","json"]},null,8,["value"])])),_:1})])),_:1},8,["model"]),u(f,{class:"mt-4px"},{default:c((()=>[p("li",null,[t[3]||(t[3]=_(" File type:txt/json One mailbox per line Not more than 5 MB ")),u(v,{target:"_blank",onClick:m},{default:c((()=>t[2]||(t[2]=[_("Download the template")]))),_:1})])])),_:1})])}}}),ll={class:"flex-1"},il={class:"flex items-center"},nl={class:"w-260px"},sl={class:"ml-10px"},ol={class:"mt-8px"},rl=s({__name:"type",props:{value:{},valueModifiers:{},name:{},nameModifiers:{}},emits:["update:value","update:name"],setup(e,{expose:t}){const a=o(e,"value"),l=o(e,"name"),n=i([]),s=i([]),m=i(0),{loading:v,setLoading:f}=Qe(),h=async()=>{try{f(!0);const{message:e}=await re();J(e)&&(s.value=e,n.value=e.map((e=>({label:e.mail_type,value:e.id}))))}finally{f(!1)}},g=async e=>{l.value=s.value.filter((t=>e.includes(t.id))).map((e=>e.mail_type));const{message:t}=await de({etypes:e.join(",")});N(t)&&(m.value=t.result)},x=()=>{Ye({title:"Create New Group",width:480,footer:!0,data:{refresh:h},component:al})};return h(),t({getType:h}),(e,t)=>{const l=pt,i=V;return r(),d("div",ll,[p("div",il,[p("div",nl,[u(l,{value:a.value,"onUpdate:value":[t[0]||(t[0]=e=>a.value=e),g],options:y(n),multiple:!0,filterable:!0,loading:y(v),placeholder:"Please select recipients with groups"},null,8,["value","options","loading"])]),p("div",sl,[u(i,{onClick:x},{default:c((()=>t[1]||(t[1]=[_("Create")]))),_:1})])]),p("div",ol,[t[2]||(t[2]=_("Send Emails (")),p("b",null,b(y(m)),1),t[3]||(t[3]=_(" Recipients)"))])])}}});var dl=e("D",(e=>(e.Columns="columns",e.Button="button",e.Divider="divider",e.Header="header",e.Text="text",e.Image="image",e.Menu="menu",e.Html="html",e.commonComp="commonComp",e))(dl||{}));e("d",["button","divider","header","text","image","menu","html","commonComp"]);const ul={comp_type:{button:()=>Rl}};function cl(){const e=Object.keys(ul.comp_type);Object.entries(_l.value).forEach((([,t])=>{e.includes(t.type)&&Object.entries(bl.value).forEach((([e,a])=>{if(e===t.key){const e=ul.comp_type[t.type]();a.style=yt(a.style,e)}}))}))}e("n",i(!1));const pl=e("o",i("")),ml=e("m",i(""));e("q",i("")),i("bottom"),e("v",i(""));const vl=e("B",i([])),yl=e("p",i({})),fl=e("c",i({})),_l=e("k",i({})),hl=e("s",i({})),gl=e("w",i({})),bl=e("j",i({})),xl=i({}),wl=e("x",i({backgroundColor:"#ffffff",maxWidth:"500px"})),kl=e("e",i()),Ml=e("J",P((()=>({version:1.4,columns_source:vl.value,column_map:yl.value,cell_map:fl.value,cell_style_map:hl.value,column_row_style_map:gl.value,comp_style_map:bl.value,compOptions:xl.value,comp_map:_l.value,page_style:wl.value})))),Cl=i(!0),Ul=e("G",i((async()=>!1))),$l=(e("a",i([{type:"columns",name:"Columns",key:"0",children:[]},{type:"button",name:"Button",key:"0"},{type:"divider",name:"Divider",key:"0"},{type:"header",name:"Header",key:"0"},{type:"text",name:"Text",key:"0"},{type:"image",name:"Image",key:"0"},{type:"menu",name:"Menu",key:"0"}])),{style:{background:"transparent",textAlign:"center",padding:{more:!1,all:"0px",top:"",right:"",bottom:"",left:""},border:{more:!1,all:"0px",top:"",right:"",bottom:"",left:""}}}),Pl={style:{backgroundColor:"transparent",padding:{more:!1,all:"0px",top:"",right:"",bottom:"",left:""}}},Rl={border:{more:!1,all:"",top:"",right:"",bottom:"",left:""},padding:{more:!0,all:"",top:"10px",left:"20px",right:"20px",bottom:"10px"},borderRadius:{more:!1,all:"4px",top:"",left:"",right:"",bottom:""},width:"auto",lineHeight:"120%",color:"#ffffff",display:"inline-block",backgroundColor:"#3AAEE0",FontWeight:"normal",fontSize:"14px",textAlign:"center",LetterSpacing:"0px"},jl={button:{style:Rl,general:{textAlign:"center",padding:{more:!1,all:"10px",top:"",left:"",right:"",bottom:""}},info:{href:"",target:"_blank"},content:"Button"},divider:{style:{borderTop:"1px solid #bbbbbb",width:"100%",display:"inline-block",lineHeight:"1px",height:"0px",verticalAlign:"middle"},general:{textAlign:"center",padding:{more:!1,all:"10px",top:"",left:"",right:"",bottom:""}},info:{}},header:{style:{position:"relative",display:"block",lineHeight:"140%",fontWeight:"normal",fontSize:"22px",letterSpacing:"0px",color:"#333333"},general:{textAlign:"left",padding:{more:!1,all:"10px",top:"",left:"",right:"",bottom:""}},info:{},content:"Header"},text:{style:{fontSize:"14px",fontWeight:"normal",color:"#333",textAlign:"left",lineHeight:"140%",letterSpacing:"0px"},general:{padding:{more:!1,all:"10px",top:"",left:"",right:"",bottom:""}},info:{},content:"Text"},image:{style:{display:"inline-block",width:"100%"},general:{textAlign:"center",padding:{more:!1,all:"10px",top:"",left:"",right:"",bottom:""}},info:{href:"",target:"_blank",src:"",alt:""}},menu:{style:{fontWeight:"normal",fontSize:"14px",letterSpacing:"0px",color:"#444444",linkColor:"#0068A5",padding:{more:!0,all:"",top:"5px",left:"15px",right:"15px",bottom:"5px"}},general:{textAlign:"center",padding:{more:!1,all:"10px",top:"",left:"",right:"",bottom:""}},info:{layout:"horizontal"},links:[{id:Zl(6),label:"Menu",href:""},{id:Zl(6),label:"Menu",href:""}]}},Sl=e("t",{events:{makeDom:[function(){let e=null;return()=>{clearTimeout(e),e=setTimeout((()=>{kl.value=Dl().outerHTML,El()}),300)}}()]},$emit(e,t){this.events[e]&&this.events[e].forEach((e=>e(t)))}}),El=function(){let e=null;return()=>{Cl.value&&(Cl.value=!1,clearTimeout(e),e=setTimeout((async()=>{await Ul.value(),Cl.value=!0}),1e3))}}();function Tl(){const e=function(){const e={};for(const t in _l.value){const a=document.createElement("div");Bl(a,bl.value[t]);let l=null;switch(_l.value[t].type){case"button":l=document.createElement("a"),zl(l,bl.value[t]);break;case"divider":l=document.createElement("div"),Ll(l,bl.value[t]);break;case"header":l=document.createElement("div"),Al(l,bl.value[t]);break;case"text":l=document.createElement("div"),Hl(l,bl.value[t]);break;case"image":if(bl.value[t].info?.href){l=document.createElement("a"),l.href=bl.value[t].info?.href,l.target=bl.value[t].info?.target;const e=document.createElement("img");e.src=bl.value[t].info?.src||"",e.alt=bl.value[t].info?.alt||"",e.style.display="block",e.style.width="100%",l.appendChild(e)}else l=document.createElement("img"),l.src=bl.value[t].info?.src||"",l.alt=bl.value[t].info?.alt||"";Ol(l,bl.value[t]);break;case"menu":l=document.createElement("div"),Gl(l,bl.value[t])}l&&a.appendChild(l),e[t]={dom:a,general:{},info:bl.value[t].info}}return e}(),t={};for(const a in fl.value){const l=document.createElement("td");l.style.width=fl.value[a].width,Nl(l,hl.value[a]),fl.value[a].children.forEach((t=>{if(e[t]){l.appendChild(e[t].dom);for(const a in e[t].general)l.style[a]=e[t].general[a]}})),t[a]={dom:l}}return t}function Dl(){const e=function(){const e=Tl(),t={};for(const a in yl.value){const l=document.createElement("tr"),i=document.createElement("td"),n=document.createElement("div");Il(n,gl.value[a]);const s=document.createElement("table");s.style.width="100%";const o=document.createElement("tr");yl.value[a].children.forEach((t=>{o.appendChild(e[t].dom)})),s.appendChild(o),n.appendChild(s),i.appendChild(n),l.appendChild(i),t[a]={dom:l}}return t}(),t=document.createElement("table");t.setAttribute("width",wl.value.maxWidth),t.style.margin="0 auto",t.style.backgroundColor=wl.value.backgroundColor;for(const a of vl.value)t.appendChild(e[a].dom);return t}function Bl(e,t){const a=ti(t,"general");a&&Object.entries(a).forEach((([t,a])=>{e.style[t]=a}))}function zl(e,t){const a=ti(t),l=ti(t,"general");for(const n in a)e.style[n]=a[n];e.innerText=t.content;const{info:i}=t;return i&&(e.href=i.href,e.target=i.target),{generalStyle:l}}function Ll(e,t){const a=ti(t),l=ti(t,"general");for(const i in a)e.style[i]=a[i];return{generalStyle:l}}function Al(e,t){const a=ti(t),l=ti(t,"general");for(const i in a)e.style[i]=a[i];return e.innerText=t.content,{generalStyle:l}}function Hl(e,t){const a=ti(t),l=ti(t,"general");for(const i in a)e.style[i]=a[i];return e.innerText=t.content,{generalStyle:l}}function Ol(e,t){const a=ti(t);for(const l in a)e.style[l]=a[l]}function Gl(e,t){const{links:a,info:l}=t;a.forEach((a=>{const i=document.createElement("a");!function(e,t){const a=ti(t);for(const l in a)e.style[l]=a[l]}(i,t),i.style.display="vertical"===l?.layout?"block":"inline-block",i.href=a.href,i.target="_blank",i.innerText=a.label,e.appendChild(i)}))}function Il(e,t){const a=ti(t);for(const l in a)e.style[l]=a[l]}function Nl(e,t){const a=ti(t);for(const l in a)e.style[l]=a[l]}function Wl(e,t){yl.value[e].children.push(t),Fl(t),Sl.$emit("makeDom")}function Fl(e){fl.value[e]={width:"100%",key:e,children:[]},function(e){hl.value[e]=ft($l)}(e),Sl.$emit("makeDom")}function ql(e,t){_l.value[e]={key:e,type:t},Kl(e,t),Sl.$emit("makeDom")}function Kl(e,t){bl.value[e]=ft(jl[t]),Sl.$emit("makeDom")}function Jl(e,t){!function(e){delete bl.value[e],Sl.$emit("makeDom")}(e),delete _l.value[e],fl.value[t].children=fl.value[t].children.filter((t=>t!==e)),Sl.$emit("makeDom")}function Vl(e,t){fl.value[e].children.forEach((t=>{Jl(t,e)})),delete fl.value[e],yl.value[t].children=yl.value[t].children.filter((t=>t!==e)),Sl.$emit("makeDom")}function Ql(e,t){const a=yl.value[t].children;if(a.length<e.length){const l=e.length-a.length;for(let e=0;e<l;e++){const e=Zl();Wl(t,e)}}else a.splice(e.length).forEach((e=>{Vl(e,t)}));a.forEach(((t,a)=>{fl.value[t].width=e[a]+"%"})),Sl.$emit("makeDom")}function Yl(e){const t=JSON.parse(e);xl.value=t.compOptions,hl.value=t.cell_style_map,gl.value=t.column_row_style_map,yl.value=t.column_map,_l.value=t.comp_map,fl.value=t.cell_map,bl.value=t.comp_style_map,vl.value=t.columns_source,t.page_style&&(wl.value=t.page_style)}function Xl(e){if(e)return 1.4!==JSON.parse(e).version?(Yl(e),cl(),{content:Dl().outerHTML,render:Ml.value}):null}function Zl(e=10){return Math.random().toString(16).slice(2,2+e)}function ei(e,t){let a="",l="",i="",n="",s="";return"border"==t&&(a="border",l="borderTop",i="borderRight",n="borderBottom",s="borderLeft"),"padding"==t&&(a="padding",l="paddingTop",i="paddingRight",n="paddingBottom",s="paddingLeft"),"borderRadius"==t&&(a="borderRadius",l="borderTopLeftRadius",i="borderTopRightRadius",n="borderBottomRightRadius",s="borderBottomLeftRadius"),e.more?{[l]:e.top,[i]:e.right,[n]:e.bottom,[s]:e.left}:{[a]:e.all}}function ti(e,t="style"){if(!e)return;const a={};for(const i in e[t])"border"==(l=i)||"padding"==l||"borderRadius"==l?Object.assign(a,ei(e[t][i],i)):a[i]=e[t][i];var l;return a}const ai=["innerHTML"],li=s({__name:"preview",props:{id:{}},setup(e){const t=E(e,"id"),a=i(""),l=async()=>{if(!t.value)return;const{message:e}=await ue({id:t.value});if(N(e)){const l=Xl(e.render);l&&1===e.type?(a.value=l.content,await ce({id:t.value,type:e.type,temp_name:e.name,render:JSON.stringify(l.render),content:l.content},!1)):a.value=e.content}};return U((()=>t.value),(()=>{l()})),l(),(e,t)=>(r(),d("div",{class:"flex-1 min-w-520px overflow-auto border-#ebebeb border-1 border-solid rounded-4px p-12px",innerHTML:y(a)},null,8,ai))}}),ii={class:"mb-12px font-bold text-15px text-default leading-28px"},ni={class:"flex flex-col w-550px"},si={class:"form-card mb-16px pt-20px"},oi={class:"w-360px"},ri={class:"w-360px"},di={class:"w-260px"},ui={class:"w-60px ml-24px"},ci={class:"form-card flex-1 py-20px"},pi={class:"w-360px"},mi={class:"flex w-360px"},vi={class:"flex-1 mr-10px"},yi={class:"form-card flex flex-col items-center w-640px ml-16px pt-12px p-16px overflow-hidden"},fi={class:"mb-12px"},_i={class:"min-w-260px"},hi={class:"min-w-260px"},gi={class:"min-w-260px"},bi={class:"mt-16px"},xi=s({__name:"index",props:R({row:{},isEdit:{type:Boolean,default:!1},refresh:{type:Function,default:()=>{}}},{show:{type:Boolean},showModifiers:{}}),emits:["update:show"],setup(e){const a=e,{t:l}=w(),{refresh:n}=a,s=o(e,"show"),d=q(),m=k("formRef"),h=k("containerRef"),{height:M}=function(e){const t=i(0),{mainHeight:a,footerHeight:l}=v(q());return U((()=>a.value),(a=>{$((()=>{if(!e.value)return;const{top:i}=e.value.getBoundingClientRect();t.value=a-i-16-16-l.value}))}),{immediate:!0}),{height:P((()=>0===t.value?"auto":t.value+"px"))}}(h),C=g({task_name:Z(12),addresser:null,full_name:"",subject:"",temp_id:Jt.value,is_record:0,etypes:[],unsubscribe:1,threadsType:0,threads:1,start_time:null,pause:0,remark:"",mail_to:""}),R=i([]),j={full_name:{trigger:["blur","input"],validator:()=>""!==C.full_name||new Error("Please enter display name")},subject:{trigger:["blur","input"],validator:()=>""!==C.subject||new Error("Please enter mail subject")},etypes:{trigger:"change",validator:()=>0!==C.etypes.length||new Error("Please select contact person")},start_time:{validator:()=>1!==C.pause||null!==C.start_time||new Error("Please select send time")}},S=e=>{C.full_name=e||""},E=k("startTimeRef"),A=()=>{$((()=>{E.value?.restoreValidation()}))},H=()=>{E.value?.validate()},O=()=>{Ye({title:l("Mail.Mass.index_54"),width:450,minHeight:196,component:L((()=>ee((()=>t.import("./unsubscribe-legacy.js?v=1741416570306")),void 0)))})},G=()=>{Ye({title:l("Mail.Mass.index_42"),width:554,minHeight:604,content:()=>u("img",{src:"/static/vite/images/unsubscribe.png"},[_(" ")])})},I=k("subjectRef"),N=k("mailToRef"),W=async()=>{if(!d.isFree)return""===C.subject?(I.value?.focus(),void te.error("Please enter mail subject")):""===C.mail_to?(N.value?.focus(),void te.error("Please enter test email")):void(await pe({mail_from:C.addresser||"",subject:C.subject,mail_to:C.mail_to,temp_id:C.temp_id||0}));Je({source:325})},K=()=>{C.subject||C.etypes.length>0?Xe({title:"Tips",content:"Do you want to discard your current edits?",onConfirm:()=>{s.value=!1}}):s.value=!1},J=async()=>{if(d.isFree)return Je({source:326}),!1;await(m.value?.validate());const e={task_name:C.task_name,addresser:C.addresser||"",full_name:C.full_name,subject:C.subject,temp_id:C.temp_id||0,is_record:C.is_record,unsubscribe:C.unsubscribe,threads:0===C.threadsType?0:C.threads,etypes:C.etypes.join(","),start_time:0===C.pause?Math.floor((new Date).getTime()/1e3):Math.floor((C.start_time||0)/1e3),remark:C.remark},{isEdit:t,row:l}=a;t&&l?await me({...e,id:l.id}):await ve(e),s.value=!1,n?.()};return T((()=>{Jt.value=null,Vt.value=!1})),(()=>{const{row:e,isEdit:t}=a;e&&(C.task_name=t?e.task_name:`${e.task_name}_${Z(4)}`,C.addresser=e.addresser,C.full_name=e.full_name,C.subject=e.subject,C.is_record=e.is_record,C.unsubscribe=e.unsubscribe,C.threadsType=0===e.threads?0:1,C.threads=e.threads,C.etypes=e.etypes.split(",").map((e=>ae(e))),1e3*e.start_time>(new Date).getTime()&&(C.pause=1,C.start_time=1e3*e.start_time),C.temp_id=e.temp_id,C.remark=e.remark)})(),(e,t)=>{const a=vt,l=mt,i=_t,n=dt,s=V,o=ht,d=rt,v=gt,g=F,w=At;return r(),x(w,{ref_key:"formRef",ref:m,"label-width":"150",model:y(C),rules:j},{default:c((()=>[p("div",ii,b(e.isEdit?e.$t("Mail.Mass.index_67"):e.$t("Mail.Mass.index_1")),1),p("div",{ref_key:"containerRef",ref:h,class:"flex min-h-654px",style:D({height:y(M)})},[p("div",ni,[p("div",si,[u(a,{label:"From",path:"addresser"},{default:c((()=>[u(Qa,{value:y(C).addresser,"onUpdate:value":t[0]||(t[0]=e=>y(C).addresser=e),onChange:S},null,8,["value"])])),_:1}),u(a,{label:"Display Name",path:"full_name"},{default:c((()=>[p("div",oi,[u(l,{value:y(C).full_name,"onUpdate:value":t[1]||(t[1]=e=>y(C).full_name=e),placeholder:"Please enter display Name"},null,8,["value"])])])),_:1}),u(a,{label:"Subject",path:"subject"},{default:c((()=>[p("div",ri,[u(l,{ref_key:"subjectRef",ref:I,value:y(C).subject,"onUpdate:value":t[2]||(t[2]=e=>y(C).subject=e),placeholder:"Please enter mail subject"},null,8,["value"])])])),_:1}),u(a,{label:"Recipients",type:"etypes"},{default:c((()=>[u(rl,{value:y(C).etypes,"onUpdate:value":t[3]||(t[3]=e=>y(C).etypes=e),name:y(R),"onUpdate:name":t[4]||(t[4]=e=>f(R)?R.value=e:null)},null,8,["value","name"])])),_:1}),u(a,{label:"Email template"},{default:c((()=>[p("div",di,[u(Ka,{value:y(C).temp_id,"onUpdate:value":t[5]||(t[5]=e=>y(C).temp_id=e)},null,8,["value"])])])),_:1}),u(a,{label:e.$t("Mail.Mass.index_30")},{default:c((()=>[u(i,{value:y(C).is_record,"onUpdate:value":t[6]||(t[6]=e=>y(C).is_record=e),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1},8,["label"]),u(a,{label:e.$t("Mail.Mass.index_31")},{default:c((()=>[u(i,{value:y(C).unsubscribe,"onUpdate:value":t[7]||(t[7]=e=>y(C).unsubscribe=e),"checked-value":1,"unchecked-value":0},null,8,["value"]),u(n,{class:"ml-16px",size:"small",onClick:O},{default:c((()=>[_(b(e.$t("Public.Btn.Set")),1)])),_:1}),u(s,{class:"ml-16px",onClick:G},{default:c((()=>[_(b(e.$t("Mail.Mass.index_32")),1)])),_:1})])),_:1},8,["label"]),u(a,{label:e.$t("Mail.Mass.index_33"),path:"threads"},{default:c((()=>[u(d,{value:y(C).threadsType,"onUpdate:value":t[8]||(t[8]=e=>y(C).threadsType=e)},{default:c((()=>[u(o,{value:0},{default:c((()=>[_(b(e.$t("Mail.Mass.index_34")),1)])),_:1}),u(o,{value:1},{default:c((()=>[_(b(e.$t("Mail.Mass.index_35")),1)])),_:1})])),_:1},8,["value"]),B(p("div",ui,[u(v,{value:y(C).threads,"onUpdate:value":t[9]||(t[9]=e=>y(C).threads=e),min:1,max:5,"show-button":!1,placeholder:e.$t("Mail.Mass.index_36")},null,8,["value","placeholder"])],512),[[z,1===y(C).threadsType]])])),_:1},8,["label"])]),p("div",ci,[u(a,{ref_key:"startTimeRef",ref:E,label:"Send time",path:"start_time"},{default:c((()=>[u(d,{value:y(C).pause,"onUpdate:value":[t[11]||(t[11]=e=>y(C).pause=e),A],class:"flex items-center"},{default:c((()=>[u(o,{value:0},{default:c((()=>t[14]||(t[14]=[_("Send Now")]))),_:1}),u(o,{class:"items-center",value:1},{default:c((()=>[u(g,{value:y(C).start_time,"onUpdate:value":[t[10]||(t[10]=e=>y(C).start_time=e),H],type:"datetime",disabled:0===y(C).pause,clearable:""},null,8,["value","disabled"])])),_:1})])),_:1},8,["value"])])),_:1},512),u(a,{label:"Remark"},{default:c((()=>[p("div",pi,[u(l,{value:y(C).remark,"onUpdate:value":t[12]||(t[12]=e=>y(C).remark=e),placeholder:"Please enter remark"},null,8,["value"])])])),_:1}),u(a,{label:"Send Test email to","show-feedback":!1},{default:c((()=>[p("div",mi,[p("div",vi,[u(l,{ref_key:"mailToRef",ref:N,value:y(C).mail_to,"onUpdate:value":t[13]||(t[13]=e=>y(C).mail_to=e),placeholder:"Please enter email"},null,8,["value"])]),u(n,{onClick:W},{default:c((()=>t[15]||(t[15]=[_("Send Test Mail")]))),_:1})])])),_:1})])]),p("div",yi,[p("div",fi,[u(a,{label:"From: ","show-feedback":!1,style:{"--n-blank-height":"21px"},"label-style":{fontWeight:"bold"}},{default:c((()=>[p("div",_i,b(y(C).addresser),1)])),_:1}),u(a,{label:"To: ","show-feedback":!1,style:{"--n-blank-height":"21px"},"label-style":{fontWeight:"bold"}},{default:c((()=>[p("div",hi,b(y(R).length>0?y(R).join(", "):"--"),1)])),_:1}),u(a,{label:"Subject: ","show-feedback":!1,style:{"--n-blank-height":"21px"},"label-style":{fontWeight:"bold"}},{default:c((()=>[p("div",gi,b(y(C).subject||"--"),1)])),_:1})]),u(li,{id:y(C).temp_id},null,8,["id"])])],4),p("div",bi,[u(n,{class:"mr-16px",onClick:K},{default:c((()=>[_(b(e.$t("Public.Btn.Cancel")),1)])),_:1}),u(n,{type:"primary",onClick:J},{default:c((()=>[_(b(e.$t("Public.Btn.Confirm")),1)])),_:1})])])),_:1},8,["model"])}}}),wi=K(xi,[["__scopeId","data-v-3b3d3467"]]),ki={class:"p-20px"},Mi=s({__name:"details",props:{id:{},type:{},row:{}},setup(e){const t=e,{t:a}=w(),l=g({task_id:t.id,type:t.type,value:"domain"===t.type?t.row.domain:t.row.status,page:1,size:10}),{loading:i,setLoading:n}=Qe(),{table:s,columns:o}=Ve([{key:"recipient",title:a("Mail.Mass.index_50"),width:160,render:e=>u(ut,{class:e.tooltip?"":"break-all!","line-clamp":e.tooltip?999:1,tooltip:!1},{default:()=>[e.recipient]})},{key:"dsn",title:"Dsn",width:60},{key:"delay",title:a("Mail.Mass.index_51"),width:70},{key:"delays",title:a("Mail.Mass.index_52"),width:150},{key:"relay",title:a("Mail.Mass.index_53"),width:200,render:e=>u(ut,{class:e.tooltip?"":"break-all!","line-clamp":e.tooltip?9999:1,tooltip:!1},{default:()=>[e.relay]})},{key:"err_info",title:a("Public.Btn.Details"),render:e=>u(ut,{class:e.tooltip?"":"break-all!","line-clamp":e.tooltip?9999:1,tooltip:!1},{default:()=>[e.err_info]})}]),p=e=>({onMousemove:()=>{e.tooltip=!0},onMouseleave:()=>{e.tooltip=!1}}),m=async()=>{try{n(!0);const{message:e}=await St(A(l));N(e)&&(s.data=J(e.data)?e.data.map((e=>({...e,tooltip:!1}))):[],s.total=le(e.page))}finally{n(!1)}};return"domain"===l.type&&o.value.push({key:"status",title:a("Public.Table.Status"),width:100,ellipsis:{tooltip:!0},render:e=>e.status}),"status"===l.type&&o.value.unshift({key:"domain",title:a("Mail.Mass.index_45"),width:120,ellipsis:{tooltip:!0},render:e=>e.domain}),m(),(e,t)=>{const a=Mt,n=Lt,v=Ut;return r(),d("div",ki,[u(v,null,{table:c((()=>[u(a,{loading:y(i),data:y(s).data,columns:y(o),"row-props":p},null,8,["loading","data","columns"])])),pageRight:c((()=>[u(n,{page:y(l).page,"onUpdate:page":t[0]||(t[0]=e=>y(l).page=e),"page-size":y(l).size,"onUpdate:pageSize":t[1]||(t[1]=e=>y(l).size=e),"item-count":y(s).total,onRefresh:m},null,8,["page","page-size","item-count"])])),_:1})])}}}),Ci={class:"p-20px"},Ui=s({__name:"index",props:{row:{}},setup(e){const t=e,{t:a}=w(),l=g({task_id:t.row.id,type:"domain"}),i=async()=>{const{message:e}=await ye({task_id:t.row.id});N(e)&&X(e.result)},{loading:n,setLoading:s}=Qe(),{table:o,columns:p}=Ve([{key:"domain",title:()=>u(m,null,["domain"===l.type?a("Mail.Mass.index_45"):a("Public.Table.Status")]),render:e=>"domain"===l.type?e.domain:e.status},{key:"count",title:a("Mail.Mass.index_46")},Ze({width:120,options:e=>[{label:a("Public.Btn.Details"),onClick:()=>{f(e)}}]})]),v=et(""),f=e=>{v.data.id=t.row.id,v.data.type=l.type,v.data.row=e,v.title=a("Mail.Mass.index_49",["domain"===l.type?e.domain:e.status]),v.show=!0},h=async()=>{try{s(!0);const{message:e}=await Et(A(l));o.data=J(e)?e:[]}finally{s(!1)}};return h(),(e,t)=>{const a=ot,s=rt,m=dt,f=Mt,g=Ut,x=zt;return r(),d("div",Ci,[u(g,null,{toolsLeft:c((()=>[u(s,{value:y(l).type,"onUpdate:value":[t[0]||(t[0]=e=>y(l).type=e),h]},{default:c((()=>[u(a,{value:"domain"},{default:c((()=>[_(b(e.$t("Mail.Mass.index_45")),1)])),_:1}),u(a,{value:"status"},{default:c((()=>[_(b(e.$t("Public.Table.Status")),1)])),_:1})])),_:1},8,["value"]),u(m,{onClick:i},{default:c((()=>[_(b(e.$t("Public.Btn.Export")),1)])),_:1})])),table:c((()=>[u(f,{"max-height":340,loading:y(n),data:y(o).data,columns:y(p)},null,8,["loading","data","columns"])])),_:1}),u(x,{show:y(v).show,"onUpdate:show":t[1]||(t[1]=e=>y(v).show=e),title:y(v).title,data:y(v).data,width:980,"min-height":152,component:Mi},null,8,["show","title","data"])])}}}),$i={class:"h-full"},Pi=s({__name:"index",props:{row:{}},setup(e){const t=e,{t:a}=w(),l=i(a("Mail.Mass.index_48")),{loading:n,setLoading:s}=Qe();return(async()=>{try{s(!0);const{message:e}=await It({path:t.row.error_log});N(e)&&(l.value=e.data?e.data.slice(-1e4):a("Mail.Mass.index_48"))}finally{s(!1)}})(),(e,t)=>{const a=Gt;return r(),d("div",$i,[u(a,{log:y(l),loading:y(n)},null,8,["log","loading"])])}}}),Ri=s({__name:"index",setup(e){const{t:a}=w(),l=g({p:1,size:10}),i=g({title:"",row:void 0,isEdit:!1}),n=e=>{i.row=e,i.isEdit=!1,Vt.value=!0},{table:s,columns:o}=Ve([{key:"created",title:a("Mail.Mass.index_2"),width:"14%",minWidth:140,render:e=>W(e.created)},{key:"subject",title:a("Mail.Mass.index_23"),width:"12%",minWidth:100,ellipsis:{tooltip:!0}},{key:"addresser",title:a("Mail.Mass.index_4"),minWidth:180,width:"15%",ellipsis:{tooltip:!0}},{key:"recipient_count",title:a("Mail.Mass.index_5"),width:"7%",minWidth:80},{key:"success_count",title:a("Mail.Mass.index_6"),width:"7%",minWidth:80,render:e=>2===e.task_process?e.delivered-e.count.error_count:"--"},{key:"error_count",title:a("Mail.Mass.index_7"),width:"7%",minWidth:80,render:e=>2===e.task_process?u("a",{class:"bt-link error",href:"javascript:;",onClick:()=>{v(e)}},[e.count.error_count]):"--"},{key:"task_process",title:a("Public.Table.Status"),width:"7%",render:e=>0===e.task_process||1===e.pause?u("span",{class:"text-#fcb040"},[_(" "),a("Mail.Mass.index_9"),_(" ")]):1===e.task_process?u("span",{class:"text-#fcb040"},[_(" "),a("Mail.Mass.index_10"),_(" ")]):a("Mail.Mass.index_11")},{key:"remark",title:a("Public.Table.Ps"),width:"10%",minWidth:80,ellipsis:{tooltip:!0}},tt({status:"success"}),Ze({width:180,options:e=>[{label:a("Public.Btn.Edit"),show:0===e.task_process&&0===e.pause,onClick:()=>{(e=>{i.row=e,i.isEdit=!0,Vt.value=!0})(e)}},{label:a("Mail.Mass.index_61"),show:!(0===e.task_process&&0===e.pause),onClick:()=>{p(e)}},{label:1===e.pause?a("Mail.Mass.index_12"):a("Public.Status.Pause"),show:2!==e.task_process,onClick:()=>{M(e)}},{label:a("Public.Btn.Del"),onClick:()=>{C(e)}}]})]),p=e=>{Ye({title:a("Mail.Mass.index_62",[e.subject]),width:640,minHeight:320,footer:!0,confirmText:a("Mail.Mass.index_63"),data:{row:e,onAdd:n},component:L((()=>ee((()=>t.import("./index-legacy182.js?v=1741416570306")),void 0)))})},m=et(""),v=e=>{m.data.row=e,m.title=a("Mail.Mass.index_13",[e.subject]),m.show=!0},k=et(""),M=e=>{Xe({title:a("Mail.Mass.index_15",[e.subject]),content:e.task_process?a("Mail.Mass.index_16"):a("Mail.Mass.index_17"),onConfirm:async()=>{await Tt({task_id:e.id,pause:e.pause?0:1}),U()}})},C=async e=>{Xe({title:a("Mail.Mass.index_18"),content:a("Mail.Mass.index_19",[e.subject]),onConfirm:async()=>{await Dt({task_id:e.id}),U()}})},U=async()=>{try{s.loading=!0;const{message:e}=await Bt(A(l));N(e)&&(s.data=J(e.data)?e.data:[],s.total=le(e.page))}finally{s.loading=!1}};return U(),(e,t)=>{const a=dt,p=Mt,v=Lt,g=Ut,w=zt;return r(),d("div",null,[B(u(g,null,{toolsLeft:c((()=>[u(a,{type:"primary",onClick:t[0]||(t[0]=e=>n())},{default:c((()=>[_(b(e.$t("Mail.Mass.index_1")),1)])),_:1})])),table:c((()=>[u(p,{loading:y(s).loading,data:y(s).data,columns:y(o)},null,8,["loading","data","columns"])])),pageRight:c((()=>[u(v,{page:y(l).p,"onUpdate:page":t[1]||(t[1]=e=>y(l).p=e),"page-size":y(l).size,"onUpdate:pageSize":t[2]||(t[2]=e=>y(l).size=e),"item-count":y(s).total,onRefresh:U},null,8,["page","page-size","item-count"])])),_:1},512),[[z,!y(Vt)]]),y(Vt)?(r(),x(wi,{key:0,show:y(Vt),"onUpdate:show":t[3]||(t[3]=e=>f(Vt)?Vt.value=e:null),"is-edit":y(i).isEdit,title:y(i).title,row:y(i).row,refresh:U},null,8,["show","is-edit","title","row"])):h("",!0),u(w,{show:y(m).show,"onUpdate:show":t[4]||(t[4]=e=>y(m).show=e),title:y(m).title,data:y(m).data,width:700,"min-height":192,component:Ui},null,8,["show","title","data"]),u(w,{show:y(k).show,"onUpdate:show":t[5]||(t[5]=e=>y(k).show=e),title:y(k).title,data:y(k).data,width:750,height:580,component:Pi},null,8,["show","title","data"])])}}}),ji=K(Ri,[["__scopeId","data-v-8e0ce07e"]]),Si=e=>{Kt.value=e},Ei={class:"mb-20px"},Ti={class:"w-320px"},Di={class:"flex items-center"},Bi=s({__name:"form",props:R({data:{default:null},refresh:{}},{show:{type:Boolean,default:!1},showModifiers:{}}),emits:["update:show"],setup(e){const a=e,l=L((()=>ee((()=>t.import("./index-legacy183.js?v=1741416570306")),void 0))),n=E(a,"data"),s=o(e,"show"),m=k("editorRef"),v=i(1),g=i(""),x=()=>{s.value=!1},w=i(!1),M=async(e=!1)=>{if(n.value)try{e||(w.value=!0),await ce({id:n.value.id,type:v.value,temp_name:g.value,render:JSON.stringify(m.value?.getEmailData()),content:m.value?.getEmailHTML()||""},e)}finally{e||(w.value=!1)}},U=async()=>{await M(!0),x(),a.refresh()};return C((()=>{(async()=>{w.value=!0,setTimeout((async()=>{if(n.value)try{g.value=n.value.name;const{message:e}=await ue({id:n.value.id});N(e)&&m.value?.setEmailData(e.render)}finally{setTimeout((()=>{w.value=!1}),500)}}),500)})()})),(e,t)=>{const a=vt,i=mt,n=bt,s=dt;return r(),d("div",null,[t[5]||(t[5]=p("div",{class:"mb-14px font-bold text-18px text-default leading-28px"},"Template Editor",-1)),u(n,null,{default:c((()=>[h("",!0),p("div",Ei,[u(y(l),{ref_key:"editorRef",ref:m,save:M},null,512)]),u(a,{label:"Template name"},{default:c((()=>[p("div",Ti,[u(i,{value:y(g),"onUpdate:value":t[1]||(t[1]=e=>f(g)?g.value=e:null)},null,8,["value"])])])),_:1})])),_:1}),p("div",Di,[u(s,{onClick:x},{default:c((()=>t[4]||(t[4]=[_("Back")]))),_:1}),u(s,{type:"primary",loading:y(w),disabled:y(w),class:"ml-12px",onClick:U},{default:c((()=>[_(b(e.$t("Public.Btn.Confirm")),1)])),_:1},8,["loading","disabled"])])])}}}),zi=["innerHTML"],Li=s({__name:"preview",props:{row:{}},setup(e){const t=E(e,"row"),a=i("");return(async()=>{const{message:e}=await ue({id:t.value.id});if(N(e)){const l=Xl(e.render);l&&1===e.type?(a.value=l.content,await ce({id:t.value.id,type:e.type,temp_name:e.name,render:JSON.stringify(l.render),content:l.content},!1)):a.value=e.content}})(),(e,t)=>(r(),d("div",{class:"min-h-600px overflow-auto",innerHTML:y(a)},null,8,zi))}}),Ai={class:"relative"},Hi=s({__name:"index",setup(e){const{t:t}=w(),a=i(!1),l=i(null),n=async()=>{const e=`template_${W(new Date,"yyyyMMddHHmmss")}`,{message:t}=await be({temp_name:e,type:1});S(),N(t)&&(l.value=t.data,a.value=!0)},s=()=>{Ot({path:"/tmp/upload",size:1,confirmText:t("Public.Btn.Import"),showSuccessMsg:!1,uploadData:{accept:["zip"].map((e=>`.${e}`)).join(","),multiple:!1},onUploadSuccess:async e=>{const t=e[0];await xe({path:`/tmp/upload/${t.name}`}),S()}})},{keys:o,table:p,columns:m,setLoading:v}=Ve([{type:"selection",width:40},{key:"name",title:"Name"},{key:"created",title:"Add Time",render:e=>W(e.created)},Ze({width:360,options:e=>[{label:"Create task",onClick:()=>{var t;t=e.id,Si("task"),Jt.value=t,$((()=>{Vt.value=!0}))}},{label:"Duplicate",onClick:()=>{M(e)}},{label:t("Public.Btn.Export"),onClick:()=>{C(e)}},{label:"Preview",onClick:()=>{U(e)}},{label:t("Public.Btn.Edit"),onClick:()=>{P(e)}},{label:t("Public.Btn.Del"),onClick:()=>{R(e)}}]})]),k=[{key:"import",label:"Batch Export",onBatch:async e=>{const{message:t}=await _e({ids:e.map((e=>e.id)).join(",")});N(t)&&X(t.result)}}],M=async e=>{await fe({id:`${e.id}`}),S()},C=async e=>{const{message:t}=await _e({ids:`${e.id}`});N(t)&&X(t.result)},U=e=>{Ye({title:`Preview [${e.name}]`,width:800,data:{row:e},component:Li})},P=e=>{l.value=e,a.value=!0},R=e=>{Xe({title:`Delete Template [${e.name}]`,content:"Are you sure you want to delete this template?",onConfirm:async()=>{await he({id:e.id}),S()}})},j=g({p:1,size:10}),S=async()=>{try{v(!0);const{message:e}=await ge(A(j));N(e)&&(p.data=J(e.data)?e.data:[],p.total=e.total)}finally{v(!1)}};return S(),(e,t)=>{const i=dt,v=Mt,g=Nt,w=Lt,M=Ut;return r(),d("div",Ai,[B(u(M,null,{toolsLeft:c((()=>[u(i,{type:"primary",onClick:n},{default:c((()=>t[5]||(t[5]=[_("Add Template")]))),_:1}),u(i,{onClick:s},{default:c((()=>[_(b(e.$t("Public.Btn.Import")),1)])),_:1})])),table:c((()=>[u(v,{"checked-row-keys":y(o),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>f(o)?o.value=e:null),loading:y(p).loading,data:y(p).data,columns:y(m)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:c((()=>[u(g,{"checked-row-keys":y(o),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>f(o)?o.value=e:null),data:y(p).data,options:k},null,8,["checked-row-keys","data"])])),pageRight:c((()=>[u(w,{page:y(j).p,"onUpdate:page":t[2]||(t[2]=e=>y(j).p=e),"page-size":y(j).size,"onUpdate:pageSize":t[3]||(t[3]=e=>y(j).size=e),"item-count":y(p).total,onRefresh:S},null,8,["page","page-size","item-count"])])),_:1},512),[[z,!y(a)]]),y(a)?(r(),x(Bi,{key:0,show:y(a),"onUpdate:show":t[4]||(t[4]=e=>f(a)?a.value=e:null),data:y(l),refresh:S},null,8,["show","data"])):h("",!0)])}}}),Oi=(e={})=>ie.post("/plugin?action=a&name=mail_sys&s=get_mail_type_list",e),Gi=s({__name:"index",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e,{expose:t}){const a=o(e,"value"),l=i([]),{loading:n,setLoading:s}=Qe(),d=async()=>{try{s(!0);const{message:e}=await Oi();J(e)&&(l.value=e.map((e=>({label:e.mail_type,value:e.id}))))}finally{s(!1)}};return d(),t({getType:d}),(e,t)=>{const i=pt;return r(),x(i,H(e.$attrs,{value:a.value,"onUpdate:value":t[0]||(t[0]=e=>a.value=e),options:y(l),loading:y(n)}),null,16,["value","options","loading"])}}}),Ii={class:"px-20px pt-24px pb-8px"},Ni={class:"w-300px"},Wi={class:"w-300px"},Fi=s({__name:"index",props:{row:{},onRefresh:{}},setup(e,{expose:t}){const{t:a}=w(),l=e,{row:n,onRefresh:s}=l;$((()=>{m.etypes=n.mail_type.map((e=>ae(Object.keys(e)[0])))}));const o=i(null),m=g({etypes:[]}),v={etypes:{trigger:"change",validator:()=>!!m.etypes.length||new Error(a("Mail.Unsubscribe.index_16"))}};return t({onConfirm:async()=>{await(o.value?.validate()),await we({etypes:m.etypes.join(","),recipients:n.recipient,active:n.active}),s?.()}}),(e,t)=>{const a=mt,l=vt,i=At;return r(),d("div",Ii,[u(i,{ref_key:"formRef",ref:o,model:y(m),rules:v},{default:c((()=>[u(l,{label:e.$t("Config.Alarm.index_43")},{default:c((()=>[p("div",Ni,[u(a,{value:y(n).recipient,"onUpdate:value":t[0]||(t[0]=e=>y(n).recipient=e),readonly:!0},null,8,["value"])])])),_:1},8,["label"]),u(l,{label:"Groups",path:"etypes"},{default:c((()=>[p("div",Wi,[u(Gi,{ref:"typeSelect",value:y(m).etypes,"onUpdate:value":t[1]||(t[1]=e=>y(m).etypes=e),multiple:"",filterable:""},null,8,["value"])])])),_:1})])),_:1},8,["model"])])}}}),qi={class:"p-20px"},Ki={class:"w-320px"},Ji={class:"flex-1"},Vi={class:"flex items-center h-32px mb-8px"},Qi={class:"w-320px"},Yi=s({__name:"index",props:{active:{},group:{},refresh:{}},setup(e,{expose:t}){const{t:a}=w(),l=e,{refresh:n}=l,s=i(null),o=g({etypes:-1!==l.group?[l.group]:[],type:1,file:"",content:""}),m={etypes:{trigger:"change",validator:()=>!!o.etypes.length||new Error(a("Mail.Unsubscribe.index_16"))},data:{validator:()=>1!==o.type||o.content?!(0===o.type&&!o.file)||new Error("Please upload the file"):new Error("Please enter the content")}},v=()=>{X("/www/server/panel/plugin/mail_sys/data/example_recipients.txt")};return t({onConfirm:async()=>{await(s.value?.validate()),1===o.type&&await ke({etypes:o.etypes.join(","),recipient_content:o.content}),0===o.type&&await Me({etypes:o.etypes.join(","),file:o.file}),n?.()}}),(e,t)=>{const a=vt,l=ht,i=rt,n=Ft,f=At,h=V,g=Ht;return r(),d("div",qi,[u(f,{ref_key:"formRef",ref:s,model:y(o),rules:m},{default:c((()=>[u(a,{label:"Groups",path:"etypes"},{default:c((()=>[p("div",Ki,[u(Gi,{ref:"typeSelect",value:y(o).etypes,"onUpdate:value":t[0]||(t[0]=e=>y(o).etypes=e),multiple:"",filterable:""},null,8,["value"])])])),_:1}),u(a,{label:"Data",path:"data"},{default:c((()=>[p("div",Ji,[p("div",Vi,[u(i,{value:y(o).type,"onUpdate:value":t[1]||(t[1]=e=>y(o).type=e)},{default:c((()=>[u(l,{value:1},{default:c((()=>t[4]||(t[4]=[_("Paste data")]))),_:1}),u(l,{value:0},{default:c((()=>t[5]||(t[5]=[_("Upload file")]))),_:1})])),_:1},8,["value"])]),B(p("div",Qi,[u(n,{value:y(o).content,"onUpdate:value":t[2]||(t[2]=e=>y(o).content=e),rows:6,placeholder:"Please paste in the data"},null,8,["value"])],512),[[z,1===y(o).type]]),B(p("div",null,[u(Za,{value:y(o).file,"onUpdate:value":t[3]||(t[3]=e=>y(o).file=e),path:"/www/server/panel/data/mail/in_bulk/recipient",accept:["txt","json"]},null,8,["value"])],512),[[z,0===y(o).type]])])])),_:1})])),_:1},8,["model"]),u(g,{class:"mt-8px ml-24px"},{default:c((()=>[p("li",null,[_(b(e.$t("Mail.Mass.index_74"))+" ",1),u(h,{target:"_blank",onClick:v},{default:c((()=>t[6]||(t[6]=[_("Download the template")]))),_:1})])])),_:1})])}}}),Xi=i([]),Zi=async()=>{const{message:e}=await Oi();Xi.value=J(e)?e:[]},en={class:"p-20px"},tn={class:"flex-1"},an={class:"mt-12px"},ln={class:"px-20px pt-24px pb-8px"},nn={class:"w-150px"},sn=s({__name:"set",setup(e){const{t:t}=w(),a=i(""),{table:l,columns:n,setLoading:s}=Ve([{key:"mail_type",title:"Group Name"},Ze({width:120,options:e=>[{label:t("Public.Btn.Edit"),disabled:0===e.id,onClick:()=>{m(e)}},{label:t("Public.Btn.Delete"),disabled:0===e.id,onClick:()=>{v(e)}}]})]),o=async()=>{const e=a.value.trim();var t;""!==e?(await(t={mail_type:e},ie.post("/plugin?action=a&name=mail_sys&s=add_mail_type",t,{requestOptions:{loading:ne.global.t("Mail.Api.index_22"),successMessage:!0}})),h(),a.value=""):te.error("Please enter group name")},m=e=>{x.title="Edit Group",M.id=e.id,M.mail_type=e.mail_type,x.show=!0},v=e=>{Xe({title:`Delete Group [${e.mail_type}]`,content:"Are you sure you want to delete this group?",onConfirm:async()=>{var t;await(t={ids:`${e.id}`},ie.post("/plugin?action=a&name=mail_sys&s=del_mail_type_list",t,{requestOptions:{loading:ne.global.t("Mail.Api.index_37"),successMessage:!0}})),h()}})},h=async()=>{try{s(!0),await Zi(),l.data=Xi.value}finally{s(!1)}},x=et(),k=i(null),M=g({id:-1,mail_type:""}),C={mail_type:{required:!0,message:"Please enter group name",trigger:["blur","change"]}},U=async()=>{var e;await(k.value?.validate()),await(e=A(M),ie.post("/plugin?action=a&name=mail_sys&s=edit_mail_type",e,{requestOptions:{loading:ne.global.t("Mail.Api.index_42"),successMessage:!0}})),await h()};return h(),(e,t)=>{const i=mt,s=dt,m=xt,v=Mt,h=vt,g=At,w=zt;return r(),d("div",en,[u(m,null,{default:c((()=>[p("div",tn,[u(i,{value:y(a),"onUpdate:value":t[0]||(t[0]=e=>f(a)?a.value=e:null),placeholder:"Please enter group name"},null,8,["value"])]),p("div",null,[u(s,{type:"primary",onClick:o},{default:c((()=>[_(b(e.$t("Public.Btn.Add")),1)])),_:1})])])),_:1}),p("div",an,[u(v,{"max-height":300,loading:y(l).loading,data:y(l).data,columns:y(n)},null,8,["loading","data","columns"])]),u(w,{show:y(x).show,"onUpdate:show":t[2]||(t[2]=e=>y(x).show=e),title:y(x).title,width:350,footer:!0,onConfirm:U},{default:c((()=>[p("div",ln,[u(g,{ref_key:"formRef",ref:k,model:y(M),rules:C},{default:c((()=>[u(h,{label:"Group Name",path:"mail_type"},{default:c((()=>[p("div",nn,[u(i,{value:y(M).mail_type,"onUpdate:value":t[1]||(t[1]=e=>y(M).mail_type=e),placeholder:""},null,8,["value"])])])),_:1})])),_:1},8,["model"])])])),_:1},8,["show","title"])])}}}),on={class:"w-200px"},rn=s({__name:"index",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e){const{t:t}=w(),a=o(e,"value"),l=P((()=>{const e=Xi.value.map((e=>({label:e.mail_type,value:e.id})));return e.unshift({label:t("Public.All"),value:-1}),e})),i=({option:e})=>`Group: ${e.label}`,n=()=>{Ye({title:"Group Management",width:360,component:sn})},{loading:s,setLoading:p}=Qe();return(async()=>{try{p(!0),await Zi()}finally{p(!1)}})(),T((()=>{Xi.value=[]})),(e,t)=>{const o=dt,p=pt;return r(),d("div",on,[u(p,{value:a.value,"onUpdate:value":t[0]||(t[0]=e=>a.value=e),loading:y(s),options:y(l),renderTag:i},{action:c((()=>[u(o,{block:"",onClick:n},{default:c((()=>t[1]||(t[1]=[_("Group Management")]))),_:1})])),_:1},8,["value","loading","options"])])}}}),dn={class:"px-20px pt-24px pb-8px"},un={class:"w-240px"},cn=s({__name:"batch",props:{rows:{}},emits:["refresh"],setup(e,{expose:t,emit:a}){const l=e,i=a,{t:n}=w(),{rows:s}=l,o=k("formRef"),m=g({type:null}),v={type:{trigger:"change",validator:()=>null!==m.type||new Error(n("Mail.Unsubscribe.index_16"))}},f=P((()=>Xi.value.map((e=>({label:e.mail_type,value:e.id}))))),{loading:_,setLoading:h}=Qe();return(async()=>{try{h(!0),await Zi()}finally{h(!1)}})(),t({onConfirm:async()=>{await(o.value?.validate()),await Ce({etypes:`${m.type||0}`,recipients:s.map((e=>e.recipient)).join(","),active:s[0].active}),i("refresh")}}),(e,t)=>{const a=pt,l=vt,i=At;return r(),d("div",dn,[u(i,{ref_key:"formRef",ref:o,model:y(m),rules:v},{default:c((()=>[u(l,{label:"Groups",path:"type"},{default:c((()=>[p("div",un,[u(a,{value:y(m).type,"onUpdate:value":t[0]||(t[0]=e=>y(m).type=e),loading:y(_),options:y(f),multiple:"",filterable:""},null,8,["value","loading","options"])])])),_:1})])),_:1},8,["model"])])}}}),pn={class:"text-center fw-bold text-18px color-#666"},mn={class:"w-96% h-200px mx-auto"},vn=s({__name:"index",props:{active:{default:0}},setup(e){const t=E(e,"active"),a=(e=[])=>[{data:e}],l=(e=[])=>[{name:"Count",type:"line",data:e,itemStyle:{color:"#20a53a"},smooth:!0,showSymbol:!1,sampling:"average",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(32, 164, 58, 0.4)"},{offset:.7,color:"rgba(32, 164, 58, 0)"}]}}}],i=M({tooltip:{trigger:"axis",order:"seriesDesc",axisPointer:{type:"shadow"}},grid:{top:"16%",left:"2%",right:"2%",bottom:"4%",containLabel:!0},xAxis:a(),yAxis:{type:"value"},series:l()}),{loading:n,setLoading:s}=Qe(),o=async()=>{try{s(!0);const{message:e}=await Ue({active:t.value});if(J(e)){const t=e.map((e=>e.month)),n=e.map((e=>e.count));i.xAxis=a(t),i.series=l(n)}}finally{s(!1)}};return o(),U((()=>t.value),(()=>{o()})),(e,a)=>{const l=Q;return r(),x(l,{class:"mb-16px",show:y(n)},{default:c((()=>[p("div",pn,b(y(t)?e.$t("Mail.Mass.index_71"):e.$t("Mail.Mass.index_72"))+" "+b(e.$t("Mail.Mass.index_73")),1),p("div",mn,[u(Ct,{height:200,option:y(i)},null,8,["option"])])])),_:1},8,["show"])}}}),yn=s({__name:"index",setup(e,{expose:t}){const{t:a}=w(),l=g({p:1,size:10,active:1,keyword:""}),i=()=>{Ye({title:a("Mail.Mass.index_75"),width:540,minHeight:170,footer:!0,data:{active:l.active,group:Qt.value,refresh:()=>{h()}},component:Yi})},n=e=>{l.active=e,l.p=1,h()},s=()=>{l.p=1,h()},{keys:o,table:d,columns:p,setLoading:m}=Ve([{type:"selection",width:40},{key:"recipient",title:a("Mail.Unsubscribe.index_1"),ellipsis:{tooltip:!0}},{key:"mail_type",title:"Group Name",render:e=>e.mail_type.map((e=>Object.values(e)[0])).join(", ")},{key:"created",title:a("Mail.Unsubscribe.index_19"),width:"12%",minWidth:140,render:e=>W(e.created)},Ze({width:250,options:e=>[{label:a("Mail.Mass.index_76"),onClick:async()=>{Ye({title:a("Mail.Mass.index_76"),width:500,footer:!0,data:{row:e,onRefresh:()=>{h()}},component:Fi})}},{label:e.active?a("Mail.Mass.index_72"):a("Mail.Mass.index_71"),show:!1,onClick:async()=>{Xe({title:`${e.active?a("Mail.Mass.index_72"):a("Mail.Mass.index_71")} [${e.recipient}]`,content:a("Mail.Mass.index_77",[e.active?a("Mail.Mass.index_72"):a("Mail.Mass.index_71")]),onConfirm:async()=>{await $e({recipient:e.recipient,active:0===e.active?1:0}),h()}})}},{label:a("Public.Btn.Del"),onClick:async()=>{Xe({title:`${a("Public.Btn.Del")} [${e.recipient}]`,content:a("Mail.Mass.index_78",[e.active?a("Mail.Mass.index_71"):a("Mail.Mass.index_72")]),onConfirm:async()=>{await Pe({mails:`${e.recipient}`,active:e.active}),h()}})}}]})]),v=[{key:"del",label:a("Public.Batch.Del"),onBatch:e=>{Xe({title:a("Public.Batch.Del"),content:a("Site.Batch.index_11"),onConfirm:async()=>{await Pe({mails:e.map((e=>e.recipient)).join("\n"),active:l.active}),h()}})}},{key:"category",label:"Batch set group",onBatch:e=>{Ye({title:"Batch set group",width:440,footer:!0,data:{rows:e,onRefresh:()=>{h()}},component:cn})}}],h=async()=>{try{m(!0);const{message:e}=await Re({...-1===Qt.value?{}:{etype:Qt.value},search:l.keyword,p:l.p,size:l.size,active:l.active});N(e)&&(d.data=e.data,d.total=e.total)}finally{o.value=[],m(!1)}};return C((()=>{h()})),T((()=>{Qt.value=-1})),t({init:h}),(e,t)=>{const a=dt,m=ot,g=rt,w=Wt,k=Mt,M=Nt,C=Lt,U=Ut,$=wt;return r(),x($,null,{default:c((()=>[u(vn,{active:y(l).active},null,8,["active"]),u(U,null,{toolsLeft:c((()=>[u(a,{type:"primary",onClick:i},{default:c((()=>[_(b(e.$t("Public.Btn.Import")),1)])),_:1})])),toolsRight:c((()=>[u(g,{value:y(l).active,"onUpdate:value":t[0]||(t[0]=e=>y(l).active=e),onUpdateValue:n},{default:c((()=>[u(m,{label:e.$t("Mail.Mass.index_71"),value:1},null,8,["label"]),u(m,{label:e.$t("Mail.Mass.index_72"),value:0},null,8,["label"])])),_:1},8,["value"]),u(rn,{value:y(Qt),"onUpdate:value":[t[1]||(t[1]=e=>f(Qt)?Qt.value=e:null),h]},null,8,["value"]),u(w,{value:y(l).keyword,"onUpdate:value":t[2]||(t[2]=e=>y(l).keyword=e),width:240,placeholder:e.$t("Mail.Unsubscribe.index_5"),onSearch:s},null,8,["value","placeholder"])])),table:c((()=>[u(k,{"checked-row-keys":y(o),"onUpdate:checkedRowKeys":t[3]||(t[3]=e=>f(o)?o.value=e:null),"row-key":"id",loading:y(d).loading,data:y(d).data,columns:y(p)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:c((()=>[u(M,{"checked-row-keys":y(o),"onUpdate:checkedRowKeys":t[4]||(t[4]=e=>f(o)?o.value=e:null),"row-key":"id",data:y(d).data,options:v},null,8,["checked-row-keys","data"])])),pageRight:c((()=>[u(C,{page:y(l).p,"onUpdate:page":t[5]||(t[5]=e=>y(l).p=e),"page-size":y(l).size,"onUpdate:pageSize":t[6]||(t[6]=e=>y(l).size=e),"item-count":y(d).total,"store-key":"mail-unsubscribe",onRefresh:h},null,8,["page","page-size","item-count"])])),_:1})])),_:1})}}}),fn={class:"p-20px"},_n={class:"mt-12px"},hn={class:"mt-12px"},gn={class:"w-300px"},bn={class:"w-300px"},xn={class:"ml-32px"},wn=s({__name:"AddGroup",props:{refresh:{}},setup(e,{expose:t}){const a=e,l=k("formRef"),n=g({type:1,input_name:"",select_name:null,file_path:""}),s={name:{trigger:["blur","input","change"],validator:()=>1!==n.type||n.input_name?!(0===n.type&&!n.select_name)||new Error("Please select the group name"):new Error("Please enter the group name")},file_path:{message:"Please upload file",trigger:["change"],validator:()=>!(0===n.type&&!n.file_path)||new Error("Please upload file")}},o=i([]),m=()=>{const e="/www/server/panel/data/mail/in_bulk/recipient";Ot({path:e,size:5,uploadData:{accept:["txt"].map((e=>`.${e}`)).join(","),multiple:!1},onUploadSuccess:t=>{n.file_path=`${e}/${t[0].name}`}})};return(async()=>{const{message:e}=await je();J(e)&&(o.value=e.map((e=>({label:e.mail_type,value:e.mail_type}))))})(),t({onConfirm:async()=>{await(l.value?.validate()),await Se({is_new:n.type,group_name:0===n.type?n.select_name||"":n.input_name,file_path:n.file_path}),a.refresh()}}),(e,t)=>{const a=ht,i=rt,v=vt,f=mt,g=pt,w=dt,k=At,M=Ht;return r(),d("div",fn,[u(k,{ref_key:"formRef",ref:l,model:y(n),rules:s},{default:c((()=>[u(v,{label:" "},{default:c((()=>[u(i,{value:y(n).type,"onUpdate:value":t[0]||(t[0]=e=>y(n).type=e)},{default:c((()=>[p("div",null,[u(a,{value:1},{default:c((()=>t[3]||(t[3]=[_("Create a new group and import")]))),_:1})]),p("div",_n,[u(a,{value:0},{default:c((()=>t[4]||(t[4]=[_("Import into existing group")]))),_:1})]),p("div",hn,[u(a,{value:2},{default:c((()=>t[5]||(t[5]=[_("Only create a new group")]))),_:1})])])),_:1},8,["value"])])),_:1}),u(v,{label:"Group name",path:"name"},{default:c((()=>[B(p("div",gn,[u(f,{value:y(n).input_name,"onUpdate:value":t[1]||(t[1]=e=>y(n).input_name=e)},null,8,["value"])],512),[[z,1===y(n).type||2===y(n).type]]),B(p("div",bn,[u(g,{value:y(n).select_name,"onUpdate:value":t[2]||(t[2]=e=>y(n).select_name=e),options:y(o)},null,8,["value","options"])],512),[[z,0===y(n).type]])])),_:1}),2!==y(n).type?(r(),x(v,{key:0,label:"File",path:"file_path"},{default:c((()=>[u(w,{onClick:m},{default:c((()=>[_(b(e.$t("Public.Btn.Import")),1)])),_:1}),p("div",xn,[p("span",null,b(e.$t("Mail.Mass.index_43")),1),p("span",{class:j(y(n).file_path?"text-default":"text-error")},b(y(n).file_path||e.$t("Mail.Mass.index_44")),3)])])),_:1})):h("",!0)])),_:1},8,["model"]),u(M,{class:"ml-20px mt-8px"},{default:c((()=>t[6]||(t[6]=[p("li",null,"Currently, Only group files exported from aaPanel are supported for import.",-1)]))),_:1})])}}}),kn={class:"p-20px pb-32px"},Mn={class:"flex items-center h-32px"},Cn={class:"mt-8px"},Un=s({__name:"BatchExport",props:{rows:{default:()=>[]}},setup(e,{expose:t}){const a=e,l=g({type:0});return t({onConfirm:async()=>{const{message:e}=await Ee({is_split:l.type,ids:a.rows.map((e=>e.id)).join(",")});N(e)&&X(e.result)}}),(e,t)=>{const a=ht,i=rt,n=vt,s=At;return r(),d("div",kn,[u(s,null,{default:c((()=>[u(n,{label:"Export method","show-feedback":!1},{default:c((()=>[u(i,{value:y(l).type,"onUpdate:value":t[0]||(t[0]=e=>y(l).type=e)},{default:c((()=>[p("div",Mn,[u(a,{value:0},{default:c((()=>t[1]||(t[1]=[_(" Export each group to a separate file ")]))),_:1})]),p("div",Cn,[u(a,{value:1},{default:c((()=>t[2]||(t[2]=[_(" Export multiple groups into a single file ")]))),_:1})])])),_:1},8,["value"])])),_:1})])),_:1})])}}}),$n={class:"px-20px pt-24px pb-8px"},Pn={class:"w-240px"},Rn=s({__name:"BatchMerge",props:{rows:{default:()=>[]},refresh:{}},setup(e,{expose:t}){const a=e,l=g({target_group:a.rows[0].id}),n=i([]);return n.value=a.rows.map((e=>({label:e.mail_type,value:e.id}))),t({onConfirm:async()=>{await Te({source_groups:a.rows.map((e=>e.id)).join(","),target_group:l.target_group}),a.refresh()}}),(e,t)=>{const a=pt,i=vt,s=At;return r(),d("div",$n,[u(s,null,{default:c((()=>[u(i,{label:"Merge to"},{default:c((()=>[p("div",Pn,[u(a,{value:y(l).target_group,"onUpdate:value":t[0]||(t[0]=e=>y(l).target_group=e),options:y(n)},null,8,["value","options"])])])),_:1})])),_:1})])}}}),jn={class:"p-20px pt-24px pb-8px"},Sn={class:"w-200px"},En=s({__name:"RenameGroup",props:{row:{},isEdit:{type:Boolean},refresh:{}},setup(e,{expose:t}){const a=e,{row:l,isEdit:n,refresh:s}=a,o=i(null),m=g({mail_type:l?l.mail_type:""}),v={mail_type:{required:!0,trigger:"blur",message:"Please enter group name"}};return t({onConfirm:async()=>{await(o.value?.validate()),n&&l?await De({...A(m),id:l.id}):await Be(A(m)),s?.()}}),(e,t)=>{const a=mt,l=vt,i=At;return r(),d("div",jn,[u(i,{ref_key:"formRef",ref:o,model:y(m),rules:v},{default:c((()=>[u(l,{label:"Group Name",path:"mail_type"},{default:c((()=>[p("div",Sn,[u(a,{value:y(m).mail_type,"onUpdate:value":t[0]||(t[0]=e=>y(m).mail_type=e),placeholder:"Please enter group name"},null,8,["value"])])])),_:1})])),_:1},8,["model"])])}}}),Tn=s({__name:"index",setup(e,{expose:t}){const{t:a}=w(),l=()=>{P()},i=g({show:!1,title:"Add Group",data:{refresh:l}}),n=()=>{i.title="Add Group",i.show=!0},s=g({p:1,size:10,type:-1,keyword:""}),{keys:o,table:p,columns:m,setLoading:v}=Ve([{type:"selection",width:40},{key:"mail_type",title:"Group Name",render:e=>u("a",{class:"bt-link",href:"javascript:;",onClick:()=>{var t;t=e.id,Qt.value=t,Si("contact")}},[e.mail_type])},{key:"subscribers",title:a("Mail.Mass.index_71"),align:"center"},{key:"unsubscribers",title:a("Mail.Mass.index_72"),align:"center"},{key:"created",title:a("Mail.Unsubscribe.index_19"),render:e=>W(e.created)},Ze({width:200,options:e=>[{label:a("Mail.Mass.index_83"),show:!1,onClick:()=>{at(e.subscribe_url)}},{label:a("Docker.Container.index_15"),onClick:()=>{$(e)}},{label:a("Public.Btn.Del"),onClick:()=>{Xe({title:a("Public.Btn.Del"),content:a("Mail.Mass.index_85",[e.mail_type]),onConfirm:async()=>{await ze({ids:e.id}),P()}})}}]})]),h=[{key:"del",type:"confirm",label:a("Public.Batch.Del"),confirm:{title:a("Public.Batch.Del"),desc:a("Site.Batch.index_11"),api:e=>ze({ids:e.id},!1),done:()=>{P()},columns:[{key:"mail_type",title:"Groups",ellipsis:{tooltip:{width:"trigger"}}}]}},{key:"export",label:"Batch export",onBatch:e=>{x(e)}},{key:"merge",label:"Batch merge",onBatch:e=>{M(e)}}],b=g({show:!1,title:"Export Group",data:{rows:[]}}),x=e=>{b.data.rows=e,b.show=!0},k=g({show:!1,title:"Merge Group",data:{rows:[],refresh:l}}),M=e=>{k.data.rows=e,k.show=!0},U=g({show:!1,title:"Edit Group",data:{row:null,isEdit:!1,refresh:l}}),$=e=>{U.data.row=e,U.data.isEdit=!0,U.show=!0},P=async()=>{try{v(!0);const{message:e}=await Le({search:s.keyword,p:s.p,size:s.size});N(e)&&(p.data=e.data,p.total=e.total)}finally{o.value=[],v(!1)}};return C((()=>{P()})),t({init:P}),(e,t)=>{const a=dt,l=Wt,v=Mt,g=Nt,x=Lt,w=Ut,M=zt;return r(),d("div",null,[u(w,null,{toolsLeft:c((()=>[u(a,{type:"primary",onClick:n},{default:c((()=>t[9]||(t[9]=[_("Add Group")]))),_:1})])),toolsRight:c((()=>[u(l,{value:y(s).keyword,"onUpdate:value":t[0]||(t[0]=e=>y(s).keyword=e),width:240,placeholder:e.$t("Config.Alarm.index_67"),onSearch:P},null,8,["value","placeholder"])])),table:c((()=>[u(v,{"checked-row-keys":y(o),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>f(o)?o.value=e:null),"row-key":"id",loading:y(p).loading,data:y(p).data,columns:y(m)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:c((()=>[u(g,{"checked-row-keys":y(o),"onUpdate:checkedRowKeys":t[2]||(t[2]=e=>f(o)?o.value=e:null),"row-key":"id",data:y(p).data,options:h},null,8,["checked-row-keys","data"])])),pageRight:c((()=>[u(x,{page:y(s).p,"onUpdate:page":t[3]||(t[3]=e=>y(s).p=e),"page-size":y(s).size,"onUpdate:pageSize":t[4]||(t[4]=e=>y(s).size=e),"item-count":y(p).total,onRefresh:P},null,8,["page","page-size","item-count"])])),_:1}),u(M,{show:y(i).show,"onUpdate:show":t[5]||(t[5]=e=>y(i).show=e),title:y(i).title,width:530,data:y(i).data,footer:!0,component:wn},null,8,["show","title","data"]),u(M,{show:y(U).show,"onUpdate:show":t[6]||(t[6]=e=>y(U).show=e),title:y(U).title,width:400,data:y(U).data,footer:!0,component:En},null,8,["show","title","data"]),u(M,{show:y(b).show,"onUpdate:show":t[7]||(t[7]=e=>y(b).show=e),title:y(b).title,width:440,data:y(b).data,footer:!0,component:Un},null,8,["show","title","data"]),u(M,{show:y(k).show,"onUpdate:show":t[8]||(t[8]=e=>y(k).show=e),title:y(k).title,width:440,data:y(k).data,footer:!0,component:Rn},null,8,["show","title","data"])])}}}),Dn=s({__name:"index",setup(e,{expose:t}){const{t:a}=w(),l=g({p:1,size:10,status:"bounced",search:""}),n=i([]),{keys:s,table:o,columns:d,setLoading:p}=Ve([{type:"selection",width:40},{key:"recipient",title:a("Mail.Unsubscribe.index_1")},{key:"task_name",title:a("Mail.Mass.index_23"),render:e=>`${e.task_name} (${W(e.task_time)})`},{key:"status",title:a("Ftp.Table.index_3")},{key:"state",title:a("Config.Safe.index_156"),render:e=>e.state||e.count>=3?a("Mail.Mass.index_95"):a("Mail.Mass.index_96")},{key:"created",title:a("Mail.Unsubscribe.index_19"),render:e=>W(e.created)},Ze({width:200,options:e=>[{label:a("Public.Btn.Del"),onClick:async()=>{Xe({title:a("Public.Btn.Del"),content:a("Mail.Mass.index_85",[e.recipient]),onConfirm:async()=>{await Ae({ids:e.id}),k()}})}}]})]),m=[{key:"del",type:"confirm",label:a("Public.Batch.Del"),confirm:{title:a("Public.Batch.Del"),desc:a("Site.Batch.index_11"),api:e=>Ae({ids:e.id},!1),done:()=>{k()},columns:[{key:"recipient",title:a("Mail.Unsubscribe.index_1"),ellipsis:{tooltip:{width:"trigger"}}}]}}],v=()=>{l.p=1,k()},h=()=>{Xe({title:a("Public.Btn.Clear"),content:a("Mail.Mass.index_94"),onConfirm:async()=>{await Oe({status:l.status}),k()}})},k=async()=>{try{p(!0);const{message:e}=await He(A(l));N(e)&&(o.data=e.data,o.total=e.total)}finally{s.value=[],p(!1)}},{loading:M,setLoading:C}=Qe(),U=async()=>{await(async()=>{try{C(!0);const{message:e}=await Ge();J(e)&&(n.value=e.map((e=>({label:e.status,value:e.status}))),n.value.length&&(l.status=n.value[0].value))}finally{C(!1)}})(),k()};return U(),t({init:U}),(e,t)=>{const a=dt,i=pt,p=Wt,g=Mt,w=Nt,C=Lt,U=Ut,$=wt;return r(),x($,null,{default:c((()=>[u(U,null,{toolsLeft:c((()=>[u(a,{type:"primary",onClick:k},{default:c((()=>[_(b(e.$t("Public.Btn.Refresh")),1)])),_:1}),u(a,{onClick:h},{default:c((()=>[_(b(e.$t("Public.Btn.Clear")),1)])),_:1})])),toolsRight:c((()=>[u(i,{class:"w-200px",loading:y(M),value:y(l).status,"onUpdate:value":[t[0]||(t[0]=e=>y(l).status=e),v],options:y(n)},null,8,["loading","value","options"]),u(p,{value:y(l).search,"onUpdate:value":t[1]||(t[1]=e=>y(l).search=e),width:240,placeholder:e.$t("Config.Alarm.index_67"),onSearch:k},null,8,["value","placeholder"])])),table:c((()=>[u(g,{"checked-row-keys":y(s),"onUpdate:checkedRowKeys":t[2]||(t[2]=e=>f(s)?s.value=e:null),"row-key":"id",loading:y(o).loading,data:y(o).data,columns:y(d)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:c((()=>[u(w,{"checked-row-keys":y(s),"onUpdate:checkedRowKeys":t[3]||(t[3]=e=>f(s)?s.value=e:null),"row-key":"id",data:y(o).data,options:m},null,8,["checked-row-keys","data"])])),pageRight:c((()=>[u(C,{page:y(l).p,"onUpdate:page":t[4]||(t[4]=e=>y(l).p=e),"page-size":y(l).size,"onUpdate:pageSize":t[5]||(t[5]=e=>y(l).size=e),"item-count":y(o).total,onRefresh:k},null,8,["page","page-size","item-count"])])),_:1})])),_:1})}}}),Bn={key:0,class:"pt-40px pb-40px"},zn={class:"text-center my-24px"},Ln={class:"flex justify-center"},An={class:"w-76%"},Hn=K(s({__name:"conversion",setup(e){const t=q(),{isFree:a}=v(t),l=()=>{Je({source:360})};return(e,t)=>{const i=dt,n=kt;return r(),d("div",null,[y(a)?(r(),d("div",Bn,[t[0]||(t[0]=p("div",{class:"mb-24px text-center text-24px font-bold"},"Automation",-1)),t[1]||(t[1]=p("div",{class:"text-center text-14px color-desc"}," Pro Edition Exclusive Features ",-1)),p("div",zn,[u(i,{type:"primary",class:"px-20px h-38px text-15px",onClick:l},{default:c((()=>[_(b(e.$t("WP.Transition.index_7")),1)])),_:1})]),p("div",Ln,[p("div",An,[u(n,{class:"w-full",width:"100%",src:y("/static/vite/images/auto-pro.png")},null,8,["src"])])])])):S(e.$slots,"default",{key:1},void 0,!0)])}}}),[["__scopeId","data-v-f5816121"]]),On=[{key:"default",title:"Simple welcome email",description:"Send a welcome email to new subscribers",data:{triggers:[{type:"subscriber_added",group_ids:[]}],root:{broken:!1,complete:!1,email_id:0,from:"",from_name:"",id:0,name:"",next:null,nodeKey:"a86bac74",parentNodeKey:"root",parent_id:0,subject:"",track_opens:!0,track_clicks:!0,track_unsubscribe:!0,type:"email"}}}],Gn={class:"p-24px"},In={class:"w-260px"},Nn={class:"template-list"},Wn={class:"template-title"},Fn={class:"template-desc"},qn=K(s({__name:"index",setup(e,{expose:t}){const a=k("formRef"),l=g({name:""}),n=i("default"),s={name:{required:!0,message:"Please enter the task name",trigger:"blur"}},o=O();return t({onConfirm:async()=>{await(a.value?.validate());const e=On.filter((e=>e.key===n.value))[0];if(e){const{message:t}=await Ie({name:l.name,triggers:e.data.triggers,root:e.data.root});te.success("Add successfully"),N(t)&&o.push(`/flow/${t.id}`)}}}),(e,t)=>{const i=mt,o=vt,v=At;return r(),d("div",Gn,[u(v,{ref_key:"formRef",ref:a,model:y(l),rules:s},{default:c((()=>[u(o,{label:"Task name",path:"name"},{default:c((()=>[p("div",In,[u(i,{value:y(l).name,"onUpdate:value":t[0]||(t[0]=e=>y(l).name=e)},null,8,["value"])])])),_:1}),u(o,{label:"Template","show-feedback":!1},{default:c((()=>[p("div",Nn,[(r(!0),d(m,null,G(y(On),(e=>(r(),d("div",{key:e.key,class:j(["template-item",{active:y(n)===e.key}])},[p("div",Wn,b(e.title),1),p("div",Fn,b(e.description),1)],2)))),128))])])),_:1})])),_:1},8,["model"])])}}}),[["__scopeId","data-v-5af2dd72"]]),Kn={class:"px-20px pt-28px pb-12px"},Jn={class:"w-240px"},Vn=s({__name:"index",props:{row:{default:null}},setup(e,{expose:t}){const a=e,l=k("formRef"),i=g({name:""}),n={name:{required:!0,trigger:"blur",message:"Please enter the name"}};return(()=>{const{row:e}=a;e&&(i.name=e.name||"")})(),t({onConfirm:async()=>{await(l.value?.validate()),await Ne({id:a.row.id,name:i.name}),a.row.name=i.name}}),(e,t)=>{const a=mt,s=vt,o=At;return r(),d("div",Kn,[u(o,{ref_key:"formRef",ref:l,model:y(i),rules:n},{default:c((()=>[u(s,{label:"Name",path:"name"},{default:c((()=>[p("div",Jn,[u(a,{value:y(i).name,"onUpdate:value":t[0]||(t[0]=e=>y(i).name=e)},null,8,["value"])])])),_:1})])),_:1},8,["model"])])}}}),Qn=s({__name:"index",setup(e){const{t:t}=w(),a=g({show:!1}),l=()=>{a.show=!0},{table:i,columns:n,setLoading:s}=Ve([{key:"name",title:"Name"},{key:"status",title:"Status",render:e=>u(_t,{value:e.status,checkedValue:1,uncheckedValue:0,size:"small",onUpdateValue:async t=>{await We({id:e.id,status:t}),e.status=t}},null)},{key:"sent",title:"Delivered / Sent",render:e=>`${e.delivered} / ${e.sent}`},{key:"clicked",title:"Clicked",render:e=>`${e.clicked}%`},{key:"opened",title:"Opened",render:e=>`${e.opened}%`},Ze({width:260,options:e=>[{label:"Duplicate",onClick:()=>{o(e)}},{label:"Rename",onClick:()=>{p(e)}},{label:t("Public.Btn.Edit"),disabled:1===e.status,onClick:()=>{v(e)}},{label:t("Public.Btn.Delete"),onClick:()=>{f(e)}}]})]),o=async e=>{const t=te.loading("Copying, please wait...");try{const{message:t}=await Fe({id:e.id});if(N(t)){const a=e=>{let t=e;for(;t;)t.id=0,N(t)&&"condition"===t.type&&(a(t.yes),a(t.no)),t=t.next};a(t.root),await Ie({name:`${e.name} - Copy`,triggers:t.triggers,root:t.root},!1),b(),te.success("Copy success")}}finally{t.close()}},d=g({show:!1,title:"Rename the automation",data:{row:null}}),p=e=>{d.data.row=e,d.show=!0},m=O(),v=e=>{m.push(`/flow/${e.id}`)},f=e=>{Xe({title:`Delete [${e.name}]`,content:"Are you sure to delete this item?",onConfirm:async()=>{try{s(!0),await qe({id:e.id}),b()}finally{s(!1)}}})},h=g({keyword:"",p:1,p_size:10}),b=async()=>{try{s(!0);const{message:e}=await Ke(A(h));N(e)&&(i.data=J(e.list)?e.list:[],i.total=e.total)}finally{s(!1)}};return b(),(e,t)=>{const s=dt,o=Mt,p=Lt,m=Ut,v=zt;return r(),x(Hn,null,{default:c((()=>[u(m,null,{toolsLeft:c((()=>[u(s,{type:"primary",onClick:l},{default:c((()=>t[4]||(t[4]=[_("New automation")]))),_:1})])),table:c((()=>[u(o,{loading:y(i).loading,data:y(i).data,columns:y(n)},null,8,["loading","data","columns"])])),pageRight:c((()=>[u(p,{page:y(h).p,"onUpdate:page":t[0]||(t[0]=e=>y(h).p=e),"page-size":y(h).p_size,"onUpdate:pageSize":t[1]||(t[1]=e=>y(h).p_size=e),"item-count":y(i).total,onRefresh:b},null,8,["page","page-size","item-count"])])),_:1}),u(v,{show:y(a).show,"onUpdate:show":t[2]||(t[2]=e=>y(a).show=e),title:"Add Automated Task",width:500,footer:!0,component:qn},null,8,["show"]),u(v,{show:y(d).show,"onUpdate:show":t[3]||(t[3]=e=>y(d).show=e),title:y(d).title,width:440,data:y(d).data,footer:!0,component:Vn},null,8,["show","title","data"])])),_:1})}}}),Yn=s({__name:"index",setup(e){const t=[{key:"overview",label:"Overview",component:qa},{key:"task",label:"Marketing Task",component:ji},{key:"template",label:"Template",component:Hi},{key:"contact",label:"Subscribers",component:yn},{key:"mail",label:"Groups",component:Tn},{key:"invalid",label:"Suspend List",component:Dn},{key:"automation",label:"Automation",component:Qn}];return(e,l)=>{const i=a,n=wt;return r(),x(n,{class:"p-16px"},{default:c((()=>[u(i,{value:y(Kt),"onUpdate:value":l[0]||(l[0]=e=>f(Kt)?Kt.value=e:null),options:t},null,8,["value"])])),_:1})}}}),Xn=Object.freeze(Object.defineProperty({__proto__:null,default:Yn},Symbol.toStringTag,{value:"Module"}));e("L",Xn)}}}));
