System.register(["./page_layout-legacy.js?v=1744703330658","./index-legacy.js?v=1744703330658","./index.vue_vue_type_script_setup_true_lang-legacy4.js?v=1744703330658","./index.vue_vue_type_script_setup_true_lang-legacy12.js?v=1744703330658","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1744703330658","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1744703330658","./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1744703330658","./public-legacy.js?v=1744703330658","./upload-legacy.js?v=1744703330658","./mail-legacy.js?v=1744703330658","./quota-legacy.js?v=1744703330658","./naive-legacy.js?v=1744703330658","./vue-legacy.js?v=1744703330658","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1744703330658","./common-legacy.js?v=1744703330658","./__commonjsHelpers__-legacy.js?v=1744703330658","./index.vue_vue_type_script_setup_true_lang-legacy8.js?v=1744703330658"],(function(e,a){"use strict";var l,t,i,n,o,s,u,d,r,c,p,_,m,v,x,w,h,g,f,b,M,y,k,B,q,$,j,U,P,C,E,z,S,A,R,D,T,G,I,L,V,W,F,O,K,Y,Z,H,J,N,Q,X,ee,ae,le,te,ie,ne,oe,se,ue,de;return{setters:[e=>{l=e.aS,t=e.i,i=e.u,n=e.d,o=e.k,s=e.I,u=e.h,d=e.J,r=e.b9,c=e.a,p=e.cz},e=>{_=e._},e=>{m=e._},e=>{v=e._},e=>{x=e._},e=>{w=e._},e=>{h=e._},e=>{g=e.e,f=e.d,b=e.b,M=e.F,y=e.f,k=e.h,B=e.a,q=e.u},e=>{$=e.o},e=>{j=e.q,U=e.r,P=e.c,C=e.t,E=e.u,z=e.v,S=e.w,A=e.x},e=>{R=e.a},e=>{D=e.T,T=e._,G=e.ch,I=e.b$,L=e.bY,V=e.cn,W=e.ck},e=>{F=e.d,O=e.t,K=e.R,Y=e.S,Z=e.P,H=e.a0,J=e.U,N=e.a1,Q=e.c,X=e.O,ee=e.r,ae=e.j,le=e.V,te=e.$,ie=e.ap,ne=e.ai,oe=e.ab,se=e.af,ue=e.Y},e=>{de=e._},null,null,null],execute:function(){var re=document.createElement("style");re.textContent=".n-button[data-v-559afaf8]{padding:0 24px;--n-height: 40px;--n-border-radius: 2px;--n-color: #eee;--n-text-color: #333;--n-border: none;--n-color-hover: #20a53a;--n-border-hover: 1px solid #20a53a;--n-text-color-hover: #fff;--n-color-focus: #20a53a;--n-text-color-focus: #fff;--n-border-focus: 1px solid #20a53a}.bg-recommend[data-v-559afaf8]{position:absolute;width:32px;height:32px;top:-1px;left:-1px;background-image:url(/static/vite/images/recommend.svg);background-repeat:no-repeat;background-position:center;background-size:contain}\n",document.head.appendChild(re);const ce={class:"flex justify-center p-32px"},pe=o(F({__name:"login",props:{row:{},info:{}},setup(e){const a=O(e,"row"),o=i(),s=async()=>{if(o.isFree)return void g({source:221});const{message:e}=await(i={rc_user:a.value.username,rc_pass:a.value.password},l.post("/plugin?action=a&name=mail_sys&s=login_roundcube_multiple",i,{requestOptions:{loading:t.global.t("Mail.Api.index_36")}}));var i;n(e)&&window.open(`${e.result}`)},u=()=>{a.value.webmail_url&&window.open(`${a.value.webmail_url.url}`)};return(e,a)=>{const l=D;return K(),Y("div",ce,[Z(l,{onClick:s},{default:H((()=>[J("span",null,N(e.$t("Database.PhpAdmin.index_11")),1),a[0]||(a[0]=J("span",{class:"bg-recommend"},null,-1))])),_:1}),Z(l,{class:"ml-32px",onClick:u},{default:H((()=>[Q(N(e.$t("Database.PhpAdmin.index_6")),1)])),_:1})])}}}),[["__scopeId","data-v-559afaf8"]]),_e={class:"p-20px"},me={class:"w-280px"},ve={class:"w-100px ml-10px"},xe={class:"w-280px"},we={class:"w-130px"},he={class:"w-140px ml-10px"},ge={class:"w-280px"},fe=F({__name:"index",props:{row:{},isEdit:{type:Boolean}},emits:["refresh"],setup(e,{expose:a,emit:l}){const t=e,i=l,{isEdit:n}=t,{t:o}=X(),r=ee(null),c=ae({full_name:"",domain:null,quota:5,quota_unit:"GB",is_admin:0,username:"",password:"",active:1,quota_limit:1}),p=ee([]),_=[{label:"GB",value:"GB"},{label:"MB",value:"MB"}],m=[{label:o("Mail.MailBox.index_19"),value:0},{label:o("Mail.MailBox.index_20"),value:1}],v={full_name:{trigger:["blur","input"],validator:()=>""!==c.full_name.trim()||new Error(o("Mail.MailBox.index_21"))},username:{trigger:["blur","input"],validator:()=>""!==c.username.trim()||new Error(o("Mail.MailBox.index_22"))},quota:{trigger:["blur","input"],validator:()=>(console.log(c.quota),!!c.quota||new Error(o("Mail.MailBox.index_23")))},password:{trigger:["blur","input"],validator:()=>{if(n){if(c.password&&c.password.trim().length<8)return new Error(o("Mail.MailBox.index_26"));const e=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/;if(c.password&&!e.test(c.password))return new Error(o("Mail.MailBox.index_27"))}else{if(c.password.trim().length<8)return new Error(o("Mail.MailBox.index_24"));if(!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/.test(c.password))return new Error(o("Mail.MailBox.index_25"))}return!0}}},x=()=>({full_name:c.full_name,quota:c.quota+" "+c.quota_unit,is_admin:c.is_admin,username:c.username+"@"+c.domain,password:c.password,active:c.active,quota_active:c.quota_limit});return(async()=>{const{message:e}=await P();s(e)&&(p.value=e.map((e=>({label:e,value:e}))),null===c.domain&&(c.domain=e[0]))})(),(()=>{const{row:e,isEdit:a}=t;if(a&&e){c.full_name=e.full_name,c.is_admin=e.is_admin,c.username=e.username.split("@")[0],c.active=e.active;const[a,l]=e.username.split("@");c.username=a,c.domain=l;const t=u(e.quota),[i,n]=t.split(" ");c.quota=d(i),c.quota_unit=n,c.quota_limit=e.quota_active}})(),a({onConfirm:async()=>{await(r.value?.validate()),n?await j(x()):await U(x()),i("refresh")}}),(e,a)=>{const l=T,t=G,i=I,o=L,s=V,u=de;return K(),Y("div",_e,[Z(u,{ref_key:"formRef",ref:r,model:le(c),rules:v},{default:H((()=>[Z(t,{label:e.$t("Mail.MailBox.index_10"),path:"full_name"},{default:H((()=>[J("div",me,[Z(l,{value:le(c).full_name,"onUpdate:value":a[0]||(a[0]=e=>le(c).full_name=e),placeholder:e.$t("Mail.MailBox.index_11")},null,8,["value","placeholder"])])])),_:1},8,["label"]),Z(t,{label:"Quota limit"},{default:H((()=>[Z(i,{"checked-value":1,"unchecked-value":0,value:le(c).quota_limit,"onUpdate:value":a[1]||(a[1]=e=>le(c).quota_limit=e)},null,8,["value"])])),_:1}),le(c).quota_limit?(K(),te(t,{key:0,label:e.$t("Mail.MailBox.index_3"),path:"quota"},{default:H((()=>[Z(o,{value:le(c).quota,"onUpdate:value":a[2]||(a[2]=e=>le(c).quota=e),class:"w-170px",min:0,"show-button":!1,placeholder:e.$t("Mail.MailBox.index_12")},null,8,["value","placeholder"]),J("div",ve,[Z(s,{value:le(c).quota_unit,"onUpdate:value":a[3]||(a[3]=e=>le(c).quota_unit=e),options:_},null,8,["value"])])])),_:1},8,["label"])):ie("",!0),Z(t,{label:e.$t("Mail.MailBox.index_13"),path:"is_admin"},{default:H((()=>[J("div",xe,[Z(s,{value:le(c).is_admin,"onUpdate:value":a[4]||(a[4]=e=>le(c).is_admin=e),options:m},null,8,["value"])])])),_:1},8,["label"]),Z(t,{label:e.$t("Mail.MailBox.index_14"),path:"username"},{default:H((()=>[J("div",we,[Z(l,{value:le(c).username,"onUpdate:value":a[5]||(a[5]=e=>le(c).username=e),disabled:le(n),placeholder:e.$t("Mail.MailBox.index_15")},null,8,["value","disabled","placeholder"])]),J("div",he,[Z(s,{value:le(c).domain,"onUpdate:value":a[6]||(a[6]=e=>le(c).domain=e),disabled:le(n),filterable:!0,options:le(p)},null,8,["value","disabled","options"])])])),_:1},8,["label"]),Z(t,{label:e.$t("Mail.MailBox.index_16"),path:"password"},{default:H((()=>[J("div",ge,[Z(l,{value:le(c).password,"onUpdate:value":a[7]||(a[7]=e=>le(c).password=e),placeholder:le(n)?e.$t("Mail.MailBox.index_17"):e.$t("Mail.MailBox.index_18")},null,8,["value","placeholder"])])])),_:1},8,["label"]),le(n)?ie("",!0):(K(),te(t,{key:1,label:e.$t("Public.Table.Status"),path:"active","show-feedback":!1},{default:H((()=>[Z(i,{value:le(c).active,"onUpdate:value":a[8]||(a[8]=e=>le(c).active=e),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1},8,["label"]))])),_:1},8,["model"])])}}}),be={class:"w-220px mr-8px"},Me="/www/server/panel/data/mail";e("default",F({__name:"index",setup(e){const l=ue((()=>c((()=>a.import("./batch-legacy2.js?v=1744703330658")),void 0))),{t:t}=X(),o=i(),d=ne(),U=ee([]),T=()=>{U.value.unshift({label:t("Public.All"),value:"all"})},G=({option:e})=>`${t("Mail.MailBox.index_29")}${e.label}`,L=()=>{$({path:Me,uploadData:{accept:".json",multiple:!1},onUploadSuccess:async e=>{const a=Me+e[0].fullPath;await A({file:a}),Be()}})},F=async()=>{const{message:e}=await z({domain:O.domain});n(e)&&p(e.result)},O=ae({p:1,size:10,domain:"all",search:""}),Y=f("",{isEdit:!1,row:void 0,onRefresh:()=>{Be()}}),de=()=>{Y.data.isEdit=!1,Y.data.row=void 0,Y.title=t("Mail.MailBox.index_1"),Y.show=!0},re=()=>{o.isFree?g({source:327}):qe.show=!0},{keys:ce,table:_e,columns:me}=b([{type:"selection",width:40},{key:"username",title:t("Public.Table.Username"),ellipsis:{tooltip:!0}},M({width:160}),{key:"info",title:t("Mail.MailBox.index_2"),width:180,render:e=>Z("a",{class:"bt-link",href:"javascript:;",onClick:()=>{we(e)}},[t("Public.Btn.Copy")])},{key:"quota",title:t("Mail.MailBox.index_3"),render:e=>e.quota_active?`${u(e.current_usage)}/${u(e.quota)}`:Z("img",{src:R},null)},{key:"is_admin",title:t("Mail.MailBox.index_4"),render:e=>1===e.is_admin?"Admin":"General user"},{key:"active",title:t("Public.Table.Status"),render:e=>Z(I,{value:e.active,size:"small",checkedValue:1,uncheckedValue:0,onUpdateValue:async a=>{await j({username:e.username,full_name:e.full_name,quota:u(e.quota),active:a,is_admin:e.is_admin,quota_active:e.quota_active}),e.active=a}},null)},y({width:150,options:e=>[{label:"WebMail",onClick:()=>{e.webmail_url?he(e):ve()}},{label:t("Public.Btn.Edit"),onClick:()=>{ge(e)}},{label:t("Public.Btn.Del"),onClick:()=>{ye(e)}}]})]),ve=()=>{const{hide:e}=B({title:t("Mail.MailBox.index_5"),content:()=>Z(oe,{tag:"div",keypath:"Mail.MailBox.index_6",scope:"global"},{link_1:()=>Z("a",{class:"bt-link",href:"javascript:;",onClick:()=>{d.push("/mail/domain"),e()}},[t("Layout.Sider.mail_1"),Q(" > Mail Domain")])}),onConfirm:()=>{d.push("/mail/domain")}})},xe=[{key:"delete",type:"confirm",label:t("Site.Batch.index_21"),confirm:{title:t("Site.Batch.index_21"),desc:t("Site.Batch.index_11"),columns:[{...me.value[1],width:"auto"}],api:e=>C({username:e.username},!1),done:()=>{Be()}}}],we=e=>{const a=e.webmail_url?e.webmail_url.url:"Not installed WebMail";k(`WebMail: ${a}\nUsername: ${e.username}\nPassword: ${e.password}\nPOP service [ Address: ${e.mx} Port: 110/995 ]\nIMAP service [ Address: ${e.mx} Port: 143/993 ]\nSMTP service [ Address: ${e.mx} Port: 25/465/587 ]\n`)},he=async e=>{q({title:"WebMail",width:400,data:{row:e,info:ke},component:pe})},ge=e=>{Y.data.isEdit=!0,Y.data.row=e,Y.title=t("Mail.MailBox.index_7"),Y.show=!0},ye=async e=>{B({title:t("Mail.MailBox.index_8"),content:t("Mail.MailBox.index_9",[e.username]),onConfirm:async()=>{await C({username:e.username}),Be()}})},ke=ae({id:0,site_name:"",status:!1,ssl_status:!1}),Be=async()=>{try{_e.loading=!0;const{message:e}=await E({p:O.p,size:O.size,search:O.search,..."all"!==O.domain?{domain:O.domain}:{}});n(e)&&(_e.data=s(e.data)?e.data:[],e.page?_e.total=r(e.page):_e.total=e.total)}finally{_e.loading=!1,ce.value=[]}},qe=f(t("Mail.MailBox.index_31"),{getList:Be}),$e=()=>{O.p=1,Be()};return T(),(async()=>{const{message:e}=await P();s(e)&&(U.value=e.map((e=>({label:e,value:e}))),T())})(),(async()=>{try{_e.loading=!0,await(async()=>{const{message:e}=await S();n(e)&&(ke.id=e.id,ke.status=e.status,ke.site_name=e.site_name,ke.ssl_status=e.ssl_status)})(),await Be()}finally{_e.loading=!1}})(),(e,a)=>{const t=D,i=V,n=h,o=w,s=x,u=v,d=m,r=_,c=W;return K(),te(c,{class:"p-16px"},{default:H((()=>[Z(d,null,{toolsLeft:H((()=>[Z(t,{type:"primary",onClick:de},{default:H((()=>[Q(N(e.$t("Mail.MailBox.index_1")),1)])),_:1}),Z(t,{onClick:re},{default:H((()=>[Q(N(e.$t("Mail.MailBox.index_30")),1)])),_:1}),ie("",!0),Z(t,{onClick:L},{default:H((()=>[Q(N(e.$t("Public.Btn.Import")),1)])),_:1}),Z(t,{onClick:F},{default:H((()=>[Q(N(e.$t("Public.Btn.Export")),1)])),_:1})])),toolsRight:H((()=>[J("div",be,[Z(i,{value:le(O).domain,"onUpdate:value":[a[0]||(a[0]=e=>le(O).domain=e),$e],options:le(U),"render-tag":G,filterable:!0},null,8,["value","options"])]),Z(n,{value:le(O).search,"onUpdate:value":a[1]||(a[1]=e=>le(O).search=e),width:"280",placeholder:e.$t("Mail.MailBox.index_28"),onSearch:$e},null,8,["value","placeholder"])])),table:H((()=>[Z(o,{"row-key":"username","checked-row-keys":le(ce),"onUpdate:checkedRowKeys":a[2]||(a[2]=e=>se(ce)?ce.value=e:null),loading:le(_e).loading,data:le(_e).data,columns:le(me)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:H((()=>[Z(s,{page:le(O).p,"onUpdate:page":a[3]||(a[3]=e=>le(O).p=e),"page-size":le(O).size,"onUpdate:pageSize":a[4]||(a[4]=e=>le(O).size=e),"item-count":le(_e).total,onRefresh:Be},null,8,["page","page-size","item-count"])])),pageLeft:H((()=>[Z(u,{"row-key":"username","checked-row-keys":le(ce),"onUpdate:checkedRowKeys":a[5]||(a[5]=e=>se(ce)?ce.value=e:null),data:le(_e).data,options:xe},null,8,["checked-row-keys","data"])])),_:1}),Z(r,{show:le(Y).show,"onUpdate:show":a[6]||(a[6]=e=>le(Y).show=e),title:le(Y).title,data:le(Y).data,width:480,"min-height":236,footer:!0,component:fe},null,8,["show","title","data"]),Z(r,{show:le(qe).show,"onUpdate:show":a[7]||(a[7]=e=>le(qe).show=e),title:le(qe).title,data:le(qe).data,width:480,"min-height":236,footer:!0,component:le(l)},null,8,["show","title","data","component"])])),_:1})}}}))}}}));
