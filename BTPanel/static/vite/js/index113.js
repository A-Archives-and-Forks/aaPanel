import{_ as a}from"./index.js?v=1753954525509";import{_ as e}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1753954525509";import{b as t,c as r,f as n,h as s,d as l,e as i}from"./public.js?v=1753954525509";import{_ as o}from"./index.vue_vue_type_script_setup_true_lang.js?v=1753954525509";import{a$ as d,w as p,X as _,c as u,x as g}from"./page_layout.js?v=1753954525509";import{h as c,i as m,g as b,j as x,k as h,l as v}from"./organization.js?v=1753954525509";import{k as w,P as f,r as C,e as y,U as k,V as j,Q as U,a2 as P,X as L,a1 as $,al as T,m as q,j as z,a3 as E}from"./vue.js?v=1753954525509";import{c3 as R,cG as S,cA as D,aq as I,bY as X,ay as A}from"./naive.js?v=1753954525509";import{_ as B}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1753954525509";import"./common.js?v=1753954525509";import"./__commonjsHelpers__.js?v=1753954525509";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1753954525509";const F={class:"p-20px"},G=w({__name:"form",props:{data:{}},setup(a,{expose:e}){const{t:t}=f(),r=a,{isEdit:n,row:s,getList:l,id:i}=r.data,_=C([]),u=C(null),g=y({contrast:"in",compare:"",executeType:"1",script:null,args:"",id:0}),x=y({is_args:!1,args_holder:"",args_title:""}),h=a=>q(R,{trigger:"hover",placement:"top-start"},{trigger:()=>q("span",a.label),default:()=>q("span",a.label)}),v=(a,e)=>{x.is_args=e.is_args,x.args_holder=e.args_ps,x.args_title=e.args_title},w=[{label:t("Crontab.Planned.index_3"),value:"1"}],z=[{label:t("Crontab.arrange.index_9"),value:"in"},{label:t("Crontab.arrange.index_10"),value:"not in"},{label:t("Crontab.arrange.index_11"),value:"="},{label:t("Crontab.arrange.index_12"),value:"!="}],E={compare:{required:!0,message:t("Crontab.arrange.index_8"),trigger:["blur","input"]},script:{required:!0,type:"number",message:t("Crontab.arrange.index_13"),trigger:["blur","input"]},args:{required:!0,trigger:["blur","change"],message:t("Security.Conf.Index_28")}},A=()=>({run_script_id:g.script,operator:g.contrast,op_value:g.compare,run_script:"",args:g.args,...n?{where_id:g.id}:{trigger_id:i}});return(async()=>{const{message:a}=await b();p(a)&&(_.value=a.map((a=>({label:a.name,value:a.name,children:a.script_list.map((a=>({label:a.name,value:a.script_id,is_args:a.is_args,args_ps:a.args_ps,args_title:a.args_title})))}))))})(),n&&s&&(g.contrast=s.operator,g.compare=s.op_value,g.script=s.run_script_id,g.args=s.args,x.is_args=!!s.script_info.is_args,x.args_holder=s.script_info.args_ps,x.args_title=s.script_info.args_title,g.id=s.where_id),e({onConfirm:async({hide:a})=>{var e;await(null==(e=u.value)?void 0:e.validate()),n?await c(A()):await m(A()),null==l||l(),a()}}),(a,e)=>{const t=S,r=D,n=I,s=X,l=d,i=o;return k(),j("div",F,[U(i,{ref_key:"formRef",ref:u,model:L(g),rules:E},{default:P((()=>[U(s,null,{default:P((()=>[U(r,{label:a.$t("Crontab.Planned.index_23")},{default:P((()=>[U(t,{class:"w-120px!",value:L(g).contrast,"onUpdate:value":e[0]||(e[0]=a=>L(g).contrast=a),options:z},null,8,["value"])])),_:1},8,["label"]),U(r,{path:"compare"},{default:P((()=>[U(n,{class:"w-215px!",value:L(g).compare,"onUpdate:value":e[1]||(e[1]=a=>L(g).compare=a),placeholder:a.$t("Crontab.arrange.index_8")},null,8,["value","placeholder"])])),_:1})])),_:1}),U(s,null,{default:P((()=>[U(r,{label:a.$t("Docker.LocalImage.pull.index_12")},{default:P((()=>[U(t,{class:"w-120px!",value:L(g).executeType,"onUpdate:value":e[2]||(e[2]=a=>L(g).executeType=a),options:w},null,8,["value"])])),_:1},8,["label"]),U(r,{path:"script"},{default:P((()=>[U(l,{class:"w-218px!",value:L(g).script,"onUpdate:value":[e[3]||(e[3]=a=>L(g).script=a),v],filterable:!0,"check-strategy":"child","show-path":!1,placeholder:a.$t("Crontab.arrange.index_29"),options:L(_),"render-label":h},null,8,["value","placeholder","options"])])),_:1})])),_:1}),L(x).is_args?(k(),$(r,{key:0,label:L(x).args_title,path:"args"},{default:P((()=>[U(n,{class:"w-350px!",value:L(g).args,"onUpdate:value":e[4]||(e[4]=a=>L(g).args=a),placeholder:L(x).args_holder},null,8,["value","placeholder"])])),_:1},8,["label"])):T("",!0)])),_:1},8,["model"])])}}}),H={class:"p-20px"},O=w({__name:"logs",props:{data:{}},setup(a,{expose:s}){const{t:l}=f(),i=a,{id:o}=i.data,d=y({p:1,rows:10}),{keys:p,table:c,columns:m}=t([{key:"name",title:l("Crontab.arrange.index_5"),render:a=>q("span",{},[_(a.start_time)])},{key:"name",title:l("Crontab.arrange.index_6"),render:a=>{const e=a.end_time-a.start_time;return q("span",{},["".concat(e<1?"<1":e).concat(l("Crontab.Planned.index_45"))])}},{key:"name",title:l("Crontab.Planned.index_23"),render:function(a){return q("span",{},[a.status?q("span",{class:"text-[#20a53a]"},l("Crontab.arrange.index_35")):q("span",{class:"text-[#ef0808]"},l("Crontab.arrange.index_36"))])}},{key:"name",title:l("Crontab.arrange.index_20"),ellipsis:{tooltip:!0},width:"50%",render:function(a){return q("span",{class:"h-60px p-5px"},[a.status?a.result_succ:a.result_err])}}]),{loading:b,setLoading:h}=r(),v=async()=>{try{h(!0);const{message:a}=await x({...d,where_id:o});u(a)&&(c.data=a.data,c.total=g(a.page))}finally{p.value=[],h(!1)}};return v(),s({init:v}),(a,t)=>{const r=n,s=B,l=e;return k(),j("div",H,[U(l,null,{table:P((()=>[U(r,{"max-height":250,loading:L(b),data:L(c).data,columns:L(m)},null,8,["loading","data","columns"])])),pageRight:P((()=>[U(s,{page:L(d).p,"onUpdate:page":t[0]||(t[0]=a=>L(d).p=a),"page-size":L(d).rows,"onUpdate:pageSize":t[1]||(t[1]=a=>L(d).rows=a),"item-count":L(c).total,onRefresh:v},null,8,["page","page-size","item-count"])])),_:1})])}}}),Q={class:"p-20px"},V=w({__name:"index",props:{data:{}},setup(o,{expose:d}){const{t:_}=f(),u=o,{id:g}=u.data,{keys:c,table:m,columns:b}=t([{key:"name",title:_("Crontab.arrange.index_15"),ellipsis:{tooltip:{width:"trigger"}},render:a=>{const e={in:_("Crontab.arrange.index_9"),"not in":_("Crontab.arrange.index_10"),"=":_("Crontab.arrange.index_11"),"!=":_("Crontab.arrange.index_12")};return q("span",{},_("Crontab.arrange.index_39",[a.script_info.name,e[a.operator],a.op_value]))}},s({width:130,options:a=>[{label:_("Site.TableOP.index_7"),onClick:()=>{R(a)}},{label:_("Ftp.Table.index_15"),onClick:()=>{$.data.id=a.where_id,$.show=!0}},{label:_("Public.Btn.Del"),onClick:()=>{l({title:_("Crontab.arrange.index_16"),content:_("Crontab.arrange.index_18"),onConfirm:async({hide:e})=>{await h({where_id:a.where_id}),C(),e()}})}}]})]),{loading:x,setLoading:w}=r(),C=async()=>{try{w(!0);const{message:a}=await v({trigger_id:g});p(a)&&(m.data=a)}finally{c.value=[],w(!1)}},y=i(_("Crontab.arrange.index_14"),{getList:C,id:g}),$=i(_("Crontab.arrange.index_17")),T=()=>{y.data.isEdit=!1,y.title=_("Crontab.arrange.index_14"),y.show=!0},R=a=>{y.data.row=a,y.data.isEdit=!0,y.title=_("Crontab.arrange.index_19"),y.show=!0};return C(),d({init:C}),(t,r)=>{const s=A,l=n,i=e,o=a;return k(),j("div",Q,[U(i,null,{toolsLeft:P((()=>[U(s,{type:"primary",onClick:T},{default:P((()=>[z(E(t.$t("Crontab.arrange.index_14")),1)])),_:1})])),table:P((()=>[U(l,{loading:L(x),"max-height":200,data:L(m).data,columns:L(b)},null,8,["loading","data","columns"])])),_:1}),U(o,{show:L(y).show,"onUpdate:show":r[0]||(r[0]=a=>L(y).show=a),title:L(y).title,data:L(y).data,width:600,footer:!0,component:G},null,8,["show","title","data"]),U(o,{show:L($).show,"onUpdate:show":r[1]||(r[1]=a=>L($).show=a),title:L($).title,data:L($).data,width:850,component:O},null,8,["show","title","data"])])}}});export{V as default};
