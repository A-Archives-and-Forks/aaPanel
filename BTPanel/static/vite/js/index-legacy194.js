System.register(["./index-legacy.js?v=1741416570306","./index-legacy95.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1741416570306","./page_layout-legacy.js?v=1741416570306","./public-legacy.js?v=1741416570306","./mail-legacy.js?v=1741416570306","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1741416570306","./vue-legacy.js?v=1741416570306","./naive-legacy.js?v=1741416570306","./index-legacy103.js?v=1741416570306","./common-legacy.js?v=1741416570306","./__commonjsHelpers__-legacy.js?v=1741416570306"],(function(e,t){"use strict";var a,l,s,n,i,o,c,r,d,u,_,m,p,g,h,y,x,f,v,w,b,S,j,M,k,R,P,C,$,B,z,E,U,H,N,O;return{setters:[e=>{a=e._,l=e.a},e=>{s=e._},e=>{n=e._},e=>{i=e.b,o=e.m},e=>{c=e.j,r=e.b,d=e.d,u=e.a,_=e.c},e=>{m=e.ak,p=e.al,g=e.am,h=e.an,y=e.ao},e=>{x=e._},e=>{f=e.d,v=e.M,w=e.r,b=e.j,S=e.P,j=e.Q,M=e.N,k=e.$,R=e.R,P=e.S,C=e.a0,$=e.a7,B=e.ah,z=e._,E=e.c},e=>{U=e._,H=e.cb,N=e.T},e=>{O=e._},null,null],execute:function(){const t={class:"p-20px"},T={class:"w-260px"},q=f({__name:"hostname",emits:["refresh"],setup(e,{expose:a,emit:l}){const n=l,{t:i}=v(),o=w(null),c=b({hostname:""}),r={hostname:{trigger:["input","blur"],validator:()=>""!==c.hostname.trim()||new Error(i("Mail.Setting.index_50"))}};return a({onConfirm:async()=>{await(o.value?.validate()),await m($(c)),n("refresh")}}),(e,a)=>{const l=U,n=H,i=x,d=s;return S(),j("div",t,[M(i,{ref_key:"formRef",ref:o,model:P(c),rules:r},{default:k((()=>[M(n,{label:e.$t("Mail.Setting.index_48"),path:"hostname"},{default:k((()=>[R("div",T,[M(l,{value:P(c).hostname,"onUpdate:value":a[0]||(a[0]=e=>P(c).hostname=e)},null,8,["value"])])])),_:1},8,["label"])])),_:1},8,["model"]),M(d,{class:"mt-8px"},{default:k((()=>[R("li",null,C(e.$t("Mail.Setting.index_49")),1)])),_:1})])}}}),A=f({__name:"log",emits:["close","close-env"],setup(e,{emit:t}){const a=t,{t:l}=v(),s=w(l("Mail.Setting.index_47")),n=async()=>{const{message:e}=await p();i(e)&&(s.value=e.result||l("Mail.Setting.index_47"))},{loop:o}=c((async()=>{await n()}),1),r=B();return(async()=>{(async()=>{await g(),a("close"),a("close-env"),r.push("/mail/domain")})(),await n(),o()})(),(e,t)=>{const a=O;return S(),z(a,{log:P(s)},null,8,["log"])}}}),D={class:"flex flex-col h-full overflow-hidden"},L={class:"flex-1 p-20px overflow-auto"};e("default",f({__name:"index",emits:["close"],setup(e,{emit:t}){const c=t,{t:m}=v(),p=["Redis-install","Redis-Passwd","SElinux"],{table:g,columns:x}=r([{key:"env",title:m("Mail.Setting.index_39"),width:150},{key:"details",title:m("Mail.Setting.index_40"),ellipsis:{tooltip:!0},render:e=>{let t="";const{env:a,status:l,details:s}=e,n=p.includes(a);return t=s&&n?l?"Ready":s:l?"Ready":""!=s?s:"Abnormity",M("span",{class:l?"text-primary":"text-error"},[t])}},{key:"action",title:m("Public.Table.Operation"),width:120,render:e=>{const{env:t,status:a,details:l}=e;return p.includes(t)||!l||a?m("Mail.Setting.index_41"):M("a",{class:"bt-link",href:"javascript:;",onClick:()=>{"HostName"===e.env?w(e):b(e)}},[m("Public.Btn.Repair")])}}]),f=d(m("Mail.Setting.index_42"),{onRefresh:()=>{z()}}),w=e=>{f.data.row=e,f.show=!0},b=e=>{u({title:m("Mail.Setting.index_43"),content:m("Mail.Setting.index_44"),onConfirm:async()=>{const{env:t}=e;let a="";switch(t){case"Postfix-Version":case"Postfix-install":case"Sqlite-support":a="repair_postfix";break;case"Rspamd-install":a="install_rspamd";break;case"Dovecot-install":a="repair_dovecot"}await h(t,a),z()}})},{loading:$,setLoading:B}=_(),z=async()=>{try{B(!0);const{message:e}=await y();i(e)&&(g.data=Object.entries(e).map((([e,t])=>({env:e,details:t.msg,status:t.status}))))}finally{B(!1)}},U=()=>{c("close")},H=d(m("Mail.Setting.index_45"),{onCloseEnv:()=>{U()}}),O=async()=>{g.data.every((e=>e.status))?H.show=!0:o.error(m("Mail.Setting.index_46"))};return z(),(e,t)=>{const i=n,o=s,c=a,r=N,d=l;return S(),j("div",D,[R("div",L,[M(i,{"max-height":364,"single-line":!1,loading:P($),data:P(g).data,columns:P(x)},null,8,["loading","data","columns"]),M(o,{class:"mt-20px"},{default:k((()=>[R("li",null,C(e.$t("Mail.Setting.index_38")),1)])),_:1}),M(c,{show:P(f).show,"onUpdate:show":t[0]||(t[0]=e=>P(f).show=e),title:P(f).title,data:P(f).data,width:500,footer:!0,component:q},null,8,["show","title","data"]),M(c,{show:P(H).show,"onUpdate:show":t[1]||(t[1]=e=>P(H).show=e),title:P(H).title,data:P(H).data,"hide-close":!0,width:700,height:490,component:A},null,8,["show","title","data"])]),M(d,null,{default:k((()=>[M(r,{class:"cancel-btn",color:"#cbcbcb",size:"small",onClick:U},{default:k((()=>[E(C(e.$t("Public.Btn.Cancel")),1)])),_:1}),M(r,{type:"primary",size:"small",onClick:z},{default:k((()=>[E(C(e.$t("Public.Btn.Refresh")),1)])),_:1}),M(r,{type:"primary",size:"small",onClick:O},{default:k((()=>[E(C(e.$t("Public.Btn.Submit")),1)])),_:1})])),_:1})])}}}))}}}));
