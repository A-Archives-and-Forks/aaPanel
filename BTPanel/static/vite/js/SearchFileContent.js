import{_ as e}from"./index.js?v=1756367574781";import{_ as a,q as l,bJ as t,bI as s,m as o,t as n,p as i}from"./page_layout.js?v=1756367574781";import{k as c,P as r,i as u,r as d,R as f,V as h,W as p,a3 as v,S as m,U as _,j as b,a4 as C,a2 as k,an as F,F as j,O as y,av as x,ak as M}from"./vue.js?v=1756367574781";import{d as $}from"./index39.js?v=1756367574781";import{R as g}from"./ResourceManagerWindow.js?v=1756367574781";import{dW as w,dR as U,av as O,au as R,aC as S,_ as P,dT as W,dU as D}from"./naive.js?v=1756367574781";import"./common.js?v=1756367574781";import"./__commonjsHelpers__.js?v=1756367574781";import"./public.js?v=1756367574781";import"./soft2.js?v=1756367574781";import"./soft.js?v=1756367574781";import"./file2.js?v=1756367574781";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1756367574781";const I={class:"search-wrapper"},q={class:"w-100% flex justify-start gap-6 items-center"},z={class:"w-100% flex justify-between"},A={class:"search-res"},E={class:"top-desc"},H={class:"mr-5px"},J={class:"match-list"},K={class:"text-font1 fw-bold"},T=i(c({__name:"SearchFileContent",props:{currentPath:{type:String,default:"/"}},setup(i,{expose:c}){const T=i,{t:V}=r(),B=u("fileStore"),{currentPath:G,resetSearchFileContentFormData:L,choosedKeys:N}=B;function Q(){L()}c({open:function(){le.value=!0,Z.value.path=G.value},close:Q});const{searchStatistics:X,searchRes:Y,searchFileContentFormData:Z}=B,ee=d(),ae=d(T.currentPath),le=d(!1);function te(){!async function(){const e=o.loading(V("file.searchFileContentModal.searching"));try{const e=await n.post("/files?action=files_search",Z.value,{requestOptions:{isOriginalResult:!0}});Y.value=e.message,Object.keys(Y.value).length&&(console.log(Object.values(Y.value).flat()),X.value.files=Object.keys(Y.value).length,X.value.times=Object.values(Y.value).flat().reduce((e,a)=>e+Object.values(a).length,0))}catch(a){console.warn(a)}finally{e.close()}}()}function se(){ee.value.open()}function oe(e){Z.value.path=e}return(o,n)=>{const i=R,c=S,r=O,u=U,d=P,T=a,V=D,G=W,L=w,ne=l,ie=s,ce=t,re=e;return h(),f(j,null,[p(re,{show:_(le),"onUpdate:show":n[7]||(n[7]=e=>M(le)?le.value=e:null),title:o.$t("file.searchFileContentModal.title"),width:720,onPublicClose:Q},{default:v(()=>[m("div",I,[p(L,{"label-placement":"left","label-width":60,"label-align":"left"},{default:v(()=>[p(u,{label:o.$t("file.searchFileContentModal.search")},{default:v(()=>[p(r,null,{default:v(()=>[p(i,{value:_(Z).text,"onUpdate:value":n[0]||(n[0]=e=>_(Z).text=e)},null,8,["value"]),p(c,{type:"primary",onClick:te},{default:v(()=>[b(C(o.$t("file.searchFileContentModal.search")),1)]),_:1})]),_:1})]),_:1},8,["label"]),p(u,{label:o.$t("file.searchFileContentModal.suffix")},{default:v(()=>[p(i,{value:_(Z).exts,"onUpdate:value":n[1]||(n[1]=e=>_(Z).exts=e)},null,8,["value"])]),_:1},8,["label"]),p(u,{label:o.$t("file.searchFileContentModal.folder")},{default:v(()=>[m("div",q,[p(i,{value:_(Z).path,"onUpdate:value":n[3]||(n[3]=e=>_(Z).path=e)},{suffix:v(()=>[p(d,{checked:_(Z).is_subdir,"onUpdate:checked":n[2]||(n[2]=e=>_(Z).is_subdir=e),"checked-value":1,"unchecked-value":0},{default:v(()=>[b(C(o.$t("file.searchFileContentModal.subdir")),1)]),_:1},8,["checked"])]),_:1},8,["value"]),p(T,{name:"file-dir",color:"#000",size:"24",style:{cursor:"pointer"},onClick:se})])]),_:1},8,["label"]),p(u,{label:o.$t("file.searchFileContentModal.mode")},{default:v(()=>[m("div",z,[p(G,{value:_(Z).mode,"onUpdate:value":n[4]||(n[4]=e=>_(Z).mode=e)},{default:v(()=>[p(V,{value:0},{default:v(()=>[b(C(o.$t("file.searchFileContentModal.words")),1)]),_:1}),p(V,{value:1},{default:v(()=>[b(C(o.$t("file.searchFileContentModal.regex")),1)]),_:1})]),_:1},8,["value"]),m("div",null,[0==_(Z).mode?(h(),k(d,{key:0,checked:_(Z).isword,"onUpdate:checked":n[5]||(n[5]=e=>_(Z).isword=e),label:o.$t("file.searchFileContentModal.matchWholeWord"),class:"mr-5","checked-value":1,"unchecked-value":0},null,8,["checked","label"])):F("",!0),p(d,{checked:_(Z).iscase,"onUpdate:checked":n[6]||(n[6]=e=>_(Z).iscase=e),label:o.$t("file.searchFileContentModal.matchCase"),"checked-value":1,"unchecked-value":0},null,8,["checked","label"])])])]),_:1},8,["label"])]),_:1}),m("div",A,[m("div",E,[m("span",H,C(o.$t("file.searchFileContentModal.searchResult")),1),m("span",null,C(_(X).times)+" "+C(o.$t("file.searchFileContentModal.matchesIn"))+" "+C(_(X).files)+" "+C(o.$t("file.searchFileContentModal.files")),1)]),p(ne,{style:{"margin-bottom":"20px"}}),(h(!0),f(j,null,y(_(Y),(e,a)=>(h(),k(ce,{key:a,class:"mb-10px"},{default:v(()=>[p(ie,{title:"".concat(a," (").concat(o.$t("file.searchFileContentModal.match")," ").concat(Object.values(e).length," ").concat(o.$t("file.searchFileContentModal.times"),")"),name:"1"},{"header-extra":v(()=>[p(c,{text:"",type:"primary",onClick:x(e=>async function(e){const a=e.split("/");N.value=a.splice(-1,1),$(B,"AceEditor",e=>e.value.open(a.join("/"))),Q()}(a),["stop"])},{default:v(()=>[b(C(o.$t("file.searchFileContentModal.edit")),1)]),_:2},1032,["onClick"])]),default:v(()=>[m("div",J,[(h(!0),f(j,null,y(e,(e,a)=>(h(),f("div",{class:"match-list-item",key:a},[m("div",K,C(o.$t("file.searchFileContentModal.line"))+" "+C(a)+": ",1),m("div",null,C(e),1)]))),128))])]),_:2},1032,["title"])]),_:2},1024))),128))])])]),_:1},8,["show","title"]),p(g,{"current-path":_(ae),ref_key:"resourceRef",ref:ee,onChooseDir:oe},null,8,["current-path"])],64)}}}),[["__scopeId","data-v-8e683af6"]]);export{T as default};
